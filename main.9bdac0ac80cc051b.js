"use strict";(self.webpackChunkangular_webxr_gallery=self.webpackChunkangular_webxr_gallery||[]).push([[179],{392:(x_,aS,b_)=>{var Iu={};function Ht(n){return"function"==typeof n}function M_(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}b_.r(Iu),b_.d(Iu,{add:()=>Sie,angle:()=>$ie,bezier:()=>Uie,ceil:()=>Eie,clone:()=>wie,copy:()=>bie,create:()=>QF,cross:()=>Oie,dist:()=>ere,distance:()=>rk,div:()=>Qie,divide:()=>ik,dot:()=>ak,equals:()=>Zie,exactEquals:()=>Yie,floor:()=>Cie,forEach:()=>rre,fromValues:()=>xie,hermite:()=>kie,inverse:()=>Lie,len:()=>nre,length:()=>ek,lerp:()=>Fie,max:()=>Aie,min:()=>Tie,mul:()=>Jie,multiply:()=>nk,negate:()=>Pie,normalize:()=>Nie,random:()=>Bie,rotateX:()=>Gie,rotateY:()=>Wie,rotateZ:()=>jie,round:()=>Die,scale:()=>Iie,scaleAndAdd:()=>Rie,set:()=>Mie,sqrDist:()=>tre,sqrLen:()=>ire,squaredDistance:()=>sk,squaredLength:()=>ok,str:()=>qie,sub:()=>Kie,subtract:()=>tk,transformMat3:()=>zie,transformMat4:()=>Vie,transformQuat:()=>Hie,zero:()=>Xie});const S_=M_(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function E_(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Fi{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Ht(i))try{i()}catch(s){e=s instanceof S_?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{uS(s)}catch(o){e=e??[],o instanceof S_?e=[...e,...o.errors]:e.push(o)}}if(e)throw new S_(e)}}add(e){var t;if(e&&e!==this)if(this.closed)uS(e);else{if(e instanceof Fi){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&E_(t,e)}remove(e){const{_finalizers:t}=this;t&&E_(t,e),e instanceof Fi&&e._removeParent(this)}}Fi.EMPTY=(()=>{const n=new Fi;return n.closed=!0,n})();const cS=Fi.EMPTY;function lS(n){return n instanceof Fi||n&&"closed"in n&&Ht(n.remove)&&Ht(n.add)&&Ht(n.unsubscribe)}function uS(n){Ht(n)?n():n.unsubscribe()}const Jo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},sf={setTimeout(n,e,...t){const{delegate:i}=sf;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=sf;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function hS(n){sf.setTimeout(()=>{const{onUnhandledError:e}=Jo;if(!e)throw n;e(n)})}function C_(){}const gk=T_("C",void 0,void 0);function T_(n,e,t){return{kind:n,value:e,error:t}}let Qo=null;function af(n){if(Jo.useDeprecatedSynchronousErrorHandling){const e=!Qo;if(e&&(Qo={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Qo;if(Qo=null,t)throw i}}else n()}class A_ extends Fi{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,lS(e)&&e.add(this)):this.destination=Mk}static create(e,t,i){return new Ru(e,t,i)}next(e){this.isStopped?I_(function vk(n){return T_("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?I_(function _k(n){return T_("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?I_(gk,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const wk=Function.prototype.bind;function D_(n,e){return wk.call(n,e)}class xk{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){cf(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){cf(i)}else cf(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){cf(t)}}}class Ru extends A_{constructor(e,t,i){let r;if(super(),Ht(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Jo.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&D_(e.next,s),error:e.error&&D_(e.error,s),complete:e.complete&&D_(e.complete,s)}):r=e}this.destination=new xk(r)}}function cf(n){Jo.useDeprecatedSynchronousErrorHandling?function yk(n){Jo.useDeprecatedSynchronousErrorHandling&&Qo&&(Qo.errorThrown=!0,Qo.error=n)}(n):hS(n)}function I_(n,e){const{onStoppedNotification:t}=Jo;t&&sf.setTimeout(()=>t(n,e))}const Mk={closed:!0,next:C_,error:function bk(n){throw n},complete:C_},R_="function"==typeof Symbol&&Symbol.observable||"@@observable";function ho(n){return n}function dS(n){return 0===n.length?ho:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Sn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function Ck(n){return n&&n instanceof A_||function Ek(n){return n&&Ht(n.next)&&Ht(n.error)&&Ht(n.complete)}(n)&&lS(n)}(t)?t:new Ru(t,i,r);return af(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=fS(i))((r,s)=>{const o=new Ru({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[R_](){return this}pipe(...t){return dS(t)(this)}toPromise(t){return new(t=fS(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function fS(n){var e;return null!==(e=n??Jo.Promise)&&void 0!==e?e:Promise}const Tk=M_(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Tr=(()=>{class n extends Sn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new pS(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new Tk}next(t){af(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){af(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){af(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?cS:(this.currentObservers=null,s.push(t),new Fi(()=>{this.currentObservers=null,E_(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Sn;return t.source=this,t}}return n.create=(e,t)=>new pS(e,t),n})();class pS extends Tr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:cS}}function mS(n){return Ht(n?.lift)}function En(n){return e=>{if(mS(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Cn(n,e,t,i,r){return new Ak(n,e,t,i,r)}class Ak extends A_{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Rt(n,e){return En((t,i)=>{let r=0;t.subscribe(Cn(i,s=>{i.next(n.call(e,s,r++))}))})}function fo(n){return this instanceof fo?(this.v=n,this):new fo(n)}function yS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function O_(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const wS=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function xS(n){return Ht(n?.then)}function bS(n){return Ht(n[R_])}function MS(n){return Symbol.asyncIterator&&Ht(n?.[Symbol.asyncIterator])}function SS(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ES=function Zk(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function CS(n){return Ht(n?.[ES])}function TS(n){return function vS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){i[d]&&(r[d]=function(f){return new Promise(function(p,g){s.push([d,f,p,g])>1||a(d,f)})})}function a(d,f){try{!function c(d){d.value instanceof fo?Promise.resolve(d.value.v).then(l,u):h(s[0][2],d)}(i[d](f))}catch(p){h(s[0][3],p)}}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield fo(t.read());if(r)return yield fo(void 0);yield yield fo(i)}}finally{t.releaseLock()}})}function AS(n){return Ht(n?.getReader)}function ir(n){if(n instanceof Sn)return n;if(null!=n){if(bS(n))return function Kk(n){return new Sn(e=>{const t=n[R_]();if(Ht(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(wS(n))return function Jk(n){return new Sn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(xS(n))return function Qk(n){return new Sn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,hS)})}(n);if(MS(n))return DS(n);if(CS(n))return function eU(n){return new Sn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(AS(n))return function tU(n){return DS(TS(n))}(n)}throw SS(n)}function DS(n){return new Sn(e=>{(function nU(n,e){var t,i,r,s;return function gS(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=yS(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Cs(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function jn(n,e,t=1/0){return Ht(e)?jn((i,r)=>Rt((s,o)=>e(i,s,r,o))(ir(n(i,r))),t):("number"==typeof e&&(t=e),En((i,r)=>function iU(n,e,t,i,r,s,o,a){const c=[];let l=0,u=0,h=!1;const d=()=>{h&&!c.length&&!l&&e.complete()},f=g=>l<i?p(g):c.push(g),p=g=>{s&&e.next(g),l++;let _=!1;ir(t(g,u++)).subscribe(Cn(e,m=>{r?.(m),s?f(m):e.next(m)},()=>{_=!0},void 0,()=>{if(_)try{for(l--;c.length&&l<i;){const m=c.shift();o?Cs(e,o,()=>p(m)):p(m)}d()}catch(m){e.error(m)}}))};return n.subscribe(Cn(e,f,()=>{h=!0,d()})),()=>{a?.()}}(i,r,n,t)))}function lc(n=1/0){return jn(ho,n)}const $r=new Sn(n=>n.complete());function F_(n){return n[n.length-1]}function Pu(n){return function sU(n){return n&&Ht(n.schedule)}(F_(n))?n.pop():void 0}function IS(n,e=0){return En((t,i)=>{t.subscribe(Cn(i,r=>Cs(i,n,()=>i.next(r),e),()=>Cs(i,n,()=>i.complete(),e),r=>Cs(i,n,()=>i.error(r),e)))})}function RS(n,e=0){return En((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function PS(n,e){if(!n)throw new Error("Iterable cannot be null");return new Sn(t=>{Cs(t,e,()=>{const i=n[Symbol.asyncIterator]();Cs(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function On(n,e){return e?function fU(n,e){if(null!=n){if(bS(n))return function cU(n,e){return ir(n).pipe(RS(e),IS(e))}(n,e);if(wS(n))return function uU(n,e){return new Sn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(xS(n))return function lU(n,e){return ir(n).pipe(RS(e),IS(e))}(n,e);if(MS(n))return PS(n,e);if(CS(n))return function hU(n,e){return new Sn(t=>{let i;return Cs(t,e,()=>{i=n[ES](),Cs(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Ht(i?.return)&&i.return()})}(n,e);if(AS(n))return function dU(n,e){return PS(TS(n),e)}(n,e)}throw SS(n)}(n,e):ir(n)}class rr extends Tr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function We(...n){return On(n,Pu(n))}function LS(n={}){const{connector:e=(()=>new Tr),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,c,l=0,u=!1,h=!1;const d=()=>{a?.unsubscribe(),a=void 0},f=()=>{d(),o=c=void 0,u=h=!1},p=()=>{const g=o;f(),g?.unsubscribe()};return En((g,_)=>{l++,!h&&!u&&d();const m=c=c??e();_.add(()=>{l--,0===l&&!h&&!u&&(a=k_(p,r))}),m.subscribe(_),!o&&l>0&&(o=new Ru({next:v=>m.next(v),error:v=>{h=!0,d(),a=k_(f,t,v),m.error(v)},complete:()=>{u=!0,d(),a=k_(f,i),m.complete()}}),ir(g).subscribe(o))})(s)}}function k_(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Ru({next:()=>{i.unsubscribe(),n()}});return ir(e(...t)).subscribe(i)}function Ar(n,e){return En((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Cn(i,c=>{r?.unsubscribe();let l=0;const u=s++;ir(n(c,u)).subscribe(r=Cn(i,h=>i.next(e?e(c,h,u,l++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function gU(n,e){return n===e}function Ct(n){for(let e in n)if(n[e]===Ct)return e;throw Error("Could not find renamed property on target object.")}function Tn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Tn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function U_(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const _U=Ct({__forward_ref__:Ct});function B_(n){return n.__forward_ref__=B_,n.toString=function(){return Tn(this())},n}function Be(n){return uf(n)?n():n}function uf(n){return"function"==typeof n&&n.hasOwnProperty(_U)&&n.__forward_ref__===B_}function V_(n){return n&&!!n.\u0275providers}const NS="https://g.co/ng/security#xss";class he extends Error{constructor(e,t){super(function hf(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Xe(n){return"string"==typeof n?n:null==n?"":String(n)}function z_(n,e){throw new he(-201,!1)}function sr(n,e){null==n&&function He(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function De(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Xr(n){return{providers:n.providers||[],imports:n.imports||[]}}function df(n){return OS(n,pf)||OS(n,FS)}function OS(n,e){return n.hasOwnProperty(e)?n[e]:null}function ff(n){return n&&(n.hasOwnProperty(H_)||n.hasOwnProperty(EU))?n[H_]:null}const pf=Ct({\u0275prov:Ct}),H_=Ct({\u0275inj:Ct}),FS=Ct({ngInjectableDef:Ct}),EU=Ct({ngInjectorDef:Ct});var lt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(lt||{});let G_;function kS(){return G_}function wi(n){const e=G_;return G_=n,e}function US(n,e,t){const i=df(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&lt.Optional?null:void 0!==e?e:void z_(Tn(n))}const Ot=globalThis,Lu={},q_="__NG_DI_FLAG__",mf="ngTempTokenPath",AU=/\n/gm,VS="__source";let uc;function mo(n){const e=uc;return uc=n,e}function RU(n,e=lt.Default){if(void 0===uc)throw new he(-203,!1);return null===uc?US(n,void 0,e):uc.get(n,e&lt.Optional?null:void 0,e)}function Se(n,e=lt.Default){return(kS()||RU)(Be(n),e)}function xe(n,e=lt.Default){return Se(n,gf(e))}function gf(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Y_(n){const e=[];for(let t=0;t<n.length;t++){const i=Be(n[t]);if(Array.isArray(i)){if(0===i.length)throw new he(900,!1);let r,s=lt.Default;for(let o=0;o<i.length;o++){const a=i[o],c=PU(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(Se(r,s))}else e.push(Se(i))}return e}function Nu(n,e){return n[q_]=e,n.prototype[q_]=e,n}function PU(n){return n[q_]}function Ts(n){return{toString:n}.toString()}var _f=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(_f||{}),Dr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Dr||{});const qr={},bt=[],vf=Ct({\u0275cmp:Ct}),Z_=Ct({\u0275dir:Ct}),K_=Ct({\u0275pipe:Ct}),HS=Ct({\u0275mod:Ct}),As=Ct({\u0275fac:Ct}),Ou=Ct({__NG_ELEMENT_ID__:Ct}),GS=Ct({__NG_ENV_ID__:Ct});function WS(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function J_(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];$S(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function jS(n){return 3===n||4===n||6===n}function $S(n){return 64===n.charCodeAt(0)}function Fu(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||XS(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function XS(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const qS="ng-template";function OU(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==WS(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function YS(n){return 4===n.type&&n.value!==qS}function FU(n,e,t){return e===(4!==n.type||t?n.value:qS)}function kU(n,e,t){let i=4;const r=n.attrs||[],s=function VU(n){for(let e=0;e<n.length;e++)if(jS(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&i){if(i=2|1&i,""!==c&&!FU(n,c,t)||""===c&&1===e.length){if(Ir(i))return!1;o=!0}}else{const l=8&i?c:e[++a];if(8&i&&null!==n.attrs){if(!OU(n.attrs,l,t)){if(Ir(i))return!1;o=!0}continue}const h=UU(8&i?"class":c,r,YS(n),t);if(-1===h){if(Ir(i))return!1;o=!0;continue}if(""!==l){let d;d=h>s?"":r[h+1].toLowerCase();const f=8&i?d:null;if(f&&-1!==WS(f,l,0)||2&i&&l!==d){if(Ir(i))return!1;o=!0}}}}else{if(!o&&!Ir(i)&&!Ir(c))return!1;if(o&&Ir(c))continue;o=!1,i=c|1&i}}return Ir(i)||o}function Ir(n){return 0==(1&n)}function UU(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function zU(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function ZS(n,e,t=!1){for(let i=0;i<e.length;i++)if(kU(n,e[i],t))return!0;return!1}function KS(n,e){return n?":not("+e.trim()+")":e}function GU(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ir(o)&&(e+=KS(s,r),r=""),i=o,s=s||!Ir(i);t++}return""!==r&&(e+=KS(s,r)),e}function ea(n){return Ts(()=>{const e=QS(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===_f.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Dr.Emulated,styles:n.styles||bt,_:null,schemas:n.schemas||null,tView:null,id:""};eE(t);const i=n.dependencies;return t.directiveDefs=yf(i,!1),t.pipeDefs=yf(i,!0),t.id=function YU(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function $U(n){return ut(n)||An(n)}function XU(n){return null!==n}function Ds(n){return Ts(()=>({type:n.type,bootstrap:n.bootstrap||bt,declarations:n.declarations||bt,imports:n.imports||bt,exports:n.exports||bt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function JS(n,e){if(null==n)return qr;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function oi(n){return Ts(()=>{const e=QS(n);return eE(e),e})}function ut(n){return n[vf]||null}function An(n){return n[Z_]||null}function Bn(n){return n[K_]||null}function $n(n,e){const t=n[HS]||null;if(!t&&!0===e)throw new Error(`Type ${Tn(n)} does not have '\u0275mod' property.`);return t}function QS(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||qr,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||bt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:JS(n.inputs,e),outputs:JS(n.outputs)}}function eE(n){n.features?.forEach(e=>e(n))}function yf(n,e){if(!n)return null;const t=e?Bn:$U;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(XU)}const Qt=0,me=1,Ke=2,Gt=3,Rr=4,ku=5,Xn=6,hc=7,Ft=8,or=9,dc=10,qe=11,Uu=12,tE=13,fc=14,Yt=15,Bu=16,pc=17,Yr=18,Vu=19,nE=20,_o=21,Is=22,zu=23,Hu=24,je=25,Q_=1,iE=2,Zr=7,mc=9,ln=11;function qn(n){return Array.isArray(n)&&"object"==typeof n[Q_]}function Yn(n){return Array.isArray(n)&&!0===n[Q_]}function ev(n){return 0!=(4&n.flags)}function ta(n){return n.componentOffset>-1}function xf(n){return 1==(1&n.flags)}function Pr(n){return!!n.template}function tv(n){return 0!=(512&n[Ke])}function na(n,e){return n.hasOwnProperty(As)?n[As]:null}const vo=Symbol("SIGNAL");function oE(n,e){return(null===n||"object"!=typeof n)&&Object.is(n,e)}let Vn=null,Wu=!1;function ar(n){const e=Vn;return Vn=n,e}const nv={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function aE(n){if(Wu)throw new Error("");if(null===Vn)return;const e=Vn.nextProducerIndex++;gc(Vn),e<Vn.producerNode.length&&Vn.producerNode[e]!==n&&ju(Vn)&&Sf(Vn.producerNode[e],Vn.producerIndexOfThis[e]),Vn.producerNode[e]!==n&&(Vn.producerNode[e]=n,Vn.producerIndexOfThis[e]=ju(Vn)?dE(n,Vn,e):0),Vn.producerLastReadVersion[e]=n.version}function cE(n){if(!ju(n)||n.dirty){if(!n.producerMustRecompute(n)&&!function hE(n){gc(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(cE(t),i!==t.version))return!0}return!1}(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function lE(n){if(void 0===n.liveConsumerNode)return;const e=Wu;Wu=!0;try{for(const t of n.liveConsumerNode)t.dirty||uE(t)}finally{Wu=e}}function iv(){return!1!==Vn?.consumerAllowSignalWrites}function uE(n){n.dirty=!0,lE(n),n.consumerMarkedDirty?.(n)}function bf(n){return n&&(n.nextProducerIndex=0),ar(n)}function Mf(n,e){if(ar(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(ju(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Sf(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function rv(n){if(gc(n),ju(n))for(let e=0;e<n.producerNode.length;e++)Sf(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function dE(n,e,t){if(fE(n),gc(n),0===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=dE(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Sf(n,e){if(fE(n),gc(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)Sf(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];gc(r),r.producerIndexOfThis[i]=e}}function ju(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function gc(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function fE(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}const sv=Symbol("UNSET"),ov=Symbol("COMPUTING"),Ef=Symbol("ERRORED"),iB=(()=>({...nv,value:sv,dirty:!0,error:null,equal:oE,producerMustRecompute:n=>n.value===sv||n.value===ov,producerRecomputeValue(n){if(n.value===ov)throw new Error("Detected cycle in computations.");const e=n.value;n.value=ov;const t=bf(n);let i;try{i=n.computation()}catch(r){i=Ef,n.error=r}finally{Mf(n,t)}e!==sv&&e!==Ef&&i!==Ef&&n.equal(e,i)?n.value=e:(n.value=i,n.version++)}}))();let pE=function rB(){throw new Error};function av(){pE()}let cv=null;function Cf(n,e){const t=Object.create(oB);function i(){return aE(t),t.value}return t.value=n,e?.equal&&(t.equal=e.equal),i.set=gE,i.update=aB,i.mutate=cB,i.asReadonly=lB,i[vo]=t,i}const oB=(()=>({...nv,equal:oE,readonlyFn:void 0}))();function mE(n){n.version++,lE(n),cv?.()}function gE(n){const e=this[vo];iv()||av(),e.equal(e.value,n)||(e.value=n,mE(e))}function aB(n){iv()||av(),gE.call(this,n(this[vo].value))}function cB(n){const e=this[vo];iv()||av(),n(e.value),mE(e)}function lB(){const n=this[vo];if(void 0===n.readonlyFn){const e=()=>this();e[vo]=n,n.readonlyFn=e}return n.readonlyFn}class dB{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function ia(){return yE}function yE(n){return n.type.prototype.ngOnChanges&&(n.setInput=pB),fB}function fB(){const n=xE(this),e=n?.current;if(e){const t=n.previous;if(t===qr)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function pB(n,e,t,i){const r=this.declaredInputs[t],s=xE(n)||function mB(n,e){return n[wE]=e}(n,{previous:qr,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[r];o[r]=new dB(c&&c.currentValue,e,a===qr),n[i]=e}ia.ngInherit=!0;const wE="__ngSimpleChanges__";function xE(n){return n[wE]||null}const Kr=function(n,e,t){};function kt(n){for(;Array.isArray(n);)n=n[Qt];return n}function bi(n,e){return kt(e[n.index])}function $u(n,e){return n.data[e]}function Ui(n,e){const t=e[n];return qn(t)?t:t[Qt]}function Jr(n,e){return null==e?null:n[e]}function SE(n){n[pc]=0}function xB(n){1024&n[Ke]||(n[Ke]|=1024,CE(n,1))}function EE(n){1024&n[Ke]&&(n[Ke]&=-1025,CE(n,-1))}function CE(n,e){let t=n[Gt];if(null===t)return;t[ku]+=e;let i=t;for(t=t[Gt];null!==t&&(1===e&&1===i[ku]||-1===e&&0===i[ku]);)t[ku]+=e,i=t,t=t[Gt]}function hv(n,e){if(256==(256&n[Ke]))throw new he(911,!1);null===n[_o]&&(n[_o]=[]),n[_o].push(e)}const Ge={lFrame:kE(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function DE(){return Ge.bindingsEnabled}function ee(){return Ge.lFrame.lView}function gt(){return Ge.lFrame.tView}function mn(){let n=IE();for(;null!==n&&64===n.type;)n=n.parent;return n}function IE(){return Ge.lFrame.currentTNode}function Qr(n,e){const t=Ge.lFrame;t.currentTNode=n,t.isParent=e}function dv(){return Ge.lFrame.isParent}function es(){return Ge.lFrame.bindingIndex++}function NB(n,e){const t=Ge.lFrame;t.bindingIndex=t.bindingRootIndex=n,pv(e)}function pv(n){Ge.lFrame.currentDirectiveIndex=n}function NE(){return Ge.lFrame.currentQueryIndex}function gv(n){Ge.lFrame.currentQueryIndex=n}function FB(n){const e=n[me];return 2===e.type?e.declTNode:1===e.type?n[Xn]:null}function OE(n,e,t){if(t&lt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&lt.Host||(r=FB(s),null===r||(s=s[fc],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ge.lFrame=FE();return i.currentTNode=e,i.lView=n,!0}function _v(n){const e=FE(),t=n[me];Ge.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function FE(){const n=Ge.lFrame,e=null===n?null:n.child;return null===e?kE(n):e}function kE(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function UE(){const n=Ge.lFrame;return Ge.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const BE=UE;function vv(){const n=UE();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ci(){return Ge.lFrame.selectedIndex}function ra(n){Ge.lFrame.selectedIndex=n}function Wt(){const n=Ge.lFrame;return $u(n.tView,n.selectedIndex)}function Af(){Ge.lFrame.currentNamespace="svg"}let HE=!0;function Df(){return HE}function yo(n){HE=n}function If(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function Rf(n,e,t){GE(n,e,3,t)}function Pf(n,e,t,i){(3&n[Ke])===t&&GE(n,e,t,i)}function yv(n,e){let t=n[Ke];(3&t)===e&&(t&=8191,t+=1,n[Ke]=t)}function GE(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let c=void 0!==i?65535&n[pc]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(n[pc]+=65536),(a<s||-1==s)&&(HB(n,t,e,c),n[pc]=(4294901760&n[pc])+c+2),c++}function WE(n,e){Kr(4,n,e);const t=ar(null);try{e.call(n)}finally{ar(t),Kr(5,n,e)}}function HB(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[Ke]>>13<n[pc]>>16&&(3&n[Ke])===e&&(n[Ke]+=8192,WE(a,s)):WE(a,s)}const yc=-1;class qu{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function xv(n){return n!==yc}function Yu(n){return 32767&n}function Zu(n,e){let t=function XB(n){return n>>16}(n),i=e;for(;t>0;)i=i[fc],t--;return i}let bv=!0;function Lf(n){const e=bv;return bv=n,e}const jE=255,$E=5;let qB=0;const ts={};function Nf(n,e){const t=XE(n,e);if(-1!==t)return t;const i=e[me];i.firstCreatePass&&(n.injectorIndex=e.length,Mv(i.data,n),Mv(e,null),Mv(i.blueprint,null));const r=Of(n,e),s=n.injectorIndex;if(xv(r)){const o=Yu(r),a=Zu(r,e),c=a[me].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function Mv(n,e){n.push(0,0,0,0,0,0,0,0,e)}function XE(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Of(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=tC(r),null===i)return yc;if(t++,r=r[fc],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return yc}function Sv(n,e,t){!function YB(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ou)&&(i=t[Ou]),null==i&&(i=t[Ou]=qB++);const r=i&jE;e.data[n+(r>>$E)]|=1<<r}(n,e,t)}function qE(n,e,t){if(t&lt.Optional||void 0!==n)return n;z_()}function YE(n,e,t,i){if(t&lt.Optional&&void 0===i&&(i=null),!(t&(lt.Self|lt.Host))){const r=n[or],s=wi(void 0);try{return r?r.get(e,i,t&lt.Optional):US(e,i,t&lt.Optional)}finally{wi(s)}}return qE(i,0,t)}function ZE(n,e,t,i=lt.Default,r){if(null!==n){if(2048&e[Ke]&&!(i&lt.Self)){const o=function t3(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[Ke]&&!(512&o[Ke]);){const a=KE(s,o,t,i|lt.Self,ts);if(a!==ts)return a;let c=s.parent;if(!c){const l=o[nE];if(l){const u=l.get(t,ts,i);if(u!==ts)return u}c=tC(o),o=o[fc]}s=c}return r}(n,e,t,i,ts);if(o!==ts)return o}const s=KE(n,e,t,i,ts);if(s!==ts)return s}return YE(e,t,i,r)}function KE(n,e,t,i,r){const s=function JB(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Ou)?n[Ou]:void 0;return"number"==typeof e?e>=0?e&jE:e3:e}(t);if("function"==typeof s){if(!OE(e,n,i))return i&lt.Host?qE(r,0,i):YE(e,t,i,r);try{let o;if(o=s(i),null!=o||i&lt.Optional)return o;z_()}finally{BE()}}else if("number"==typeof s){let o=null,a=XE(n,e),c=yc,l=i&lt.Host?e[Yt][Xn]:null;for((-1===a||i&lt.SkipSelf)&&(c=-1===a?Of(n,e):e[a+8],c!==yc&&QE(i,!1)?(o=e[me],a=Yu(c),e=Zu(c,e)):a=-1);-1!==a;){const u=e[me];if(JE(s,a,u.data)){const h=KB(a,e,t,o,i,l);if(h!==ts)return h}c=e[a+8],c!==yc&&QE(i,e[me].data[a+8]===l)&&JE(s,a,e)?(o=u,a=Yu(c),e=Zu(c,e)):a=-1}}return r}function KB(n,e,t,i,r,s){const o=e[me],a=o.data[n+8],u=Ff(a,o,t,null==i?ta(a)&&bv:i!=o&&0!=(3&a.type),r&lt.Host&&s===a);return null!==u?sa(e,o,u,a):ts}function Ff(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,c=n.directiveStart,u=s>>20,d=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<d;f++){const p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(r){const f=o[c];if(f&&Pr(f)&&f.type===t)return c}return null}function sa(n,e,t,i){let r=n[t];const s=e.data;if(function GB(n){return n instanceof qu}(r)){const o=r;o.resolving&&function vU(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new he(-200,`Circular dependency in DI detected for ${n}${t}`)}(function Et(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Xe(n)}(s[t]));const a=Lf(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?wi(o.injectImpl):null;OE(n,i,lt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function zB(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=yE(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&wi(l),Lf(a),o.resolving=!1,BE()}}return r}function JE(n,e,t){return!!(t[e+(n>>$E)]&1<<n)}function QE(n,e){return!(n&lt.Self||n&lt.Host&&e)}class li{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return ZE(this._tNode,this._lView,e,gf(i),t)}}function e3(){return new li(mn(),ee())}function Ev(n){return uf(n)?()=>{const e=Ev(Be(n));return e&&e()}:na(n)}function tC(n){const e=n[me],t=e.type;return 2===t?e.declTNode:1===t?n[Xn]:null}const xc="__parameters__";function Mc(n,e,t){return Ts(()=>{const i=function Cv(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(c,l,u){const h=c.hasOwnProperty(xc)?c[xc]:Object.defineProperty(c,xc,{value:[]})[xc];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function Ec(n,e){n.forEach(t=>Array.isArray(t)?Ec(t,e):e(t))}function iC(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Uf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}const Vf=Nu(Mc("Optional"),8),zf=Nu(Mc("SkipSelf"),4);class Le{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=De({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const th=new Le("ENVIRONMENT_INITIALIZER"),cC=new Le("INJECTOR",-1),lC=new Le("INJECTOR_DEF_TYPES");class Iv{get(e,t=Lu){if(t===Lu){const i=new Error(`NullInjectorError: No provider for ${Tn(e)}!`);throw i.name="NullInjectorError",i}return t}}function E3(...n){return{\u0275providers:hC(0,n),\u0275fromNgModule:!0}}function hC(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return Ec(e,o=>{const a=o;Gf(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&dC(r,s),t}function dC(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];Rv(r,s=>{e(s,i)})}}function Gf(n,e,t,i){if(!(n=Be(n)))return!1;let r=null,s=ff(n);const o=!s&&ut(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const c=n.ngModule;if(s=ff(c),!s)return!1;r=c}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)Gf(l,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;i.add(r);try{Ec(s.imports,u=>{Gf(u,e,t,i)&&(l||=[],l.push(u))})}finally{}void 0!==l&&dC(l,e)}if(!a){const l=na(r)||(()=>new r);e({provide:r,useFactory:l,deps:bt},r),e({provide:lC,useValue:r,multi:!0},r),e({provide:th,useValue:()=>Se(r),multi:!0},r)}const c=s.providers;if(null!=c&&!a){const l=n;Rv(c,u=>{e(u,l)})}}}return r!==n&&void 0!==n.providers}function Rv(n,e){for(let t of n)V_(t)&&(t=t.\u0275providers),Array.isArray(t)?Rv(t,e):e(t)}const C3=Ct({provide:String,useValue:Ct});function Pv(n){return null!==n&&"object"==typeof n&&C3 in n}function oa(n){return"function"==typeof n}const Lv=new Le("Set Injector scope."),Wf={},A3={};let Nv;function jf(){return void 0===Nv&&(Nv=new Iv),Nv}class cr{}class $f extends cr{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Fv(e,o=>this.processProvider(o)),this.records.set(cC,Ac(void 0,this)),r.has("environment")&&this.records.set(cr,Ac(void 0,this));const s=this.records.get(Lv);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(lC,bt,lt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=mo(this),i=wi(void 0);try{return e()}finally{mo(t),wi(i)}}get(e,t=Lu,i=lt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(GS))return e[GS](this);i=gf(i);const s=mo(this),o=wi(void 0);try{if(!(i&lt.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function L3(n){return"function"==typeof n||"object"==typeof n&&n instanceof Le}(e)&&df(e);c=l&&this.injectableDefInScope(l)?Ac(Ov(e),Wf):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(i&lt.Self?jf():this.parent).get(e,t=i&lt.Optional&&t===Lu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[mf]=a[mf]||[]).unshift(Tn(e)),s)throw a;return function LU(n,e,t,i){const r=n[mf];throw e[VS]&&r.unshift(e[VS]),n.message=function NU(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Tn(e);if(Array.isArray(e))r=e.map(Tn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Tn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(AU,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[mf]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{wi(o),mo(s)}}resolveInjectorInitializers(){const e=mo(this),t=wi(void 0);try{const r=this.get(th,bt,lt.Self);for(const s of r)s()}finally{mo(e),wi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Tn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new he(205,!1)}processProvider(e){let t=oa(e=Be(e))?e:Be(e&&e.provide);const i=function I3(n){return Pv(n)?Ac(void 0,n.useValue):Ac(function mC(n,e,t){let i;if(oa(n)){const r=Be(n);return na(r)||Ov(r)}if(Pv(n))i=()=>Be(n.useValue);else if(function pC(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Y_(n.deps||[]));else if(function fC(n){return!(!n||!n.useExisting)}(n))i=()=>Se(Be(n.useExisting));else{const r=Be(n&&(n.useClass||n.provide));if(!function R3(n){return!!n.deps}(n))return na(r)||Ov(r);i=()=>new r(...Y_(n.deps))}return i}(n),Wf)}(e);if(oa(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Ac(void 0,Wf,!0),r.factory=()=>Y_(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Wf&&(t.value=A3,t.value=t.factory()),"object"==typeof t.value&&t.value&&function P3(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Be(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function Ov(n){const e=df(n),t=null!==e?e.factory:na(n);if(null!==t)return t;if(n instanceof Le)throw new he(204,!1);if(n instanceof Function)return function D3(n){const e=n.length;if(e>0)throw function Qu(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new he(204,!1);const t=function SU(n){return n&&(n[pf]||n[FS])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new he(204,!1)}function Ac(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Fv(n,e){for(const t of n)Array.isArray(t)?Fv(t,e):t&&V_(t)?Fv(t.\u0275providers,e):e(t)}function yC(n,e=null,t=null,i){const r=wC(n,e,t,i);return r.resolveInjectorInitializers(),r}function wC(n,e=null,t=null,i,r=new Set){const s=[t||bt,E3(n)];return i=i||("object"==typeof n?void 0:Tn(n)),new $f(s,e||jf(),i||null,r)}let Bv,lr=(()=>{var n;class e{static create(i,r){if(Array.isArray(i))return yC({name:""},r,i,"");{const s=i.name??"";return yC({name:s},i.parent,i.providers,s)}}}return(n=e).THROW_IF_NOT_FOUND=Lu,n.NULL=new Iv,n.\u0275prov=De({token:n,providedIn:"any",factory:()=>Se(cC)}),n.__NG_ELEMENT_ID__=-1,e})();const qf=new Le("AppId",{providedIn:"root",factory:()=>H3}),H3="ng",bC=new Le("Platform Initializer"),Rc=new Le("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),MC=new Le("CSP nonce",{providedIn:"root",factory:()=>function Ic(){if(void 0!==Bv)return Bv;if(typeof document<"u")return document;throw new he(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function Vv(n){return n.ownerDocument.defaultView}function Vi(n){return n instanceof Function?n():n}function Wv(n){return 128==(128&n.flags)}var xo=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(xo||{});const jv=new Map;let J3=0;const Xv="__ngContext__";function Zn(n,e){qn(e)?(n[Xv]=e[Vu],function eV(n){jv.set(n[Vu],n)}(e)):n[Xv]=e}let qv;function Yv(n,e){return qv(n,e)}function rh(n){const e=n[Gt];return Yn(e)?e[Gt]:e}function HC(n){return WC(n[Uu])}function GC(n){return WC(n[Rr])}function WC(n){for(;null!==n&&!Yn(n);)n=n[Rr];return n}function Nc(n,e,t,i,r){if(null!=i){let s,o=!1;Yn(i)?s=i:qn(i)&&(o=!0,i=i[Qt]);const a=kt(i);0===n&&null!==t?null==r?qC(e,t,a):ca(e,t,a,r||null,!0):1===n&&null!==t?ca(e,t,a,r||null,!0):2===n?function ip(n,e,t){const i=tp(n,e);i&&function yV(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function bV(n,e,t,i,r){const s=t[Zr];s!==kt(t)&&Nc(e,n,i,s,r);for(let a=ln;a<t.length;a++){const c=t[a];ah(c[me],c,n,e,i,s)}}(e,n,s,t,r)}}function ep(n,e,t){return n.createElement(e,t)}function $C(n,e){const t=n[mc],i=t.indexOf(e);EE(e),t.splice(i,1)}function sh(n,e){if(n.length<=ln)return;const t=ln+e,i=n[t];if(i){const r=i[Bu];null!==r&&r!==n&&$C(r,i),e>0&&(n[t-1][Rr]=i[Rr]);const s=Uf(n,ln+e);!function hV(n,e){ah(n,e,e[qe],2,null,null),e[Qt]=null,e[Xn]=null}(i[me],i);const o=s[Yr];null!==o&&o.detachView(s[me]),i[Gt]=null,i[Rr]=null,i[Ke]&=-129}return i}function Kv(n,e){if(!(256&e[Ke])){const t=e[qe];e[zu]&&rv(e[zu]),e[Hu]&&rv(e[Hu]),t.destroyNode&&ah(n,e,t,3,null,null),function pV(n){let e=n[Uu];if(!e)return Jv(n[me],n);for(;e;){let t=null;if(qn(e))t=e[Uu];else{const i=e[ln];i&&(t=i)}if(!t){for(;e&&!e[Rr]&&e!==n;)qn(e)&&Jv(e[me],e),e=e[Gt];null===e&&(e=n),qn(e)&&Jv(e[me],e),t=e&&e[Rr]}e=t}}(e)}}function Jv(n,e){if(!(256&e[Ke])){e[Ke]&=-129,e[Ke]|=256,function vV(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof qu)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];Kr(4,a,c);try{c.call(a)}finally{Kr(5,a,c)}}else{Kr(4,r,s);try{s.call(r)}finally{Kr(5,r,s)}}}}}(n,e),function _V(n,e){const t=n.cleanup,i=e[hc];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[hc]=null);const r=e[_o];if(null!==r){e[_o]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[me].type&&e[qe].destroy();const t=e[Bu];if(null!==t&&Yn(e[Gt])){t!==e[Gt]&&$C(t,e);const i=e[Yr];null!==i&&i.detachView(n)}!function tV(n){jv.delete(n[Vu])}(e)}}function Qv(n,e,t){return function XC(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Qt];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Dr.None||s===Dr.Emulated)return null}return bi(i,t)}}(n,e.parent,t)}function ca(n,e,t,i,r){n.insertBefore(e,t,i,r)}function qC(n,e,t){n.appendChild(e,t)}function YC(n,e,t,i,r){null!==i?ca(n,e,t,i,r):qC(n,e,t)}function tp(n,e){return n.parentNode(e)}let ey,JC=function KC(n,e,t){return 40&n.type?bi(n,t):null};function np(n,e,t,i){const r=Qv(n,i,e),s=e[qe],a=function ZC(n,e,t){return JC(n,e,t)}(i.parent||e[Xn],i,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)YC(s,r,t[c],a,!1);else YC(s,r,t,a,!1);void 0!==ey&&ey(s,i,e,t,r)}function oh(n,e){if(null!==e){const t=e.type;if(3&t)return bi(e,n);if(4&t)return ty(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return oh(n,i);{const r=n[e.index];return Yn(r)?ty(-1,r):kt(r)}}if(32&t)return Yv(e,n)()||kt(n[e.index]);{const i=eT(n,e);return null!==i?Array.isArray(i)?i[0]:oh(rh(n[Yt]),i):oh(n,e.next)}}return null}function eT(n,e){return null!==e?n[Yt][Xn].projection[e.projection]:null}function ty(n,e){const t=ln+n+1;if(t<e.length){const i=e[t],r=i[me].firstChild;if(null!==r)return oh(i,r)}return e[Zr]}function ny(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],c=t.type;if(o&&0===e&&(a&&Zn(kt(a),i),t.flags|=2),32!=(32&t.flags))if(8&c)ny(n,e,t.child,i,r,s,!1),Nc(e,n,r,a,s);else if(32&c){const l=Yv(t,i);let u;for(;u=l();)Nc(e,n,r,u,s);Nc(e,n,r,a,s)}else 16&c?nT(n,e,i,t,r,s):Nc(e,n,r,a,s);t=o?t.projectionNext:t.next}}function ah(n,e,t,i,r,s){ny(t,i,n.firstChild,e,r,s,!1)}function nT(n,e,t,i,r,s){const o=t[Yt],c=o[Xn].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)Nc(e,n,r,c[l],s);else{let l=c;const u=o[Gt];Wv(i)&&(l.flags|=128),ny(n,e,l,u,r,s,!0)}}function iT(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function rT(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&J_(n,e,i),null!==r&&iT(n,e,r),null!==s&&function SV(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class cT{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${NS})`}}const kV=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Fc=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Fc||{});function ly(n){const e=function uh(){const n=ee();return n&&n[dc].sanitizer}();return e?e.sanitize(Fc.URL,n)||"":function ch(n,e){const t=function LV(n){return n instanceof cT&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${NS})`)}return t===e}(n,"URL")?function bo(n){return n instanceof cT?n.changingThisBreaksApplicationSecurity:n}(n):function sy(n){return(n=String(n)).match(kV)?n:"unsafe:"+n}(Xe(n))}let _T=(n,e,t)=>null;function _y(n,e,t=!1){return _T(n,e,t)}class rz{}class wT{}class oz{resolveComponentFactory(e){throw function sz(n){const e=Error(`No component factory found for ${Tn(n)}.`);return e.ngComponent=n,e}(e)}}let dp=(()=>{class e{}return e.NULL=new oz,e})();function az(){return Bc(mn(),ee())}function Bc(n,e){return new Mo(bi(n,e))}let Mo=(()=>{class e{constructor(i){this.nativeElement=i}}return e.__NG_ELEMENT_ID__=az,e})();function cz(n){return n instanceof Mo?n.nativeElement:n}class bT{}let uz=(()=>{var n;class e{}return(n=e).\u0275prov=De({token:n,providedIn:"root",factory:()=>null}),e})();class pp{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const hz=new pp("17.0.0-next.5"),wy={};function xy(n){return n.ngOriginalError}class ns{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&xy(e);for(;t&&xy(t);)t=xy(t);return t||null}}let mp=(()=>{var n;class e{}return(n=e).__NG_ELEMENT_ID__=fz,n.__NG_ENV_ID__=t=>t,e})();class dz extends mp{constructor(e){super(),this._lView=e}onDestroy(e){return hv(this._lView,e),()=>function TE(n,e){if(null===n[_o])return;const t=n[_o].indexOf(e);-1!==t&&n[_o].splice(t,1)}(this._lView,e)}}function fz(){return new dz(ee())}function by(n){return e=>{setTimeout(n,void 0,e)}}const ui=class pz extends Tr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=by(s),r&&(r=by(r)),o&&(o=by(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Fi&&e.add(a),a}};function ST(...n){}class At{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ui(!1),this.onMicrotaskEmpty=new ui(!1),this.onStable=new ui(!1),this.onError=new ui(!1),typeof Zone>"u")throw new he(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function mz(){const n="function"==typeof Ot.requestAnimationFrame;let e=Ot[n?"requestAnimationFrame":"setTimeout"],t=Ot[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function vz(n){const e=()=>{!function _z(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Ot,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Sy(n),n.isCheckStableRunning=!0,My(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Sy(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function wz(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return ET(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),CT(n)}},onInvoke:(t,i,r,s,o,a,c)=>{try{return ET(n),t.invoke(r,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),CT(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Sy(n),My(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!At.isInAngularZone())throw new he(909,!1)}static assertNotInAngularZone(){if(At.isInAngularZone())throw new he(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,gz,ST,ST);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const gz={};function My(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Sy(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function ET(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function CT(n){n._nesting--,My(n)}class yz{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ui,this.onMicrotaskEmpty=new ui,this.onStable=new ui,this.onError=new ui}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const TT=new Le("",{providedIn:"root",factory:AT});function AT(){const n=xe(At);let e=!0;return function pU(...n){const e=Pu(n),t=function aU(n,e){return"number"==typeof F_(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?ir(i[0]):lc(t)(On(i,e)):$r}(new Sn(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new Sn(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{At.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{At.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(LS()))}var la=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(la||{});function DT(n,e){!e&&function kv(n){if(!kS()&&!function IU(){return uc}())throw new he(-203,!1)}();const t=e?.injector??xe(lr);if(!function aa(n){return"browser"===(n??xe(lr)).get(Rc)}(t))return{destroy(){}};let i;const r=t.get(mp).onDestroy(()=>i?.()),s=t.get(Ey),o=s.handler??=new RT,a=t.get(At),c=t.get(ns,null,{optional:!0}),u=new IT(a,c,e?.phase??la.MixedReadWrite,()=>{i?.(),n()});return i=()=>{o.unregister(u),r()},o.register(u),{destroy:i}}class IT{constructor(e,t,i,r){this.zone=e,this.errorHandler=t,this.phase=i,this.callbackFn=r}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}}class RT{constructor(){this.executingCallbacks=!1,this.buckets={[la.EarlyRead]:new Set,[la.Write]:new Set,[la.MixedReadWrite]:new Set,[la.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new he(102,!1)}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const t of e)t.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let Ey=(()=>{var n;class e{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}}return(n=e).\u0275prov=De({token:n,providedIn:"root",factory:()=>new n}),e})();function fh(n){for(;n;){n[Ke]|=64;const e=rh(n);if(tv(n)&&!e)return n;n=e}return null}const LT=new Le("",{providedIn:"root",factory:()=>!1});let _p=null;function kT(n,e){return n[e]??VT()}function UT(n,e){const t=VT();t.producerNode?.length&&(n[e]=_p,t.lView=n,_p=BT())}const Tz={...nv,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{fh(n.lView)},lView:null};function BT(){return Object.create(Tz)}function VT(){return _p??=BT(),_p}const Je={};function Cy(n){zT(gt(),ee(),ci()+n,!1)}function zT(n,e,t,i){if(!i)if(3==(3&e[Ke])){const s=n.preOrderCheckHooks;null!==s&&Rf(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Pf(e,s,0,t)}ra(t)}function ke(n,e=lt.Default){const t=ee();return null===t?Se(n,e):ZE(mn(),t,Be(n),e)}function vp(n,e,t,i,r,s,o,a,c,l,u){const h=e.blueprint.slice();return h[Qt]=r,h[Ke]=140|i,(null!==l||n&&2048&n[Ke])&&(h[Ke]|=2048),SE(h),h[Gt]=h[fc]=n,h[Ft]=t,h[dc]=o||n&&n[dc],h[qe]=a||n&&n[qe],h[or]=c||n&&n[or]||null,h[Xn]=s,h[Vu]=function Q3(){return J3++}(),h[Is]=u,h[nE]=l,h[Yt]=2==e.type?n[Yt]:h,h}function Vc(n,e,t,i,r){let s=n.data[e];if(null===s)s=function Ty(n,e,t,i,r){const s=IE(),o=dv(),c=n.data[e]=function Oz(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return function vc(){return null!==Ge.skipHydrationRootTNode}()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}(n,e,t,i,r),function LB(){return Ge.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Xu(){const n=Ge.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Qr(s,!0),s}function ph(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function GT(n,e,t,i,r){const s=kT(e,zu),o=ci(),a=2&i;try{ra(-1),a&&e.length>je&&zT(n,e,je,!1),Kr(a?2:0,r);const l=a?s:null,u=bf(l);try{null!==l&&(l.dirty=!1),t(i,r)}finally{Mf(l,u)}}finally{a&&null===e[zu]&&UT(e,zu),ra(o),Kr(a?3:1,r)}}function Ay(n,e,t){if(ev(e)){const i=ar(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{ar(i)}}}function WT(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Ry(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Ry(n,e,t,i,r,s,o,a,c,l,u){const h=je+i,d=h+r,f=function Dz(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Je);return t}(h,d),p="function"==typeof l?l():l;return f[me]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}let jT=n=>null;function $T(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?XT(t,e,r,s):i.hasOwnProperty(r)&&XT(t,e,i[r],s)}return t}function XT(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function qT(n,e,t,i,r,s){for(let l=0;l<i.length;l++)Sv(Nf(t,e),n,i[l].type);!function Xz(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=ph(n,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];t.mergedAttrs=Fu(t.mergedAttrs,u.hostAttrs),qz(n,t,e,c,u),$z(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const h=u.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function Fz(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const h=s[u],d=t?t.get(h):null,p=d?d.outputs:null;c=$T(h.inputs,u,c,d?d.inputs:null),l=$T(h.outputs,u,l,p);const g=null===c||null===o||YS(e)?null:Kz(c,u,o);a.push(g)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(n,t,s)}function YT(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function OB(){return Ge.lFrame.currentDirectiveIndex}();try{ra(s);for(let a=i;a<r;a++){const c=n.data[a],l=e[a];pv(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&Gz(c,l)}}finally{ra(-1),pv(o)}}function Gz(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Ly(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function $z(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Pr(e)&&(t[""]=n)}}function qz(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=na(r.type)),o=new qu(s,Pr(r),ke);n.blueprint[i]=o,t[i]=o,function Vz(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function zz(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,ph(n,t,r.hostVars,Je),r)}function is(n,e,t,i,r,s){const o=bi(n,e);!function Ny(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?Xe(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[qe],o,s,n.value,t,i,r)}function Zz(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)ZT(i,t,o[a++],o[a++],o[a++])}function ZT(n,e,t,i,r){const s=ar(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{ar(s)}}function Kz(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function JT(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];gv(t[i]),o.contentQueries(2,e[s],s)}}}function yp(n,e){return n[Uu]?n[tE][Rr]=e:n[Uu]=e,n[tE]=e,e}function Oy(n,e,t){gv(0);const i=ar(null);try{e(n,t)}finally{ar(i)}}function QT(n){return n[hc]||(n[hc]=[])}function eA(n){return n.cleanup||(n.cleanup=[])}function nA(n,e){const t=n[or],i=t?t.get(ns,null):null;i&&i.handleError(e)}function Fy(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];ZT(n.data[o],e[o],i,a,r)}}function Os(n,e,t){const i=function Tf(n,e){return kt(e[n])}(e,n);!function jC(n,e,t){n.setValue(e,t)}(n[qe],i,t)}function Jz(n,e){const t=Ui(e,n),i=t[me];!function Qz(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[Qt];null!==r&&null===t[Is]&&(t[Is]=_y(r,t[or])),ky(i,t,t[Ft])}function ky(n,e,t){_v(e);try{const i=n.viewQuery;null!==i&&Oy(1,i,t);const r=n.template;null!==r&&GT(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&JT(n,e),n.staticViewQueries&&Oy(2,n.viewQuery,t);const s=n.components;null!==s&&function eH(n,e){for(let t=0;t<e.length;t++)Jz(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ke]&=-5,vv()}}function wp(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=U_(r,a):2==s&&(i=U_(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function mh(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(kt(s)),Yn(s)&&iA(s,i);const o=t.type;if(8&o)mh(n,e,t.child,i);else if(32&o){const a=Yv(t,e);let c;for(;c=a();)i.push(c)}else if(16&o){const a=eT(e,t);if(Array.isArray(a))i.push(...a);else{const c=rh(e[Yt]);mh(c[me],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function iA(n,e){for(let t=ln;t<n.length;t++){const i=n[t],r=i[me].firstChild;null!==r&&mh(i[me],i,r,e)}n[Zr]!==n[Qt]&&e.push(n[Zr])}function xp(n,e,t,i=!0){const r=e[dc],s=r.rendererFactory,o=r.afterRenderEventManager;s.begin?.(),o?.begin();try{rA(n,e,n.template,t)}catch(c){throw i&&nA(e,c),c}finally{s.end?.(),r.inlineEffectRunner?.flush(),o?.end()}}function rA(n,e,t,i){const r=e[Ke];if(256!=(256&r)){e[dc].inlineEffectRunner?.flush(),_v(e);try{SE(e),function PE(n){return Ge.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&GT(n,e,t,2,i);const o=3==(3&r);if(o){const l=n.preOrderCheckHooks;null!==l&&Rf(e,l,null)}else{const l=n.preOrderHooks;null!==l&&Pf(e,l,0,null),yv(e,0)}if(function nH(n){for(let e=HC(n);null!==e;e=GC(e)){if(!e[iE])continue;const t=e[mc];for(let i=0;i<t.length;i++){xB(t[i])}}}(e),sA(e,0),null!==n.contentQueries&&JT(n,e),o){const l=n.contentCheckHooks;null!==l&&Rf(e,l)}else{const l=n.contentHooks;null!==l&&Pf(e,l,1),yv(e,1)}!function Az(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const i=kT(e,Hu);try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)ra(~s);else{const o=s,a=t[++r],c=t[++r];NB(a,o),i.dirty=!1;const l=bf(i);try{c(2,e[o])}finally{Mf(i,l)}}}}finally{null===e[Hu]&&UT(e,Hu),ra(-1)}}(n,e);const a=n.components;null!==a&&aA(e,a,0);const c=n.viewQuery;if(null!==c&&Oy(2,c,i),o){const l=n.viewCheckHooks;null!==l&&Rf(e,l)}else{const l=n.viewHooks;null!==l&&Pf(e,l,2),yv(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Ke]&=-73,EE(e)}finally{vv()}}}function sA(n,e){for(let t=HC(n);null!==t;t=GC(t))for(let i=ln;i<t.length;i++)oA(t[i],e)}function iH(n,e,t){oA(Ui(e,n),t)}function oA(n,e){if(!function yB(n){return 128==(128&n[Ke])}(n))return;const t=n[me],i=n[Ke];if(80&i&&0===e||1024&i)rA(t,n,t.template,n[Ft]);else if(n[ku]>0){sA(n,1);const r=t.components;null!==r&&aA(n,r,1)}}function aA(n,e,t){for(let i=0;i<e.length;i++)iH(n,e[i],t)}class gh{get rootNodes(){const e=this._lView,t=e[me];return mh(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ft]}set context(e){this._lView[Ft]=e}get destroyed(){return 256==(256&this._lView[Ke])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Gt];if(Yn(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(sh(e,i),Uf(t,i))}this._attachedToViewContainer=!1}Kv(this._lView[me],this._lView)}onDestroy(e){hv(this._lView,e)}markForCheck(){fh(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ke]&=-129}reattach(){this._lView[Ke]|=128}detectChanges(){xp(this._lView[me],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new he(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function fV(n,e){ah(n,e,e[qe],2,null,null)}(this._lView[me],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new he(902,!1);this._appRef=e}}class rH extends gh{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;xp(e[me],e,e[Ft],!1)}checkNoChanges(){}get context(){return null}}class cA extends dp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=ut(e);return new _h(t,this.ngModule)}}function lA(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class oH{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=gf(i);const r=this.injector.get(e,wy,i);return r!==wy||t===wy?r:this.parentInjector.get(e,t,i)}}class _h extends wT{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=lA(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return lA(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function WU(n){return n.map(GU).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof cr?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new oH(e,s):e,a=o.get(bT,null);if(null===a)throw new he(407,!1);const u={rendererFactory:a,sanitizer:o.get(uz,null),inlineEffectRunner:null,afterRenderEventManager:o.get(Ey,null)},h=a.createRenderer(null,this.componentDef),d=this.componentDef.selectors[0][0]||"div",f=i?function Iz(n,e,t,i){const s=i.get(LT,!1)||t===Dr.ShadowDom,o=n.selectRootElement(e,s);return function Rz(n){jT(n)}(o),o}(h,i,this.componentDef.encapsulation,o):ep(h,d,function sH(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(d)),_=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let m=null;null!==f&&(m=_y(f,o,!0));const v=Ry(0,null,null,1,0,null,null,null,null,null,null),y=vp(null,v,null,_,null,null,u,h,o,null,m);let w,x;_v(y);try{const S=this.componentDef;let M,E=null;S.findHostDirectiveDefs?(M=[],E=new Map,S.findHostDirectiveDefs(S,M,E),M.push(S)):M=[S];const b=function cH(n,e){const t=n[me],i=je;return n[i]=e,Vc(t,i,2,"#host",null)}(y,f),C=function lH(n,e,t,i,r,s,o){const a=r[me];!function uH(n,e,t,i){for(const r of n)e.mergedAttrs=Fu(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(wp(e,e.mergedAttrs,!0),null!==t&&rT(i,t,e))}(i,n,e,o);let c=null;null!==e&&(c=_y(e,r[or]));const l=s.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const h=vp(r,WT(t),null,u,r[n.index],n,s,l,null,null,c);return a.firstCreatePass&&Ly(a,n,i.length-1),yp(r,h),r[n.index]=h}(b,f,S,M,y,u,h);x=$u(v,je),f&&function dH(n,e,t,i){if(i)J_(n,t,["ng-version",hz.full]);else{const{attrs:r,classes:s}=function jU(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ir(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&J_(n,t,r),s&&s.length>0&&iT(n,t,s.join(" "))}}(h,S,f,i),void 0!==t&&function fH(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(x,this.ngContentSelectors,t),w=function hH(n,e,t,i,r,s){const o=mn(),a=r[me],c=bi(o,r);qT(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Zn(sa(r,a,o.directiveStart+u,o),r);YT(a,r,o),c&&Zn(c,r);const l=sa(r,a,o.directiveStart+o.componentOffset,o);if(n[Ft]=r[Ft]=l,null!==s)for(const u of s)u(l,e);return Ay(a,o,n),l}(C,S,M,E,y,[pH]),ky(v,y,null)}finally{vv()}return new aH(this.componentType,w,Bc(x,y),y,x)}}class aH extends rz{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new rH(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;Fy(s[me],s,r,e,t),this.previousInputValues.set(e,t),fh(Ui(this._tNode.index,s))}}get injector(){return new li(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function pH(){const n=mn();If(ee()[me],n)}function gn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Ep(n,e,t,i){const r=ee();return gn(r,es(),e)&&(gt(),is(Wt(),r,n,e,t,i)),Ep}function Hc(n,e,t,i){return gn(n,es(),t)?e+Xe(t)+i:Je}function Hy(n,e,t,i,r){const o=r?"class":"style";Fy(n,t,e.inputs[o],o,i)}let Wy=(()=>{class e{}return e.__NG_ELEMENT_ID__=uG,e})();function uG(n){return function hG(n,e,t){if(ta(n)&&!t){const i=Ui(n.index,e);return new gh(i,i)}return 47&n.type?new gh(e[Yt],e):null}(mn(),ee(),16==(16&n))}function jy(n,e){return!e||Wv(n)}function Kc(n,e,t,i=!0){const r=e[me];if(function mV(n,e,t,i){const r=ln+i,s=t.length;i>0&&(t[r-1][Rr]=e),i<s-ln?(e[Rr]=t[r],iC(t,ln+i,e)):(t.push(e),e[Rr]=null),e[Gt]=t;const o=e[Bu];null!==o&&t!==o&&function gV(n,e){const t=n[mc];e[Yt]!==e[Gt][Gt][Yt]&&(n[iE]=!0),null===t?n[mc]=[e]:t.push(e)}(o,e);const a=e[Yr];null!==a&&a.insertView(n),e[Ke]|=128}(r,e,n,t),i){const s=ty(t,n),o=e[qe],a=tp(o,n[Zr]);null!==a&&function dV(n,e,t,i,r,s){i[Qt]=r,i[Xn]=e,ah(n,i,t,1,r,s)}(r,n[Xn],o,e,a,s)}}let Or=(()=>{class e{}return e.__NG_ELEMENT_ID__=$G,e})();function $G(){return o1(mn(),ee())}const XG=Or,r1=class extends XG{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Bc(this._hostTNode,this._hostLView)}get injector(){return new li(this._hostTNode,this._hostLView)}get parentInjector(){const e=Of(this._hostTNode,this._hostLView);if(xv(e)){const t=Zu(e,this._hostLView),i=Yu(e);return new li(t[me].data[i+8],t)}return new li(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=s1(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-ln}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,jy(this._hostTNode,null)),a}createComponent(e,t,i,r,s){const o=e&&!function Ju(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const p=t||{};a=p.index,i=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}const c=o?e:new _h(ut(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule){const g=(o?l:this.parentInjector).get(cr,null);g&&(s=g)}ut(c.componentType??{});const f=c.create(l,r,null,s);return this.insertImpl(f.hostView,a,jy(this._hostTNode,null)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function wB(n){return Yn(n[Gt])}(r)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=r[Gt],l=new r1(c,c[Xn],c[Gt]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return Kc(o,r,s,i),e.attachToViewContainerRef(),iC(t0(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=s1(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=sh(this._lContainer,t);i&&(Uf(t0(this._lContainer),t),Kv(i[me],i))}detach(e){const t=this._adjustIndex(e,-1),i=sh(this._lContainer,t);return i&&null!=Uf(t0(this._lContainer),t)?new gh(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function s1(n){return n[8]}function t0(n){return n[8]||(n[8]=[])}function o1(n,e){let t;const i=e[n.index];return Yn(i)?t=i:(t=function KT(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null,null]}(i,e,null,n),e[n.index]=t,yp(e,t)),a1(t,e,n,i),new r1(t,n,e)}let a1=function c1(n,e,t,i){if(n[Zr])return;let r;r=8&t.type?kt(i):function qG(n,e){const t=n[qe],i=t.createComment(""),r=bi(e,n);return ca(t,tp(t,r),i,function wV(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Zr]=r};function hi(n,e,t,i){const r=ee(),s=gt(),o=je+n,a=r[qe],c=s.firstCreatePass?function M4(n,e,t,i,r,s){const o=e.consts,c=Vc(e,n,2,i,Jr(o,r));return function Py(n,e,t,i){if(DE()){const r=null===i?null:{"":-1},s=function Wz(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(ZS(e,o.selectors,!1))if(i||(i=[]),Pr(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),Ly(n,e,a.length)}else i.unshift(o),Ly(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&qT(n,e,t,o,r,a),r&&function jz(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new he(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Fu(t.mergedAttrs,t.attrs)}(e,t,c,Jr(o,s)),null!==c.attrs&&wp(c,c.attrs,!1),null!==c.mergedAttrs&&wp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,e,t,i):s.data[o],l=y1(s,r,c,a,e,n);r[o]=l;const u=xf(c);return Qr(c,!0),rT(a,l,c),32!=(32&c.flags)&&Df()&&np(s,r,l,c),0===function bB(){return Ge.lFrame.elementDepthCount}()&&Zn(l,r),function MB(){Ge.lFrame.elementDepthCount++}(),u&&(function Dy(n,e,t){DE()&&(function Hz(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;ta(t)&&function Yz(n,e,t){const i=bi(e,n),r=WT(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=yp(n,vp(n,r,null,o,i,e,null,n[dc].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Nf(t,e),Zn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const c=n.data[a],l=sa(e,n,a,t);Zn(l,e),null!==o&&Zz(0,a-r,l,c,0,o),Pr(c)&&(Ui(t.index,e)[Ft]=sa(e,n,a,t))}}(n,e,t,bi(t,e)),64==(64&t.flags)&&YT(n,e,t))}(s,r,c),Ay(s,c,r)),null!==i&&function Iy(n,e,t=bi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}(r,c),hi}function as(){let n=mn();dv()?function fv(){Ge.lFrame.isParent=!1}():(n=n.parent,Qr(n,!1));const e=n;(function EB(n){return Ge.skipHydrationRootTNode===n})(e)&&function DB(){Ge.skipHydrationRootTNode=null}(),function SB(){Ge.lFrame.elementDepthCount--}();const t=gt();return t.firstCreatePass&&(If(t,n),ev(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function jB(n){return 0!=(8&n.flags)}(e)&&Hy(t,e,ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function $B(n){return 0!=(16&n.flags)}(e)&&Hy(t,e,ee(),e.stylesWithoutHost,!1),as}function Fs(n,e,t,i){return hi(n,e,t,i),as(),Fs}typeof requestIdleCallback<"u"?requestIdleCallback:setTimeout,typeof requestIdleCallback<"u"?cancelIdleCallback:clearTimeout;let y1=(n,e,t,i,r,s)=>(yo(!0),ep(i,r,function zE(){return Ge.lFrame.currentNamespace}()));const tl="en-US";let C1=tl;function zp(n){return!!n&&"function"==typeof n.then}function K1(n){return!!n&&"function"==typeof n.subscribe}function nl(n,e,t,i){const r=ee(),s=gt(),o=mn();return function Q1(n,e,t,i,r,s,o){const a=xf(i),l=n.firstCreatePass&&eA(n),u=e[Ft],h=QT(e);let d=!0;if(3&i.type||o){const g=bi(i,e),_=o?o(g):g,m=h.length,v=o?w=>o(kt(w[i.index])):i.index;let y=null;if(!o&&a&&(y=function C5(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[hc],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=s,y.__ngLastListenerFn__=s,d=!1;else{s=tD(i,e,u,s,!1);const w=t.listen(_,r,s);h.push(s,w),l&&l.push(r,v,m,m+1)}}else s=tD(i,e,u,s,!1);const f=i.outputs;let p;if(d&&null!==f&&(p=f[r])){const g=p.length;if(g)for(let _=0;_<g;_+=2){const x=e[p[_]][p[_+1]].subscribe(s),S=h.length;h.push(s,x),l&&l.push(r,i.index,S,-(S+1))}}}(s,r,r[qe],o,n,e,i),nl}function eD(n,e,t,i){try{return Kr(6,e,t),!1!==t(i)}catch(r){return nA(n,r),!1}finally{Kr(7,e,t)}}function tD(n,e,t,i,r){return function s(o){if(o===Function)return i;fh(n.componentOffset>-1?Ui(n.index,e):e);let c=eD(e,t,i,o),l=s.__ngNextListenerFn__;for(;l;)c=eD(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&o.preventDefault(),c}}function c0(n,e,t){return l0(n,"",e,"",t),c0}function l0(n,e,t,i,r){const s=ee(),o=Hc(s,e,t,i);return o!==Je&&function zi(n,e,t,i,r,s,o,a){const c=bi(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?(Fy(n,t,u,i,r),ta(e)&&function Uz(n,e){const t=Ui(e,n);16&t[Ke]||(t[Ke]|=64)}(t,e.index)):3&e.type&&(i=function kz(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(c,i,r))}(gt(),Wt(),s,n,o,s[qe],r,!1),l0}function il(n,e=""){const t=ee(),i=gt(),r=n+je,s=i.firstCreatePass?Vc(i,r,1,e,null):i.data[r],o=wD(i,t,s,e,n);t[r]=o,Df()&&np(i,t,o,s),Qr(s,!1)}let wD=(n,e,t,i,r)=>(yo(!0),function Qf(n,e){return n.createText(e)}(e[qe],i));function u0(n){return h0("",n,""),u0}function h0(n,e,t){const i=ee(),r=Hc(i,n,e,t);return r!==Je&&Os(i,ci(),r),h0}class fa{}class ID{}class g0 extends fa{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new cA(this);const r=$n(e);this._bootstrapComponents=Vi(r.bootstrap),this._r3Injector=wC(e,t,[{provide:fa,useValue:this},{provide:dp,useValue:this.componentFactoryResolver},...i],Tn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class _0 extends ID{constructor(e){super(),this.moduleType=e}create(e){return new g0(this.moduleType,e,[])}}class RD extends fa{constructor(e){super(),this.componentFactoryResolver=new cA(this),this.instance=null;const t=new $f([...e.providers,{provide:fa,useValue:this},{provide:dp,useValue:this.componentFactoryResolver}],e.parent||jf(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function v0(n,e,t=null){return new RD({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let Z5=(()=>{var n;class e{constructor(i){this._injector=i,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(i){if(!i.standalone)return null;if(!this.cachedInjectors.has(i)){const r=hC(0,i.type),s=r.length>0?v0([r],this._injector,`Standalone[${i.type.name}]`):null;this.cachedInjectors.set(i,s)}return this.cachedInjectors.get(i)}ngOnDestroy(){try{for(const i of this.cachedInjectors.values())null!==i&&i.destroy()}finally{this.cachedInjectors.clear()}}}return(n=e).\u0275prov=De({token:n,providedIn:"environment",factory:()=>new n(Se(cr))}),e})();function PD(n){n.getStandaloneInjector=e=>e.get(Z5).getOrCreateStandaloneInjector(n)}function SW(){return this._results[Symbol.iterator]()}class w0{get changes(){return this._changes||(this._changes=new ui)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=w0.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=SW)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Mi(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function o3(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let ks=(()=>{class e{}return e.__NG_ELEMENT_ID__=TW,e})();const EW=ks,CW=class extends EW{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=function xh(n,e,t,i){const r=e.tView,a=vp(n,r,t,4096&n[Ke]?4096:16,null,e,null,null,null,i?.injector??null,i?.dehydratedView??null);a[Bu]=n[e.index];const l=n[Yr];return null!==l&&(a[Yr]=l.createEmbeddedView(r)),ky(r,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,dehydratedView:i});return new gh(r)}};function TW(){return Wp(mn(),ee())}function Wp(n,e){return 4&n.type?new CW(e,n,Bc(n,e)):null}class x0{constructor(e){this.queryList=e,this.matches=null}clone(){return new x0(this.queryList)}setDirty(){this.queryList.setDirty()}}class b0{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new b0(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==KD(e,t).matches&&this.queries[t].setDirty()}}class jD{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class M0{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new M0(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class S0{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new S0(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,AW(t,s)),this.matchTNodeWithReadOption(e,t,Ff(t,e,s,!1,!1))}else i===ks?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Ff(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Mo||r===Or||r===ks&&4&t.type)this.addMatch(t.index,-2);else{const s=Ff(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function AW(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function IW(n,e,t,i){return-1===t?function DW(n,e){return 11&n.type?Bc(n,e):4&n.type?Wp(n,e):null}(e,n):-2===t?function RW(n,e,t){return t===Mo?Bc(e,n):t===ks?Wp(e,n):t===Or?o1(e,n):void 0}(n,e,i):sa(n,n[me],t,e)}function $D(n,e,t,i){const r=e[Yr].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:IW(e,s[l],o[c+1],t.metadata.read))}r.matches=a}return r.matches}function E0(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=$D(n,e,r,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)i.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let h=ln;h<u.length;h++){const d=u[h];d[Bu]===d[Gt]&&E0(d[me],d,l,i)}if(null!==u[mc]){const h=u[mc];for(let d=0;d<h.length;d++){const f=h[d];E0(f[me],f,l,i)}}}}}return i}function C0(n){const e=ee(),t=gt(),i=NE();gv(i+1);const r=KD(t,i);if(n.dirty&&function vB(n){return 4==(4&n[Ke])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?E0(t,e,i,[]):$D(t,e,r,i);n.reset(s,cz),n.notifyOnChanges()}return!0}return!1}function XD(n,e,t){const i=gt();i.firstCreatePass&&(function ZD(n,e,t){null===n.queries&&(n.queries=new M0),n.queries.track(new S0(e,t))}(i,new jD(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function YD(n,e,t){const i=new w0(4==(4&t));(function Nz(n,e,t,i){const r=QT(e);r.push(t),n.firstCreatePass&&eA(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Yr]&&(e[Yr]=new b0),e[Yr].queries.push(new x0(i))}(i,ee(),e)}function KD(n,e){return n.queries.getByIndex(e)}const P0=new Le("Application Initializer");let L0=(()=>{var n;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r}),this.appInits=xe(P0,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const i=[];for(const s of this.appInits){const o=s();if(zp(o))i.push(o);else if(K1(o)){const a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});i.push(a)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(i).then(()=>{r()}).catch(s=>{this.reject(s)}),0===i.length&&r(),this.initialized=!0}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),fI=(()=>{var n;class e{log(i){console.log(i)}warn(i){console.warn(i)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})();const Us=new Le("LocaleId",{providedIn:"root",factory:()=>xe(Us,lt.Optional|lt.SkipSelf)||function tj(){return typeof $localize<"u"&&$localize.locale||tl}()});let pI=(()=>{var n;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new rr(!1)}add(){this.hasPendingTasks.next(!0);const i=this.taskId++;return this.pendingTasks.add(i),i}remove(i){this.pendingTasks.delete(i),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();class rj{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let mI=(()=>{var n;class e{compileModuleSync(i){return new _0(i)}compileModuleAsync(i){return Promise.resolve(this.compileModuleSync(i))}compileModuleAndAllComponentsSync(i){const r=this.compileModuleSync(i),o=Vi($n(i).declarations).reduce((a,c)=>{const l=ut(c);return l&&a.push(new _h(l)),a},[]);return new rj(r,o)}compileModuleAndAllComponentsAsync(i){return Promise.resolve(this.compileModuleAndAllComponentsSync(i))}clearCache(){}clearCacheFor(i){}getModuleId(i){}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const yI=new Le(""),Xp=new Le("");let U0,F0=(()=>{var n;class e{constructor(i,r,s){this._ngZone=i,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,U0||(function Sj(n){U0=n}(s),s.addToWindow(r)),this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{At.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(i)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,r,s){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),i(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:i,timeoutId:o,updateCb:s})}whenStable(i,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(i){this.registry.registerApplication(i,this)}unregisterApplication(i){this.registry.unregisterApplication(i)}findProviders(i,r,s){return[]}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(At),Se(k0),Se(Xp))},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})(),k0=(()=>{var n;class e{constructor(){this._applications=new Map}registerApplication(i,r){this._applications.set(i,r)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,r=!0){return U0?.findTestabilityInTree(this,i,r)??null}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})(),Eo=null;const wI=new Le("AllowMultipleToken"),B0=new Le("PlatformDestroyListeners"),V0=new Le("appBootstrapListener");class bI{constructor(e,t){this.name=e,this.token=t}}function SI(n,e,t=[]){const i=`Platform: ${e}`,r=new Le(i);return(s=[])=>{let o=z0();if(!o||o.injector.get(wI,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function Tj(n){if(Eo&&!Eo.get(wI,!1))throw new he(400,!1);(function xI(){!function sB(n){pE=n}(()=>{throw new he(600,!1)})})(),Eo=n;const e=n.get(CI);(function MI(n){n.get(bC,null)?.forEach(t=>t())})(n)}(function EI(n=[],e){return lr.create({name:e,providers:[{provide:Lv,useValue:"platform"},{provide:B0,useValue:new Set([()=>Eo=null])},...n]})}(a,i))}return function Dj(n){const e=z0();if(!e)throw new he(401,!1);return e}()}}function z0(){return Eo?.get(CI)??null}let CI=(()=>{var n;class e{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,r){const s=function Ij(n="zone.js",e){return"noop"===n?new yz:"zone.js"===n?new At(e):n}(r?.ngZone,function TI(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return s.run(()=>{const o=function Y5(n,e,t){return new g0(n,e,t)}(i.moduleType,this.injector,function PI(n){return[{provide:At,useFactory:n},{provide:th,multi:!0,useFactory:()=>{const e=xe(Pj,{optional:!0});return()=>e.initialize()}},{provide:RI,useFactory:Rj},{provide:TT,useFactory:AT}]}(()=>s)),a=o.injector.get(ns,null);return s.runOutsideAngular(()=>{const c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{qp(this._modules,o),c.unsubscribe()})}),function AI(n,e,t){try{const i=t();return zp(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(a,s,()=>{const c=o.injector.get(L0);return c.runInitializers(),c.donePromise.then(()=>(function T1(n){sr(n,"Expected localeId to be defined"),"string"==typeof n&&(C1=n.toLowerCase().replace(/_/g,"-"))}(o.injector.get(Us,tl)||tl),this._moduleDoBootstrap(o),o))})})}bootstrapModule(i,r=[]){const s=DI({},r);return function Ej(n,e,t){const i=new _0(t);return Promise.resolve(i)}(0,0,i).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(i){const r=i.injector.get(ol);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!i.instance.ngDoBootstrap)throw new he(-403,!1);i.instance.ngDoBootstrap(r)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new he(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const i=this._injector.get(B0,null);i&&(i.forEach(r=>r()),i.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(lr))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})();function DI(n,e){return Array.isArray(e)?e.reduce(DI,n):{...n,...e}}let ol=(()=>{var n;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=xe(RI),this.zoneIsStable=xe(TT),this.componentTypes=[],this.components=[],this.isStable=xe(pI).hasPendingTasks.pipe(Ar(i=>i?We(!1):this.zoneIsStable),function mU(n,e=ho){return n=n??gU,En((t,i)=>{let r,s=!0;t.subscribe(Cn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),LS()),this._injector=xe(cr)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(i,r){const s=i instanceof wT;if(!this._injector.get(L0).done)throw!s&&function go(n){const e=ut(n)||An(n)||Bn(n);return null!==e&&e.standalone}(i),new he(405,!1);let a;a=s?i:this._injector.get(dp).resolveComponentFactory(i),this.componentTypes.push(a.componentType);const c=function Cj(n){return n.isBoundToModule}(a)?void 0:this._injector.get(fa),u=a.create(lr.NULL,[],r||a.selector,c),h=u.location.nativeElement,d=u.injector.get(yI,null);return d?.registerApplication(h),u.onDestroy(()=>{this.detachView(u.hostView),qp(this.components,u),d?.unregisterApplication(h)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new he(101,!1);try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1}}attachView(i){const r=i;this._views.push(r),r.attachToAppRef(this)}detachView(i){const r=i;qp(this._views,r),r.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i);const r=this._injector.get(V0,[]);[...this._bootstrapListeners,...r].forEach(s=>s(i))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(i=>i()),this._views.slice().forEach(i=>i.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(i){return this._destroyListeners.push(i),()=>qp(this._destroyListeners,i)}destroy(){if(this._destroyed)throw new he(406,!1);const i=this._injector;i.destroy&&!i.destroyed&&i.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();function qp(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const RI=new Le("",{providedIn:"root",factory:()=>xe(ns).handleError.bind(void 0)});function Rj(){const n=xe(At),e=xe(ns);return t=>n.runOutsideAngular(()=>e.handleError(t))}let Pj=(()=>{var n;class e{constructor(){this.zone=xe(At),this.applicationRef=xe(ol)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const Uj=SI(null,"core",[]);let Bj=(()=>{var n;class e{constructor(i){}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(ol))},n.\u0275mod=Ds({type:n}),n.\u0275inj=Xr({}),e})(),q0=null;function al(){return q0}class s${}const Hi=new Le("DocumentToken");let Y0=(()=>{var n;class e{historyGo(i){throw new Error("Not implemented")}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:function(){return xe(a$)},providedIn:"platform"}),e})();const o$=new Le("Location Initialized");let a$=(()=>{var n;class e extends Y0{constructor(){super(),this._doc=xe(Hi),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return al().getBaseHref(this._doc)}onPopState(i){const r=al().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",i,!1),()=>r.removeEventListener("popstate",i)}onHashChange(i){const r=al().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",i,!1),()=>r.removeEventListener("hashchange",i)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(i){this._location.pathname=i}pushState(i,r,s){this._history.pushState(i,r,s)}replaceState(i,r,s){this._history.replaceState(i,r,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:function(){return new n},providedIn:"platform"}),e})();function Z0(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function WI(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Bs(n){return n&&"?"!==n[0]?"?"+n:n}let ma=(()=>{var n;class e{historyGo(i){throw new Error("Not implemented")}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:function(){return xe($I)},providedIn:"root"}),e})();const jI=new Le("appBaseHref");let $I=(()=>{var n;class e extends ma{constructor(i,r){super(),this._platformLocation=i,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??xe(Hi).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return Z0(this._baseHref,i)}path(i=!1){const r=this._platformLocation.pathname+Bs(this._platformLocation.search),s=this._platformLocation.hash;return s&&i?`${r}${s}`:r}pushState(i,r,s,o){const a=this.prepareExternalUrl(s+Bs(o));this._platformLocation.pushState(i,r,a)}replaceState(i,r,s,o){const a=this.prepareExternalUrl(s+Bs(o));this._platformLocation.replaceState(i,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Y0),Se(jI,8))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),c$=(()=>{var n;class e extends ma{constructor(i,r){super(),this._platformLocation=i,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}path(i=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(i){const r=Z0(this._baseHref,i);return r.length>0?"#"+r:r}pushState(i,r,s,o){let a=this.prepareExternalUrl(s+Bs(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(i,r,a)}replaceState(i,r,s,o){let a=this.prepareExternalUrl(s+Bs(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(i,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Y0),Se(jI,8))},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})(),Oh=(()=>{var n;class e{constructor(i){this._subject=new ui,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=i;const r=this._locationStrategy.getBaseHref();this._basePath=function h$(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(WI(XI(r))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(i=!1){return this.normalize(this._locationStrategy.path(i))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(i,r=""){return this.path()==this.normalize(i+Bs(r))}normalize(i){return e.stripTrailingSlash(function u$(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,XI(i)))}prepareExternalUrl(i){return i&&"/"!==i[0]&&(i="/"+i),this._locationStrategy.prepareExternalUrl(i)}go(i,r="",s=null){this._locationStrategy.pushState(s,"",i,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+Bs(r)),s)}replaceState(i,r="",s=null){this._locationStrategy.replaceState(s,"",i,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+Bs(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(i=0){this._locationStrategy.historyGo?.(i)}onUrlChange(i){return this._urlChangeListeners.push(i),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(i);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(i="",r){this._urlChangeListeners.forEach(s=>s(i,r))}subscribe(i,r,s){return this._subject.subscribe({next:i,error:r,complete:s})}}return(n=e).normalizeQueryParams=Bs,n.joinWithSlash=Z0,n.stripTrailingSlash=WI,n.\u0275fac=function(i){return new(i||n)(Se(ma))},n.\u0275prov=De({token:n,factory:function(){return function l$(){return new Oh(Se(ma))}()},providedIn:"root"}),e})();function XI(n){return n.replace(/\/index.html$/,"")}let cR=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=Ds({type:n}),n.\u0275inj=Xr({}),e})();function uR(n){return"server"===n}let D8=(()=>{var n;class e{}return(n=e).\u0275prov=De({token:n,providedIn:"root",factory:()=>new I8(Se(Hi),window)}),e})();class I8{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function R8(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class t6 extends s${constructor(){super(...arguments),this.supportsDOMEvents=!0}}class fw extends t6{static makeCurrent(){!function r$(n){q0||(q0=n)}(new fw)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function n6(){return Bh=Bh||document.querySelector("base"),Bh?Bh.getAttribute("href"):null}();return null==t?null:function i6(n){um=um||document.createElement("a"),um.setAttribute("href",n);const e=um.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Bh=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Y$(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let um,Bh=null,s6=(()=>{var n;class e{build(){return new XMLHttpRequest}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})();const pw=new Le("EventManagerPlugins");let mR=(()=>{var n;class e{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(s=>{s.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,r,s){return this._findPluginFor(r).addEventListener(i,r,s)}getZone(){return this._zone}_findPluginFor(i){let r=this._eventNameToPlugin.get(i);if(r)return r;if(r=this._plugins.find(o=>o.supports(i)),!r)throw new he(5101,!1);return this._eventNameToPlugin.set(i,r),r}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(pw),Se(At))},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})();class gR{constructor(e){this._doc=e}}const mw="ng-app-id";let _R=(()=>{var n;class e{constructor(i,r,s,o={}){this.doc=i,this.appId=r,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=uR(o),this.resetHostNodes()}addStyles(i){for(const r of i)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(i){for(const r of i)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const i=this.styleNodesInDOM;i&&(i.forEach(r=>r.remove()),i.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(const r of this.getAllStyles())this.addStyleToHost(i,r)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(const r of this.hostNodes)this.addStyleToHost(r,i)}onStyleRemoved(i){const r=this.styleRef;r.get(i)?.elements?.forEach(s=>s.remove()),r.delete(i)}collectServerRenderedStyles(){const i=this.doc.head?.querySelectorAll(`style[${mw}="${this.appId}"]`);if(i?.length){const r=new Map;return i.forEach(s=>{null!=s.textContent&&r.set(s.textContent,s)}),r}return null}changeUsageCount(i,r){const s=this.styleRef;if(s.has(i)){const o=s.get(i);return o.usage+=r,o.usage}return s.set(i,{usage:r,elements:[]}),r}getStyleElement(i,r){const s=this.styleNodesInDOM,o=s?.get(r);if(o?.parentNode===i)return s.delete(r),o.removeAttribute(mw),o;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(mw,this.appId),a}}addStyleToHost(i,r){const s=this.getStyleElement(i,r);i.appendChild(s);const o=this.styleRef,a=o.get(r)?.elements;a?a.push(s):o.set(r,{elements:[s],usage:1})}resetHostNodes(){const i=this.hostNodes;i.clear(),i.add(this.doc.head)}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Hi),Se(qf),Se(MC,8),Se(Rc))},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})();const gw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},_w=/%COMP%/g,l6=new Le("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function yR(n,e){return e.map(t=>t.replace(_w,n))}let wR=(()=>{var n;class e{constructor(i,r,s,o,a,c,l,u=null){this.eventManager=i,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=uR(c),this.defaultRenderer=new vw(i,a,l,this.platformIsServer)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Dr.ShadowDom&&(r={...r,encapsulation:Dr.Emulated});const s=this.getOrCreateRenderer(i,r);return s instanceof bR?s.applyToHost(i):s instanceof yw&&s.applyStyles(),s}getOrCreateRenderer(i,r){const s=this.rendererByCompId;let o=s.get(r.id);if(!o){const a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(r.encapsulation){case Dr.Emulated:o=new bR(l,u,r,this.appId,h,a,c,d);break;case Dr.ShadowDom:return new f6(l,u,i,r,a,c,this.nonce,d);default:o=new yw(l,u,r,h,a,c,d)}s.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(mR),Se(_R),Se(qf),Se(l6),Se(Hi),Se(Rc),Se(At),Se(MC))},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})();class vw{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(gw[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(xR(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(xR(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new he(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=gw[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=gw[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(xo.DashCase|xo.Important)?e.style.setProperty(t,i,r&xo.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&xo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=al().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function xR(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class f6 extends vw{constructor(e,t,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=yR(r.id,r.styles);for(const u of l){const h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=u,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class yw extends vw{constructor(e,t,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?yR(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class bR extends yw{constructor(e,t,i,r,s,o,a,c){const l=r+"-"+i.id;super(e,t,i,s,o,a,c,l),this.contentAttr=function u6(n){return"_ngcontent-%COMP%".replace(_w,n)}(l),this.hostAttr=function h6(n){return"_nghost-%COMP%".replace(_w,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let p6=(()=>{var n;class e extends gR{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,s){return i.addEventListener(r,s,!1),()=>this.removeEventListener(i,r,s)}removeEventListener(i,r,s){return i.removeEventListener(r,s)}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Hi))},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})();const MR=["alt","control","meta","shift"],m6={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},g6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let _6=(()=>{var n;class e extends gR{constructor(i){super(i)}supports(i){return null!=e.parseEventName(i)}addEventListener(i,r,s){const o=e.parseEventName(r),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>al().onAndCancel(i,o.domEventName,a))}static parseEventName(i){const r=i.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const o=e._normalizeKey(r.pop());let a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),MR.forEach(u=>{const h=r.indexOf(u);h>-1&&(r.splice(h,1),a+=u+".")}),a+=o,0!=r.length||0===o.length)return null;const l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(i,r){let s=m6[i.key]||i.key,o="";return r.indexOf("code.")>-1&&(s=i.code,o="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),MR.forEach(a=>{a!==s&&(0,g6[a])(i)&&(o+=a+".")}),o+=s,o===r)}static eventCallback(i,r,s){return o=>{e.matchEventFullKeyCode(o,i)&&s.runGuarded(()=>r(o))}}static _normalizeKey(i){return"esc"===i?"escape":i}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Hi))},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})();const ER=[{provide:Rc,useValue:"browser"},{provide:bC,useValue:function v6(){fw.makeCurrent()},multi:!0},{provide:Hi,useFactory:function w6(){return function z3(n){Bv=n}(document),document},deps:[]}],x6=SI(Uj,"browser",ER),b6=new Le(""),CR=[{provide:Xp,useClass:class r6{addToWindow(e){Ot.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new he(5103,!1);return s},Ot.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ot.getAllAngularRootElements=()=>e.getAllRootElements(),Ot.frameworkStabilizers||(Ot.frameworkStabilizers=[]),Ot.frameworkStabilizers.push(i=>{const r=Ot.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(c){o=o||c,s--,0==s&&i(o)};r.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?al().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:yI,useClass:F0,deps:[At,k0,Xp]},{provide:F0,useClass:F0,deps:[At,k0,Xp]}],TR=[{provide:Lv,useValue:"root"},{provide:ns,useFactory:function y6(){return new ns},deps:[]},{provide:pw,useClass:p6,multi:!0,deps:[Hi,At,Rc]},{provide:pw,useClass:_6,multi:!0,deps:[Hi]},wR,_R,mR,{provide:bT,useExisting:wR},{provide:class P8{},useClass:s6,deps:[]},[]];let M6=(()=>{var n;class e{constructor(i){}static withServerTransition(i){return{ngModule:e,providers:[{provide:qf,useValue:i.appId}]}}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(b6,12))},n.\u0275mod=Ds({type:n}),n.\u0275inj=Xr({providers:[...TR,...CR],imports:[cR,Bj]}),e})(),AR=(()=>{var n;class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Hi))},n.\u0275prov=De({token:n,factory:function(i){let r=null;return r=i?new i:function E6(){return new AR(Se(Hi))}(),r},providedIn:"root"}),e})();typeof window<"u"&&window;const{isArray:R6}=Array,{getPrototypeOf:P6,prototype:L6,keys:N6}=Object;const{isArray:k6}=Array;function xw(...n){const e=Pu(n),t=function oU(n){return Ht(F_(n))?n.pop():void 0}(n),{args:i,keys:r}=function O6(n){if(1===n.length){const e=n[0];if(R6(e))return{args:e,keys:null};if(function F6(n){return n&&"object"==typeof n&&P6(n)===L6}(e)){const t=N6(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}(n);if(0===i.length)return On([],e);const s=new Sn(function z6(n,e,t=ho){return i=>{PR(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let c=0;c<r;c++)PR(e,()=>{const l=On(n[c],e);let u=!1;l.subscribe(Cn(i,h=>{s[c]=h,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>function V6(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}(r,o):ho));return t?s.pipe(function B6(n){return Rt(e=>function U6(n,e){return k6(e)?n(...e):n(e)}(n,e))}(t)):s}function PR(n,e,t){n?Cs(t,n,e):e()}const hm=M_(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function bw(...n){return function H6(){return lc(1)}()(On(n,Pu(n)))}function LR(n){return new Sn(e=>{ir(n()).subscribe(e)})}function dm(n,e){const t=Ht(n)?n:()=>n,i=r=>r.error(t());return new Sn(e?r=>e.schedule(i,0,r):i)}function Mw(){return En((n,e)=>{let t=null;n._refCount++;const i=Cn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class NR extends Sn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,mS(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Fi;const t=this.getSubject();e.add(this.source.subscribe(Cn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Fi.EMPTY)}return e}refCount(){return Mw()(this)}}function ll(n){return n<=0?()=>$r:En((e,t)=>{let i=0;e.subscribe(Cn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function To(n,e){return En((t,i)=>{let r=0;t.subscribe(Cn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function fm(n){return En((e,t)=>{let i=!1;e.subscribe(Cn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function OR(n=W6){return En((e,t)=>{let i=!1;e.subscribe(Cn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function W6(){return new hm}function ga(n,e){const t=arguments.length>=2;return i=>i.pipe(n?To((r,s)=>n(r,s,i)):ho,ll(1),t?fm(e):OR(()=>new hm))}function Vh(n,e){return Ht(e)?jn(n,e,1):jn(n,1)}function Kn(n,e,t){const i=Ht(n)||e||t?{next:n,error:e,complete:t}:n;return i?En((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Cn(s,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),s.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),s.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),s.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):ho}function _a(n){return En((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Cn(t,void 0,void 0,o=>{s=ir(n(o,_a(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Sw(n){return n<=0?()=>$r:En((e,t)=>{let i=[];e.subscribe(Cn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Ew(n){return En((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const nt="primary",zh=Symbol("RouteTitle");class Z6{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ul(n){return new Z6(n)}function K6(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function cs(n,e){const t=n?Cw(n):void 0,i=e?Cw(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!FR(n[r],e[r]))return!1;return!0}function Cw(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function FR(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function kR(n){return n.length>0?n[n.length-1]:null}function Ao(n){return function I6(n){return!!n&&(n instanceof Sn||Ht(n.lift)&&Ht(n.subscribe))}(n)?n:zp(n)?On(Promise.resolve(n)):We(n)}const Q6={exact:function VR(n,e,t){if(!va(n.segments,e.segments)||!pm(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!VR(n.children[i],e.children[i],t))return!1;return!0},subset:zR},UR={exact:function eX(n,e){return cs(n,e)},subset:function tX(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>FR(n[t],e[t]))},ignored:()=>!0};function BR(n,e,t){return Q6[t.paths](n.root,e.root,t.matrixParams)&&UR[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function zR(n,e,t){return HR(n,e,e.segments,t)}function HR(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!va(r,t)||e.hasChildren()||!pm(r,t,i))}if(n.segments.length===t.length){if(!va(n.segments,t)||!pm(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!zR(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(va(n.segments,r)&&pm(n.segments,r,i)&&n.children[nt])&&HR(n.children[nt],e,s,i)}}function pm(n,e,t){return e.every((i,r)=>UR[t](n[r].parameters,i.parameters))}class hl{constructor(e=new Dt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ul(this.queryParams)),this._queryParamMap}toString(){return rX.serialize(this)}}class Dt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return mm(this)}}class Hh{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ul(this.parameters)),this._parameterMap}toString(){return jR(this)}}function va(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let dl=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:function(){return new Tw},providedIn:"root"}),e})();class Tw{parse(e){const t=new mX(e);return new hl(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Gh(e.root,!0)}`,i=function aX(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${gm(t)}=${gm(r)}`).join("&"):`${gm(t)}=${gm(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function sX(n){return encodeURI(n)}(e.fragment)}`:""}`}}const rX=new Tw;function mm(n){return n.segments.map(e=>jR(e)).join("/")}function Gh(n,e){if(!n.hasChildren())return mm(n);if(e){const t=n.children[nt]?Gh(n.children[nt],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==nt&&i.push(`${r}:${Gh(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function iX(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===nt&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==nt&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===nt?[Gh(n.children[nt],!1)]:[`${r}:${Gh(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[nt]?`${mm(n)}/${t[0]}`:`${mm(n)}/(${t.join("//")})`}}function GR(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function gm(n){return GR(n).replace(/%3B/gi,";")}function Aw(n){return GR(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function _m(n){return decodeURIComponent(n)}function WR(n){return _m(n.replace(/\+/g,"%20"))}function jR(n){return`${Aw(n.path)}${function oX(n){return Object.keys(n).map(e=>`;${Aw(e)}=${Aw(n[e])}`).join("")}(n.parameters)}`}const cX=/^[^\/()?;#]+/;function Dw(n){const e=n.match(cX);return e?e[0]:""}const lX=/^[^\/()?;=#]+/,hX=/^[^=?&#]+/,fX=/^[^&#]+/;class mX{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Dt([],{}):new Dt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[nt]=new Dt(e,t)),i}parseSegment(){const e=Dw(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new he(4009,!1);return this.capture(e),new Hh(_m(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function uX(n){const e=n.match(lX);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Dw(this.remaining);r&&(i=r,this.capture(i))}e[_m(t)]=_m(i)}parseQueryParam(e){const t=function dX(n){const e=n.match(hX);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function pX(n){const e=n.match(fX);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=WR(t),s=WR(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Dw(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new he(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=nt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[nt]:new Dt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new he(4011,!1)}}function $R(n){return n.segments.length>0?new Dt([],{[nt]:n}):n}function XR(n){const e={};for(const i of Object.keys(n.children)){const s=XR(n.children[i]);if(i===nt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function gX(n){if(1===n.numberOfChildren&&n.children[nt]){const e=n.children[nt];return new Dt(n.segments.concat(e.segments),e.children)}return n}(new Dt(n.segments,e))}function ya(n){return n instanceof hl}function qR(n){let e;const i=function t(s){const o={};for(const c of s.children){const l=t(c);o[c.outlet]=l}const a=new Dt(s.url,o);return s===n&&(e=a),a}(n.root),r=$R(i);return e??r}function YR(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return Iw(r,r,r,t,i);const s=function vX(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new KR(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new KR(t,e,i)}(e);if(s.toRoot())return Iw(r,r,new Dt([],{}),t,i);const o=function yX(n,e,t){if(n.isAbsolute)return new ym(e,!0,0);if(!t)return new ym(e,!1,NaN);if(null===t.parent)return new ym(t,!0,0);const i=vm(n.commands[0])?0:1;return function wX(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new he(4005,!1);r=i.segments.length}return new ym(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?jh(o.segmentGroup,o.index,s.commands):JR(o.segmentGroup,o.index,s.commands);return Iw(r,o.segmentGroup,a,t,i)}function vm(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Wh(n){return"object"==typeof n&&null!=n&&n.outlets}function Iw(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=n===e?t:ZR(n,e,t);const a=$R(XR(o));return new hl(a,s,r)}function ZR(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:ZR(s,e,t)}),new Dt(n.segments,i)}class KR{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&vm(i[0]))throw new he(4003,!1);const r=i.find(Wh);if(r&&r!==kR(i))throw new he(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ym{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function JR(n,e,t){if(n||(n=new Dt([],{})),0===n.segments.length&&n.hasChildren())return jh(n,e,t);const i=function bX(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(Wh(a))break;const c=`${a}`,l=i<t.length-1?t[i+1]:null;if(r>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!eP(c,l,o))return s;i+=2}else{if(!eP(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Dt(n.segments.slice(0,i.pathIndex),{});return s.children[nt]=new Dt(n.segments.slice(i.pathIndex),n.children),jh(s,0,r)}return i.match&&0===r.length?new Dt(n.segments,{}):i.match&&!n.hasChildren()?Rw(n,e,t):i.match?jh(n,0,r):Rw(n,e,t)}function jh(n,e,t){if(0===t.length)return new Dt(n.segments,{});{const i=function xX(n){return Wh(n[0])?n[0].outlets:{[nt]:n}}(t),r={};if(Object.keys(i).some(s=>s!==nt)&&n.children[nt]&&1===n.numberOfChildren&&0===n.children[nt].segments.length){const s=jh(n.children[nt],e,t);return new Dt(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=JR(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new Dt(n.segments,r)}}function Rw(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Wh(s)){const c=MX(s.outlets);return new Dt(i,c)}if(0===r&&vm(t[0])){i.push(new Hh(n.segments[e].path,QR(t[0]))),r++;continue}const o=Wh(s)?s.outlets[nt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&vm(a)?(i.push(new Hh(o,QR(a))),r+=2):(i.push(new Hh(o,{})),r++)}return new Dt(i,{})}function MX(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=Rw(new Dt([],{}),0,i))}),e}function QR(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function eP(n,e,t){return n==t.path&&cs(e,t.parameters)}const $h="imperative";class ls{constructor(e,t){this.id=e,this.url=t}}class wm extends ls{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Hs extends ls{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class fl extends ls{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class pl extends ls{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class xm extends ls{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class tP extends ls{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class SX extends ls{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EX extends ls{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class CX extends ls{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class TX extends ls{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class AX{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class DX{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class IX{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class RX{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class PX{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class LX{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nP{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Pw{}class Lw{constructor(e){this.url=e}}class NX{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Xh,this.attachRef=null}}let Xh=(()=>{var n;class e{constructor(){this.contexts=new Map}onChildOutletCreated(i,r){const s=this.getOrCreateContext(i);s.outlet=r,this.contexts.set(i,s)}onChildOutletDestroyed(i){const r=this.getContext(i);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let r=this.getContext(i);return r||(r=new NX,this.contexts.set(i,r)),r}getContext(i){return this.contexts.get(i)||null}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();class iP{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Nw(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Nw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Ow(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Ow(e,this._root).map(t=>t.value)}}function Nw(n,e){if(n===e.value)return e;for(const t of e.children){const i=Nw(n,t);if(i)return i}return null}function Ow(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Ow(n,t);if(i.length)return i.unshift(e),i}return[]}class Ur{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function ml(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class rP extends iP{constructor(e,t){super(e),this.snapshot=t,kw(this,e)}toString(){return this.snapshot.toString()}}function sP(n,e){const t=function OX(n,e){const o=new Fw([],{},{},"",{},nt,e,null,{});return new aP("",new Ur(o,[]))}(0,e),i=new rr([new Hh("",{})]),r=new rr({}),s=new rr({}),o=new rr({}),a=new rr(""),c=new gl(i,r,o,a,s,nt,e,t.root);return c.snapshot=t.root,new rP(new Ur(c,[]),t)}class gl{constructor(e,t,i,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Rt(l=>l[zh]))??We(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Rt(e=>ul(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Rt(e=>ul(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function oP(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function FX(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Fw{get title(){return this.data?.[zh]}constructor(e,t,i,r,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ul(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ul(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class aP extends iP{constructor(e,t){super(t),this.url=e,kw(this,t)}toString(){return cP(this._root)}}function kw(n,e){e.value._routerState=n,e.children.forEach(t=>kw(n,t))}function cP(n){const e=n.children.length>0?` { ${n.children.map(cP).join(", ")} } `:"";return`${n.value}${e}`}function Uw(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,cs(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),cs(e.params,t.params)||n.paramsSubject.next(t.params),function J6(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!cs(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),cs(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Bw(n,e){const t=cs(n.params,e.params)&&function nX(n,e){return va(n,e)&&n.every((t,i)=>cs(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Bw(n.parent,e.parent))}let Vw=(()=>{var n;class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=nt,this.activateEvents=new ui,this.deactivateEvents=new ui,this.attachEvents=new ui,this.detachEvents=new ui,this.parentContexts=xe(Xh),this.location=xe(Or),this.changeDetector=xe(Wy),this.environmentInjector=xe(cr),this.inputBinder=xe(bm,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){const{firstChange:r,previousValue:s}=i.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new he(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new he(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new he(4012,!1);this.location.detach();const i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,r){this.activated=i,this._activatedRoute=r,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){const i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,r){if(this.isActivated)throw new he(4013,!1);this._activatedRoute=i;const s=this.location,a=i.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new kX(i,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275dir=oi({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ia]}),e})();class kX{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===gl?this.route:e===Xh?this.childContexts:this.parent.get(e,t)}}const bm=new Le("");let lP=(()=>{var n;class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(i){this.unsubscribeFromRouteData(i),this.subscribeToRouteData(i)}unsubscribeFromRouteData(i){this.outletDataSubscriptions.get(i)?.unsubscribe(),this.outletDataSubscriptions.delete(i)}subscribeToRouteData(i){const{activatedRoute:r}=i,s=xw([r.queryParams,r.params,r.data]).pipe(Ar(([o,a,c],l)=>(c={...o,...a,...c},0===l?We(c):Promise.resolve(c)))).subscribe(o=>{if(!i.isActivated||!i.activatedComponentRef||i.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(i);const a=function i$(n){const e=ut(n);if(!e)return null;const t=new _h(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(a)for(const{templateName:c}of a.inputs)i.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(i)});this.outletDataSubscriptions.set(i,s)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})();function qh(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function BX(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return qh(n,i,r);return qh(n,i)})}(n,e,t);return new Ur(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>qh(n,a)),o}}const i=function VX(n){return new gl(new rr(n.url),new rr(n.params),new rr(n.queryParams),new rr(n.fragment),new rr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>qh(n,s));return new Ur(i,r)}}const zw="ngNavigationCancelingError";function uP(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=ya(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=hP(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function hP(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[zw]=!0,i.cancellationCode=e,t&&(i.url=t),i}function dP(n){return n&&n[zw]}let fP=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=ea({type:n,selectors:[["ng-component"]],standalone:!0,features:[PD],decls:1,vars:0,template:function(i,r){1&i&&Fs(0,"router-outlet")},dependencies:[Vw],encapsulation:2}),e})();function Hw(n){const e=n.children&&n.children.map(Hw),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==nt&&(t.component=fP),t}function us(n){return n.outlet||nt}function Yh(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class qX{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Uw(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=ml(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=ml(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=ml(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=ml(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new LX(s.value.snapshot))}),e.children.length&&this.forwardEvent(new RX(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(Uw(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Uw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Yh(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class pP{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Mm{constructor(e,t){this.component=e,this.route=t}}function YX(n,e,t){const i=n._root;return Zh(i,e?e._root:null,t,[i.value])}function _l(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function MU(n){return null!==df(n)}(n)?e.get(n):n:i}function Zh(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=ml(e);return n.children.forEach(o=>{(function KX(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function JX(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!va(n.url,e.url);case"pathParamsOrQueryParamsChange":return!va(n.url,e.url)||!cs(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Bw(n,e)||!cs(n.queryParams,e.queryParams);default:return!Bw(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new pP(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Zh(n,e,s.component?a?a.children:null:t,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Mm(a.outlet.component,o))}else o&&Kh(e,a,r),r.canActivateChecks.push(new pP(i)),Zh(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Kh(a,t.getContext(o),r)),r}function Kh(n,e,t){const i=ml(n),r=n.value;Object.entries(i).forEach(([s,o])=>{Kh(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new Mm(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Jh(n){return"function"==typeof n}function mP(n){return n instanceof hm||"EmptyError"===n?.name}const Sm=Symbol("INITIAL_VALUE");function vl(){return Ar(n=>xw(n.map(e=>e.pipe(ll(1),function G6(...n){const e=Pu(n);return En((t,i)=>{(e?bw(n,t,e):bw(n,t)).subscribe(i)})}(Sm)))).pipe(Rt(e=>{for(const t of e)if(!0!==t){if(t===Sm)return Sm;if(!1===t||t instanceof hl)return t}return!0}),To(e=>e!==Sm),ll(1)))}function gP(n){return function Sk(...n){return dS(n)}(Kn(e=>{if(ya(e))throw uP(0,e)}),Rt(e=>!0===e))}class Em{constructor(e){this.segmentGroup=e||null}}class Gw extends Error{constructor(e){super(),this.urlTree=e}}function yl(n){return dm(new Em(n))}class v9{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new he(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return We(i);if(r.numberOfChildren>1||!r.children[nt])return dm(new he(4e3,!1));r=r.children[nt]}}applyRedirectCommands(e,t,i){const r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t.startsWith("/"))throw new Gw(r);return r}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new hl(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,i,r)}),new Dt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new he(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const Ww={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function y9(n,e,t,i,r){const s=jw(n,e,t);return s.matched?(i=function HX(n,e){return n.providers&&!n._injector&&(n._injector=v0(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function m9(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?We(r.map(o=>{const a=_l(o,n);return Ao(function r9(n){return n&&Jh(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(vl(),gP()):We(!0)}(i,e,t).pipe(Rt(o=>!0===o?s:{...Ww}))):We(s)}function jw(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...Ww}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||K6)(t,n,e);if(!r)return{...Ww};const s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function _P(n,e,t,i){return t.length>0&&function b9(n,e,t){return t.some(i=>Cm(n,e,i)&&us(i)!==nt)}(n,t,i)?{segmentGroup:new Dt(e,x9(i,new Dt(t,n.children))),slicedSegments:[]}:0===t.length&&function M9(n,e,t){return t.some(i=>Cm(n,e,i))}(n,t,i)?{segmentGroup:new Dt(n.segments,w9(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Dt(n.segments,n.children),slicedSegments:t}}function w9(n,e,t,i,r){const s={};for(const o of i)if(Cm(n,t,o)&&!r[us(o)]){const a=new Dt([],{});s[us(o)]=a}return{...r,...s}}function x9(n,e){const t={};t[nt]=e;for(const i of n)if(""===i.path&&us(i)!==nt){const r=new Dt([],{});t[us(i)]=r}return t}function Cm(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class C9{}class A9{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new v9(this.urlSerializer,this.urlTree)}noMatchError(e){return new he(4002,!1)}recognize(){const e=_P(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,nt).pipe(_a(t=>{if(t instanceof Gw)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Em?this.noMatchError(t):t}),Rt(t=>{const i=new Fw([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},nt,this.rootComponentType,null,{}),r=new Ur(i,t),s=new aP("",r),o=function _X(n,e,t=null,i=null){return YR(qR(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,nt).pipe(_a(i=>{throw i instanceof Em?this.noMatchError(i):i}))}inheritParamsAndData(e){const t=e.value,i=oP(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0).pipe(Rt(s=>s instanceof Ur?[s]:[]))}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return On(r).pipe(Vh(s=>{const o=i.children[s],a=function $X(n,e){const t=n.filter(i=>us(i)===e);return t.push(...n.filter(i=>us(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function $6(n,e){return En(function j6(n,e,t,i,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Cn(o,u=>{const h=l++;c=a?n(c,u,h):(a=!0,u),i&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),fm(null),function X6(n,e){const t=arguments.length>=2;return i=>i.pipe(n?To((r,s)=>n(r,s,i)):ho,Sw(1),t?fm(e):OR(()=>new hm))}(),jn(s=>{if(null===s)return yl(i);const o=vP(s);return function D9(n){n.sort((e,t)=>e.value.outlet===nt?-1:t.value.outlet===nt?1:e.value.outlet.localeCompare(t.value.outlet))}(o),We(o)}))}processSegment(e,t,i,r,s,o){return On(t).pipe(Vh(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(_a(c=>{if(c instanceof Em)return We(null);throw c}))),ga(a=>!!a),_a(a=>{if(mP(a))return function E9(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?We(new C9):yl(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function S9(n,e,t,i){return!!(us(n)===i||i!==nt&&Cm(e,t,n))&&("**"===n.path||jw(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):yl(r):yl(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}="**"===r.path?yP(s):jw(t,r,s);if(!a)return yl(t);const h=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,l);return this.applyRedirects.lineralizeSegments(r,h).pipe(jn(d=>this.processSegment(e,i,t,d.concat(u),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){let o;return"**"===i.path?(o=We(yP(r)),t.children={}):o=y9(t,i,r,e),o.pipe(Ar(a=>a.matched?this.getChildConfig(e=i._injector??e,i,r).pipe(Ar(({routes:c})=>{const l=i._loadedInjector??e,{consumedSegments:u,remainingSegments:h,parameters:d}=a,f=new Fw(u,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function R9(n){return n.data||{}}(i),us(i),i.component??i._loadedComponent??null,i,function P9(n){return n.resolve||{}}(i)),{segmentGroup:p,slicedSegments:g}=_P(t,u,h,c);if(0===g.length&&p.hasChildren())return this.processChildren(l,c,p).pipe(Rt(m=>null===m?null:new Ur(f,m)));if(0===c.length&&0===g.length)return We(new Ur(f,[]));const _=us(i)===s;return this.processSegment(l,c,p,g,_?nt:s,!0).pipe(Rt(m=>new Ur(f,m instanceof Ur?[m]:[])))})):yl(t)))}getChildConfig(e,t,i){return t.children?We({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?We({routes:t._loadedRoutes,injector:t._loadedInjector}):function p9(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?We(!0):We(r.map(o=>{const a=_l(o,n);return Ao(function e9(n){return n&&Jh(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(vl(),gP())}(e,t,i).pipe(jn(r=>r?this.configLoader.loadChildren(e,t).pipe(Kn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function _9(n){return dm(hP(!1,3))}())):We({routes:[],injector:e})}}function I9(n){const e=n.value.routeConfig;return e&&""===e.path}function vP(n){const e=[],t=new Set;for(const i of n){if(!I9(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=vP(i.children);e.push(new Ur(i.value,r))}return e.filter(i=>!t.has(i))}function yP(n){return{matched:!0,parameters:n.length>0?kR(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function wP(n){return"string"==typeof n.title||null===n.title}function $w(n){return Ar(e=>{const t=n(e);return t?On(t).pipe(Rt(()=>e)):We(e)})}let xP=(()=>{var n;class e{buildTitle(i){let r,s=i.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(o=>o.outlet===nt);return r}getResolvedTitleForRoute(i){return i.data[zh]}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:function(){return xe(U9)},providedIn:"root"}),e})(),U9=(()=>{var n;class e extends xP{constructor(i){super(),this.title=i}updateTitle(i){const r=this.buildTitle(i);void 0!==r&&this.title.setTitle(r)}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(AR))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const wl=new Le("",{providedIn:"root",factory:()=>({})}),xl=new Le("ROUTES");let Xw=(()=>{var n;class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=xe(mI)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return We(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);const r=Ao(i.loadComponent()).pipe(Rt(bP),Kn(o=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=o}),Ew(()=>{this.componentLoaders.delete(i)})),s=new NR(r,()=>new Tr).pipe(Mw());return this.componentLoaders.set(i,s),s}loadChildren(i,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return We({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const o=function B9(n,e,t,i){return Ao(n.loadChildren()).pipe(Rt(bP),jn(r=>r instanceof ID||Array.isArray(r)?We(r):On(e.compileModuleAsync(r))),Rt(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(xl,[],{optional:!0,self:!0}).flat()),{routes:o.map(Hw),injector:s}}))}(r,this.compiler,i,this.onLoadEndListener).pipe(Ew(()=>{this.childrenLoaders.delete(r)})),a=new NR(o,()=>new Tr).pipe(Mw());return this.childrenLoaders.set(r,a),a}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();function bP(n){return function V9(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let qw=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:function(){return xe(z9)},providedIn:"root"}),e})(),z9=(()=>{var n;class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,r){return i}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const MP=new Le("");function H9(n){return n.get(At).runOutsideAngular(()=>{const e=n.get(Hi);if(!e.startViewTransition)return Promise.resolve();let t;const i=new Promise(r=>{t=r});return e.startViewTransition(()=>(t(),function G9(n){return new Promise(e=>{DT(e,{injector:n})})}(n))),i})}let Tm=(()=>{var n;class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Tr,this.transitionAbortSubject=new Tr,this.configLoader=xe(Xw),this.environmentInjector=xe(cr),this.urlSerializer=xe(dl),this.rootContexts=xe(Xh),this.location=xe(Oh),this.inputBindingEnabled=null!==xe(bm,{optional:!0}),this.titleStrategy=xe(xP),this.options=xe(wl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=xe(qw),this.createViewTransition=xe(MP,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>We(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new DX(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new AX(s))}complete(){this.transitions?.complete()}handleNavigationRequest(i){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...i,id:r})}setupNavigations(i,r,s){return this.transitions=new rr({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:$h,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(To(o=>0!==o.id),Rt(o=>({...o,extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ar(o=>{this.currentTransition=o;let a=!1,c=!1;return We(o).pipe(Kn(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ar(l=>{const u=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!u&&"reload"!==(l.extras.onSameUrlNavigation??i.onSameUrlNavigation)){const d="";return this.events.next(new pl(l.id,this.urlSerializer.serialize(l.rawUrl),d,0)),l.resolve(null),$r}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return We(l).pipe(Ar(d=>{const f=this.transitions?.getValue();return this.events.next(new wm(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),f!==this.transitions?.getValue()?$r:Promise.resolve(d)}),function L9(n,e,t,i,r,s){return jn(o=>function T9(n,e,t,i,r,s,o="emptyOnly"){return new A9(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(Rt(({state:a,tree:c})=>({...o,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),Kn(d=>{o.targetSnapshot=d.targetSnapshot,o.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects};const f=new tP(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:d,extractedUrl:f,source:p,restoredState:g,extras:_}=l,m=new wm(d,this.urlSerializer.serialize(f),p,g);this.events.next(m);const v=sP(0,this.rootComponentType).snapshot;return this.currentTransition=o={...l,targetSnapshot:v,urlAfterRedirects:f,extras:{..._,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=f,We(o)}{const d="";return this.events.next(new pl(l.id,this.urlSerializer.serialize(l.extractedUrl),d,1)),l.resolve(null),$r}}),Kn(l=>{const u=new SX(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),Rt(l=>(this.currentTransition=o={...l,guards:YX(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},o)),function o9(n,e){return jn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?We({...t,guardsResult:!0}):function a9(n,e,t,i){return On(n).pipe(jn(r=>function f9(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||0===s.length)return We(!0);const o=s.map(a=>{const c=Yh(e)??r,l=_l(a,c);return Ao(function i9(n){return n&&Jh(n.canDeactivate)}(l)?l.canDeactivate(n,e,t,i):c.runInContext(()=>l(n,e,t,i))).pipe(ga())});return We(o).pipe(vl())}(r.component,r.route,t,e,i)),ga(r=>!0!==r,!0))}(o,i,r,n).pipe(jn(a=>a&&function QX(n){return"boolean"==typeof n}(a)?function c9(n,e,t,i){return On(e).pipe(Vh(r=>bw(function u9(n,e){return null!==n&&e&&e(new IX(n)),We(!0)}(r.route.parent,i),function l9(n,e){return null!==n&&e&&e(new PX(n)),We(!0)}(r.route,i),function d9(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function ZX(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>LR(()=>We(o.guards.map(c=>{const l=Yh(o.node)??t,u=_l(c,l);return Ao(function n9(n){return n&&Jh(n.canActivateChild)}(u)?u.canActivateChild(i,n):l.runInContext(()=>u(i,n))).pipe(ga())})).pipe(vl())));return We(s).pipe(vl())}(n,r.path,t),function h9(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return We(!0);const r=i.map(s=>LR(()=>{const o=Yh(e)??t,a=_l(s,o);return Ao(function t9(n){return n&&Jh(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(ga())}));return We(r).pipe(vl())}(n,r.route,t))),ga(r=>!0!==r,!0))}(i,s,n,e):We(a)),Rt(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),Kn(l=>{if(o.guardsResult=l.guardsResult,ya(l.guardsResult))throw uP(0,l.guardsResult);const u=new EX(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),To(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),$w(l=>{if(l.guards.canActivateChecks.length)return We(l).pipe(Kn(u=>{const h=new CX(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}),Ar(u=>{let h=!1;return We(u).pipe(function N9(n,e){return jn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return We(t);let s=0;return On(r).pipe(Vh(o=>function O9(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!wP(r)&&(s[zh]=r.title),function F9(n,e,t,i){const r=Cw(n);if(0===r.length)return We({});const s={};return On(r).pipe(jn(o=>function k9(n,e,t,i){const r=Yh(e)??i,s=_l(n,r);return Ao(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(ga(),Kn(a=>{s[o]=a}))),Sw(1),function q6(n){return Rt(()=>n)}(s),_a(o=>mP(o)?$r:dm(o)))}(s,n,e,i).pipe(Rt(o=>(n._resolvedData=o,n.data=oP(n,t).resolve,r&&wP(r)&&(n.data[zh]=r.title),null)))}(o.route,i,n,e)),Kn(()=>s++),Sw(1),jn(o=>s===r.length?We(t):$r))})}(this.paramsInheritanceStrategy,this.environmentInjector),Kn({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(u,"",2)}}))}),Kn(u=>{const h=new TX(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}))}),$w(l=>{const u=h=>{const d=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(h.routeConfig).pipe(Kn(f=>{h.component=f}),Rt(()=>{})));for(const f of h.children)d.push(...u(f));return d};return xw(u(l.targetSnapshot.root)).pipe(fm(),ll(1))}),$w(()=>this.afterPreactivation()),Ar(()=>{const l=this.createViewTransition?.(this.environmentInjector);return l?On(l).pipe(Rt(()=>o)):We(o)}),Rt(l=>{const u=function UX(n,e,t){const i=qh(n,e._root,t?t._root:void 0);return new rP(i,e)}(i.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o={...l,targetRouterState:u},this.currentNavigation.targetRouterState=u,o}),Kn(()=>{this.events.next(new Pw)}),((n,e,t,i)=>Rt(r=>(new qX(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,i.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),ll(1),Kn({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Hs(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),function Y6(n){return En((e,t)=>{ir(n).subscribe(Cn(t,()=>t.complete(),C_)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe(Kn(l=>{throw l}))),Ew(()=>{a||c||this.cancelNavigationTransition(o,"",1),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),_a(l=>{if(c=!0,dP(l))this.events.next(new fl(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),function zX(n){return dP(n)&&ya(n.url)}(l)?this.events.next(new Lw(l.url)):o.resolve(!1);else{this.events.next(new xm(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(i.errorHandler(l))}catch(u){o.reject(u)}}return $r}))}))}cancelNavigationTransition(i,r,s){const o=new fl(i.id,this.urlSerializer.serialize(i.extractedUrl),r,s);this.events.next(o),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();function W9(n){return n!==$h}let j9=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:function(){return xe(X9)},providedIn:"root"}),e})();class $9{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let X9=(()=>{var n;class e extends $9{}return(n=e).\u0275fac=function(){let t;return function(r){return(t||(t=function eC(n){return Ts(()=>{const e=n.prototype.constructor,t=e[As]||Ev(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[As]||Ev(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}(n)))(r||n)}}(),n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),q9=(()=>{var n;class e{constructor(){this.location=xe(Oh),this.urlSerializer=xe(dl),this.options=xe(wl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=xe(qw),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new hl,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=sP(0,null),this.stateMemento=this.createStateMemento()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}handleNavigationEvent(i,r){if(i instanceof wm)this.stateMemento=this.createStateMemento();else if(i instanceof pl)this.rawUrlTree=r.initialUrl;else if(i instanceof tP){if("eager"===this.urlUpdateStrategy&&!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(s,r)}}else i instanceof Pw?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):i instanceof fl&&(3===i.code||2===i.code)?this.restoreHistory(r):i instanceof xm?this.restoreHistory(r,!0):i instanceof Hs&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,r){const s=this.urlSerializer.serialize(i);if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){const a={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(s,"",a)}else{const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(s,"",o)}}restoreHistory(i,r=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.currentUrlTree===i.finalUrl&&0===o&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,r){return"computed"===this.canceledNavigationResolution?{navigationId:i,\u0275routerPageId:r}:{navigationId:i}}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var Qh=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Qh||{});function SP(n,e){n.events.pipe(To(t=>t instanceof Hs||t instanceof fl||t instanceof xm||t instanceof pl),Rt(t=>t instanceof Hs||t instanceof pl?Qh.COMPLETE:t instanceof fl&&(0===t.code||1===t.code)?Qh.REDIRECTING:Qh.FAILED),To(t=>t!==Qh.REDIRECTING),ll(1)).subscribe(()=>{e()})}function Y9(n){throw n}const Z9={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},K9={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let pr=(()=>{var n;class e{get currentUrlTree(){return this.stateManager.currentUrlTree}get rawUrlTree(){return this.stateManager.rawUrlTree}get events(){return this._events}get routerState(){return this.stateManager.routerState}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=xe(fI),this.stateManager=xe(q9),this.options=xe(wl,{optional:!0})||{},this.pendingTasks=xe(pI),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=xe(Tm),this.urlSerializer=xe(dl),this.location=xe(Oh),this.urlHandlingStrategy=xe(qw),this._events=new Tr,this.errorHandler=this.options.errorHandler||Y9,this.navigated=!1,this.routeReuseStrategy=xe(j9),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=xe(xl,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!xe(bm,{optional:!0}),this.eventsSubscription=new Fi,this.isNgZoneEnabled=xe(At)instanceof At&&At.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const i=this.navigationTransitions.events.subscribe(r=>{try{const s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(null!==s&&null!==o)if(this.stateManager.handleNavigationEvent(r,o),r instanceof fl&&0!==r.code&&1!==r.code)this.navigated=!0;else if(r instanceof Hs)this.navigated=!0;else if(r instanceof Lw){const a=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),c={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||W9(s.source)};this.scheduleNavigation(a,$h,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}(function Q9(n){return!(n instanceof Pw||n instanceof Lw)})(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const i=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),$h,i)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(i=>{const r="popstate"===i.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(i.url,r,i.state)},0)}))}navigateToSyncWithBrowser(i,r,s){const o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){const l={...s};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const c=this.parseUrl(i);this.scheduleNavigation(c,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(Hw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,r={}){const{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=r,u=l?this.currentUrlTree.fragment:a;let d,h=null;switch(c){case"merge":h={...this.currentUrlTree.queryParams,...o};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}null!==h&&(h=this.removeEmptyProps(h));try{d=qR(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof i[0]||!i[0].startsWith("/"))&&(i=[]),d=this.currentUrlTree.root}return YR(d,i,h,u??null)}navigateByUrl(i,r={skipLocationChange:!1}){const s=ya(i)?i:this.parseUrl(i),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,$h,null,r)}navigate(i,r={skipLocationChange:!1}){return function J9(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new he(4008,!1)}(i),this.navigateByUrl(this.createUrlTree(i,r),r)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,r){let s;if(s=!0===r?{...Z9}:!1===r?{...K9}:r,ya(i))return BR(this.currentUrlTree,i,s);const o=this.parseUrl(i);return BR(this.currentUrlTree,o,s)}removeEmptyProps(i){return Object.keys(i).reduce((r,s)=>{const o=i[s];return null!=o&&(r[s]=o),r},{})}scheduleNavigation(i,r,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((d,f)=>{c=d,l=f});const h=this.pendingTasks.add();return SP(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:o,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(d=>Promise.reject(d))}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();class EP{}let nq=(()=>{var n;class e{constructor(i,r,s,o,a){this.router=i,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(To(i=>i instanceof Hs),Vh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,r){const s=[];for(const o of r){o.providers&&!o._injector&&(o._injector=v0(o.providers,i,`Route: ${o.path}`));const a=o._injector??i,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return On(s).pipe(lc())}preloadConfig(i,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(i,r):We(null);const o=s.pipe(jn(a=>null===a?We(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,this.processRoutes(a.injector??i,a.routes))));return r.loadComponent&&!r._loadedComponent?On([o,this.loader.loadComponent(r)]).pipe(lc()):o})}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(pr),Se(mI),Se(cr),Se(EP),Se(Xw))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const Zw=new Le("");let CP=(()=>{var n;class e{constructor(i,r,s,o,a={}){this.urlSerializer=i,this.transitions=r,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof wm?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof Hs?(this.lastId=i.id,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.urlAfterRedirects).fragment)):i instanceof pl&&0===i.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof nP&&(i.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(i.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new nP(i,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(n=e).\u0275fac=function(i){!function HT(){throw new Error("invalid")}()},n.\u0275prov=De({token:n,factory:n.\u0275fac}),e})();function hs(n,e){return{\u0275kind:n,\u0275providers:e}}function AP(){const n=xe(lr);return e=>{const t=n.get(ol);if(e!==t.components[0])return;const i=n.get(pr),r=n.get(DP);1===n.get(Kw)&&i.initialNavigation(),n.get(IP,null,lt.Optional)?.setUpPreloading(),n.get(Zw,null,lt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const DP=new Le("",{factory:()=>new Tr}),Kw=new Le("",{providedIn:"root",factory:()=>1}),IP=new Le("");function oq(n){return hs(0,[{provide:IP,useExisting:nq},{provide:EP,useExisting:n}])}const RP=new Le("ROUTER_FORROOT_GUARD"),lq=[Oh,{provide:dl,useClass:Tw},pr,Xh,{provide:gl,useFactory:function TP(n){return n.routerState.root},deps:[pr]},Xw,[]];function uq(){return new bI("Router",pr)}let PP=(()=>{var n;class e{constructor(i){}static forRoot(i,r){return{ngModule:e,providers:[lq,[],{provide:xl,multi:!0,useValue:i},{provide:RP,useFactory:pq,deps:[[pr,new Vf,new zf]]},{provide:wl,useValue:r||{}},r?.useHash?{provide:ma,useClass:c$}:{provide:ma,useClass:$I},{provide:Zw,useFactory:()=>{const n=xe(D8),e=xe(At),t=xe(wl),i=xe(Tm),r=xe(dl);return t.scrollOffset&&n.setOffset(t.scrollOffset),new CP(r,i,n,e,t)}},r?.preloadingStrategy?oq(r.preloadingStrategy).\u0275providers:[],{provide:bI,multi:!0,useFactory:uq},r?.initialNavigation?mq(r):[],r?.bindToComponentInputs?hs(8,[lP,{provide:bm,useExisting:lP}]).\u0275providers:[],r?.enableViewTransitions?hs(9,[{provide:MP,useValue:H9}]).\u0275providers:[],[{provide:LP,useFactory:AP},{provide:V0,multi:!0,useExisting:LP}]]}}static forChild(i){return{ngModule:e,providers:[{provide:xl,multi:!0,useValue:i}]}}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(RP,8))},n.\u0275mod=Ds({type:n}),n.\u0275inj=Xr({}),e})();function pq(n){return"guarded"}function mq(n){return["disabled"===n.initialNavigation?hs(3,[{provide:P0,multi:!0,useFactory:()=>{const e=xe(pr);return()=>{e.setUpLocationChangeListener()}}},{provide:Kw,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?hs(2,[{provide:Kw,useValue:0},{provide:P0,multi:!0,deps:[lr],useFactory:e=>{const t=e.get(o$,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(pr),s=e.get(DP);SP(r,()=>{i(!0)}),e.get(Tm).afterPreactivation=()=>(i(!0),s.closed?We(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const LP=new Le("");let _q=(()=>{var n;class e{constructor(){this.artworks=Cf([{id:0,title:"Self Portrait",audio:"assets/audio/1.mp3",date:"1887",description:"This self-portrait was one of about 32 produced over a 10-year period, and these were an important part of his work as a painter; he painted himself because he often lacked the money to pay for models. Art historians are divided as to whether this painting is Van Gogh's final self-portrait or not. It is considered that it was painted in Arles following Van Gogh's admission to hospital after mutilating his ear. Van Gogh sent the picture to his younger brother, the art dealer Theo; an accompanying letter read: 'I hope you will notice that my facial expressions have become much calmer, although my eyes have the same insecure look as before, or so it appears to me.'",height:65,textureUrl:"assets/artworks/Vincent_van_Gogh_-_Self-Portrait_-_Google_Art_Project.jpg",votes:0,width:54,wiki:"https://wikipedia.org/wiki/Van_Gogh_self-portrait_(1889)"},{id:1,title:"Almond Blossom",audio:"assets/audio/2.mp3",date:"1890",description:"In mid-March 1888 van Gogh writes that the almond trees are coming into full flower, weather there is changeable, often windy with turbulent skies. Later on Theo wrote to his brother Vincent on January 31, 1890, to announce the birth of his son, Vincent Willem van Gogh. He was very close to his brother and he sought to symbolize new life in the flowers of the almond tree for the birth of baby Vincent.",height:73.5,textureUrl:"assets/artworks/almond_blossom.jpg",votes:0,width:92,wiki:"https://en.wikipedia.org/wiki/Almond_Blossoms"},{id:2,title:"The Bedroom",audio:"assets/audio/3.mp3",date:"1887",description:"The painting depicts van Gogh's bedroom at 2, Place Lamartine in Arles, Bouches-du-Rhone, France, known as the Yellow House. The door to the right opened on to the upper floor and the staircase; the door to the left was that of the guest room he held prepared for Gauguin; the window in the front wall looked on to Place Lamartine and its public gardens. This room was not rectangular but trapezoid with an obtuse angle in the left hand corner of the front wall and an acute angle at the right.",height:72.4,textureUrl:"assets/artworks/bedroom.jpg",votes:0,width:91.3,wiki:"https://wikipedia.org/wiki/Bedroom_in_Arles"},{id:3,title:"Sunflowers",audio:"assets/audio/1.mp3",date:"1887",description:"This is one of five versions of Sunflowers on display in museums and galleries across the world. Van Gogh made the paintings to decorate his house in Arles in readiness for a visit from his friend and fellow artist, Paul Gauguin.'The sunflower is mine', Van Gogh once declared, and it is clear that the flower had various meanings for him. The different stages in the sunflower's life cycle shown here, from young bud through to maturity and eventual decay, follow in the vanitas tradition of Dutch seventeenth-century flower paintings, which emphasise the transient nature of human actions. The sunflowers were perhaps also intended to be a symbol of friendship and a celebration of the beauty and vitality of nature.",height:95,textureUrl:"assets/artworks/sunflowers.jpg",votes:0,width:73,download:"https://commons.wikimedia.org/wiki/File:Vincent_Willem_van_Gogh_127.jpg",wiki:"https://wikipedia.org/wiki/Sunflowers_(Van_Gogh_series)"},{id:4,title:"Irises",audio:"assets/audio/1.mp3",date:"1889",description:"Van Gogh painted this still life in the psychiatric hospital in Saint-Remy. For him, the painting was mainly a study in color. He set out to achieve a powerful color contrast. By placing the purple flowers against a yellow background, he made the decorative forms stand out even more strongly. The irises were originally purple. But as the red pigment has faded, they have turned blue. Van Gogh made two paintings of this bouquet. In the other still life, he contrasted purple and pink with green.",height:93,textureUrl:"assets/artworks/irises.jpg",votes:0,width:74,wiki:"https://en.wikipedia.org/wiki/Vase_with_Irises_Against_a_Yellow_Background"}]),this.upvoted=[],this.artworksLength=this.artworks.length}getArtworks(){return this.artworks()}upvoteArtwork(i){return-1===this.upvoted.indexOf(i)&&(this.upvoted.push(i),this.artworks.mutate(r=>{r[i].votes+=1}),console.log("Mutated",i,this.artworks()[i].votes)),console.log("Upvoted already!"),this.artworks()[i].votes}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();function Gs(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function NP(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}var Jw,Jn,tn,Zt,gr,rx,sx,VP,GP,Tl,ad,c,l,u,h,d,f,n,e,t,i,r,s,o,a,p,Wi={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},bl={duration:.5,overwrite:!1,delay:0},mr=1e8,Lt=1e-8,Qw=2*Math.PI,vq=Qw/4,yq=0,OP=Math.sqrt,wq=Math.cos,xq=Math.sin,Fn=function(e){return"string"==typeof e},nn=function(e){return"function"==typeof e},Ws=function(e){return"number"==typeof e},ex=function(e){return typeof e>"u"},ds=function(e){return"object"==typeof e},Ti=function(e){return!1!==e},tx=function(){return typeof window<"u"},Am=function(e){return nn(e)||Fn(e)},FP="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Qn=Array.isArray,nx=/(?:-?\.?\d|\.)+/gi,kP=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Ml=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ix=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,UP=/[+-]=-?[.\d]+/,BP=/[^,'"\[\]\s]+/gi,bq=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ji={},Dm={},zP=function(e){return(Dm=xa(e,ji))&&Ri},ox=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Im=function(e,t){return!t&&console.warn(e)},HP=function(e,t){return e&&(ji[e]=t)&&Dm&&(Dm[e]=t)||ji},ed=function(){return 0},Mq={suppressEvents:!0,isStart:!0,kill:!1},Rm={suppressEvents:!0,kill:!1},Sq={suppressEvents:!0},ax={},Do=[],cx={},$i={},lx={},WP=30,Pm=[],ux="",hx=function(e){var i,r,t=e[0];if(ds(t)||nn(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(r=Pm.length;r--&&!Pm[r].targetTest(t););i=Pm[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new yL(e[r],i)))||e.splice(r,1);return e},wa=function(e){return e._gsap||hx(yr(e))[0]._gsap},jP=function(e,t,i){return(i=e[t])&&nn(i)?e[t]():ex(i)&&e.getAttribute&&e.getAttribute(t)||i},Ai=function(e,t){return(e=e.split(",")).forEach(t)||e},hn=function(e){return Math.round(1e5*e)/1e5||0},zn=function(e){return Math.round(1e7*e)/1e7||0},Sl=function(e,t){var i=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),"+"===i?e+r:"-"===i?e-r:"*"===i?e*r:e/r},Eq=function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i},Lm=function(){var i,r,e=Do.length,t=Do.slice(0);for(cx={},Do.length=0,i=0;i<e;i++)(r=t[i])&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},$P=function(e,t,i,r){Do.length&&!Jn&&Lm(),e.render(t,i,r||Jn&&t<0&&(e._initted||e._startAt)),Do.length&&!Jn&&Lm()},XP=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(BP).length<2?t:Fn(e)?e.trim():e},qP=function(e){return e},_r=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},xa=function(e,t){for(var i in t)e[i]=t[i];return e},YP=function n(e,t){for(var i in t)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=ds(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},Nm=function(e,t){var r,i={};for(r in e)r in t||(i[r]=e[r]);return i},td=function(e){var t=e.parent||Zt,i=e.keyframes?function(e){return function(t,i){for(var r in i)r in t||"duration"===r&&e||"ease"===r||(t[r]=i[r])}}(Qn(e.keyframes)):_r;if(Ti(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},ZP=function(e,t,i,r,s){void 0===i&&(i="_first"),void 0===r&&(r="_last");var a,o=e[r];if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},Om=function(e,t,i,r){void 0===i&&(i="_first"),void 0===r&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[i]===t&&(e[i]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},Io=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},ba=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},dx=function(e,t,i,r){return e._startAt&&(Jn?e._startAt.revert(Rm):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},Dq=function n(e){return!e||e._ts&&n(e.parent)},KP=function(e){return e._repeat?El(e._tTime,e=e.duration()+e._rDelay)*e:0},El=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},Fm=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},km=function(e){return e._end=zn(e._start+(e._tDur/Math.abs(e._ts||e._rts||Lt)||0))},Um=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=zn(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),km(e),i._dirty||ba(i,e)),e},JP=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=Fm(e.rawTime(),t),(!t._dur||id(0,t.totalDuration(),i)-t._tTime>Lt)&&t.render(i,!0)),ba(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-Lt}},fs=function(e,t,i,r){return t.parent&&Io(t),t._start=zn((Ws(i)?i:i||e!==Zt?vr(e,i,t):e._time)+t._delay),t._end=zn(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),ZP(e,t,"_first","_last",e._sort?"_start":0),fx(t)||(e._recent=t),r||JP(e,t),e._ts<0&&Um(e,e._tTime),e},QP=function(e,t){return(ji.ScrollTrigger||ox("scrollTrigger",t))&&ji.ScrollTrigger.create(t,e)},eL=function(e,t,i,r,s){return bx(e,t,s),e._initted?!i&&e._pt&&!Jn&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&GP!==Xi.frame?(Do.push(e),e._lazy=[s,r],1):void 0:1},Iq=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},fx=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},Cl=function(e,t,i,r){var s=e._repeat,o=zn(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:zn(o*(s+1)+e._rDelay*s):o,a>0&&!r&&Um(e,e._tTime=e._tDur*a),e.parent&&km(e),i||ba(e.parent,e),e},tL=function(e){return e instanceof Di?ba(e):Cl(e,e._dur)},Lq={_start:0,endTime:ed,totalDuration:ed},vr=function n(e,t,i){var a,c,l,r=e.labels,s=e._recent||Lq,o=e.duration()>=mr?s.endTime(!1):e._dur;return Fn(t)&&(isNaN(t)||t in r)?(c=t.charAt(0),l="%"===t.substr(-1),a=t.indexOf("="),"<"===c||">"===c?(a>=0&&(t=t.replace(/=/,"")),("<"===c?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(l?(a<0?s:i).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(c=parseFloat(t.charAt(a-1)+t.substr(a+1)),l&&i&&(c=c/100*(Qn(i)?i[0]:i).totalDuration()),a>1?n(e,t.substr(0,a-1),i)+c:o+c)):null==t?o:+t},nd=function(e,t,i){var a,c,r=Ws(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s];if(r&&(o.duration=t[1]),o.parent=i,e){for(a=o,c=i;c&&!("immediateRender"in a);)a=c.vars.defaults||{},c=Ti(c.vars.inherit)&&c.parent;o.immediateRender=Ti(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new yn(t[0],o,t[s+1])},Ro=function(e,t){return e||0===e?t(e):t},id=function(e,t,i){return i<e?e:i>t?t:i},ei=function(e,t){return Fn(e)&&(t=bq.exec(e))?t[1]:""},px=[].slice,nL=function(e,t){return e&&ds(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&ds(e[0]))&&!e.nodeType&&e!==gr},yr=function(e,t,i){return tn&&!t&&tn.selector?tn.selector(e):!Fn(e)||i||!rx&&Al()?Qn(e)?function(e,t,i){return void 0===i&&(i=[]),e.forEach(function(r){var s;return Fn(r)&&!t||nL(r,1)?(s=i).push.apply(s,yr(r)):i.push(r)})||i}(e,i):nL(e)?px.call(e,0):e?[e]:[]:px.call((t||sx).querySelectorAll(e),0)},mx=function(e){return e=yr(e)[0]||Im("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return yr(t,i.querySelectorAll?i:i===e?Im("Invalid scope")||sx.createElement("div"):e)}},iL=function(e){return e.sort(function(){return.5-Math.random()})},rL=function(e){if(nn(e))return e;var t=ds(e)?e:{each:e},i=Ma(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},a=r>0&&r<1,c=isNaN(r)||a,l=t.axis,u=r,h=r;return Fn(r)?u=h={center:.5,edges:.5,end:1}[r]||0:!a&&c&&(u=r[0],h=r[1]),function(d,f,p){var m,v,y,w,x,S,M,E,b,g=(p||t).length,_=o[g];if(!_){if(!(b="auto"===t.grid?0:(t.grid||[1,mr])[1])){for(M=-mr;M<(M=p[b++].getBoundingClientRect().left)&&b<g;);b--}for(_=o[g]=[],m=c?Math.min(b,g)*u-.5:r%b,v=b===mr?0:c?g*h/b-.5:r/b|0,M=0,E=mr,S=0;S<g;S++)y=S%b-m,w=v-(S/b|0),_[S]=x=l?Math.abs("y"===l?w:y):OP(y*y+w*w),x>M&&(M=x),x<E&&(E=x);"random"===r&&iL(_),_.max=M-E,_.min=E,_.v=g=(parseFloat(t.amount)||parseFloat(t.each)*(b>g?g-1:l?"y"===l?g/b:b:Math.max(b,g/b))||0)*("edges"===r?-1:1),_.b=g<0?s-g:s,_.u=ei(t.amount||t.each)||0,i=i&&g<0?gL(i):i}return g=(_[d]-_.min)/_.max||0,zn(_.b+(i?i(g):g)*_.v)+_.u}},gx=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var r=zn(Math.round(parseFloat(i)/e)*e*t);return(r-r%1)/t+(Ws(i)?0:ei(i))}},sL=function(e,t){var r,s,i=Qn(e);return!i&&ds(e)&&(r=i=e.radius||mr,e.values?(e=yr(e.values),(s=!Ws(e[0]))&&(r*=r)):e=gx(e.increment)),Ro(t,i?nn(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var d,f,a=parseFloat(s?o.x:o),c=parseFloat(s?o.y:0),l=mr,u=0,h=e.length;h--;)(d=s?(d=e[h].x-a)*d+(f=e[h].y-c)*f:Math.abs(e[h]-a))<l&&(l=d,u=h);return u=!r||l<=r?e[u]:o,s||u===o||Ws(o)?u:u+ei(o)}:gx(e))},oL=function(e,t,i,r){return Ro(Qn(e)?!t:!0===i?!!(i=0):!r,function(){return Qn(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+.99*i))/i)*i*r)/r})},aL=function(e,t,i){return Ro(i,function(r){return e[~~t(r)]})},rd=function(e){for(var r,s,o,a,t=0,i="";~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),a="["===e.charAt(r+7),s=e.substr(r+7,o-r-7).match(a?BP:nx),i+=e.substr(t,r-t)+oL(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return i+e.substr(t,e.length-t)},cL=function(e,t,i,r,s){var o=t-e,a=r-i;return Ro(s,function(c){return i+((c-e)/o*a||0)})},lL=function(e,t,i){var o,a,c,r=e.labels,s=mr;for(o in r)(a=r[o]-t)<0==!!i&&a&&s>(a=Math.abs(a))&&(c=o,s=a);return c},wr=function(e,t,i){var c,l,u,r=e.vars,s=r[t],o=tn,a=e._ctx;if(s)return c=r[t+"Params"],l=r.callbackScope||e,i&&Do.length&&Lm(),a&&(tn=a),u=c?s.apply(l,c):s.call(l),tn=o,u},sd=function(e){return Io(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Jn),e.progress()<1&&wr(e,"onInterrupt"),e},uL=[],hL=function(e){if(tx()&&e){var t=(e=!e.name&&e.default||e).name,i=nn(e),r=t&&!i&&e.init?function(){this._props=[]}:e,s={init:ed,render:Ex,add:wx,kill:i7,modifier:n7,rawVars:0},o={targetTest:0,get:0,getSetter:Sx,aliases:{},register:0};if(Al(),e!==r){if($i[t])return;_r(r,_r(Nm(e,s),o)),xa(r.prototype,xa(s,Nm(e,o))),$i[r.prop=t]=r,e.targetTest&&(Pm.push(r),ax[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}HP(t,r),e.register&&e.register(Ri,r,Ii)}else e&&uL.push(e)},Nt=255,od={aqua:[0,Nt,Nt],lime:[0,Nt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Nt],navy:[0,0,128],white:[Nt,Nt,Nt],olive:[128,128,0],yellow:[Nt,Nt,0],orange:[Nt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Nt,0,0],pink:[Nt,192,203],cyan:[0,Nt,Nt],transparent:[Nt,Nt,Nt,0]},_x=function(e,t,i){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(i-t)*e*6:e<.5?i:3*e<2?t+(i-t)*(2/3-e)*6:t)*Nt+.5|0},dL=function(e,t,i){var s,o,a,c,l,u,h,d,f,p,r=e?Ws(e)?[e>>16,e>>8&Nt,e&Nt]:0:od.black;if(!r){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),od[e])r=od[e];else if("#"===e.charAt(0)){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(r=parseInt(e.substr(1,6),16))>>16,r>>8&Nt,r&Nt,parseInt(e.substr(7),16)/255];r=[(e=parseInt(e.substr(1),16))>>16,e>>8&Nt,e&Nt]}else if("hsl"===e.substr(0,3))if(r=p=e.match(nx),t){if(~e.indexOf("="))return r=e.match(kP),i&&r.length<4&&(r[3]=1),r}else c=+r[0]%360/360,l=+r[1]/100,s=2*(u=+r[2]/100)-(o=u<=.5?u*(l+1):u+l-u*l),r.length>3&&(r[3]*=1),r[0]=_x(c+1/3,s,o),r[1]=_x(c,s,o),r[2]=_x(c-1/3,s,o);else r=e.match(nx)||od.transparent;r=r.map(Number)}return t&&!p&&(s=r[0]/Nt,o=r[1]/Nt,a=r[2]/Nt,u=((h=Math.max(s,o,a))+(d=Math.min(s,o,a)))/2,h===d?c=l=0:(f=h-d,l=u>.5?f/(2-h-d):f/(h+d),c=h===s?(o-a)/f+(o<a?6:0):h===o?(a-s)/f+2:(s-o)/f+4,c*=60),r[0]=~~(c+.5),r[1]=~~(100*l+.5),r[2]=~~(100*u+.5)),i&&r.length<4&&(r[3]=1),r},fL=function(e){var t=[],i=[],r=-1;return e.split(Po).forEach(function(s){var o=s.match(Ml)||[];t.push.apply(t,o),i.push(r+=o.length+1)}),t.c=i,t},pL=function(e,t,i){var c,l,u,h,r="",s=(e+r).match(Po),o=t?"hsla(":"rgba(",a=0;if(!s)return e;if(s=s.map(function(d){return(d=dL(d,t,1))&&o+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(u=fL(e),(c=i.c).join(r)!==u.c.join(r)))for(h=(l=e.replace(Po,"1").split(Ml)).length-1;a<h;a++)r+=l[a]+(~c.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:i).shift());if(!l)for(h=(l=e.split(Po)).length-1;a<h;a++)r+=l[a]+s[a];return r+l[h]},Po=function(){var e,n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in od)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),Hq=/hsl[a]?\(/,mL=function(e){var i,t=e.join(" ");if(Po.lastIndex=0,Po.test(t))return i=Hq.test(t),e[1]=pL(e[1],i),e[0]=pL(e[0],i,fL(e[1])),!0},Xi=(n=Date.now,e=500,t=33,i=n(),r=i,o=s=1e3/240,p=function g(_){var y,w,x,S,m=n()-r,v=!0===_;if(m>e&&(i+=m-t),((y=(x=(r+=m)-i)-o)>0||v)&&(S=++h.frame,d=x-1e3*h.time,h.time=x/=1e3,o+=y+(y>=s?4:s-y),w=1),v||(c=l(g)),w)for(f=0;f<a.length;f++)a[f](x,d,S,_)},h={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(_){return d/(1e3/(_||60))},wake:function(){VP&&(!rx&&tx()&&(gr=rx=window,sx=gr.document||{},ji.gsap=Ri,(gr.gsapVersions||(gr.gsapVersions=[])).push(Ri.version),zP(Dm||gr.GreenSockGlobals||!gr.gsap&&gr||{}),u=gr.requestAnimationFrame,uL.forEach(hL)),c&&h.sleep(),l=u||function(_){return setTimeout(_,o-1e3*h.time+1|0)},ad=1,p(2))},sleep:function(){(u?gr.cancelAnimationFrame:clearTimeout)(c),ad=0,l=ed},lagSmoothing:function(_,m){e=_||1/0,t=Math.min(m||33,e)},fps:function(_){o=1e3*h.time+(s=1e3/(_||240))},add:function(_,m,v){var y=m?function(w,x,S,M){_(w,x,S,M),h.remove(y)}:_;return h.remove(_),a[v?"unshift":"push"](y),Al(),y},remove:function(_,m){~(m=a.indexOf(_))&&a.splice(m,1)&&f>=m&&f--},_listeners:a=[]}),Al=function(){return!ad&&Xi.wake()},_t={},Gq=/^[\d.\-M][\d.\-,\s]/,Wq=/["']/g,jq=function(e){for(var a,c,l,t={},i=e.substr(1,e.length-3).split(":"),r=i[0],s=1,o=i.length;s<o;s++)c=i[s],a=s!==o-1?c.lastIndexOf(","):c.length,l=c.substr(0,a),t[r]=isNaN(l)?l.replace(Wq,"").trim():+l,r=c.substr(a+1).trim();return t},gL=function(e){return function(t){return 1-e(1-t)}},_L=function n(e,t){for(var r,i=e._first;i;)i instanceof Di?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},Ma=function(e,t){return e&&(nn(e)?e:_t[e]||function(e){var t=(e+"").split("("),i=_t[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[jq(t[1])]:function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<i?e.indexOf(")",i+1):i)}(e).split(",").map(XP)):_t._CE&&Gq.test(e)?_t._CE("",e):i}(e))||t},Sa=function(e,t,i,r){void 0===i&&(i=function(c){return 1-t(1-c)}),void 0===r&&(r=function(c){return c<.5?t(2*c)/2:1-t(2*(1-c))/2});var o,s={easeIn:t,easeOut:i,easeInOut:r};return Ai(e,function(a){for(var c in _t[a]=ji[a]=s,_t[o=a.toLowerCase()]=i,s)_t[o+("easeIn"===c?".in":"easeOut"===c?".out":".inOut")]=_t[a+"."+c]=s[c]}),s},vL=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},vx=function n(e,t,i){var r=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),o=s/Qw*(Math.asin(1/r)||0),a=function(u){return 1===u?1:r*Math.pow(2,-10*u)*xq((u-o)*s)+1},c="out"===e?a:"in"===e?function(l){return 1-a(1-l)}:vL(a);return s=Qw/s,c.config=function(l,u){return n(e,l,u)},c},yx=function n(e,t){void 0===t&&(t=1.70158);var i=function(o){return o?--o*o*((t+1)*o+t)+1:0},r="out"===e?i:"in"===e?function(s){return 1-i(1-s)}:vL(i);return r.config=function(s){return n(e,s)},r};Ai("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;Sa(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(2*i,t)/2:1-Math.pow(2*(1-i),t)/2})}),_t.Linear.easeNone=_t.none=_t.Linear.easeIn,Sa("Elastic",vx("in"),vx("out"),vx()),function(n,e){var s=function(a){return a<.36363636363636365?n*a*a:a<.7272727272727273?n*Math.pow(a-1.5/e,2)+.75:a<.9090909090909092?n*(a-=2.25/e)*a+.9375:n*Math.pow(a-2.625/e,2)+.984375};Sa("Bounce",function(o){return 1-s(1-o)},s)}(7.5625,2.75),Sa("Expo",function(n){return n?Math.pow(2,10*(n-1)):0}),Sa("Circ",function(n){return-(OP(1-n*n)-1)}),Sa("Sine",function(n){return 1===n?1:1-wq(n*vq)}),Sa("Back",yx("in"),yx("out"),yx()),_t.SteppedEase=_t.steps=ji.SteppedEase={config:function(e,t){void 0===e&&(e=1);var i=1/e,r=e+(t?0:1),s=t?1:0;return function(a){return((r*id(0,.99999999,a)|0)+s)*i}}},bl.ease=_t["quad.out"],Ai("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return ux+=n+","+n+"Params,"});var yL=function(e,t){this.id=yq++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:jP,this.set=t?t.getSetter:Sx},cd=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Cl(this,+t.duration,1,1),this.data=t.data,tn&&(this._ctx=tn,tn.data.push(this)),ad||Xi.wake()}var e=n.prototype;return e.delay=function(i){return i||0===i?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,Cl(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,r){if(Al(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(Um(this,i),!s._dp||s.parent||JP(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&fs(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Lt||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),$P(this,i,r)),this},e.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+KP(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},e.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?i:1-i)+KP(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(i,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,r):this._repeat?El(this._tTime,s)+1:1},e.timeScale=function(i){if(!arguments.length)return this._rts===-Lt?0:this._rts;if(this._rts===i)return this;var r=this.parent&&this._ts?Fm(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-Lt?0:this._rts,this.totalTime(id(-Math.abs(this._delay),this._tDur,r),!0),km(this),function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Al(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==Lt&&(this._tTime-=Lt)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&fs(r,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(Ti(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Fm(r.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){void 0===i&&(i=Sq);var r=Jn;return Jn=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),"nested"!==this.data&&!1!==i.kill&&this.kill(),Jn=r,this},e.globalTime=function(i){for(var r=this,s=arguments.length?i:r.rawTime();r;)s=r._start+s/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1/0:this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,tL(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,tL(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,r){return this.totalTime(vr(this,i),Ti(r))},e.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,Ti(r))},e.play=function(i,r){return null!=i&&this.seek(i,r),this.reversed(!1).paused(!1)},e.reverse=function(i,r){return null!=i&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(i,r){return null!=i&&this.seek(i,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-Lt:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Lt,this},e.isActive=function(){var s,i=this.parent||this._dp,r=this._start;return!(i&&!(this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=r&&s<this.endTime(!0)-Lt))},e.eventCallback=function(i,r,s){var o=this.vars;return arguments.length>1?(r?(o[i]=r,s&&(o[i+"Params"]=s),"onUpdate"===i&&(this._onUpdate=r)):delete o[i],this):o[i]},e.then=function(i){var r=this;return new Promise(function(s){var o=nn(i)?i:qP,a=function(){var l=r.then;r.then=null,nn(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=l),s(o),r.then=l};r._initted&&1===r.totalProgress()&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){sd(this)},n}();_r(cd.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Lt,_prom:0,_ps:!1,_rts:1});var Di=function(n){function e(i,r){var s;return void 0===i&&(i={}),(s=n.call(this,i)||this).labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=Ti(i.sortChildren),Zt&&fs(i.parent||Zt,Gs(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&QP(Gs(s),i.scrollTrigger),s}NP(e,n);var t=e.prototype;return t.to=function(r,s,o){return nd(0,arguments,this),this},t.from=function(r,s,o){return nd(1,arguments,this),this},t.fromTo=function(r,s,o,a){return nd(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,td(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new yn(r,s,vr(this,o),1),this},t.call=function(r,s,o){return fs(this,yn.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,a,c,l,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=u,o.parent=this,new yn(r,o,vr(this,c)),this},t.staggerFrom=function(r,s,o,a,c,l,u){return o.runBackwards=1,td(o).immediateRender=Ti(o.immediateRender),this.staggerTo(r,s,o,a,c,l,u)},t.staggerFromTo=function(r,s,o,a,c,l,u,h){return a.startAt=o,td(a).immediateRender=Ti(a.immediateRender),this.staggerTo(r,s,a,c,l,u,h)},t.render=function(r,s,o){var d,f,p,g,_,m,v,y,w,x,S,M,a=this._time,c=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=r<=0?0:zn(r),h=this._zTime<0!=r<0&&(this._initted||!l);if(this!==Zt&&u>c&&r>=0&&(u=c),u!==this._tTime||o||h){if(a!==this._time&&l&&(u+=this._time-a,r+=this._time-a),d=u,w=this._start,m=!(y=this._ts),h&&(l||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(S=this._yoyo,_=l+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(100*_+r,s,o);if(d=zn(u%_),u===c?(g=this._repeat,d=l):((g=~~(u/_))&&g===u/_&&(d=l,g--),d>l&&(d=l)),x=El(this._tTime,_),!a&&this._tTime&&x!==g&&this._tTime-x*_-this._dur<=0&&(x=g),S&&1&g&&(d=l-d,M=1),g!==x&&!this._lock){var E=S&&1&x,b=E===(S&&1&g);if(g<x&&(E=!E),a=E?0:u%l?l:u,this._lock=1,this.render(a||(M?0:zn(g*_)),s,!l)._lock=0,this._tTime=u,!s&&this.parent&&wr(this,"onRepeat"),this.vars.repeatRefresh&&!M&&(this.invalidate()._lock=1),a&&a!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,c=this._tDur,b&&(this._lock=2,this.render(a=E?l:-1e-4,!0),this.vars.repeatRefresh&&!M&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;_L(this,M)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=function(e,t,i){var r;if(i>t)for(r=e._first;r&&r._start<=i;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,zn(a),zn(d)),v&&(u-=d-(d=v._start))),this._tTime=u,this._time=d,this._act=!y,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!s&&!g&&(wr(this,"onStart"),this._tTime!==u))return this;if(d>=a&&r>=0)for(f=this._first;f;){if(p=f._next,(f._act||d>=f._start)&&f._ts&&v!==f){if(f.parent!==this)return this.render(r,s,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,s,o),d!==this._time||!this._ts&&!m){v=0,p&&(u+=this._zTime=-Lt);break}}f=p}else{f=this._last;for(var C=r<0?r:d;f;){if(p=f._prev,(f._act||C<=f._end)&&f._ts&&v!==f){if(f.parent!==this)return this.render(r,s,o);if(f.render(f._ts>0?(C-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(C-f._start)*f._ts,s,o||Jn&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!m){v=0,p&&(u+=this._zTime=C?-Lt:Lt);break}}f=p}}if(v&&!s&&(this.pause(),v.render(d>=a?0:-Lt)._zTime=d>=a?1:-1,this._ts))return this._start=w,km(this),this.render(r,s,o);this._onUpdate&&!s&&wr(this,"onUpdate",!0),(u===c&&this._tTime>=this.totalDuration()||!u&&a)&&(w===this._start||Math.abs(y)!==Math.abs(this._ts))&&(this._lock||((r||!l)&&(u===c&&this._ts>0||!u&&this._ts<0)&&Io(this,1),!s&&(!(r<0)||a)&&(u||a||!c)&&(wr(this,u===c&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(Ws(s)||(s=vr(this,s,r)),!(r instanceof cd)){if(Qn(r))return r.forEach(function(a){return o.add(a,s)}),this;if(Fn(r))return this.addLabel(r,s);if(!nn(r))return this;r=yn.delayedCall(0,r)}return this!==r?fs(this,r,s):this},t.getChildren=function(r,s,o,a){void 0===r&&(r=!0),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=-mr);for(var c=[],l=this._first;l;)l._start>=a&&(l instanceof yn?s&&c.push(l):(o&&c.push(l),r&&c.push.apply(c,l.getChildren(!0,s,o)))),l=l._next;return c},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return Fn(r)?this.removeLabel(r):nn(r)?this.killTweensOf(r):(Om(this,r),r===this._recent&&(this._recent=this._last),ba(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=zn(Xi.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=vr(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var a=yn.delayedCall(0,s||ed,o);return a.data="isPause",this._hasPause=1,fs(this,a,vr(this,r))},t.removePause=function(r){var s=this._first;for(r=vr(this,r);s;)s._start===r&&"isPause"===s.data&&Io(s),s=s._next},t.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),c=a.length;c--;)Lo!==a[c]&&a[c].kill(r,s);return this},t.getTweensOf=function(r,s){for(var u,o=[],a=yr(r),c=this._first,l=Ws(s);c;)c instanceof yn?Eq(c._targets,a)&&(l?(!Lo||c._initted&&c._ts)&&c.globalTime(0)<=s&&c.globalTime(c.totalDuration())>s:!s||c.isActive())&&o.push(c):(u=c.getTweensOf(a,s)).length&&o.push.apply(o,u),c=c._next;return o},t.tweenTo=function(r,s){s=s||{};var f,o=this,a=vr(o,r),l=s.startAt,u=s.onStart,h=s.onStartParams,d=s.immediateRender,p=yn.to(o,_r({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||Lt,onStart:function(){if(o.pause(),!f){var _=s.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());p._dur!==_&&Cl(p,_,0,1).render(p._time,!0,!0),f=1}u&&u.apply(p,h||[])}},s));return d?p.render(0):p},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,_r({startAt:{time:vr(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return void 0===r&&(r=this._time),lL(this,vr(this,r))},t.previousLabel=function(r){return void 0===r&&(r=this._time),lL(this,vr(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Lt)},t.shiftChildren=function(r,s,o){void 0===o&&(o=0);for(var l,a=this._first,c=this.labels;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(l in c)c[l]>=o&&(c[l]+=r);return ba(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return n.prototype.invalidate.call(this,r)},t.clear=function(r){void 0===r&&(r=!0);for(var o,s=this._first;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),ba(this)},t.totalDuration=function(r){var l,u,h,s=0,o=this,a=o._last,c=mr;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(h=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),(u=a._start)>c&&o._sort&&a._ts&&!o._lock?(o._lock=1,fs(o,a,u-a._delay,1)._lock=0):c=u,u<0&&a._ts&&(s-=u,(!h&&!o._dp||h&&h.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),c=0),a._end>s&&a._ts&&(s=a._end),a=l;Cl(o,o===Zt&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(Zt._ts&&($P(Zt,Fm(r,Zt)),GP=Xi.frame),Xi.frame>=WP){WP+=Wi.autoSleep||120;var s=Zt._first;if((!s||!s._ts)&&Wi.autoSleep&&Xi._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Xi.sleep()}}},e}(cd);_r(Di.prototype,{_lock:0,_hasPause:0,_forcing:0});var Lo,xx,qq=function(e,t,i,r,s,o,a){var h,d,f,p,g,_,m,v,c=new Ii(this._pt,e,t,0,1,EL,null,s),l=0,u=0;for(c.b=i,c.e=r,i+="",(m=~(r+="").indexOf("random("))&&(r=rd(r)),o&&(o(v=[i,r],e,t),i=v[0],r=v[1]),d=i.match(ix)||[];h=ix.exec(r);)p=h[0],g=r.substring(l,h.index),f?f=(f+1)%5:"rgba("===g.substr(-5)&&(f=1),p!==d[u++]&&(_=parseFloat(d[u-1])||0,c._pt={_next:c._pt,p:g||1===u?g:",",s:_,c:"="===p.charAt(1)?Sl(_,p)-_:parseFloat(p)-_,m:f&&f<4?Math.round:0},l=ix.lastIndex);return c.c=l<r.length?r.substring(l,r.length):"",c.fp=a,(UP.test(r)||m)&&(c.e=0),this._pt=c,c},wx=function(e,t,i,r,s,o,a,c,l,u){nn(r)&&(r=r(s||0,e,o));var p,h=e[t],d="get"!==i?i:nn(h)?l?e[t.indexOf("set")||!nn(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():h,f=nn(h)?l?Qq:ML:Mx;if(Fn(r)&&(~r.indexOf("random(")&&(r=rd(r)),"="===r.charAt(1)&&((p=Sl(d,r)+(ei(d)||0))||0===p)&&(r=p)),!u||d!==r||xx)return isNaN(d*r)||""===r?(!h&&!(t in e)&&ox(t,r),qq.call(this,e,t,d,r,f,c||Wi.stringFilter,l)):(p=new Ii(this._pt,e,t,+d||0,r-(d||0),"boolean"==typeof h?t7:SL,0,f),l&&(p.fp=l),a&&p.modifier(a,this,e),this._pt=p)},wL=function(e,t,i,r,s,o){var a,c,l,u;if($i[e]&&!1!==(a=new $i[e]).init(s,a.rawVars?t[e]:function(e,t,i,r,s){if(nn(e)&&(e=ld(e,s,t,i,r)),!ds(e)||e.style&&e.nodeType||Qn(e)||FP(e))return Fn(e)?ld(e,s,t,i,r):e;var a,o={};for(a in e)o[a]=ld(e[a],s,t,i,r);return o}(t[e],r,s,o,i),i,r,o)&&(i._pt=c=new Ii(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==Tl))for(l=i._ptLookup[i._targets.indexOf(s)],u=a._props.length;u--;)l[a._props[u]]=c;return a},bx=function n(e,t,i){var M,E,b,C,O,B,L,F,k,W,H,X,Q,r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,c=r.lazy,l=r.onUpdate,u=r.onUpdateParams,h=r.callbackScope,d=r.runBackwards,f=r.yoyoEase,p=r.keyframes,g=r.autoRevert,_=e._dur,m=e._startAt,v=e._targets,y=e.parent,w=y&&"nested"===y.data?y.vars.targets:v,x="auto"===e._overwrite&&!Jw,S=e.timeline;if(S&&(!p||!s)&&(s="none"),e._ease=Ma(s,bl.ease),e._yEase=f?gL(Ma(!0===f?s:f,bl.ease)):0,f&&e._yoyo&&!e._repeat&&(f=e._yEase,e._yEase=e._ease,e._ease=f),e._from=!S&&!!r.runBackwards,!S||p&&!r.stagger){if(X=(F=v[0]?wa(v[0]).harness:0)&&r[F.prop],M=Nm(r,ax),m&&(m._zTime<0&&m.progress(1),t<0&&d&&a&&!g?m.render(-1,!0):m.revert(d&&_?Rm:Mq),m._lazy=0),o){if(Io(e._startAt=yn.set(v,_r({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!m&&Ti(c),startAt:null,delay:0,onUpdate:l,onUpdateParams:u,callbackScope:h,stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Jn||!a&&!g)&&e._startAt.revert(Rm),a&&_&&t<=0&&i<=0)return void(t&&(e._zTime=t))}else if(d&&_&&!m)if(t&&(a=!1),b=_r({overwrite:!1,data:"isFromStart",lazy:a&&!m&&Ti(c),immediateRender:a,stagger:0,parent:y},M),X&&(b[F.prop]=X),Io(e._startAt=yn.set(v,b)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Jn?e._startAt.revert(Rm):e._startAt.render(-1,!0)),e._zTime=t,a){if(!t)return}else n(e._startAt,Lt,Lt);for(e._pt=e._ptCache=0,c=_&&Ti(c)||c&&!_,E=0;E<v.length;E++){if(L=(O=v[E])._gsap||hx(v)[E]._gsap,e._ptLookup[E]=W={},cx[L.id]&&Do.length&&Lm(),H=w===v?E:w.indexOf(O),F&&!1!==(k=new F).init(O,X||M,e,H,w)&&(e._pt=C=new Ii(e._pt,O,k.name,0,1,k.render,k,0,k.priority),k._props.forEach(function(te){W[te]=C}),k.priority&&(B=1)),!F||X)for(b in M)$i[b]&&(k=wL(b,M,e,H,O,w))?k.priority&&(B=1):W[b]=C=wx.call(e,O,b,"get",M[b],H,w,0,r.stringFilter);e._op&&e._op[E]&&e.kill(O,e._op[E]),x&&e._pt&&(Lo=e,Zt.killTweensOf(O,W,e.globalTime(t)),Q=!e.parent,Lo=0),e._pt&&c&&(cx[L.id]=1)}B&&CL(e),e._onInit&&e._onInit(e)}e._onUpdate=l,e._initted=(!e._op||e._pt)&&!Q,p&&t<=0&&S.render(mr,!0,!0)},Jq=function(e,t,i,r){var o,a,s=t.ease||r||"power1.inOut";if(Qn(t))a=i[e]||(i[e]=[]),t.forEach(function(c,l){return a.push({t:l/(t.length-1)*100,v:c,e:s})});else for(o in t)a=i[o]||(i[o]=[]),"ease"===o||a.push({t:parseFloat(e),v:t[o],e:s})},ld=function(e,t,i,r,s){return nn(e)?e.call(t,i,r,s):Fn(e)&&~e.indexOf("random(")?rd(e):e},xL=ux+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",bL={};Ai(xL+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return bL[n]=1});var yn=function(n){function e(i,r,s,o){var a;"number"==typeof r&&(s.duration=r,r=s,s=null);var w,x,S,M,E,b,C,O,c=(a=n.call(this,o?r:td(r))||this).vars,l=c.duration,u=c.delay,h=c.immediateRender,d=c.stagger,f=c.overwrite,p=c.keyframes,g=c.defaults,_=c.scrollTrigger,m=c.yoyoEase,v=r.parent||Zt,y=(Qn(i)||FP(i)?Ws(i[0]):"length"in r)?[i]:yr(i);if(a._targets=y.length?hx(y):Im("GSAP target "+i+" not found. https://greensock.com",!Wi.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,p||d||Am(l)||Am(u)){if(r=a.vars,(w=a.timeline=new Di({data:"nested",defaults:g||{},targets:v&&"nested"===v.data?v.vars.targets:y})).kill(),w.parent=w._dp=Gs(a),w._start=0,d||Am(l)||Am(u)){if(M=y.length,C=d&&rL(d),ds(d))for(E in d)~xL.indexOf(E)&&(O||(O={}),O[E]=d[E]);for(x=0;x<M;x++)(S=Nm(r,bL)).stagger=0,m&&(S.yoyoEase=m),O&&xa(S,O),b=y[x],S.duration=+ld(l,Gs(a),x,b,y),S.delay=(+ld(u,Gs(a),x,b,y)||0)-a._delay,!d&&1===M&&S.delay&&(a._delay=u=S.delay,a._start+=u,S.delay=0),w.to(b,S,C?C(x,b,y):0),w._ease=_t.none;w.duration()?l=u=0:a.timeline=0}else if(p){td(_r(w.vars.defaults,{ease:"none"})),w._ease=Ma(p.ease||r.ease||"none");var L,F,k,B=0;if(Qn(p))p.forEach(function(W){return w.to(y,W,">")}),w.duration();else{for(E in S={},p)"ease"===E||"easeEach"===E||Jq(E,p[E],S,p.easeEach);for(E in S)for(L=S[E].sort(function(W,H){return W.t-H.t}),B=0,x=0;x<L.length;x++)(k={ease:(F=L[x]).e,duration:(F.t-(x?L[x-1].t:0))/100*l})[E]=F.v,w.to(y,k,B),B+=k.duration;w.duration()<l&&w.to({},{duration:l-w.duration()})}}l||a.duration(l=w.duration())}else a.timeline=0;return!0===f&&!Jw&&(Lo=Gs(a),Zt.killTweensOf(y),Lo=0),fs(v,Gs(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(h||!l&&!p&&a._start===zn(v._time)&&Ti(h)&&Dq(Gs(a))&&"nested"!==v.data)&&(a._tTime=-Lt,a.render(Math.max(0,-u)||0)),_&&QP(Gs(a),_),a}NP(e,n);var t=e.prototype;return t.render=function(r,s,o){var d,f,p,g,_,m,v,y,w,a=this._time,c=this._tDur,l=this._dur,u=r<0,h=r>c-Lt&&!u?c:r<Lt?0:r;if(l){if(h!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=h,y=this.timeline,this._repeat){if(g=l+this._rDelay,this._repeat<-1&&u)return this.totalTime(100*g+r,s,o);if(d=zn(h%g),h===c?(p=this._repeat,d=l):((p=~~(h/g))&&p===h/g&&(d=l,p--),d>l&&(d=l)),(m=this._yoyo&&1&p)&&(w=this._yEase,d=l-d),_=El(this._tTime,g),d===a&&!o&&this._initted)return this._tTime=h,this;p!==_&&(y&&this._yEase&&_L(y,m),this.vars.repeatRefresh&&!m&&!this._lock&&(this._lock=o=1,this.render(zn(g*p),!0).invalidate()._lock=0))}if(!this._initted){if(eL(this,u?r:d,o,s,h))return this._tTime=0,this;if(a!==this._time)return this;if(l!==this._dur)return this.render(r,s,o)}if(this._tTime=h,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(w||this._ease)(d/l),this._from&&(this.ratio=v=1-v),d&&!a&&!s&&!p&&(wr(this,"onStart"),this._tTime!==h))return this;for(f=this._pt;f;)f.r(v,f.d),f=f._next;y&&y.render(r<0?r:!d&&m?-Lt:y._dur*y._ease(d/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&dx(this,r,0,o),wr(this,"onUpdate")),this._repeat&&p!==_&&this.vars.onRepeat&&!s&&this.parent&&wr(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(u&&!this._onUpdate&&dx(this,r,0,!0),(r||!l)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&Io(this,1),!s&&(!u||a)&&(h||a||m)&&(wr(this,h===c?"onComplete":"onReverseComplete",!0),this._prom&&!(h<c&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,i,r){var l,u,h,s=e.ratio,o=t<0||!t&&(!e._start&&Iq(e)&&(e._initted||!fx(e))||(e._ts<0||e._dp._ts<0)&&!fx(e))?0:1,a=e._rDelay,c=0;if(a&&e._repeat&&(c=id(0,e._tDur,t),u=El(c,a),e._yoyo&&1&u&&(o=1-o),u!==El(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||Jn||r||e._zTime===Lt||!t&&e._zTime){if(!e._initted&&eL(e,t,r,i,c))return;for(h=e._zTime,e._zTime=t||(i?Lt:0),i||(i=t&&!h),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=c,l=e._pt;l;)l.r(o,l.d),l=l._next;t<0&&dx(e,t,0,!0),e._onUpdate&&!i&&wr(e,"onUpdate"),c&&e._repeat&&!i&&e.parent&&wr(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&Io(e,1),!i&&!Jn&&(wr(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,r,s,o);return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,a){ad||Xi.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||bx(this,c),function(e,t,i,r,s,o,a){var l,u,h,d,c=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!c)for(c=e._ptCache[t]=[],h=e._ptLookup,d=e._targets.length;d--;){if((l=h[d][t])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return xx=1,e.vars[t]="+=0",bx(e,a),xx=0,1;c.push(l)}for(d=c.length;d--;)(l=(u=c[d])._pt||u).s=!r&&0!==r||s?l.s+(r||0)+o*l.c:r,l.c=i-l.s,u.e&&(u.e=hn(i)+ei(u.e)),u.b&&(u.b=l.s+ei(u.b))}(this,r,s,o,a,this._ease(c/this._dur),c)?this.resetTo(r,s,o,a):(Um(this,0),this.parent||ZP(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(void 0===s&&(s="all"),!(r||s&&"all"!==s))return this._lazy=this._pt=0,this.parent?sd(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,Lo&&!0!==Lo.vars.overwrite)._first||sd(this),this.parent&&o!==this.timeline.totalDuration()&&Cl(this,this._dur*this.timeline._tDur/o,0,1),this}var h,d,f,p,g,_,m,a=this._targets,c=r?yr(r):a,l=this._ptLookup,u=this._pt;if((!s||"all"===s)&&function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0}(a,c))return"all"===s&&(this._pt=0),sd(this);for(h=this._op=this._op||[],"all"!==s&&(Fn(s)&&(g={},Ai(s,function(v){return g[v]=1}),s=g),s=function(e,t){var s,o,a,c,i=e[0]?wa(e[0]).harness:0,r=i&&i.aliases;if(!r)return t;for(o in s=xa({},t),r)if(o in s)for(a=(c=r[o].split(",")).length;a--;)s[c[a]]=s[o];return s}(a,s)),m=a.length;m--;)if(~c.indexOf(a[m]))for(g in d=l[m],"all"===s?(h[m]=s,p=d,f={}):(f=h[m]=h[m]||{},p=s),p)(_=d&&d[g])&&((!("kill"in _.d)||!0===_.d.kill(g))&&Om(this,_,"_pt"),delete d[g]),"all"!==f&&(f[g]=1);return this._initted&&!this._pt&&u&&sd(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return nd(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return nd(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return Zt.killTweensOf(r,s,o)},e}(cd);_r(yn.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Ai("staggerTo,staggerFrom,staggerFromTo",function(n){yn[n]=function(){var e=new Di,t=px.call(arguments,0);return t.splice("staggerFromTo"===n?5:4,0,0),e[n].apply(e,t)}});var Mx=function(e,t,i){return e[t]=i},ML=function(e,t,i){return e[t](i)},Qq=function(e,t,i,r){return e[t](r.fp,i)},e7=function(e,t,i){return e.setAttribute(t,i)},Sx=function(e,t){return nn(e[t])?ML:ex(e[t])&&e.setAttribute?e7:Mx},SL=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},t7=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},EL=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round(1e4*(i.s+i.c*e))/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},Ex=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},n7=function(e,t,i,r){for(var o,s=this._pt;s;)o=s._next,s.p===r&&s.modifier(e,t,i),s=o},i7=function(e){for(var i,r,t=this._pt;t;)r=t._next,t.p===e&&!t.op||t.op===e?Om(this,t,"_pt"):t.dep||(i=1),t=r;return!i},r7=function(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)},CL=function(e){for(var i,r,s,o,t=e._pt;t;){for(i=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=i}e._pt=s},Ii=function(){function n(t,i,r,s,o,a,c,l,u){this.t=i,this.s=s,this.c=o,this.p=r,this.r=a||SL,this.d=c||this,this.set=l||Mx,this.pr=u||0,this._next=t,t&&(t._prev=this)}return n.prototype.modifier=function(i,r,s){this.mSet=this.mSet||this.set,this.set=r7,this.m=i,this.mt=s,this.tween=r},n}();Ai(ux+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return ax[n]=1}),ji.TweenMax=ji.TweenLite=yn,ji.TimelineLite=ji.TimelineMax=Di,Zt=new Di({sortChildren:!1,defaults:bl,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Wi.stringFilter=mL;var Ea=[],Bm={},s7=[],TL=0,o7=0,Cx=function(e){return(Bm[e]||s7).map(function(t){return t()})},Tx=function(){var e=Date.now(),t=[];e-TL>2&&(Cx("matchMediaInit"),Ea.forEach(function(i){var o,a,c,l,r=i.queries,s=i.conditions;for(a in r)(o=gr.matchMedia(r[a]).matches)&&(c=1),o!==s[a]&&(s[a]=o,l=1);l&&(i.revert(),c&&t.push(i))}),Cx("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i)}),TL=e,Cx("matchMedia"))},AL=function(){function n(t,i){this.selector=i&&mx(i),this.data=[],this._r=[],this.isReverted=!1,this.id=o7++,t&&this.add(t)}var e=n.prototype;return e.add=function(i,r,s){nn(i)&&(s=r,r=i,i=nn);var o=this,a=function(){var h,l=tn,u=o.selector;return l&&l!==o&&l.data.push(o),s&&(o.selector=mx(s)),tn=o,h=r.apply(o,arguments),nn(h)&&o._r.push(h),tn=l,o.selector=u,o.isReverted=!1,h};return o.last=a,i===nn?a(o):i?o[i]=a:a},e.ignore=function(i){var r=tn;tn=null,i(this),tn=r},e.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof n?i.push.apply(i,r.getTweens()):r instanceof yn&&!(r.parent&&"nested"===r.parent.data)&&i.push(r)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,r){var s=this;if(i){var o=this.getTweens();this.data.forEach(function(c){"isFlip"===c.data&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(l){return o.splice(o.indexOf(l),1)}))}),o.map(function(c){return{g:c.globalTime(0),t:c}}).sort(function(c,l){return l.g-c.g||-1/0}).forEach(function(c){return c.t.revert(i)}),this.data.forEach(function(c){return!(c instanceof yn)&&c.revert&&c.revert(i)}),this._r.forEach(function(c){return c(i,s)}),this.isReverted=!0}else this.data.forEach(function(c){return c.kill&&c.kill()});if(this.clear(),r)for(var a=Ea.length;a--;)Ea[a].id===this.id&&Ea.splice(a,1)},e.revert=function(i){this.kill(i||{})},n}(),a7=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(i,r,s){ds(i)||(i={matches:i});var c,l,u,o=new AL(0,s||this.scope),a=o.conditions={};for(l in tn&&!o.selector&&(o.selector=tn.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=i,i)"all"===l?u=1:(c=gr.matchMedia(i[l]))&&(Ea.indexOf(o)<0&&Ea.push(o),(a[l]=c.matches)&&(u=1),c.addListener?c.addListener(Tx):c.addEventListener("change",Tx));return u&&r(o),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},n}(),Vm={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(r){return hL(r)})},timeline:function(e){return new Di(e)},getTweensOf:function(e,t){return Zt.getTweensOf(e,t)},getProperty:function(e,t,i,r){Fn(e)&&(e=yr(e)[0]);var s=wa(e||{}).get,o=i?qP:XP;return"native"===i&&(i=""),e&&(t?o(($i[t]&&$i[t].get||s)(e,t,i,r)):function(a,c,l){return o(($i[a]&&$i[a].get||s)(e,a,c,l))})},quickSetter:function(e,t,i){if((e=yr(e)).length>1){var r=e.map(function(u){return Ri.quickSetter(u,t,i)}),s=r.length;return function(u){for(var h=s;h--;)r[h](u)}}var o=$i[t],a=wa(e=e[0]||{}),c=a.harness&&(a.harness.aliases||{})[t]||t,l=o?function(u){var h=new o;Tl._pt=0,h.init(e,i?u+i:u,Tl,0,[e]),h.render(1,h),Tl._pt&&Ex(1,Tl)}:a.set(e,c);return o?l:function(u){return l(e,c,i?u+i:u,a,1)}},quickTo:function(e,t,i){var r,s=Ri.to(e,xa(((r={})[t]="+=0.1",r.paused=!0,r),i||{})),o=function(c,l,u){return s.resetTo(t,c,l,u)};return o.tween=s,o},isTweening:function(e){return Zt.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Ma(e.ease,bl.ease)),YP(bl,e||{})},config:function(e){return YP(Wi,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,s=e.defaults,o=e.extendTimeline;(e.plugins||"").split(",").forEach(function(a){return a&&!$i[a]&&!ji[a]&&Im(t+" effect requires "+a+" plugin.")}),lx[t]=function(a,c,l){return i(yr(a),_r(c||{},s),l)},o&&(Di.prototype[t]=function(a,c,l){return this.add(lx[t](a,ds(c)?c:(l=c)&&{},this),l)})},registerEase:function(e,t){_t[e]=Ma(t)},parseEase:function(e,t){return arguments.length?Ma(e,t):_t},getById:function(e){return Zt.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,s,i=new Di(e);for(i.smoothChildTiming=Ti(e.smoothChildTiming),Zt.remove(i),i._dp=0,i._time=i._tTime=Zt._time,r=Zt._first;r;)s=r._next,(t||!(!r._dur&&r instanceof yn&&r.vars.onComplete===r._targets[0]))&&fs(i,r,r._start-r._delay),r=s;return fs(Zt,i,0),i},context:function(e,t){return e?new AL(e,t):tn},matchMedia:function(e){return new a7(e)},matchMediaRefresh:function(){return Ea.forEach(function(e){var i,r,t=e.conditions;for(r in t)t[r]&&(t[r]=!1,i=1);i&&e.revert()})||Tx()},addEventListener:function(e,t){var i=Bm[e]||(Bm[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=Bm[e],r=i&&i.indexOf(t);r>=0&&i.splice(r,1)},utils:{wrap:function n(e,t,i){var r=t-e;return Qn(e)?aL(e,n(0,e.length),t):Ro(i,function(s){return(r+(s-e)%r)%r+e})},wrapYoyo:function n(e,t,i){var r=t-e,s=2*r;return Qn(e)?aL(e,n(0,e.length-1),t):Ro(i,function(o){return e+((o=(s+(o-e)%s)%s||0)>r?s-o:o)})},distribute:rL,random:oL,snap:sL,normalize:function(e,t,i){return cL(e,t,0,1,i)},getUnit:ei,clamp:function(e,t,i){return Ro(i,function(r){return id(e,t,r)})},splitColor:dL,toArray:yr,selector:mx,mapRange:cL,pipe:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduce(function(s,o){return o(s)},r)}},unitize:function(e,t){return function(i){return e(parseFloat(i))+(t||ei(i))}},interpolate:function n(e,t,i,r){var s=isNaN(e+t)?0:function(f){return(1-f)*e+f*t};if(!s){var c,l,u,h,d,o=Fn(e),a={};if(!0===i&&(r=1)&&(i=null),o)e={p:e},t={p:t};else if(Qn(e)&&!Qn(t)){for(u=[],d=(h=e.length)-2,l=1;l<h;l++)u.push(n(e[l-1],e[l]));h--,s=function(p){p*=h;var g=Math.min(d,~~p);return u[g](p-g)},i=t}else r||(e=xa(Qn(e)?[]:{},e));if(!u){for(c in t)wx.call(a,e,c,"get",t[c]);s=function(p){return Ex(p,a)||(o?e.p:e)}}}return Ro(i,s)},shuffle:iL},install:zP,effects:lx,ticker:Xi,updateRoot:Di.updateRoot,plugins:$i,globalTimeline:Zt,core:{PropTween:Ii,globals:HP,Tween:yn,Timeline:Di,Animation:cd,getCache:wa,_removeLinkedListItem:Om,reverting:function(){return Jn},context:function(e){return e&&tn&&(tn.data.push(e),e._ctx=tn),tn},suppressOverwrites:function(e){return Jw=e}}};Ai("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return Vm[n]=yn[n]}),Xi.add(Di.updateRoot),Tl=Vm.to({},{duration:0});var c7=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},Ax=function(e,t){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var c,l;if(Fn(s)&&(c={},Ai(s,function(u){return c[u]=1}),s=c),t){for(l in c={},s)c[l]=t(s[l]);s=c}!function(e,t){var r,s,o,i=e._targets;for(r in t)for(s=i.length;s--;)(o=e._ptLookup[s][r])&&(o=o.d)&&(o._pt&&(o=c7(o,r)),o&&o.modifier&&o.modifier(t[r],e,i[s],r))}(a,s)}}}},Ri=Vm.registerPlugin({name:"attr",init:function(e,t,i,r,s){var o,a,c;for(o in this.tween=i,t)c=e.getAttribute(o)||"",(a=this.add(e,"setAttribute",(c||0)+"",t[o],r,s,0,0,o)).op=o,a.b=c,this._props.push(o)},render:function(e,t){for(var i=t._pt;i;)Jn?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Ax("roundProps",gx),Ax("modifiers"),Ax("snap",sL))||Vm;yn.version=Di.version=Ri.version="3.12.2",VP=1,tx()&&Al();var DL,No,Dl,Dx,Ca,IL,Ix,FL,js={},Ta=180/Math.PI,Il=Math.PI/180,Rl=Math.atan2,RL=1e8,Rx=/([A-Z])/g,d7=/(left|right|width|margin|padding|x)/i,f7=/[\s,\(]\S/,ps={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Px=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},p7=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},m7=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},g7=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},PL=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},LL=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},_7=function(e,t,i){return e.style[t]=i},v7=function(e,t,i){return e.style.setProperty(t,i)},y7=function(e,t,i){return e._gsap[t]=i},w7=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},x7=function(e,t,i,r,s){var o=e._gsap;o.scaleX=o.scaleY=i,o.renderTransform(s,o)},b7=function(e,t,i,r,s){var o=e._gsap;o[t]=i,o.renderTransform(s,o)},Kt="transform",Br=Kt+"Origin",M7=function n(e,t){var i=this,r=this.target,s=r.style;if(e in js&&s){if(this.tfm=this.tfm||{},"transform"===e)return ps.transform.split(",").forEach(function(o){return n.call(i,o,t)});if(~(e=ps[e]||e).indexOf(",")?e.split(",").forEach(function(o){return i.tfm[o]=$s(r,o)}):this.tfm[e]=r._gsap.x?r._gsap[e]:$s(r,e),this.props.indexOf(Kt)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Br,t,"")),e=Kt}(s||t)&&this.props.push(e,t,s[e])},NL=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},S7=function(){var s,o,e=this.props,t=this.target,i=t.style,r=t._gsap;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty("--"===e[s].substr(0,2)?e[s]:e[s].replace(Rx,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),(!(s=Ix())||!s.isStart)&&!i[Kt]&&(NL(i),r.uncache=1)}},OL=function(e,t){var i={target:e,props:[],revert:S7,save:M7};return e._gsap||Ri.core.getCache(e),t&&t.split(",").forEach(function(r){return i.save(r)}),i},Lx=function(e,t){var i=No.createElementNS?No.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):No.createElement(e);return i.style?i:No.createElement(e)},ms=function n(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(Rx,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&n(e,Pl(t)||t,1)||""},kL="O,Moz,ms,Ms,Webkit".split(","),Pl=function(e,t,i){var s=(t||Ca).style,o=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(kL[o]+e in s););return o<0?null:(3===o?"ms":o>=0?kL[o]:"")+e},Nx=function(){typeof window<"u"&&window.document&&(DL=window,Dl=(No=DL.document).documentElement,Ca=Lx("div")||{style:{}},Lx("div"),Kt=Pl(Kt),Br=Kt+"Origin",Ca.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",FL=!!Pl("perspective"),Ix=Ri.core.reverting,Dx=1)},Ox=function n(e){var o,t=Lx("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,s=this.style.cssText;if(Dl.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),Dl.removeChild(t),this.style.cssText=s,o},UL=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},BL=function(e){var t;try{t=e.getBBox()}catch{t=Ox.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Ox||(t=Ox.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+UL(e,["x","cx","x1"])||0,y:+UL(e,["y","cy","y1"])||0,width:0,height:0}},VL=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!BL(e))},ud=function(e,t){if(t){var i=e.style;t in js&&t!==Br&&(t=Kt),i.removeProperty?(("ms"===t.substr(0,2)||"webkit"===t.substr(0,6))&&(t="-"+t),i.removeProperty(t.replace(Rx,"-$1").toLowerCase())):i.removeAttribute(t)}},Oo=function(e,t,i,r,s,o){var a=new Ii(e._pt,t,i,0,1,o?LL:PL);return e._pt=a,a.b=r,a.e=s,e._props.push(i),a},zL={deg:1,rad:1,turn:1},E7={grid:1,flex:1},Fo=function n(e,t,i,r){var p,g,_,m,s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",a=Ca.style,c=d7.test(t),l="svg"===e.tagName.toLowerCase(),u=(l?"client":"offset")+(c?"Width":"Height"),h=100,d="px"===r,f="%"===r;return r===o||!s||zL[r]||zL[o]?s:("px"!==o&&!d&&(s=n(e,t,i,"px")),m=e.getCTM&&VL(e),!f&&"%"!==o||!js[t]&&!~t.indexOf("adius")?(a[c?"width":"height"]=h+(d?o:r),g=~t.indexOf("adius")||"em"===r&&e.appendChild&&!l?e:e.parentNode,m&&(g=(e.ownerSVGElement||{}).parentNode),(!g||g===No||!g.appendChild)&&(g=No.body),(_=g._gsap)&&f&&_.width&&c&&_.time===Xi.time&&!_.uncache?hn(s/_.width*h):((f||"%"===o)&&!E7[ms(g,"display")]&&(a.position=ms(e,"position")),g===e&&(a.position="static"),g.appendChild(Ca),p=Ca[u],g.removeChild(Ca),a.position="absolute",c&&f&&((_=wa(g)).time=Xi.time,_.width=g[u]),hn(d?p*s/h:p&&s?h/p*s:0))):(p=m?e.getBBox()[c?"width":"height"]:e[u],hn(f?s/p*h:s/100*p)))},$s=function(e,t,i,r){var s;return Dx||Nx(),t in ps&&"transform"!==t&&~(t=ps[t]).indexOf(",")&&(t=t.split(",")[0]),js[t]&&"transform"!==t?(s=dd(e,r),s="transformOrigin"!==t?s[t]:s.svg?s.origin:Hm(ms(e,Br))+" "+s.zOrigin+"px"):(!(s=e.style[t])||"auto"===s||r||~(s+"").indexOf("calc("))&&(s=zm[t]&&zm[t](e,t,i)||ms(e,t)||jP(e,t)||("opacity"===t?1:0)),i&&!~(s+"").trim().indexOf(" ")?Fo(e,t,s,i)+i:s},C7=function(e,t,i,r){if(!i||"none"===i){var s=Pl(t,e,1),o=s&&ms(e,s,1);o&&o!==i?(t=s,i=o):"borderColor"===t&&(i=ms(e,"borderTopColor"))}var u,h,d,f,p,g,_,m,v,y,w,a=new Ii(this._pt,e.style,t,0,1,EL),c=0,l=0;if(a.b=i,a.e=r,i+="","auto"==(r+="")&&(e.style[t]=r,r=ms(e,t)||r,e.style[t]=i),mL(u=[i,r]),r=u[1],d=(i=u[0]).match(Ml)||[],(r.match(Ml)||[]).length){for(;h=Ml.exec(r);)_=h[0],v=r.substring(c,h.index),p?p=(p+1)%5:("rgba("===v.substr(-5)||"hsla("===v.substr(-5))&&(p=1),_!==(g=d[l++]||"")&&(f=parseFloat(g)||0,w=g.substr((f+"").length),"="===_.charAt(1)&&(_=Sl(f,_)+w),m=parseFloat(_),y=_.substr((m+"").length),c=Ml.lastIndex-y.length,y||(y=y||Wi.units[t]||w,c===r.length&&(r+=y,a.e+=y)),w!==y&&(f=Fo(e,t,g,y)||0),a._pt={_next:a._pt,p:v||1===l?v:",",s:f,c:m-f,m:p&&p<4||"zIndex"===t?Math.round:0});a.c=c<r.length?r.substring(c,r.length):""}else a.r="display"===t&&"none"===r?LL:PL;return UP.test(r)&&(a.e=0),this._pt=a,a},HL={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},T7=function(e){var t=e.split(" "),i=t[0],r=t[1]||"50%";return("top"===i||"bottom"===i||"left"===r||"right"===r)&&(e=i,i=r,r=e),t[0]=HL[i]||i,t[1]=HL[r]||r,t.join(" ")},A7=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var a,c,l,i=t.t,r=i.style,s=t.u,o=i._gsap;if("all"===s||!0===s)r.cssText="",c=1;else for(l=(s=s.split(",")).length;--l>-1;)js[a=s[l]]&&(c=1,a="transformOrigin"===a?Br:Kt),ud(i,a);c&&(ud(i,Kt),o&&(o.svg&&i.removeAttribute("transform"),dd(i,1),o.uncache=1,NL(r)))}},zm={clearProps:function(e,t,i,r,s){if("isFromStart"!==s.data){var o=e._pt=new Ii(e._pt,t,i,0,0,A7);return o.u=r,o.pr=-10,o.tween=s,e._props.push(i),1}}},hd=[1,0,0,1,0,0],GL={},WL=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},jL=function(e){var t=ms(e,Kt);return WL(t)?hd:t.substr(7).match(kP).map(hn)},Fx=function(e,t){var o,a,c,l,i=e._gsap||wa(e),r=e.style,s=jL(e);return i.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(s=[(c=e.transform.baseVal.consolidate().matrix).a,c.b,c.c,c.d,c.e,c.f]).join(",")?hd:s:(s===hd&&!e.offsetParent&&e!==Dl&&!i.svg&&(c=r.display,r.display="block",(!(o=e.parentNode)||!e.offsetParent)&&(l=1,a=e.nextElementSibling,Dl.appendChild(e)),s=jL(e),c?r.display=c:ud(e,"display"),l&&(a?o.insertBefore(e,a):o?o.appendChild(e):Dl.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},kx=function(e,t,i,r,s,o){var S,M,b,a=e._gsap,c=s||Fx(e,!0),l=a.xOrigin||0,u=a.yOrigin||0,h=a.xOffset||0,d=a.yOffset||0,f=c[0],p=c[1],g=c[2],_=c[3],m=c[4],v=c[5],y=t.split(" "),w=parseFloat(y[0])||0,x=parseFloat(y[1])||0;i?c!==hd&&(M=f*_-p*g)&&(b=w*(-p/M)+x*(f/M)-(f*v-p*m)/M,w=w*(_/M)+x*(-g/M)+(g*v-_*m)/M,x=b):(w=(S=BL(e)).x+(~y[0].indexOf("%")?w/100*S.width:w),x=S.y+(~(y[1]||y[0]).indexOf("%")?x/100*S.height:x)),r||!1!==r&&a.smooth?(a.xOffset=h+((m=w-l)*f+(v=x-u)*g)-m,a.yOffset=d+(m*p+v*_)-v):a.xOffset=a.yOffset=0,a.xOrigin=w,a.yOrigin=x,a.smooth=!!r,a.origin=t,a.originIsAbsolute=!!i,e.style[Br]="0px 0px",o&&(Oo(o,a,"xOrigin",l,w),Oo(o,a,"yOrigin",u,x),Oo(o,a,"xOffset",h,a.xOffset),Oo(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",w+" "+x)},dd=function(e,t){var i=e._gsap||new yL(e);if("x"in i&&!t&&!i.uncache)return i;var u,h,d,f,p,g,_,m,v,y,w,x,S,M,E,b,C,O,B,L,F,k,W,H,X,Q,te,U,q,ae,oe,le,r=e.style,s=i.scaleX<0,o="px",a="deg",c=getComputedStyle(e),l=ms(e,Br)||"0";return u=h=d=g=_=m=v=y=w=0,f=p=1,i.svg=!(!e.getCTM||!VL(e)),c.translate&&(("none"!==c.translate||"none"!==c.scale||"none"!==c.rotate)&&(r[Kt]=("none"!==c.translate?"translate3d("+(c.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==c.rotate?"rotate("+c.rotate+") ":"")+("none"!==c.scale?"scale("+c.scale.split(" ").join(",")+") ":"")+("none"!==c[Kt]?c[Kt]:"")),r.scale=r.rotate=r.translate="none"),M=Fx(e,i.svg),i.svg&&(i.uncache?(X=e.getBBox(),l=i.xOrigin-X.x+"px "+(i.yOrigin-X.y)+"px",H=""):H=!t&&e.getAttribute("data-svg-origin"),kx(e,H||l,!!H||i.originIsAbsolute,!1!==i.smooth,M)),x=i.xOrigin||0,S=i.yOrigin||0,M!==hd&&(O=M[0],B=M[1],L=M[2],F=M[3],u=k=M[4],h=W=M[5],6===M.length?(f=Math.sqrt(O*O+B*B),p=Math.sqrt(F*F+L*L),g=O||B?Rl(B,O)*Ta:0,(v=L||F?Rl(L,F)*Ta+g:0)&&(p*=Math.abs(Math.cos(v*Il))),i.svg&&(u-=x-(x*O+S*L),h-=S-(x*B+S*F))):(ae=M[7],te=M[8],U=M[9],oe=M[11],u=M[12],h=M[13],d=M[14],_=(E=Rl(le=M[6],q=M[10]))*Ta,E&&(H=k*(b=Math.cos(-E))+te*(C=Math.sin(-E)),X=W*b+U*C,Q=le*b+q*C,te=k*-C+te*b,U=W*-C+U*b,q=le*-C+q*b,oe=ae*-C+oe*b,k=H,W=X,le=Q),m=(E=Rl(-L,q))*Ta,E&&(b=Math.cos(-E),oe=F*(C=Math.sin(-E))+oe*b,O=H=O*b-te*C,B=X=B*b-U*C,L=Q=L*b-q*C),g=(E=Rl(B,O))*Ta,E&&(H=O*(b=Math.cos(E))+B*(C=Math.sin(E)),X=k*b+W*C,B=B*b-O*C,W=W*b-k*C,O=H,k=X),_&&Math.abs(_)+Math.abs(g)>359.9&&(_=g=0,m=180-m),f=hn(Math.sqrt(O*O+B*B+L*L)),p=hn(Math.sqrt(W*W+le*le)),E=Rl(k,W),v=Math.abs(E)>2e-4?E*Ta:0,w=oe?1/(oe<0?-oe:oe):0),i.svg&&(H=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!WL(ms(e,Kt)),H&&e.setAttribute("transform",H))),Math.abs(v)>90&&Math.abs(v)<270&&(s?(f*=-1,v+=g<=0?180:-180,g+=g<=0?180:-180):(p*=-1,v+=v<=0?180:-180)),t=t||i.uncache,i.x=u-((i.xPercent=u&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+o,i.y=h-((i.yPercent=h&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+o,i.z=d+o,i.scaleX=hn(f),i.scaleY=hn(p),i.rotation=hn(g)+a,i.rotationX=hn(_)+a,i.rotationY=hn(m)+a,i.skewX=v+a,i.skewY=y+a,i.transformPerspective=w+o,(i.zOrigin=parseFloat(l.split(" ")[2])||0)&&(r[Br]=Hm(l)),i.xOffset=i.yOffset=0,i.force3D=Wi.force3D,i.renderTransform=i.svg?I7:FL?$L:D7,i.uncache=0,i},Hm=function(e){return(e=e.split(" "))[0]+" "+e[1]},Ux=function(e,t,i){var r=ei(t);return hn(parseFloat(t)+parseFloat(Fo(e,"x",i+"px",r)))+r},D7=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,$L(e,t)},Aa="0deg",fd="0px",Da=") ",$L=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,c=i.z,l=i.rotation,u=i.rotationY,h=i.rotationX,d=i.skewX,f=i.skewY,p=i.scaleX,g=i.scaleY,_=i.transformPerspective,m=i.force3D,v=i.target,y=i.zOrigin,w="",x="auto"===m&&e&&1!==e||!0===m;if(y&&(h!==Aa||u!==Aa)){var b,S=parseFloat(u)*Il,M=Math.sin(S),E=Math.cos(S);S=parseFloat(h)*Il,b=Math.cos(S),o=Ux(v,o,M*b*-y),a=Ux(v,a,-Math.sin(S)*-y),c=Ux(v,c,E*b*-y+y)}_!==fd&&(w+="perspective("+_+Da),(r||s)&&(w+="translate("+r+"%, "+s+"%) "),(x||o!==fd||a!==fd||c!==fd)&&(w+=c!==fd||x?"translate3d("+o+", "+a+", "+c+") ":"translate("+o+", "+a+Da),l!==Aa&&(w+="rotate("+l+Da),u!==Aa&&(w+="rotateY("+u+Da),h!==Aa&&(w+="rotateX("+h+Da),(d!==Aa||f!==Aa)&&(w+="skew("+d+", "+f+Da),(1!==p||1!==g)&&(w+="scale("+p+", "+g+Da),v.style[Kt]=w||"translate(0, 0)"},I7=function(e,t){var x,S,M,E,b,i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,c=i.rotation,l=i.skewX,u=i.skewY,h=i.scaleX,d=i.scaleY,f=i.target,p=i.xOrigin,g=i.yOrigin,_=i.xOffset,m=i.yOffset,v=i.forceCSS,y=parseFloat(o),w=parseFloat(a);c=parseFloat(c),l=parseFloat(l),(u=parseFloat(u))&&(l+=u=parseFloat(u),c+=u),c||l?(c*=Il,l*=Il,x=Math.cos(c)*h,S=Math.sin(c)*h,M=Math.sin(c-l)*-d,E=Math.cos(c-l)*d,l&&(u*=Il,b=Math.tan(l-u),M*=b=Math.sqrt(1+b*b),E*=b,u&&(b=Math.tan(u),x*=b=Math.sqrt(1+b*b),S*=b)),x=hn(x),S=hn(S),M=hn(M),E=hn(E)):(x=h,E=d,S=M=0),(y&&!~(o+"").indexOf("px")||w&&!~(a+"").indexOf("px"))&&(y=Fo(f,"x",o,"px"),w=Fo(f,"y",a,"px")),(p||g||_||m)&&(y=hn(y+p-(p*x+g*M)+_),w=hn(w+g-(p*S+g*E)+m)),(r||s)&&(b=f.getBBox(),y=hn(y+r/100*b.width),w=hn(w+s/100*b.height)),f.setAttribute("transform",b="matrix("+x+","+S+","+M+","+E+","+y+","+w+")"),v&&(f.style[Kt]=b)},R7=function(e,t,i,r,s){var h,d,o=360,a=Fn(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?Ta:1)-r,u=r+l+"deg";return a&&("short"===(h=s.split("_")[1])&&(l%=o)!=l%180&&(l+=l<0?o:-o),"cw"===h&&l<0?l=(l+o*RL)%o-~~(l/o)*o:"ccw"===h&&l>0&&(l=(l-o*RL)%o-~~(l/o)*o)),e._pt=d=new Ii(e._pt,t,i,r,l,p7),d.e=u,d.u="deg",e._props.push(i),d},XL=function(e,t){for(var i in t)e[i]=t[i];return e},P7=function(e,t,i){var a,c,l,u,h,d,p,r=XL({},i._gsap),o=i.style;for(c in r.svg?(l=i.getAttribute("transform"),i.setAttribute("transform",""),o[Kt]=t,a=dd(i,1),ud(i,Kt),i.setAttribute("transform",l)):(l=getComputedStyle(i)[Kt],o[Kt]=t,a=dd(i,1),o[Kt]=l),js)(l=r[c])!==(u=a[c])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(c)<0&&(h=ei(l)!==(p=ei(u))?Fo(i,c,l,p):parseFloat(l),d=parseFloat(u),e._pt=new Ii(e._pt,a,c,h,d-h,Px),e._pt.u=p||0,e._props.push(c));XL(a,r)};Ai("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",r="Bottom",s="Left",o=(e<3?[t,i,r,s]:[t+s,t+i,r+i,r+s]).map(function(a){return e<2?n+a:"border"+a+n});zm[e>1?"border"+n:n]=function(a,c,l,u,h){var d,f;if(arguments.length<4)return d=o.map(function(p){return $s(a,p,l)}),5===(f=d.join(" ")).split(d[0]).length?d[0]:f;d=(u+"").split(" "),f={},o.forEach(function(p,g){return f[p]=d[g]=d[g]||d[(g-1)/2|0]}),a.init(c,f,h)}});var qL={name:"css",register:Nx,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,s){var l,u,h,d,f,p,g,_,m,v,y,w,x,S,M,E,o=this._props,a=e.style,c=i.vars.startAt;for(g in Dx||Nx(),this.styles=this.styles||OL(e),E=this.styles.props,this.tween=i,t)if("autoRound"!==g&&(u=t[g],!$i[g]||!wL(g,t,i,r,e,s)))if(p=zm[g],"function"==(f=typeof u)&&(f=typeof(u=u.call(i,r,e,s))),"string"===f&&~u.indexOf("random(")&&(u=rd(u)),p)p(this,e,g,u,i)&&(M=1);else if("--"===g.substr(0,2))l=(getComputedStyle(e).getPropertyValue(g)+"").trim(),u+="",Po.lastIndex=0,Po.test(l)||(_=ei(l),m=ei(u)),m?_!==m&&(l=Fo(e,g,l,m)+m):_&&(u+=_),this.add(a,"setProperty",l,u,r,s,0,0,g),o.push(g),E.push(g,0,a[g]);else if("undefined"!==f){if(c&&g in c?(l="function"==typeof c[g]?c[g].call(i,r,e,s):c[g],Fn(l)&&~l.indexOf("random(")&&(l=rd(l)),ei(l+"")||(l+=Wi.units[g]||ei($s(e,g))||""),"="===(l+"").charAt(1)&&(l=$s(e,g))):l=$s(e,g),d=parseFloat(l),(v="string"===f&&"="===u.charAt(1)&&u.substr(0,2))&&(u=u.substr(2)),h=parseFloat(u),g in ps&&("autoAlpha"===g&&(1===d&&"hidden"===$s(e,"visibility")&&h&&(d=0),E.push("visibility",0,a.visibility),Oo(this,a,"visibility",d?"inherit":"hidden",h?"inherit":"hidden",!h)),"scale"!==g&&"transform"!==g&&~(g=ps[g]).indexOf(",")&&(g=g.split(",")[0])),y=g in js)if(this.styles.save(g),w||((x=e._gsap).renderTransform&&!t.parseTransform||dd(e,t.parseTransform),S=!1!==t.smoothOrigin&&x.smooth,(w=this._pt=new Ii(this._pt,a,Kt,0,1,x.renderTransform,x,0,-1)).dep=1),"scale"===g)this._pt=new Ii(this._pt,x,"scaleY",x.scaleY,(v?Sl(x.scaleY,v+h):h)-x.scaleY||0,Px),this._pt.u=0,o.push("scaleY",g),g+="X";else{if("transformOrigin"===g){E.push(Br,0,a[Br]),u=T7(u),x.svg?kx(e,u,0,S,0,this):((m=parseFloat(u.split(" ")[2])||0)!==x.zOrigin&&Oo(this,x,"zOrigin",x.zOrigin,m),Oo(this,a,g,Hm(l),Hm(u)));continue}if("svgOrigin"===g){kx(e,u,1,S,0,this);continue}if(g in GL){R7(this,x,g,d,v?Sl(d,v+u):u);continue}if("smoothOrigin"===g){Oo(this,x,"smooth",x.smooth,u);continue}if("force3D"===g){x[g]=u;continue}if("transform"===g){P7(this,u,e);continue}}else g in a||(g=Pl(g)||g);if(y||(h||0===h)&&(d||0===d)&&!f7.test(u)&&g in a)h||(h=0),(_=(l+"").substr((d+"").length))!==(m=ei(u)||(g in Wi.units?Wi.units[g]:_))&&(d=Fo(e,g,l,m)),this._pt=new Ii(this._pt,y?x:a,g,d,(v?Sl(d,v+h):h)-d,y||"px"!==m&&"zIndex"!==g||!1===t.autoRound?Px:g7),this._pt.u=m||0,_!==m&&"%"!==m&&(this._pt.b=l,this._pt.r=m7);else if(g in a)C7.call(this,e,g,l,v?v+u:u);else if(g in e)this.add(e,g,l||e[g],v?v+u:u,r,s);else if("parseTransform"!==g){ox(g,u);continue}y||(g in a?E.push(g,0,a[g]):E.push(g,1,l||e[g])),o.push(g)}M&&CL(this)},render:function(e,t){if(t.tween._time||!Ix())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:$s,aliases:ps,getSetter:function(e,t,i){var r=ps[t];return r&&r.indexOf(",")<0&&(t=r),t in js&&t!==Br&&(e._gsap.x||$s(e,"x"))?i&&IL===i?"scale"===t?w7:y7:(IL=i||{})&&("scale"===t?x7:b7):e.style&&!ex(e.style[t])?_7:~t.indexOf("-")?v7:Sx(e,t)},core:{_removeProperty:ud,_getMatrix:Fx}};Ri.utils.checkPrefix=Pl,Ri.core.getStyleSaver=OL,function(n,e,t,i){var r=Ai(n+","+e+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(s){js[s]=1});Ai(e,function(s){Wi.units[s]="deg",GL[s]=1}),ps[r[13]]=n+","+e,Ai("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(s){var o=s.split(":");ps[o[1]]=r[o[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),Ai("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Wi.units[n]="px"}),Ri.registerPlugin(qL);var pd=Ri.registerPlugin(qL)||Ri;function YL(n,e,t,i,r,s,o){try{var a=n[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(i,r)}function Ll(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(c){YL(s,i,r,o,a,"next",c)}function a(c){YL(s,i,r,o,a,"throw",c)}o(void 0)})}}const KL=1,JL=2,Xs=3,Gm=0,eY=1,tY=2,Ys=0,sN=1,oN=2,aN=3,Hx=4,cN=5,Bo=301,Ia=302,md=306,Ra=1e3,ti=1001,dn=1003,Xt=1006,Zs=1008,Vo=1009,zo=1014,Ks=1015,vd=1016,Pa=1020,xr=1023,La=1026,kl=1027,yd=2300,Ul=2301,Na=3001,wt="srgb",Rn="srgb-linear",Ym="display-p3",GN="300 es",Js=2e3;class ka{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const ni=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const Ua=Math.PI/180,zl=180/Math.PI;function qi(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(ni[255&n]+ni[n>>8&255]+ni[n>>16&255]+ni[n>>24&255]+"-"+ni[255&e]+ni[e>>8&255]+"-"+ni[e>>16&15|64]+ni[e>>24&255]+"-"+ni[63&t|128]+ni[t>>8&255]+"-"+ni[t>>16&255]+ni[t>>24&255]+ni[255&i]+ni[i>>8&255]+ni[i>>16&255]+ni[i>>24&255]).toLowerCase()}function rn(n,e,t){return Math.max(e,Math.min(t,n))}function tb(n,e){return(n%e+e)%e}function wd(n,e,t){return(1-t)*n+t*e}function nb(n){return 0==(n&n-1)&&0!==n}function jN(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Jm(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Pi(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function it(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const Hl_DEG2RAD=Ua,Hl_degToRad=function kY(n){return n*Ua},Hl_radToDeg=function UY(n){return n*zl};class J{constructor(e=0,t=0){J.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(rn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class at{constructor(e,t,i,r,s,o,a,c,l){at.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,c,l)}set(e,t,i,r,s,o,a,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=i,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],l=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],g=r[0],_=r[3],m=r[6],v=r[1],y=r[4],w=r[7],x=r[2],S=r[5],M=r[8];return s[0]=o*g+a*v+c*x,s[3]=o*_+a*y+c*S,s[6]=o*m+a*w+c*M,s[1]=l*g+u*v+h*x,s[4]=l*_+u*y+h*S,s[7]=l*m+u*w+h*M,s[2]=d*g+f*v+p*x,s[5]=d*_+f*y+p*S,s[8]=d*m+f*w+p*M,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-i*s*u+i*a*c+r*s*l-r*o*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=u*o-a*l,d=a*c-u*s,f=l*s-o*c,p=t*h+i*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=h*g,e[1]=(r*l-u*i)*g,e[2]=(a*i-r*o)*g,e[3]=d*g,e[4]=(u*t-r*c)*g,e[5]=(r*s-a*t)*g,e[6]=f*g,e[7]=(i*c-l*t)*g,e[8]=(o*t-i*s)*g,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(ib.makeScale(e,t)),this}rotate(e){return this.premultiply(ib.makeRotation(-e)),this}translate(e,t){return this.premultiply(ib.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const ib=new at;function $N(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const VY={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Gl(n,e){return new VY[n](e)}function xd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function zY(){const n=xd("canvas");return n.style.display="block",n}const XN={};function bd(n){n in XN||(XN[n]=!0,console.warn(n))}function Wl(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function rb(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const HY=(new at).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),GY=(new at).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),$Y={[Rn]:n=>n,[wt]:n=>n.convertSRGBToLinear(),[Ym]:function WY(n){return n.convertSRGBToLinear().applyMatrix3(GY)}},XY={[Rn]:n=>n,[wt]:n=>n.convertLinearToSRGB(),[Ym]:function jY(n){return n.applyMatrix3(HY).convertLinearToSRGB()}},Yi={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return Rn},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(!1===this.enabled||e===t||!e||!t)return n;const i=$Y[e],r=XY[t];if(void 0===i||void 0===r)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}};let jl;class qN{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===jl&&(jl=xd("canvas")),jl.width=e.width,jl.height=e.height;const i=jl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=jl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=xd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Wl(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Wl(t[i]/255)):Wl(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let qY=0;class $l{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:qY++}),this.uuid=qi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(sb(r[o].isDataTexture?r[o].image:r[o]))}else s=sb(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function sb(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?qN.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let YY=0,br=(()=>{class n extends ka{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=ti,s=ti,o=Xt,a=Zs,c=xr,l=Vo,u=n.DEFAULT_ANISOTROPY,h=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:YY++}),this.uuid=qi(),this.name="",this.source=new $l(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new J(0,0),this.repeat=new J(1,1),this.center=new J(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new at,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof h?this.colorSpace=h:(bd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===Na?wt:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ra:t.x=t.x-Math.floor(t.x);break;case ti:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ra:t.y=t.y-Math.floor(t.y);break;case ti:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return bd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===wt?Na:3e3}set encoding(t){bd("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Na?wt:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class It{constructor(e=0,t=0,i=0,r=1){It.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,l=c[0],u=c[4],h=c[8],d=c[1],f=c[5],p=c[9],g=c[2],_=c[6],m=c[10];if(Math.abs(u-d)<.01&&Math.abs(h-g)<.01&&Math.abs(p-_)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+g)<.1&&Math.abs(p+_)<.1&&Math.abs(l+f+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(l+1)/2,w=(f+1)/2,x=(m+1)/2,S=(u+d)/4,M=(h+g)/4,E=(p+_)/4;return y>w&&y>x?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=S/i,s=M/i):w>x?w<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(w),i=S/r,s=E/r):x<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(x),i=M/s,r=E/s),this.set(i,r,s,t),this}let v=Math.sqrt((_-p)*(_-p)+(h-g)*(h-g)+(d-u)*(d-u));return Math.abs(v)<.001&&(v=1),this.x=(_-p)/v,this.y=(h-g)/v,this.z=(d-u)/v,this.w=Math.acos((l+f+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ZY extends ka{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new It(0,0,e,t),this.scissorTest=!1,this.viewport=new It(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(bd("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Na?wt:""),this.texture=new br(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:Xt,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new $l(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ba extends ZY{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class ob extends br{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=dn,this.minFilter=dn,this.wrapR=ti,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class YN extends br{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=dn,this.minFilter=dn,this.wrapR=ti,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Hn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],l=i[r+1],u=i[r+2],h=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],g=s[o+3];if(0===a)return e[t+0]=c,e[t+1]=l,e[t+2]=u,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=g);if(h!==g||c!==d||l!==f||u!==p){let _=1-a;const m=c*d+l*f+u*p+h*g,v=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){const x=Math.sqrt(y),S=Math.atan2(x,m*v);_=Math.sin(_*S)/x,a=Math.sin(a*S)/x}const w=a*v;if(c=c*_+d*w,l=l*_+f*w,u=u*_+p*w,h=h*_+g*w,_===1-a){const x=1/Math.sqrt(c*c+l*l+u*u+h*h);c*=x,l*=x,u*=x,h*=x}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],c=i[r+1],l=i[r+2],u=i[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+c*f-l*d,e[t+1]=c*p+u*d+l*h-a*f,e[t+2]=l*p+u*f+a*d-c*h,e[t+3]=u*p-a*h-c*d-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(i/2),u=a(r/2),h=a(s/2),d=c(i/2),f=c(r/2),p=c(s/2);switch(o){case"XYZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"YZX":this._x=d*u*h+l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h-d*f*p;break;case"XZY":this._x=d*u*h-l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],h=t[10],d=i+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-c)*f,this._y=(s-l)*f,this._z=(o-r)*f}else if(i>a&&i>h){const f=2*Math.sqrt(1+i-a-h);this._w=(u-c)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+l)/f}else if(a>h){const f=2*Math.sqrt(1+a-i-h);this._w=(s-l)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(c+u)/f}else{const f=2*Math.sqrt(1+h-i-a);this._w=(o-r)/f,this._x=(s+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(rn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=i*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-i*l,this._z=s*u+o*l+i*c-r*a,this._w=o*u-i*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(c),u=Math.atan2(l,a),h=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=o*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class A{constructor(e=0,t=0,i=0){A.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ZN.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ZN.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=c*t+o*r-a*i,u=c*i+a*t-s*r,h=c*r+s*i-o*t,d=-s*t-o*i-a*r;return this.x=l*c+d*-s+u*-a-h*-o,this.y=u*c+d*-o+h*-s-l*-a,this.z=h*c+d*-a+l*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return ab.copy(this).projectOnVector(e),this.sub(ab)}reflect(e){return this.sub(ab.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(rn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ab=new A,ZN=new Hn;class _s{constructor(e=new A(1/0,1/0,1/0),t=new A(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(eo.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(eo.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=eo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),Xl.copy(e.boundingBox),Xl.applyMatrix4(e.matrixWorld),this.union(Xl);else{const r=e.geometry;if(void 0!==r)if(t&&void 0!==r.attributes&&void 0!==r.attributes.position){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)eo.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(eo)}else null===r.boundingBox&&r.computeBoundingBox(),Xl.copy(r.boundingBox),Xl.applyMatrix4(e.matrixWorld),this.union(Xl)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,eo),eo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Md),Qm.subVectors(this.max,Md),ql.subVectors(e.a,Md),Yl.subVectors(e.b,Md),Zl.subVectors(e.c,Md),Ho.subVectors(Yl,ql),Go.subVectors(Zl,Yl),Va.subVectors(ql,Zl);let t=[0,-Ho.z,Ho.y,0,-Go.z,Go.y,0,-Va.z,Va.y,Ho.z,0,-Ho.x,Go.z,0,-Go.x,Va.z,0,-Va.x,-Ho.y,Ho.x,0,-Go.y,Go.x,0,-Va.y,Va.x,0];return!(!cb(t,ql,Yl,Zl,Qm)||(t=[1,0,0,0,1,0,0,0,1],!cb(t,ql,Yl,Zl,Qm)))&&(eg.crossVectors(Ho,Go),t=[eg.x,eg.y,eg.z],cb(t,ql,Yl,Zl,Qm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,eo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(eo).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Qs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Qs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Qs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Qs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Qs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Qs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Qs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Qs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Qs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Qs=[new A,new A,new A,new A,new A,new A,new A,new A],eo=new A,Xl=new _s,ql=new A,Yl=new A,Zl=new A,Ho=new A,Go=new A,Va=new A,Md=new A,Qm=new A,eg=new A,za=new A;function cb(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){za.fromArray(n,s);const a=r.x*Math.abs(za.x)+r.y*Math.abs(za.y)+r.z*Math.abs(za.z),c=e.dot(za),l=t.dot(za),u=i.dot(za);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}const KY=new _s,Sd=new A,lb=new A;class Vr{constructor(e=new A,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):KY.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Sd.subVectors(e,this.center);const t=Sd.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Sd,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(lb.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Sd.copy(e.center).add(lb)),this.expandByPoint(Sd.copy(e.center).sub(lb))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const to=new A,ub=new A,tg=new A,Wo=new A,hb=new A,ng=new A,db=new A;class Ha{constructor(e=new A,t=new A(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,to)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=to.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(to.copy(this.origin).addScaledVector(this.direction,t),to.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){ub.copy(e).add(t).multiplyScalar(.5),tg.copy(t).sub(e).normalize(),Wo.copy(this.origin).sub(ub);const s=.5*e.distanceTo(t),o=-this.direction.dot(tg),a=Wo.dot(this.direction),c=-Wo.dot(tg),l=Wo.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*c-a,d=o*a-c,p=s*u,h>=0)if(d>=-p)if(d<=p){const g=1/u;h*=g,d*=g,f=h*(h+o*d+2*a)+d*(o*h+d+2*c)+l}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l):d<=p?(h=0,d=Math.min(Math.max(-s,-c),s),f=d*(d+2*c)+l):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(ub).addScaledVector(tg,d),f}intersectSphere(e,t){to.subVectors(e.center,this.origin);const i=to.dot(this.direction),r=to.dot(to)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,c=i+o;return c<0?null:this.at(a<0?c:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c;const l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,c=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,c=(e.min.z-d.z)*h),i>c||a>r)||((a>i||i!=i)&&(i=a),(c<r||r!=r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,to)}intersectTriangle(e,t,i,r,s){hb.subVectors(t,e),ng.subVectors(i,e),db.crossVectors(hb,ng);let a,o=this.direction.dot(db);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Wo.subVectors(this.origin,e);const c=a*this.direction.dot(ng.crossVectors(Wo,ng));if(c<0)return null;const l=a*this.direction.dot(hb.cross(Wo));if(l<0||c+l>o)return null;const u=-a*Wo.dot(db);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ve{constructor(e,t,i,r,s,o,a,c,l,u,h,d,f,p,g,_){Ve.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,c,l,u,h,d,f,p,g,_)}set(e,t,i,r,s,o,a,c,l,u,h,d,f,p,g,_){const m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=c,m[2]=l,m[6]=u,m[10]=h,m[14]=d,m[3]=f,m[7]=p,m[11]=g,m[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ve).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Kl.setFromMatrixColumn(e,0).length(),s=1/Kl.setFromMatrixColumn(e,1).length(),o=1/Kl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const d=o*u,f=o*h,p=a*u,g=a*h;t[0]=c*u,t[4]=-c*h,t[8]=l,t[1]=f+p*l,t[5]=d-g*l,t[9]=-a*c,t[2]=g-d*l,t[6]=p+f*l,t[10]=o*c}else if("YXZ"===e.order){const d=c*u,f=c*h,p=l*u,g=l*h;t[0]=d+g*a,t[4]=p*a-f,t[8]=o*l,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=g+d*a,t[10]=o*c}else if("ZXY"===e.order){const d=c*u,f=c*h,p=l*u,g=l*h;t[0]=d-g*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=g-d*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if("ZYX"===e.order){const d=o*u,f=o*h,p=a*u,g=a*h;t[0]=c*u,t[4]=p*l-f,t[8]=d*l+g,t[1]=c*h,t[5]=g*l+d,t[9]=f*l-p,t[2]=-l,t[6]=a*c,t[10]=o*c}else if("YZX"===e.order){const d=o*c,f=o*l,p=a*c,g=a*l;t[0]=c*u,t[4]=g-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=f*h+p,t[10]=d-g*h}else if("XZY"===e.order){const d=o*c,f=o*l,p=a*c,g=a*l;t[0]=c*u,t[4]=-h,t[8]=l*u,t[1]=d*h+g,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=g*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(JY,e,QY)}lookAt(e,t,i){const r=this.elements;return Zi.subVectors(e,t),0===Zi.lengthSq()&&(Zi.z=1),Zi.normalize(),jo.crossVectors(i,Zi),0===jo.lengthSq()&&(1===Math.abs(i.z)?Zi.x+=1e-4:Zi.z+=1e-4,Zi.normalize(),jo.crossVectors(i,Zi)),jo.normalize(),ig.crossVectors(Zi,jo),r[0]=jo.x,r[4]=ig.x,r[8]=Zi.x,r[1]=jo.y,r[5]=ig.y,r[9]=Zi.y,r[2]=jo.z,r[6]=ig.z,r[10]=Zi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],l=i[12],u=i[1],h=i[5],d=i[9],f=i[13],p=i[2],g=i[6],_=i[10],m=i[14],v=i[3],y=i[7],w=i[11],x=i[15],S=r[0],M=r[4],E=r[8],b=r[12],C=r[1],O=r[5],B=r[9],L=r[13],F=r[2],k=r[6],W=r[10],H=r[14],X=r[3],Q=r[7],te=r[11],U=r[15];return s[0]=o*S+a*C+c*F+l*X,s[4]=o*M+a*O+c*k+l*Q,s[8]=o*E+a*B+c*W+l*te,s[12]=o*b+a*L+c*H+l*U,s[1]=u*S+h*C+d*F+f*X,s[5]=u*M+h*O+d*k+f*Q,s[9]=u*E+h*B+d*W+f*te,s[13]=u*b+h*L+d*H+f*U,s[2]=p*S+g*C+_*F+m*X,s[6]=p*M+g*O+_*k+m*Q,s[10]=p*E+g*B+_*W+m*te,s[14]=p*b+g*L+_*H+m*U,s[3]=v*S+y*C+w*F+x*X,s[7]=v*M+y*O+w*k+x*Q,s[11]=v*E+y*B+w*W+x*te,s[15]=v*b+y*L+w*H+x*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],h=e[6],d=e[10],f=e[14];return e[3]*(+s*c*h-r*l*h-s*a*d+i*l*d+r*a*f-i*c*f)+e[7]*(+t*c*f-t*l*d+s*o*d-r*o*f+r*l*u-s*c*u)+e[11]*(+t*l*h-t*a*f-s*o*h+i*o*f+s*a*u-i*l*u)+e[15]*(-r*a*u-t*c*h+t*a*d+r*o*h-i*o*d+i*c*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],_=e[14],m=e[15],v=h*_*l-g*d*l+g*c*f-a*_*f-h*c*m+a*d*m,y=p*d*l-u*_*l-p*c*f+o*_*f+u*c*m-o*d*m,w=u*g*l-p*h*l+p*a*f-o*g*f-u*a*m+o*h*m,x=p*h*c-u*g*c-p*a*d+o*g*d+u*a*_-o*h*_,S=t*v+i*y+r*w+s*x;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/S;return e[0]=v*M,e[1]=(g*d*s-h*_*s-g*r*f+i*_*f+h*r*m-i*d*m)*M,e[2]=(a*_*s-g*c*s+g*r*l-i*_*l-a*r*m+i*c*m)*M,e[3]=(h*c*s-a*d*s-h*r*l+i*d*l+a*r*f-i*c*f)*M,e[4]=y*M,e[5]=(u*_*s-p*d*s+p*r*f-t*_*f-u*r*m+t*d*m)*M,e[6]=(p*c*s-o*_*s-p*r*l+t*_*l+o*r*m-t*c*m)*M,e[7]=(o*d*s-u*c*s+u*r*l-t*d*l-o*r*f+t*c*f)*M,e[8]=w*M,e[9]=(p*h*s-u*g*s-p*i*f+t*g*f+u*i*m-t*h*m)*M,e[10]=(o*g*s-p*a*s+p*i*l-t*g*l-o*i*m+t*a*m)*M,e[11]=(u*a*s-o*h*s-u*i*l+t*h*l+o*i*f-t*a*f)*M,e[12]=x*M,e[13]=(u*g*r-p*h*r+p*i*d-t*g*d-u*i*_+t*h*_)*M,e[14]=(p*a*r-o*g*r-p*i*c+t*g*c+o*i*_-t*a*_)*M,e[15]=(o*h*r-u*a*r+u*i*c-t*h*c-o*i*d+t*a*d)*M,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+i,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+i,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,h=a+a,d=s*l,f=s*u,p=s*h,g=o*u,_=o*h,m=a*h,v=c*l,y=c*u,w=c*h,x=i.x,S=i.y,M=i.z;return r[0]=(1-(g+m))*x,r[1]=(f+w)*x,r[2]=(p-y)*x,r[3]=0,r[4]=(f-w)*S,r[5]=(1-(d+m))*S,r[6]=(_+v)*S,r[7]=0,r[8]=(p+y)*M,r[9]=(_-v)*M,r[10]=(1-(d+g))*M,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Kl.set(r[0],r[1],r[2]).length();const o=Kl.set(r[4],r[5],r[6]).length(),a=Kl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],zr.copy(this);const l=1/s,u=1/o,h=1/a;return zr.elements[0]*=l,zr.elements[1]*=l,zr.elements[2]*=l,zr.elements[4]*=u,zr.elements[5]*=u,zr.elements[6]*=u,zr.elements[8]*=h,zr.elements[9]*=h,zr.elements[10]*=h,t.setFromRotationMatrix(zr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Js){const c=this.elements,l=2*s/(t-e),u=2*s/(i-r),h=(t+e)/(t-e),d=(i+r)/(i-r);let f,p;if(a===Js)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-o/(o-s),p=-o*s/(o-s)}return c[0]=l,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=u,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=f,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Js){const c=this.elements,l=1/(t-e),u=1/(i-r),h=1/(o-s),d=(t+e)*l,f=(i+r)*u;let p,g;if(a===Js)p=(o+s)*h,g=-2*h;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=s*h,g=-1*h}return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-f,c[2]=0,c[6]=0,c[10]=g,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Kl=new A,zr=new Ve,JY=new A(0,0,0),QY=new A(1,1,1),jo=new A,ig=new A,Zi=new A,KN=new Ve,JN=new Hn;let eZ=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(rn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-rn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(c,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(rn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-rn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(rn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(c,p));break;case"XZY":this._z=Math.asin(-rn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return KN.makeRotationFromQuaternion(t),this.setFromRotationMatrix(KN,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return JN.setFromEuler(this),this.setFromQuaternion(JN,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class fb{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let tZ=0;const QN=new A,Jl=new Hn,no=new Ve,rg=new A,Ed=new A,nZ=new A,iZ=new Hn,eO=new A(1,0,0),tO=new A(0,1,0),nO=new A(0,0,1),rZ={type:"added"},sZ={type:"removed"};let sn=(()=>{class n extends ka{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:tZ++}),this.uuid=qi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new A,i=new eZ,r=new Hn,s=new A(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ve},normalMatrix:{value:new at}}),this.matrix=new Ve,this.matrixWorld=new Ve,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new fb,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Jl.setFromAxisAngle(t,i),this.quaternion.multiply(Jl),this}rotateOnWorldAxis(t,i){return Jl.setFromAxisAngle(t,i),this.quaternion.premultiply(Jl),this}rotateX(t){return this.rotateOnAxis(eO,t)}rotateY(t){return this.rotateOnAxis(tO,t)}rotateZ(t){return this.rotateOnAxis(nO,t)}translateOnAxis(t,i){return QN.copy(t).applyQuaternion(this.quaternion),this.position.add(QN.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(eO,t)}translateY(t){return this.translateOnAxis(tO,t)}translateZ(t){return this.translateOnAxis(nO,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(no.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?rg.copy(t):rg.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),Ed.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?no.lookAt(Ed,rg,this.up):no.lookAt(rg,Ed,this.up),this.quaternion.setFromRotationMatrix(no),s&&(no.extractRotation(s.matrixWorld),Jl.setFromRotationMatrix(no),this.quaternion.premultiply(Jl.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(rZ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(sZ)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),no.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),no.multiply(t.parent.matrixWorld)),t.applyMatrix4(no),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ed,t,nZ),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ed,iZ,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const c=s[o];!0===c.matrixWorldAutoUpdate&&c.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(c,l){return void 0===c[l.uuid]&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){const l=c.shapes;if(Array.isArray(l))for(let u=0,h=l.length;u<h;u++)o(t.shapes,l[u]);else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++)s.animations.push(o(t.animations,this.animations[c]))}if(i){const c=a(t.geometries),l=a(t.materials),u=a(t.textures),h=a(t.images),d=a(t.shapes),f=a(t.skeletons),p=a(t.animations),g=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),h.length>0&&(r.images=h),d.length>0&&(r.shapes=d),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),g.length>0&&(r.nodes=g)}return r.object=s,r;function a(c){const l=[];for(const u in c){const h=c[u];delete h.metadata,l.push(h)}return l}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new A(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Hr=new A,io=new A,pb=new A,ro=new A,Ql=new A,eu=new A,iO=new A,mb=new A,gb=new A,_b=new A;let sg=!1;class Ki{constructor(e=new A,t=new A,i=new A){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Hr.subVectors(e,t),r.cross(Hr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Hr.subVectors(r,t),io.subVectors(i,t),pb.subVectors(e,t);const o=Hr.dot(Hr),a=Hr.dot(io),c=Hr.dot(pb),l=io.dot(io),u=io.dot(pb),h=o*l-a*a;if(0===h)return s.set(-2,-1,-1);const d=1/h,f=(l*c-a*u)*d,p=(o*u-a*c)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,ro),ro.x>=0&&ro.y>=0&&ro.x+ro.y<=1}static getUV(e,t,i,r,s,o,a,c){return!1===sg&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),sg=!0),this.getInterpolation(e,t,i,r,s,o,a,c)}static getInterpolation(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,ro),c.setScalar(0),c.addScaledVector(s,ro.x),c.addScaledVector(o,ro.y),c.addScaledVector(a,ro.z),c}static isFrontFacing(e,t,i,r){return Hr.subVectors(i,t),io.subVectors(e,t),Hr.cross(io).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Hr.subVectors(this.c,this.b),io.subVectors(this.a,this.b),.5*Hr.cross(io).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ki.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ki.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===sg&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),sg=!0),Ki.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Ki.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Ki.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ki.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Ql.subVectors(r,i),eu.subVectors(s,i),mb.subVectors(e,i);const c=Ql.dot(mb),l=eu.dot(mb);if(c<=0&&l<=0)return t.copy(i);gb.subVectors(e,r);const u=Ql.dot(gb),h=eu.dot(gb);if(u>=0&&h<=u)return t.copy(r);const d=c*h-u*l;if(d<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(i).addScaledVector(Ql,o);_b.subVectors(e,s);const f=Ql.dot(_b),p=eu.dot(_b);if(p>=0&&f<=p)return t.copy(s);const g=f*l-c*p;if(g<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(i).addScaledVector(eu,a);const _=u*p-f*h;if(_<=0&&h-u>=0&&f-p>=0)return iO.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(iO,a);const m=1/(_+g+d);return o=g*m,a=d*m,t.copy(i).addScaledVector(Ql,o).addScaledVector(eu,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let oZ=0;class Li extends ka{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:oZ++}),this.uuid=qi(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const rO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Gr={h:0,s:0,l:0},og={h:0,s:0,l:0};function vb(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class Y{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=wt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Yi.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Yi.workingColorSpace){return this.r=e,this.g=t,this.b=i,Yi.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Yi.workingColorSpace){if(e=tb(e,1),t=rn(t,0,1),i=rn(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=vb(o,s,e+1/3),this.g=vb(o,s,e),this.b=vb(o,s,e-1/3)}return Yi.toWorkingColorSpace(this,r),this}setStyle(e,t=wt){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=wt){const i=rO[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Wl(e.r),this.g=Wl(e.g),this.b=Wl(e.b),this}copyLinearToSRGB(e){return this.r=rb(e.r),this.g=rb(e.g),this.b=rb(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=wt){return Yi.fromWorkingColorSpace(ii.copy(this),e),65536*Math.round(rn(255*ii.r,0,255))+256*Math.round(rn(255*ii.g,0,255))+Math.round(rn(255*ii.b,0,255))}getHexString(e=wt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Yi.workingColorSpace){Yi.fromWorkingColorSpace(ii.copy(this),t);const i=ii.r,r=ii.g,s=ii.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let c,l;const u=(a+o)/2;if(a===o)c=0,l=0;else{const h=o-a;switch(l=u<=.5?h/(o+a):h/(2-o-a),o){case i:c=(r-s)/h+(r<s?6:0);break;case r:c=(s-i)/h+2;break;case s:c=(i-r)/h+4}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=Yi.workingColorSpace){return Yi.fromWorkingColorSpace(ii.copy(this),t),e.r=ii.r,e.g=ii.g,e.b=ii.b,e}getStyle(e=wt){Yi.fromWorkingColorSpace(ii.copy(this),e);const t=ii.r,i=ii.g,r=ii.b;return e!==wt?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(Gr),Gr.h+=e,Gr.s+=t,Gr.l+=i,this.setHSL(Gr.h,Gr.s,Gr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Gr),e.getHSL(og);const i=wd(Gr.h,og.h,t),r=wd(Gr.s,og.s,t),s=wd(Gr.l,og.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ii=new Y;Y.NAMES=rO;class wn extends Li{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Y(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Gm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const xn=new A,ag=new J;class jt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=Ks,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)ag.fromBufferAttribute(this,t),ag.applyMatrix3(e),this.setXY(t,ag.x,ag.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)xn.fromBufferAttribute(this,t),xn.applyMatrix3(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)xn.fromBufferAttribute(this,t),xn.applyMatrix4(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)xn.fromBufferAttribute(this,t),xn.applyNormalMatrix(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)xn.fromBufferAttribute(this,t),xn.transformDirection(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Pi(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=it(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Pi(t,this.array)),t}setX(e,t){return this.normalized&&(t=it(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Pi(t,this.array)),t}setY(e,t){return this.normalized&&(t=it(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Pi(t,this.array)),t}setZ(e,t){return this.normalized&&(t=it(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Pi(t,this.array)),t}setW(e,t){return this.normalized&&(t=it(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=it(t,this.array),i=it(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=it(t,this.array),i=it(i,this.array),r=it(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=it(t,this.array),i=it(i,this.array),r=it(r,this.array),s=it(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class sO extends jt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class oO extends jt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Re extends jt{constructor(e,t,i){super(new Float32Array(e),t,i)}}let cZ=0;const Mr=new Ve,yb=new sn,tu=new A,Ji=new _s,Td=new _s,kn=new A;class et extends ka{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:cZ++}),this.uuid=qi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new($N(e)?oO:sO)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new at).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Mr.makeRotationFromQuaternion(e),this.applyMatrix4(Mr),this}rotateX(e){return Mr.makeRotationX(e),this.applyMatrix4(Mr),this}rotateY(e){return Mr.makeRotationY(e),this.applyMatrix4(Mr),this}rotateZ(e){return Mr.makeRotationZ(e),this.applyMatrix4(Mr),this}translate(e,t,i){return Mr.makeTranslation(e,t,i),this.applyMatrix4(Mr),this}scale(e,t,i){return Mr.makeScale(e,t,i),this.applyMatrix4(Mr),this}lookAt(e){return yb.lookAt(e),yb.updateMatrix(),this.applyMatrix4(yb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(tu).negate(),this.translate(tu.x,tu.y,tu.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Re(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new _s);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new A(-1/0,-1/0,-1/0),new A(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Ji.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(kn.addVectors(this.boundingBox.min,Ji.min),this.boundingBox.expandByPoint(kn),kn.addVectors(this.boundingBox.max,Ji.max),this.boundingBox.expandByPoint(kn)):(this.boundingBox.expandByPoint(Ji.min),this.boundingBox.expandByPoint(Ji.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Vr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new A,1/0);if(e){const i=this.boundingSphere.center;if(Ji.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Td.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(kn.addVectors(Ji.min,Td.min),Ji.expandByPoint(kn),kn.addVectors(Ji.max,Td.max),Ji.expandByPoint(kn)):(Ji.expandByPoint(Td.min),Ji.expandByPoint(Td.max));Ji.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)kn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(kn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)kn.fromBufferAttribute(a,l),c&&(tu.fromBufferAttribute(e,l),kn.add(tu)),r=Math.max(r,i.distanceToSquared(kn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new jt(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,l=[],u=[];for(let C=0;C<a;C++)l[C]=new A,u[C]=new A;const h=new A,d=new A,f=new A,p=new J,g=new J,_=new J,m=new A,v=new A;function y(C,O,B){h.fromArray(r,3*C),d.fromArray(r,3*O),f.fromArray(r,3*B),p.fromArray(o,2*C),g.fromArray(o,2*O),_.fromArray(o,2*B),d.sub(h),f.sub(h),g.sub(p),_.sub(p);const L=1/(g.x*_.y-_.x*g.y);isFinite(L)&&(m.copy(d).multiplyScalar(_.y).addScaledVector(f,-g.y).multiplyScalar(L),v.copy(f).multiplyScalar(g.x).addScaledVector(d,-_.x).multiplyScalar(L),l[C].add(m),l[O].add(m),l[B].add(m),u[C].add(v),u[O].add(v),u[B].add(v))}let w=this.groups;0===w.length&&(w=[{start:0,count:i.length}]);for(let C=0,O=w.length;C<O;++C){const B=w[C],L=B.start;for(let k=L,W=L+B.count;k<W;k+=3)y(i[k+0],i[k+1],i[k+2])}const x=new A,S=new A,M=new A,E=new A;function b(C){M.fromArray(s,3*C),E.copy(M);const O=l[C];x.copy(O),x.sub(M.multiplyScalar(M.dot(O))).normalize(),S.crossVectors(E,O);const L=S.dot(u[C])<0?-1:1;c[4*C]=x.x,c[4*C+1]=x.y,c[4*C+2]=x.z,c[4*C+3]=L}for(let C=0,O=w.length;C<O;++C){const B=w[C],L=B.start;for(let k=L,W=L+B.count;k<W;k+=3)b(i[k+0]),b(i[k+1]),b(i[k+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new jt(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new A,s=new A,o=new A,a=new A,c=new A,l=new A,u=new A,h=new A;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),g=e.getX(d+1),_=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,g),o.fromBufferAttribute(t,_),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(i,p),c.fromBufferAttribute(i,g),l.fromBufferAttribute(i,_),a.add(u),c.add(u),l.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(g,c.x,c.y,c.z),i.setXYZ(_,l.x,l.y,l.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)kn.fromBufferAttribute(e,t),kn.normalize(),e.setXYZ(t,kn.x,kn.y,kn.z)}toNonIndexed(){function e(a,c){const l=a.array,u=a.itemSize,h=a.normalized,d=new l.constructor(c.length*u);let f=0,p=0;for(let g=0,_=c.length;g<_;g++){f=a.isInterleavedBufferAttribute?c[g]*a.data.stride+a.offset:c[g]*u;for(let m=0;m<u;m++)d[p++]=l[f++]}return new jt(d,u,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new et,i=this.index.array,r=this.attributes;for(const a in r){const l=e(r[a],i);t.setAttribute(a,l)}const s=this.morphAttributes;for(const a in s){const c=[],l=s[a];for(let u=0,h=l.length;u<h;u++){const f=e(l[u],i);c.push(f)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const c=this.parameters;for(const l in c)void 0!==c[l]&&(e[l]=c[l]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i)e.data.attributes[c]=i[c].toJSON(e.data);const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let h=0,d=l.length;h<d;h++)u.push(l[h].toJSON(e.data));u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const l in r)this.setAttribute(l,r[l].clone(t));const s=e.morphAttributes;for(const l in s){const u=[],h=s[l];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let l=0,u=o.length;l<u;l++){const h=o[l];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const aO=new Ve,Ga=new Ha,cg=new Vr,cO=new A,nu=new A,iu=new A,ru=new A,wb=new A,lg=new A,ug=new J,hg=new J,dg=new J,lO=new A,uO=new A,hO=new A,fg=new A,pg=new A;class xt extends sn{constructor(e=new et,t=new wn){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){lg.set(0,0,0);for(let c=0,l=s.length;c<l;c++){const u=a[c];0!==u&&(wb.fromBufferAttribute(s[c],e),lg.addScaledVector(o?wb:wb.sub(t),u))}t.add(lg)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),cg.copy(i.boundingSphere),cg.applyMatrix4(s),Ga.copy(e.ray).recast(e.near),(!1!==cg.containsPoint(Ga.origin)||!(null===Ga.intersectSphere(cg,cO)||Ga.origin.distanceToSquared(cO)>(e.far-e.near)**2))&&(aO.copy(s).invert(),Ga.copy(e.ray).applyMatrix4(aO),(null===i.boundingBox||!1!==Ga.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Ga)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(null!==a)if(Array.isArray(o))for(let p=0,g=d.length;p<g;p++){const _=d[p],m=o[_.materialIndex];for(let w=Math.max(_.start,f.start),x=Math.min(a.count,Math.min(_.start+_.count,f.start+f.count));w<x;w+=3)r=mg(this,m,e,i,l,u,h,a.getX(w),a.getX(w+1),a.getX(w+2)),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=_.materialIndex,t.push(r))}else for(let _=Math.max(0,f.start),m=Math.min(a.count,f.start+f.count);_<m;_+=3)r=mg(this,o,e,i,l,u,h,a.getX(_),a.getX(_+1),a.getX(_+2)),r&&(r.faceIndex=Math.floor(_/3),t.push(r));else if(void 0!==c)if(Array.isArray(o))for(let p=0,g=d.length;p<g;p++){const _=d[p],m=o[_.materialIndex];for(let w=Math.max(_.start,f.start),x=Math.min(c.count,Math.min(_.start+_.count,f.start+f.count));w<x;w+=3)r=mg(this,m,e,i,l,u,h,w,w+1,w+2),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=_.materialIndex,t.push(r))}else for(let _=Math.max(0,f.start),m=Math.min(c.count,f.start+f.count);_<m;_+=3)r=mg(this,o,e,i,l,u,h,_,_+1,_+2),r&&(r.faceIndex=Math.floor(_/3),t.push(r))}}function mg(n,e,t,i,r,s,o,a,c,l){n.getVertexPosition(a,nu),n.getVertexPosition(c,iu),n.getVertexPosition(l,ru);const u=function lZ(n,e,t,i,r,s,o,a){let c;if(c=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===c)return null;pg.copy(a),pg.applyMatrix4(n.matrixWorld);const l=t.ray.origin.distanceTo(pg);return l<t.near||l>t.far?null:{distance:l,point:pg.clone(),object:n}}(n,e,t,i,nu,iu,ru,fg);if(u){r&&(ug.fromBufferAttribute(r,a),hg.fromBufferAttribute(r,c),dg.fromBufferAttribute(r,l),u.uv=Ki.getInterpolation(fg,nu,iu,ru,ug,hg,dg,new J)),s&&(ug.fromBufferAttribute(s,a),hg.fromBufferAttribute(s,c),dg.fromBufferAttribute(s,l),u.uv1=Ki.getInterpolation(fg,nu,iu,ru,ug,hg,dg,new J),u.uv2=u.uv1),o&&(lO.fromBufferAttribute(o,a),uO.fromBufferAttribute(o,c),hO.fromBufferAttribute(o,l),u.normal=Ki.getInterpolation(fg,nu,iu,ru,lO,uO,hO,new A),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:c,c:l,normal:new A,materialIndex:0};Ki.getNormal(nu,iu,ru,h.normal),u.face=h}return u}class vs extends et{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],l=[],u=[],h=[];let d=0,f=0;function p(g,_,m,v,y,w,x,S,M,E,b){const C=w/M,O=x/E,B=w/2,L=x/2,F=S/2,k=M+1,W=E+1;let H=0,X=0;const Q=new A;for(let te=0;te<W;te++){const U=te*O-L;for(let q=0;q<k;q++)Q[g]=(q*C-B)*v,Q[_]=U*y,Q[m]=F,l.push(Q.x,Q.y,Q.z),Q[g]=0,Q[_]=0,Q[m]=S>0?1:-1,u.push(Q.x,Q.y,Q.z),h.push(q/M),h.push(1-te/E),H+=1}for(let te=0;te<E;te++)for(let U=0;U<M;U++){const ae=d+U+k*(te+1),oe=d+(U+1)+k*(te+1),le=d+(U+1)+k*te;c.push(d+U+k*te,ae,le),c.push(ae,oe,le),X+=6}a.addGroup(f,X,b),f+=X,d+=H}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Re(l,3)),this.setAttribute("normal",new Re(u,3)),this.setAttribute("uv",new Re(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vs(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function su(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function gi(n){const e={};for(let t=0;t<n.length;t++){const i=su(n[t]);for(const r in i)e[r]=i[r]}return e}function dO(n){return null===n.getRenderTarget()?n.outputColorSpace:Rn}const hZ={clone:su,merge:gi};class ys extends Li{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=su(e.uniforms),this.uniformsGroups=function uZ(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class xb extends sn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ve,this.projectionMatrix=new Ve,this.projectionMatrixInverse=new Ve,this.coordinateSystem=Js}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Un extends xb{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*zl*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ua*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*zl*Math.atan(Math.tan(.5*Ua*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ua*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/l,r*=o.width/c,i*=o.height/l}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class pZ extends sn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null;const r=new Un(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new Un(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new Un(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new Un(-90,1,e,t);a.layers=this.layers,this.add(a);const c=new Un(-90,1,e,t);c.layers=this.layers,this.add(c);const l=new Un(-90,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,c]=t;for(const l of t)this.remove(l);if(e===Js)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,c,l]=this.children,u=e.getRenderTarget(),h=e.xr.enabled;e.xr.enabled=!1;const d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,c),i.texture.generateMipmaps=d,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}}class gg extends br{constructor(e,t,i,r,s,o,a,c,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:Bo,i,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class mZ extends Ba{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(bd("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===Na?wt:""),this.texture=new gg(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Xt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new vs(5,5,5),s=new ys({name:"CubemapFromEquirect",uniforms:su(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new xt(r,s),a=t.minFilter;return t.minFilter===Zs&&(t.minFilter=Xt),new pZ(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const bb=new A,gZ=new A,_Z=new at;class oo{constructor(e=new A(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=bb.subVectors(i,t).cross(gZ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(bb),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||_Z.getNormalMatrix(e),r=this.coplanarPoint(bb).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Wa=new Vr,_g=new A;class Mb{constructor(e=new oo,t=new oo,i=new oo,r=new oo,s=new oo,o=new oo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Js){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],l=r[4],u=r[5],h=r[6],d=r[7],f=r[8],p=r[9],g=r[10],_=r[11],m=r[12],v=r[13],y=r[14],w=r[15];if(i[0].setComponents(c-s,d-l,_-f,w-m).normalize(),i[1].setComponents(c+s,d+l,_+f,w+m).normalize(),i[2].setComponents(c+o,d+u,_+p,w+v).normalize(),i[3].setComponents(c-o,d-u,_-p,w-v).normalize(),i[4].setComponents(c-a,d-h,_-g,w-y).normalize(),t===Js)i[5].setComponents(c+a,d+h,_+g,w+y).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,h,g,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Wa.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Wa.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Wa)}intersectsSprite(e){return Wa.center.set(0,0,0),Wa.radius=.7071067811865476,Wa.applyMatrix4(e.matrixWorld),this.intersectsSphere(Wa)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(_g.x=r.normal.x>0?e.max.x:e.min.x,_g.y=r.normal.y>0?e.max.y:e.min.y,_g.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(_g)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function fO(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function vZ(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)},remove:function a(l){l.isInterleavedBufferAttribute&&(l=l.data);const u=i.get(l);u&&(n.deleteBuffer(u.buffer),i.delete(l))},update:function c(l,u){if(l.isGLBufferAttribute){const d=i.get(l);return void((!d||d.version<l.version)&&i.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}l.isInterleavedBufferAttribute&&(l=l.data);const h=i.get(l);void 0===h?i.set(l,function r(l,u){const h=l.array,d=l.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,h,d),l.onUploadCallback(),h instanceof Float32Array)p=n.FLOAT;else if(h instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=n.HALF_FLOAT}else p=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)p=n.SHORT;else if(h instanceof Uint32Array)p=n.UNSIGNED_INT;else if(h instanceof Int32Array)p=n.INT;else if(h instanceof Int8Array)p=n.BYTE;else if(h instanceof Uint8Array)p=n.UNSIGNED_BYTE;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);p=n.UNSIGNED_BYTE}return{buffer:f,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:l.version}}(l,u)):h.version<l.version&&(function s(l,u,h){const d=u.array,f=u.updateRange;n.bindBuffer(h,l),-1===f.count?n.bufferSubData(h,0,d):(t?n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(h.buffer,l,u),h.version=l.version)}}}class cu extends et{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),l=a+1,u=c+1,h=e/a,d=t/c,f=[],p=[],g=[],_=[];for(let m=0;m<u;m++){const v=m*d-o;for(let y=0;y<l;y++)p.push(y*h-s,-v,0),g.push(0,0,1),_.push(y/a),_.push(1-m/c)}for(let m=0;m<c;m++)for(let v=0;v<a;v++){const w=v+l*(m+1),x=v+1+l*(m+1),S=v+1+l*m;f.push(v+l*m,w,S),f.push(w,x,S)}this.setIndex(f),this.setAttribute("position",new Re(p,3)),this.setAttribute("normal",new Re(g,3)),this.setAttribute("uv",new Re(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cu(e.width,e.height,e.widthSegments,e.heightSegments)}}const st={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},ye={common:{diffuse:{value:new Y(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new at},alphaMap:{value:null},alphaMapTransform:{value:new at},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new at}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new at}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new at}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new at},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new at},normalScale:{value:new J(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new at},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new at}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new at}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new at}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Y(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Y(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new at},alphaTest:{value:0},uvTransform:{value:new at}},sprite:{diffuse:{value:new Y(16777215)},opacity:{value:1},center:{value:new J(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new at},alphaMap:{value:null},alphaMapTransform:{value:new at},alphaTest:{value:0}}},ws={basic:{uniforms:gi([ye.common,ye.specularmap,ye.envmap,ye.aomap,ye.lightmap,ye.fog]),vertexShader:st.meshbasic_vert,fragmentShader:st.meshbasic_frag},lambert:{uniforms:gi([ye.common,ye.specularmap,ye.envmap,ye.aomap,ye.lightmap,ye.emissivemap,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.fog,ye.lights,{emissive:{value:new Y(0)}}]),vertexShader:st.meshlambert_vert,fragmentShader:st.meshlambert_frag},phong:{uniforms:gi([ye.common,ye.specularmap,ye.envmap,ye.aomap,ye.lightmap,ye.emissivemap,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.fog,ye.lights,{emissive:{value:new Y(0)},specular:{value:new Y(1118481)},shininess:{value:30}}]),vertexShader:st.meshphong_vert,fragmentShader:st.meshphong_frag},standard:{uniforms:gi([ye.common,ye.envmap,ye.aomap,ye.lightmap,ye.emissivemap,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.roughnessmap,ye.metalnessmap,ye.fog,ye.lights,{emissive:{value:new Y(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:st.meshphysical_vert,fragmentShader:st.meshphysical_frag},toon:{uniforms:gi([ye.common,ye.aomap,ye.lightmap,ye.emissivemap,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.gradientmap,ye.fog,ye.lights,{emissive:{value:new Y(0)}}]),vertexShader:st.meshtoon_vert,fragmentShader:st.meshtoon_frag},matcap:{uniforms:gi([ye.common,ye.bumpmap,ye.normalmap,ye.displacementmap,ye.fog,{matcap:{value:null}}]),vertexShader:st.meshmatcap_vert,fragmentShader:st.meshmatcap_frag},points:{uniforms:gi([ye.points,ye.fog]),vertexShader:st.points_vert,fragmentShader:st.points_frag},dashed:{uniforms:gi([ye.common,ye.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:st.linedashed_vert,fragmentShader:st.linedashed_frag},depth:{uniforms:gi([ye.common,ye.displacementmap]),vertexShader:st.depth_vert,fragmentShader:st.depth_frag},normal:{uniforms:gi([ye.common,ye.bumpmap,ye.normalmap,ye.displacementmap,{opacity:{value:1}}]),vertexShader:st.meshnormal_vert,fragmentShader:st.meshnormal_frag},sprite:{uniforms:gi([ye.sprite,ye.fog]),vertexShader:st.sprite_vert,fragmentShader:st.sprite_frag},background:{uniforms:{uvTransform:{value:new at},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:st.background_vert,fragmentShader:st.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:st.backgroundCube_vert,fragmentShader:st.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:st.cube_vert,fragmentShader:st.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:st.equirect_vert,fragmentShader:st.equirect_frag},distanceRGBA:{uniforms:gi([ye.common,ye.displacementmap,{referencePosition:{value:new A},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:st.distanceRGBA_vert,fragmentShader:st.distanceRGBA_frag},shadow:{uniforms:gi([ye.lights,ye.fog,{color:{value:new Y(0)},opacity:{value:1}}]),vertexShader:st.shadow_vert,fragmentShader:st.shadow_frag}};ws.physical={uniforms:gi([ws.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new at},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new at},clearcoatNormalScale:{value:new J(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new at},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new at},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new at},sheen:{value:0},sheenColor:{value:new Y(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new at},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new at},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new at},transmissionSamplerSize:{value:new J},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new at},attenuationDistance:{value:0},attenuationColor:{value:new Y(0)},specularColor:{value:new Y(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new at},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new at},anisotropyVector:{value:new J},anisotropyMap:{value:null},anisotropyMapTransform:{value:new at}}]),vertexShader:st.meshphysical_vert,fragmentShader:st.meshphysical_frag};const vg={r:0,b:0,g:0};function gJ(n,e,t,i,r,s,o){const a=new Y(0);let l,u,c=!0===s?0:1,h=null,d=0,f=null;function g(_,m){_.getRGB(vg,dO(n)),i.buffers.color.setClear(vg.r,vg.g,vg.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(_,m=1){a.set(_),c=m,g(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(_){c=_,g(a,c)},render:function p(_,m){let v=!1,y=!0===m.isScene?m.background:null;y&&y.isTexture&&(y=(m.backgroundBlurriness>0?t:e).get(y)),null===y?g(a,c):y&&y.isColor&&(g(y,1),v=!0);const w=n.xr.getEnvironmentBlendMode();"additive"===w?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===w&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===md)?(void 0===u&&(u=new xt(new vs(1,1,1),new ys({name:"BackgroundCubeMaterial",uniforms:su(ws.backgroundCube.uniforms),vertexShader:ws.backgroundCube.vertexShader,fragmentShader:ws.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(x,S,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,u.material.toneMapped=y.colorSpace!==wt,(h!==y||d!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(void 0===l&&(l=new xt(new cu(2,2),new ys({name:"BackgroundMaterial",uniforms:su(ws.background.uniforms),vertexShader:ws.background.vertexShader,fragmentShader:ws.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=y,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=y.colorSpace!==wt,!0===y.matrixAutoUpdate&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),(h!==y||d!==y.version||f!==n.toneMapping)&&(l.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),l.layers.enableAll(),_.unshift(l,l.geometry,l.material,0,0,null))}}}function _J(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},c=_(null);let l=c,u=!1;function f(F){return i.isWebGL2?n.bindVertexArray(F):s.bindVertexArrayOES(F)}function p(F){return i.isWebGL2?n.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function _(F){const k=[],W=[],H=[];for(let X=0;X<r;X++)k[X]=0,W[X]=0,H[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:k,enabledAttributes:W,attributeDivisors:H,object:F,attributes:{},index:null}}function y(){const F=l.newAttributes;for(let k=0,W=F.length;k<W;k++)F[k]=0}function w(F){x(F,0)}function x(F,k){const H=l.enabledAttributes,X=l.attributeDivisors;l.newAttributes[F]=1,0===H[F]&&(n.enableVertexAttribArray(F),H[F]=1),X[F]!==k&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,k),X[F]=k)}function S(){const F=l.newAttributes,k=l.enabledAttributes;for(let W=0,H=k.length;W<H;W++)k[W]!==F[W]&&(n.disableVertexAttribArray(W),k[W]=0)}function M(F,k,W,H,X,Q,te){!0===te?n.vertexAttribIPointer(F,k,W,X,Q):n.vertexAttribPointer(F,k,W,H,X,Q)}function B(){L(),u=!0,l!==c&&(l=c,f(l.object))}function L(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function h(F,k,W,H,X){let Q=!1;if(o){const te=function g(F,k,W){const H=!0===W.wireframe;let X=a[F.id];void 0===X&&(X={},a[F.id]=X);let Q=X[k.id];void 0===Q&&(Q={},X[k.id]=Q);let te=Q[H];return void 0===te&&(te=_(function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),Q[H]=te),te}(H,W,k);l!==te&&(l=te,f(l.object)),Q=function m(F,k,W,H){const X=l.attributes,Q=k.attributes;let te=0;const U=W.getAttributes();for(const q in U)if(U[q].location>=0){const oe=X[q];let le=Q[q];if(void 0===le&&("instanceMatrix"===q&&F.instanceMatrix&&(le=F.instanceMatrix),"instanceColor"===q&&F.instanceColor&&(le=F.instanceColor)),void 0===oe||oe.attribute!==le||le&&oe.data!==le.data)return!0;te++}return l.attributesNum!==te||l.index!==H}(F,H,W,X),Q&&function v(F,k,W,H){const X={},Q=k.attributes;let te=0;const U=W.getAttributes();for(const q in U)if(U[q].location>=0){let oe=Q[q];void 0===oe&&("instanceMatrix"===q&&F.instanceMatrix&&(oe=F.instanceMatrix),"instanceColor"===q&&F.instanceColor&&(oe=F.instanceColor));const le={};le.attribute=oe,oe&&oe.data&&(le.data=oe.data),X[q]=le,te++}l.attributes=X,l.attributesNum=te,l.index=H}(F,H,W,X)}else{const te=!0===k.wireframe;(l.geometry!==H.id||l.program!==W.id||l.wireframe!==te)&&(l.geometry=H.id,l.program=W.id,l.wireframe=te,Q=!0)}null!==X&&t.update(X,n.ELEMENT_ARRAY_BUFFER),(Q||u)&&(u=!1,function E(F,k,W,H){if(!1===i.isWebGL2&&(F.isInstancedMesh||H.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const X=H.attributes,Q=W.getAttributes(),te=k.defaultAttributeValues;for(const U in Q){const q=Q[U];if(q.location>=0){let ae=X[U];if(void 0===ae&&("instanceMatrix"===U&&F.instanceMatrix&&(ae=F.instanceMatrix),"instanceColor"===U&&F.instanceColor&&(ae=F.instanceColor)),void 0!==ae){const oe=ae.normalized,le=ae.itemSize,Ee=t.get(ae);if(void 0===Ee)continue;const Pe=Ee.buffer,Te=Ee.type,ct=Ee.bytesPerElement,tt=!0===i.isWebGL2&&(Te===n.INT||Te===n.UNSIGNED_INT||1013===ae.gpuType);if(ae.isInterleavedBufferAttribute){const Ne=ae.data,R=Ne.stride,ge=ae.offset;if(Ne.isInstancedInterleavedBuffer){for(let ne=0;ne<q.locationSize;ne++)x(q.location+ne,Ne.meshPerAttribute);!0!==F.isInstancedMesh&&void 0===H._maxInstanceCount&&(H._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let ne=0;ne<q.locationSize;ne++)w(q.location+ne);n.bindBuffer(n.ARRAY_BUFFER,Pe);for(let ne=0;ne<q.locationSize;ne++)M(q.location+ne,le/q.locationSize,Te,oe,R*ct,(ge+le/q.locationSize*ne)*ct,tt)}else{if(ae.isInstancedBufferAttribute){for(let Ne=0;Ne<q.locationSize;Ne++)x(q.location+Ne,ae.meshPerAttribute);!0!==F.isInstancedMesh&&void 0===H._maxInstanceCount&&(H._maxInstanceCount=ae.meshPerAttribute*ae.count)}else for(let Ne=0;Ne<q.locationSize;Ne++)w(q.location+Ne);n.bindBuffer(n.ARRAY_BUFFER,Pe);for(let Ne=0;Ne<q.locationSize;Ne++)M(q.location+Ne,le/q.locationSize,Te,oe,le*ct,le/q.locationSize*Ne*ct,tt)}}else if(void 0!==te){const oe=te[U];if(void 0!==oe)switch(oe.length){case 2:n.vertexAttrib2fv(q.location,oe);break;case 3:n.vertexAttrib3fv(q.location,oe);break;case 4:n.vertexAttrib4fv(q.location,oe);break;default:n.vertexAttrib1fv(q.location,oe)}}}}S()}(F,k,W,H),null!==X&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(X).buffer))},reset:B,resetDefaultState:L,dispose:function b(){B();for(const F in a){const k=a[F];for(const W in k){const H=k[W];for(const X in H)p(H[X].object),delete H[X];delete k[W]}delete a[F]}},releaseStatesOfGeometry:function C(F){if(void 0===a[F.id])return;const k=a[F.id];for(const W in k){const H=k[W];for(const X in H)p(H[X].object),delete H[X];delete k[W]}delete a[F.id]},releaseStatesOfProgram:function O(F){for(const k in a){const W=a[k];if(void 0===W[F.id])continue;const H=W[F.id];for(const X in H)p(H[X].object),delete H[X];delete W[F.id]}},initAttributes:y,enableAttribute:w,disableUnusedAttributes:S}}function vJ(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(l){s=l},this.render=function a(l,u){n.drawArrays(s,l,u),t.update(u,s,1)},this.renderInstances=function c(l,u,h){if(0===h)return;let d,f;if(r)d=n,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](s,l,u,h),t.update(u,s,h)}}function yJ(n,e,t){let i;function s(M){if("highp"===M){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";M="mediump"}return"mediump"===M&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const l=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),d=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),g=n.getParameter(n.MAX_VERTEX_ATTRIBS),_=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),m=n.getParameter(n.MAX_VARYING_VECTORS),v=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,w=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const M=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:g,maxVertexUniforms:_,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:w,floatVertexTextures:y&&w,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function wJ(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new oo,a=new at,c={value:null,needsUpdate:!1};function u(h,d,f,p){const g=null!==h?h.length:0;let _=null;if(0!==g){if(_=c.value,!0!==p||null===_){const m=f+4*g,v=d.matrixWorldInverse;a.getNormalMatrix(v),(null===_||_.length<m)&&(_=new Float32Array(m));for(let y=0,w=f;y!==g;++y,w+=4)o.copy(h[y]).applyMatrix4(v,a),o.normal.toArray(_,w),_[w+3]=o.constant}c.value=_,c.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,_}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=0!==h.length||d||0!==i||r;return r=d,i=h.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=u(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,g=h.clipIntersection,_=h.clipShadows,m=n.get(h);if(!r||null===p||0===p.length||s&&!_)s?u(null):function l(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const v=s?0:i,y=4*v;let w=m.clippingState||null;c.value=w,w=u(p,d,y,f);for(let x=0;x!==y;++x)w[x]=t[x];m.clippingState=w,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=v}}}function xJ(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=Bo:304===a&&(o.mapping=Ia),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);void 0!==c&&(e.delete(a),c.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const c=o.image;if(c&&c.height>0){const l=new mZ(c.height/2);return l.fromEquirectangularTexture(n,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class yg extends xb{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,c=r-t;if(null!==this.view&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const pO=[.125,.215,.35,.446,.526,.582],Sb=new yg,mO=new Y;let Eb=null;const $a=(1+Math.sqrt(5))/2,uu=1/$a,gO=[new A(1,1,1),new A(-1,1,1),new A(1,1,-1),new A(-1,1,-1),new A(0,$a,uu),new A(0,$a,-uu),new A(uu,0,$a),new A(-uu,0,$a),new A($a,uu,0),new A(-$a,uu,0)];class _O{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Eb=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=wO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=yO(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Eb),e.scissorTest=!1,wg(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Bo||e.mapping===Ia?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Eb=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Xt,minFilter:Xt,generateMipmaps:!1,type:vd,format:xr,colorSpace:Rn,depthBuffer:!1},r=vO(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=vO(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function bJ(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+pO.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>n-4?c=pO[o-n+4-1]:0===o&&(c=0),i.push(c);const l=1/(a-2),u=-l,h=1+l,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,g=3,_=2,m=1,v=new Float32Array(g*p*f),y=new Float32Array(_*p*f),w=new Float32Array(m*p*f);for(let S=0;S<f;S++){const M=S%3*2/3-1,E=S>2?0:-1;v.set([M,E,0,M+2/3,E,0,M+2/3,E+1,0,M,E,0,M+2/3,E+1,0,M,E+1,0],g*p*S),y.set(d,_*p*S),w.set([S,S,S,S,S,S],m*p*S)}const x=new et;x.setAttribute("position",new jt(v,g)),x.setAttribute("uv",new jt(y,_)),x.setAttribute("faceIndex",new jt(w,m)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function MJ(n,e,t){const i=new Float32Array(20),r=new A(0,1,0);return new ys({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new xt(this._lodPlanes[0],e);this._renderer.compile(t,Sb)}_sceneToCubeUV(e,t,i,r){const a=new Un(90,1,t,i),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(mO),u.toneMapping=Ys,u.autoClear=!1;const f=new wn({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new xt(new vs,f);let g=!1;const _=e.background;_?_.isColor&&(f.color.copy(_),e.background=null,g=!0):(f.color.copy(mO),g=!0);for(let m=0;m<6;m++){const v=m%3;0===v?(a.up.set(0,c[m],0),a.lookAt(l[m],0,0)):1===v?(a.up.set(0,0,c[m]),a.lookAt(0,l[m],0)):(a.up.set(0,c[m],0),a.lookAt(0,0,l[m]));const y=this._cubeSize;wg(r,v*y,m>2?y:0,y,y),u.setRenderTarget(r),g&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=_}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Bo||e.mapping===Ia;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=wO()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=yO());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new xt(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const c=this._cubeSize;wg(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,Sb)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,gO[(r-1)%gO.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const c=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new xt(this._lodPlanes[r],l),d=l.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,g=s/p,_=isFinite(s)?1+Math.floor(3*g):20;_>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to 20`);const m=[];let v=0;for(let M=0;M<20;++M){const E=M/g,b=Math.exp(-E*E/2);m.push(b),0===M?v+=b:M<_&&(v+=2*b)}for(let M=0;M<m.length;M++)m[M]=m[M]/v;d.envMap.value=e.texture,d.samples.value=_,d.weights.value=m,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-i;const w=this._sizeLods[r];wg(t,3*w*(r>y-4?r-y+4:0),4*(this._cubeSize-w),3*w,2*w),c.setRenderTarget(t),c.render(h,Sb)}}function vO(n,e,t){const i=new Ba(n,e,t);return i.texture.mapping=md,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function wg(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function yO(){return new ys({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function wO(){return new ys({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function SJ(n){let e=new WeakMap,t=null;function s(a){const c=a.target;c.removeEventListener("dispose",s);const l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function i(a){if(a&&a.isTexture){const c=a.mapping,l=303===c||304===c,u=c===Bo||c===Ia;if(l||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new _O(n)),h=l?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(l&&h&&h.height>0||u&&h&&function r(a){let c=0;for(let u=0;u<6;u++)void 0!==a[u]&&c++;return 6===c}(h)){null===t&&(t=new _O(n));const d=l?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function EJ(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function CJ(n,e,t,i){const r={},s=new WeakMap;function o(h){const d=h.target;null!==d.index&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);for(const p in d.morphAttributes){const g=d.morphAttributes[p];for(let _=0,m=g.length;_<m;_++)e.remove(g[_])}d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,t.memory.geometries--}function l(h){const d=[],f=h.index,p=h.attributes.position;let g=0;if(null!==f){const v=f.array;g=f.version;for(let y=0,w=v.length;y<w;y+=3){const x=v[y+0],S=v[y+1],M=v[y+2];d.push(x,S,S,M,M,x)}}else{if(void 0===p)return;g=p.version;for(let y=0,w=p.array.length/3-1;y<w;y+=3){const x=y+0,S=y+1,M=y+2;d.push(x,S,S,M,M,x)}}const _=new($N(d)?oO:sO)(d,1);_.version=g;const m=s.get(h);m&&e.remove(m),s.set(h,_)}return{get:function a(h,d){return!0===r[d.id]||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d},update:function c(h){const d=h.attributes;for(const p in d)e.update(d[p],n.ARRAY_BUFFER);const f=h.morphAttributes;for(const p in f){const g=f[p];for(let _=0,m=g.length;_<m;_++)e.update(g[_],n.ARRAY_BUFFER)}},getWireframeAttribute:function u(h){const d=s.get(h);if(d){const f=h.index;null!==f&&d.version<f.version&&l(h)}else l(h);return s.get(h)}}}function TJ(n,e,t,i){const r=i.isWebGL2;let s,a,c;this.setMode=function o(d){s=d},this.setIndex=function l(d){a=d.type,c=d.bytesPerElement},this.render=function u(d,f){n.drawElements(s,f,a,d*c),t.update(f,s,1)},this.renderInstances=function h(d,f,p){if(0===p)return;let g,_;if(r)g=n,_="drawElementsInstanced";else if(g=e.get("ANGLE_instanced_arrays"),_="drawElementsInstancedANGLE",null===g)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g[_](s,f,a,d*c,p),t.update(f,s,p)}}function AJ(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function DJ(n,e){return n[0]-e[0]}function IJ(n,e){return Math.abs(e[1])-Math.abs(n[1])}function RJ(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new It,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function c(l,u,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==f?f.length:0;let g=s.get(u);if(void 0===g||g.count!==p){let F=function(){B.dispose(),s.delete(u),u.removeEventListener("dispose",F)};void 0!==g&&g.texture.dispose();const v=void 0!==u.morphAttributes.position,y=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,x=u.morphAttributes.position||[],S=u.morphAttributes.normal||[],M=u.morphAttributes.color||[];let E=0;!0===v&&(E=1),!0===y&&(E=2),!0===w&&(E=3);let b=u.attributes.position.count*E,C=1;b>e.maxTextureSize&&(C=Math.ceil(b/e.maxTextureSize),b=e.maxTextureSize);const O=new Float32Array(b*C*4*p),B=new ob(O,b,C,p);B.type=Ks,B.needsUpdate=!0;const L=4*E;for(let k=0;k<p;k++){const W=x[k],H=S[k],X=M[k],Q=b*C*4*k;for(let te=0;te<W.count;te++){const U=te*L;!0===v&&(o.fromBufferAttribute(W,te),O[Q+U+0]=o.x,O[Q+U+1]=o.y,O[Q+U+2]=o.z,O[Q+U+3]=0),!0===y&&(o.fromBufferAttribute(H,te),O[Q+U+4]=o.x,O[Q+U+5]=o.y,O[Q+U+6]=o.z,O[Q+U+7]=0),!0===w&&(o.fromBufferAttribute(X,te),O[Q+U+8]=o.x,O[Q+U+9]=o.y,O[Q+U+10]=o.z,O[Q+U+11]=4===X.itemSize?o.w:1)}}g={count:p,texture:B,size:new J(b,C)},s.set(u,g),u.addEventListener("dispose",F)}let _=0;for(let v=0;v<d.length;v++)_+=d[v];const m=u.morphTargetsRelative?1:1-_;h.getUniforms().setValue(n,"morphTargetBaseInfluence",m),h.getUniforms().setValue(n,"morphTargetInfluences",d),h.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{const f=void 0===d?0:d.length;let p=i[u.id];if(void 0===p||p.length!==f){p=[];for(let y=0;y<f;y++)p[y]=[y,0];i[u.id]=p}for(let y=0;y<f;y++){const w=p[y];w[0]=y,w[1]=d[y]}p.sort(IJ);for(let y=0;y<8;y++)y<f&&p[y][1]?(a[y][0]=p[y][0],a[y][1]=p[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(DJ);const g=u.morphAttributes.position,_=u.morphAttributes.normal;let m=0;for(let y=0;y<8;y++){const w=a[y],x=w[0],S=w[1];x!==Number.MAX_SAFE_INTEGER&&S?(g&&u.getAttribute("morphTarget"+y)!==g[x]&&u.setAttribute("morphTarget"+y,g[x]),_&&u.getAttribute("morphNormal"+y)!==_[x]&&u.setAttribute("morphNormal"+y,_[x]),r[y]=S,m+=S):(g&&!0===u.hasAttribute("morphTarget"+y)&&u.deleteAttribute("morphTarget"+y),_&&!0===u.hasAttribute("morphNormal"+y)&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const v=u.morphTargetsRelative?1:1-m;h.getUniforms().setValue(n,"morphTargetBaseInfluence",v),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function PJ(n,e,t,i){let r=new WeakMap;function a(c){const l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),null!==l.instanceColor&&t.remove(l.instanceColor)}return{update:function s(c){const l=i.render.frame,h=e.get(c,c.geometry);if(r.get(h)!==l&&(e.update(h),r.set(h,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",a)&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),null!==c.instanceColor&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){const d=c.skeleton;r.get(d)!==l&&(d.update(),r.set(d,l))}return h},dispose:function o(){r=new WeakMap}}}const xO=new br,bO=new ob,MO=new YN,SO=new gg,EO=[],CO=[],TO=new Float32Array(16),AO=new Float32Array(9),DO=new Float32Array(4);function hu(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=EO[r];if(void 0===s&&(s=new Float32Array(r),EO[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Pn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Ln(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function xg(n,e){let t=CO[e];void 0===t&&(t=new Int32Array(e),CO[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function LJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function NJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pn(t,e))return;n.uniform2fv(this.addr,e),Ln(t,e)}}function OJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Pn(t,e))return;n.uniform3fv(this.addr,e),Ln(t,e)}}function FJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pn(t,e))return;n.uniform4fv(this.addr,e),Ln(t,e)}}function kJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Pn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Ln(t,e)}else{if(Pn(t,i))return;DO.set(i),n.uniformMatrix2fv(this.addr,!1,DO),Ln(t,i)}}function UJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Pn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Ln(t,e)}else{if(Pn(t,i))return;AO.set(i),n.uniformMatrix3fv(this.addr,!1,AO),Ln(t,i)}}function BJ(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Pn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Ln(t,e)}else{if(Pn(t,i))return;TO.set(i),n.uniformMatrix4fv(this.addr,!1,TO),Ln(t,i)}}function VJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function zJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pn(t,e))return;n.uniform2iv(this.addr,e),Ln(t,e)}}function HJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Pn(t,e))return;n.uniform3iv(this.addr,e),Ln(t,e)}}function GJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pn(t,e))return;n.uniform4iv(this.addr,e),Ln(t,e)}}function WJ(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function jJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Pn(t,e))return;n.uniform2uiv(this.addr,e),Ln(t,e)}}function $J(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Pn(t,e))return;n.uniform3uiv(this.addr,e),Ln(t,e)}}function XJ(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Pn(t,e))return;n.uniform4uiv(this.addr,e),Ln(t,e)}}function qJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||xO,r)}function YJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||MO,r)}function ZJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||SO,r)}function KJ(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||bO,r)}function QJ(n,e){n.uniform1fv(this.addr,e)}function eQ(n,e){const t=hu(e,this.size,2);n.uniform2fv(this.addr,t)}function tQ(n,e){const t=hu(e,this.size,3);n.uniform3fv(this.addr,t)}function nQ(n,e){const t=hu(e,this.size,4);n.uniform4fv(this.addr,t)}function iQ(n,e){const t=hu(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function rQ(n,e){const t=hu(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function sQ(n,e){const t=hu(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function oQ(n,e){n.uniform1iv(this.addr,e)}function aQ(n,e){n.uniform2iv(this.addr,e)}function cQ(n,e){n.uniform3iv(this.addr,e)}function lQ(n,e){n.uniform4iv(this.addr,e)}function uQ(n,e){n.uniform1uiv(this.addr,e)}function hQ(n,e){n.uniform2uiv(this.addr,e)}function dQ(n,e){n.uniform3uiv(this.addr,e)}function fQ(n,e){n.uniform4uiv(this.addr,e)}function pQ(n,e,t){const i=this.cache,r=e.length,s=xg(t,r);Pn(i,s)||(n.uniform1iv(this.addr,s),Ln(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||xO,s[o])}function mQ(n,e,t){const i=this.cache,r=e.length,s=xg(t,r);Pn(i,s)||(n.uniform1iv(this.addr,s),Ln(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||MO,s[o])}function gQ(n,e,t){const i=this.cache,r=e.length,s=xg(t,r);Pn(i,s)||(n.uniform1iv(this.addr,s),Ln(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||SO,s[o])}function _Q(n,e,t){const i=this.cache,r=e.length,s=xg(t,r);Pn(i,s)||(n.uniform1iv(this.addr,s),Ln(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||bO,s[o])}class yQ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function JJ(n){switch(n){case 5126:return LJ;case 35664:return NJ;case 35665:return OJ;case 35666:return FJ;case 35674:return kJ;case 35675:return UJ;case 35676:return BJ;case 5124:case 35670:return VJ;case 35667:case 35671:return zJ;case 35668:case 35672:return HJ;case 35669:case 35673:return GJ;case 5125:return WJ;case 36294:return jJ;case 36295:return $J;case 36296:return XJ;case 35678:case 36198:case 36298:case 36306:case 35682:return qJ;case 35679:case 36299:case 36307:return YJ;case 35680:case 36300:case 36308:case 36293:return ZJ;case 36289:case 36303:case 36311:case 36292:return KJ}}(t.type)}}class wQ{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function vQ(n){switch(n){case 5126:return QJ;case 35664:return eQ;case 35665:return tQ;case 35666:return nQ;case 35674:return iQ;case 35675:return rQ;case 35676:return sQ;case 5124:case 35670:return oQ;case 35667:case 35671:return aQ;case 35668:case 35672:return cQ;case 35669:case 35673:return lQ;case 5125:return uQ;case 36294:return hQ;case 36295:return dQ;case 36296:return fQ;case 35678:case 36198:case 36298:case 36306:case 35682:return pQ;case 35679:case 36299:case 36307:return mQ;case 35680:case 36300:case 36308:case 36293:return gQ;case 36289:case 36303:case 36311:case 36292:return _Q}}(t.type)}}class xQ{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const Tb=/(\w+)(\])?(\[|\.)?/g;function IO(n,e){n.seq.push(e),n.map[e.id]=e}function bQ(n,e,t){const i=n.name,r=i.length;for(Tb.lastIndex=0;;){const s=Tb.exec(i);let a=s[1];const l=s[3];if("]"===s[2]&&(a|=0),void 0===l||"["===l&&Tb.lastIndex+2===r){IO(t,void 0===l?new yQ(a,n,e):new wQ(a,n,e));break}{let h=t.map[a];void 0===h&&(h=new xQ(a),IO(t,h)),t=h}}}class bg{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);bQ(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=i[a.id];!1!==c.needsUpdate&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function RO(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let MQ=0;function PO(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function SQ(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function CQ(n,e){const t=function EQ(n){switch(n){case Rn:return["Linear","( value )"];case wt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function TQ(n,e){let t;switch(e){case sN:t="Linear";break;case oN:t="Reinhard";break;case aN:t="OptimizedCineon";break;case Hx:t="ACESFilmic";break;case cN:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Ad(n){return""!==n}function LO(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function NO(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const RQ=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ab(n){return n.replace(RQ,LQ)}const PQ=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function LQ(n,e){let t=st[e];if(void 0===t){const i=PQ.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=st[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return Ab(t)}const NQ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function OO(n){return n.replace(NQ,OQ)}function OQ(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function FO(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function zQ(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=function FQ(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===KL?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===JL?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Xs&&(e="SHADOWMAP_TYPE_VSM"),e}(t),l=function kQ(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Bo:case Ia:e="ENVMAP_TYPE_CUBE";break;case md:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function UQ(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Ia&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function BQ(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Gm:e="ENVMAP_BLENDING_MULTIPLY";break;case eY:e="ENVMAP_BLENDING_MIX";break;case tY:e="ENVMAP_BLENDING_ADD"}return e}(t),d=function VQ(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function AQ(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ad).join("\n")}(t),p=function DQ(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),g=r.createProgram();let _,m,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(_=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Ad).join("\n"),_.length>0&&(_+="\n"),m=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(Ad).join("\n"),m.length>0&&(m+="\n")):(_=[FO(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ad).join("\n"),m=[f,FO(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ys?"#define TONE_MAPPING":"",t.toneMapping!==Ys?st.tonemapping_pars_fragment:"",t.toneMapping!==Ys?TQ("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",st.colorspace_pars_fragment,CQ("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Ad).join("\n")),o=Ab(o),o=LO(o,t),o=NO(o,t),a=Ab(a),a=LO(a,t),a=NO(a,t),o=OO(o),a=OO(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",_=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+_,m=["#define varying in",t.glslVersion===GN?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===GN?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+m);const w=v+m+a,x=RO(r,r.VERTEX_SHADER,v+_+o),S=RO(r,r.FRAGMENT_SHADER,w);if(r.attachShader(g,x),r.attachShader(g,S),void 0!==t.index0AttributeName?r.bindAttribLocation(g,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g),n.debug.checkShaderErrors){const b=r.getProgramInfoLog(g).trim(),C=r.getShaderInfoLog(x).trim(),O=r.getShaderInfoLog(S).trim();let B=!0,L=!0;if(!1===r.getProgramParameter(g,r.LINK_STATUS))if(B=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,g,x,S);else{const F=PO(r,x,"vertex"),k=PO(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+b+"\n"+F+"\n"+k)}else""!==b?console.warn("THREE.WebGLProgram: Program Info Log:",b):(""===C||""===O)&&(L=!1);L&&(this.diagnostics={runnable:B,programLog:b,vertexShader:{log:C,prefix:_},fragmentShader:{log:O,prefix:m}})}let M,E;return r.deleteShader(x),r.deleteShader(S),this.getUniforms=function(){return void 0===M&&(M=new bg(r,g)),M},this.getAttributes=function(){return void 0===E&&(E=function IQ(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,g)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=MQ++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=x,this.fragmentShader=S,this}let HQ=0;class GQ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new WQ(e),t.set(e,i)),i}}class WQ{constructor(e){this.id=HQ++,this.code=e,this.usedTimes=0}}function jQ(n,e,t,i,r,s,o){const a=new fb,c=new GQ,l=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(b){return 0===b?"uv":`uv${b}`}return{getParameters:function _(b,C,O,B,L){const F=B.fog,k=L.geometry,H=(b.isMeshStandardMaterial?t:e).get(b.envMap||(b.isMeshStandardMaterial?B.environment:null)),X=H&&H.mapping===md?H.image.height:null,Q=p[b.type];null!==b.precision&&(f=r.getMaxPrecision(b.precision),f!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",f,"instead."));const te=k.morphAttributes.position||k.morphAttributes.normal||k.morphAttributes.color,U=void 0!==te?te.length:0;let ae,oe,le,Ee,q=0;if(void 0!==k.morphAttributes.position&&(q=1),void 0!==k.morphAttributes.normal&&(q=2),void 0!==k.morphAttributes.color&&(q=3),Q){const $t=ws[Q];ae=$t.vertexShader,oe=$t.fragmentShader}else ae=b.vertexShader,oe=b.fragmentShader,c.update(b),le=c.getVertexShaderID(b),Ee=c.getFragmentShaderID(b);const Pe=n.getRenderTarget(),Te=!0===L.isInstancedMesh,ct=!!b.map,Ne=!!H,R=!!b.aoMap,ge=!!b.lightMap,ne=!!b.bumpMap,de=!!b.normalMap,re=!!b.displacementMap,Fe=!!b.emissiveMap,Ce=!!b.metalnessMap,Ae=!!b.roughnessMap,ze=b.anisotropy>0,ht=b.clearcoat>0,qt=b.iridescence>0,I=b.sheen>0,T=b.transmission>0,G=ze&&!!b.anisotropyMap,ue=ht&&!!b.clearcoatMap,se=ht&&!!b.clearcoatNormalMap,fe=ht&&!!b.clearcoatRoughnessMap,Oe=qt&&!!b.iridescenceMap,pe=qt&&!!b.iridescenceThicknessMap,j=I&&!!b.sheenColorMap,P=I&&!!b.sheenRoughnessMap,ie=!!b.specularMap,Me=!!b.specularColorMap,ve=!!b.specularIntensityMap,be=T&&!!b.transmissionMap,Qe=T&&!!b.thicknessMap,N=!!b.alphaMap,ce=!!b.extensions,_e=!!k.attributes.uv1,dt=!!k.attributes.uv2,Tt=!!k.attributes.uv3;let zt=Ys;return b.toneMapped&&(null===Pe||!0===Pe.isXRRenderTarget)&&(zt=n.toneMapping),{isWebGL2:u,shaderID:Q,shaderType:b.type,shaderName:b.name,vertexShader:ae,fragmentShader:oe,defines:b.defines,customVertexShaderID:le,customFragmentShaderID:Ee,isRawShaderMaterial:!0===b.isRawShaderMaterial,glslVersion:b.glslVersion,precision:f,instancing:Te,instancingColor:Te&&null!==L.instanceColor,supportsVertexTextures:d,outputColorSpace:null===Pe?n.outputColorSpace:!0===Pe.isXRRenderTarget?Pe.texture.colorSpace:Rn,map:ct,matcap:!!b.matcap,envMap:Ne,envMapMode:Ne&&H.mapping,envMapCubeUVHeight:X,aoMap:R,lightMap:ge,bumpMap:ne,normalMap:de,displacementMap:d&&re,emissiveMap:Fe,normalMapObjectSpace:de&&1===b.normalMapType,normalMapTangentSpace:de&&0===b.normalMapType,metalnessMap:Ce,roughnessMap:Ae,anisotropy:ze,anisotropyMap:G,clearcoat:ht,clearcoatMap:ue,clearcoatNormalMap:se,clearcoatRoughnessMap:fe,iridescence:qt,iridescenceMap:Oe,iridescenceThicknessMap:pe,sheen:I,sheenColorMap:j,sheenRoughnessMap:P,specularMap:ie,specularColorMap:Me,specularIntensityMap:ve,transmission:T,transmissionMap:be,thicknessMap:Qe,gradientMap:!!b.gradientMap,opaque:!1===b.transparent&&1===b.blending,alphaMap:N,alphaTest:b.alphaTest>0,alphaHash:!!b.alphaHash,combine:b.combine,mapUv:ct&&g(b.map.channel),aoMapUv:R&&g(b.aoMap.channel),lightMapUv:ge&&g(b.lightMap.channel),bumpMapUv:ne&&g(b.bumpMap.channel),normalMapUv:de&&g(b.normalMap.channel),displacementMapUv:re&&g(b.displacementMap.channel),emissiveMapUv:Fe&&g(b.emissiveMap.channel),metalnessMapUv:Ce&&g(b.metalnessMap.channel),roughnessMapUv:Ae&&g(b.roughnessMap.channel),anisotropyMapUv:G&&g(b.anisotropyMap.channel),clearcoatMapUv:ue&&g(b.clearcoatMap.channel),clearcoatNormalMapUv:se&&g(b.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:fe&&g(b.clearcoatRoughnessMap.channel),iridescenceMapUv:Oe&&g(b.iridescenceMap.channel),iridescenceThicknessMapUv:pe&&g(b.iridescenceThicknessMap.channel),sheenColorMapUv:j&&g(b.sheenColorMap.channel),sheenRoughnessMapUv:P&&g(b.sheenRoughnessMap.channel),specularMapUv:ie&&g(b.specularMap.channel),specularColorMapUv:Me&&g(b.specularColorMap.channel),specularIntensityMapUv:ve&&g(b.specularIntensityMap.channel),transmissionMapUv:be&&g(b.transmissionMap.channel),thicknessMapUv:Qe&&g(b.thicknessMap.channel),alphaMapUv:N&&g(b.alphaMap.channel),vertexTangents:!!k.attributes.tangent&&(de||ze),vertexColors:b.vertexColors,vertexAlphas:!0===b.vertexColors&&!!k.attributes.color&&4===k.attributes.color.itemSize,vertexUv1s:_e,vertexUv2s:dt,vertexUv3s:Tt,pointsUvs:!0===L.isPoints&&!!k.attributes.uv&&(ct||N),fog:!!F,useFog:!0===b.fog,fogExp2:F&&F.isFogExp2,flatShading:!0===b.flatShading,sizeAttenuation:!0===b.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===L.isSkinnedMesh,morphTargets:void 0!==k.morphAttributes.position,morphNormals:void 0!==k.morphAttributes.normal,morphColors:void 0!==k.morphAttributes.color,morphTargetsCount:U,morphTextureStride:q,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:b.dithering,shadowMapEnabled:n.shadowMap.enabled&&O.length>0,shadowMapType:n.shadowMap.type,toneMapping:zt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:ct&&!0===b.map.isVideoTexture&&b.map.colorSpace===wt,premultipliedAlpha:b.premultipliedAlpha,doubleSided:2===b.side,flipSided:1===b.side,useDepthPacking:b.depthPacking>=0,depthPacking:b.depthPacking||0,index0AttributeName:b.index0AttributeName,extensionDerivatives:ce&&!0===b.extensions.derivatives,extensionFragDepth:ce&&!0===b.extensions.fragDepth,extensionDrawBuffers:ce&&!0===b.extensions.drawBuffers,extensionShaderTextureLOD:ce&&!0===b.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:b.customProgramCacheKey()}},getProgramCacheKey:function m(b){const C=[];if(b.shaderID?C.push(b.shaderID):(C.push(b.customVertexShaderID),C.push(b.customFragmentShaderID)),void 0!==b.defines)for(const O in b.defines)C.push(O),C.push(b.defines[O]);return!1===b.isRawShaderMaterial&&(function v(b,C){b.push(C.precision),b.push(C.outputColorSpace),b.push(C.envMapMode),b.push(C.envMapCubeUVHeight),b.push(C.mapUv),b.push(C.alphaMapUv),b.push(C.lightMapUv),b.push(C.aoMapUv),b.push(C.bumpMapUv),b.push(C.normalMapUv),b.push(C.displacementMapUv),b.push(C.emissiveMapUv),b.push(C.metalnessMapUv),b.push(C.roughnessMapUv),b.push(C.anisotropyMapUv),b.push(C.clearcoatMapUv),b.push(C.clearcoatNormalMapUv),b.push(C.clearcoatRoughnessMapUv),b.push(C.iridescenceMapUv),b.push(C.iridescenceThicknessMapUv),b.push(C.sheenColorMapUv),b.push(C.sheenRoughnessMapUv),b.push(C.specularMapUv),b.push(C.specularColorMapUv),b.push(C.specularIntensityMapUv),b.push(C.transmissionMapUv),b.push(C.thicknessMapUv),b.push(C.combine),b.push(C.fogExp2),b.push(C.sizeAttenuation),b.push(C.morphTargetsCount),b.push(C.morphAttributeCount),b.push(C.numDirLights),b.push(C.numPointLights),b.push(C.numSpotLights),b.push(C.numSpotLightMaps),b.push(C.numHemiLights),b.push(C.numRectAreaLights),b.push(C.numDirLightShadows),b.push(C.numPointLightShadows),b.push(C.numSpotLightShadows),b.push(C.numSpotLightShadowsWithMaps),b.push(C.shadowMapType),b.push(C.toneMapping),b.push(C.numClippingPlanes),b.push(C.numClipIntersection),b.push(C.depthPacking)}(C,b),function y(b,C){a.disableAll(),C.isWebGL2&&a.enable(0),C.supportsVertexTextures&&a.enable(1),C.instancing&&a.enable(2),C.instancingColor&&a.enable(3),C.matcap&&a.enable(4),C.envMap&&a.enable(5),C.normalMapObjectSpace&&a.enable(6),C.normalMapTangentSpace&&a.enable(7),C.clearcoat&&a.enable(8),C.iridescence&&a.enable(9),C.alphaTest&&a.enable(10),C.vertexColors&&a.enable(11),C.vertexAlphas&&a.enable(12),C.vertexUv1s&&a.enable(13),C.vertexUv2s&&a.enable(14),C.vertexUv3s&&a.enable(15),C.vertexTangents&&a.enable(16),C.anisotropy&&a.enable(17),b.push(a.mask),a.disableAll(),C.fog&&a.enable(0),C.useFog&&a.enable(1),C.flatShading&&a.enable(2),C.logarithmicDepthBuffer&&a.enable(3),C.skinning&&a.enable(4),C.morphTargets&&a.enable(5),C.morphNormals&&a.enable(6),C.morphColors&&a.enable(7),C.premultipliedAlpha&&a.enable(8),C.shadowMapEnabled&&a.enable(9),C.useLegacyLights&&a.enable(10),C.doubleSided&&a.enable(11),C.flipSided&&a.enable(12),C.useDepthPacking&&a.enable(13),C.dithering&&a.enable(14),C.transmission&&a.enable(15),C.sheen&&a.enable(16),C.opaque&&a.enable(17),C.pointsUvs&&a.enable(18),C.decodeVideoTexture&&a.enable(19),b.push(a.mask)}(C,b),C.push(n.outputColorSpace)),C.push(b.customProgramCacheKey),C.join()},getUniforms:function w(b){const C=p[b.type];let O;return O=C?hZ.clone(ws[C].uniforms):b.uniforms,O},acquireProgram:function x(b,C){let O;for(let B=0,L=l.length;B<L;B++){const F=l[B];if(F.cacheKey===C){O=F,++O.usedTimes;break}}return void 0===O&&(O=new zQ(n,C,b,s),l.push(O)),O},releaseProgram:function S(b){if(0==--b.usedTimes){const C=l.indexOf(b);l[C]=l[l.length-1],l.pop(),b.destroy()}},releaseShaderCache:function M(b){c.remove(b)},programs:l,dispose:function E(){c.dispose()}}}function $Q(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function XQ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function kO(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function UO(){const n=[];let e=0;const t=[],i=[],r=[];function o(h,d,f,p,g,_){let m=n[e];return void 0===m?(m={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:g,group:_},n[e]=m):(m.id=h.id,m.object=h,m.geometry=d,m.material=f,m.groupOrder=p,m.renderOrder=h.renderOrder,m.z=g,m.group=_),e++,m}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(h,d,f,p,g,_){const m=o(h,d,f,p,g,_);f.transmission>0?i.push(m):!0===f.transparent?r.push(m):t.push(m)},unshift:function c(h,d,f,p,g,_){const m=o(h,d,f,p,g,_);f.transmission>0?i.unshift(m):!0===f.transparent?r.unshift(m):t.unshift(m)},finish:function u(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function l(h,d){t.length>1&&t.sort(h||XQ),i.length>1&&i.sort(d||kO),r.length>1&&r.sort(d||kO)}}}function qQ(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new UO,n.set(i,[o])):r>=s.length?(o=new UO,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function YQ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new A,color:new Y};break;case"SpotLight":t={position:new A,direction:new A,color:new Y,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new A,color:new Y,distance:0,decay:0};break;case"HemisphereLight":t={direction:new A,skyColor:new Y,groundColor:new Y};break;case"RectAreaLight":t={color:new Y,position:new A,halfWidth:new A,halfHeight:new A}}return n[e.id]=t,t}}}let KQ=0;function JQ(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function QQ(n,e){const t=new YQ,i=function ZQ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new J};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new J,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new A);const s=new A,o=new Ve,a=new Ve;return{setup:function c(u,h){let d=0,f=0,p=0;for(let O=0;O<9;O++)r.probe[O].set(0,0,0);let g=0,_=0,m=0,v=0,y=0,w=0,x=0,S=0,M=0,E=0;u.sort(JQ);const b=!0===h?Math.PI:1;for(let O=0,B=u.length;O<B;O++){const L=u[O],F=L.color,k=L.intensity,W=L.distance,H=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)d+=F.r*k*b,f+=F.g*k*b,p+=F.b*k*b;else if(L.isLightProbe)for(let X=0;X<9;X++)r.probe[X].addScaledVector(L.sh.coefficients[X],k);else if(L.isDirectionalLight){const X=t.get(L);if(X.color.copy(L.color).multiplyScalar(L.intensity*b),L.castShadow){const Q=L.shadow,te=i.get(L);te.shadowBias=Q.bias,te.shadowNormalBias=Q.normalBias,te.shadowRadius=Q.radius,te.shadowMapSize=Q.mapSize,r.directionalShadow[g]=te,r.directionalShadowMap[g]=H,r.directionalShadowMatrix[g]=L.shadow.matrix,w++}r.directional[g]=X,g++}else if(L.isSpotLight){const X=t.get(L);X.position.setFromMatrixPosition(L.matrixWorld),X.color.copy(F).multiplyScalar(k*b),X.distance=W,X.coneCos=Math.cos(L.angle),X.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),X.decay=L.decay,r.spot[m]=X;const Q=L.shadow;if(L.map&&(r.spotLightMap[M]=L.map,M++,Q.updateMatrices(L),L.castShadow&&E++),r.spotLightMatrix[m]=Q.matrix,L.castShadow){const te=i.get(L);te.shadowBias=Q.bias,te.shadowNormalBias=Q.normalBias,te.shadowRadius=Q.radius,te.shadowMapSize=Q.mapSize,r.spotShadow[m]=te,r.spotShadowMap[m]=H,S++}m++}else if(L.isRectAreaLight){const X=t.get(L);X.color.copy(F).multiplyScalar(k),X.halfWidth.set(.5*L.width,0,0),X.halfHeight.set(0,.5*L.height,0),r.rectArea[v]=X,v++}else if(L.isPointLight){const X=t.get(L);if(X.color.copy(L.color).multiplyScalar(L.intensity*b),X.distance=L.distance,X.decay=L.decay,L.castShadow){const Q=L.shadow,te=i.get(L);te.shadowBias=Q.bias,te.shadowNormalBias=Q.normalBias,te.shadowRadius=Q.radius,te.shadowMapSize=Q.mapSize,te.shadowCameraNear=Q.camera.near,te.shadowCameraFar=Q.camera.far,r.pointShadow[_]=te,r.pointShadowMap[_]=H,r.pointShadowMatrix[_]=L.shadow.matrix,x++}r.point[_]=X,_++}else if(L.isHemisphereLight){const X=t.get(L);X.skyColor.copy(L.color).multiplyScalar(k*b),X.groundColor.copy(L.groundColor).multiplyScalar(k*b),r.hemi[y]=X,y++}}v>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ye.LTC_FLOAT_1,r.rectAreaLTC2=ye.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ye.LTC_HALF_1,r.rectAreaLTC2=ye.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const C=r.hash;(C.directionalLength!==g||C.pointLength!==_||C.spotLength!==m||C.rectAreaLength!==v||C.hemiLength!==y||C.numDirectionalShadows!==w||C.numPointShadows!==x||C.numSpotShadows!==S||C.numSpotMaps!==M)&&(r.directional.length=g,r.spot.length=m,r.rectArea.length=v,r.point.length=_,r.hemi.length=y,r.directionalShadow.length=w,r.directionalShadowMap.length=w,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=w,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=S+M-E,r.spotLightMap.length=M,r.numSpotLightShadowsWithMaps=E,C.directionalLength=g,C.pointLength=_,C.spotLength=m,C.rectAreaLength=v,C.hemiLength=y,C.numDirectionalShadows=w,C.numPointShadows=x,C.numSpotShadows=S,C.numSpotMaps=M,r.version=KQ++)},setupView:function l(u,h){let d=0,f=0,p=0,g=0,_=0;const m=h.matrixWorldInverse;for(let v=0,y=u.length;v<y;v++){const w=u[v];if(w.isDirectionalLight){const x=r.directional[d];x.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(m),d++}else if(w.isSpotLight){const x=r.spot[p];x.position.setFromMatrixPosition(w.matrixWorld),x.position.applyMatrix4(m),x.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(m),p++}else if(w.isRectAreaLight){const x=r.rectArea[g];x.position.setFromMatrixPosition(w.matrixWorld),x.position.applyMatrix4(m),a.identity(),o.copy(w.matrixWorld),o.premultiply(m),a.extractRotation(o),x.halfWidth.set(.5*w.width,0,0),x.halfHeight.set(0,.5*w.height,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),g++}else if(w.isPointLight){const x=r.point[f];x.position.setFromMatrixPosition(w.matrixWorld),x.position.applyMatrix4(m),f++}else if(w.isHemisphereLight){const x=r.hemi[_];x.direction.setFromMatrixPosition(w.matrixWorld),x.direction.transformDirection(m),_++}}},state:r}}function BO(n,e){const t=new QQ(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function c(h){t.setup(i,h)},setupLightsView:function l(h){t.setupView(i,h)},pushLight:function o(h){i.push(h)},pushShadow:function a(h){r.push(h)}}}function eee(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let c;return void 0===a?(c=new BO(n,e),t.set(s,[c])):o>=a.length?(c=new BO(n,e),a.push(c)):c=a[o],c},dispose:function r(){t=new WeakMap}}}class VO extends Li{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class zO extends Li{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function iee(n,e,t){let i=new Mb;const r=new J,s=new J,o=new It,a=new VO({depthPacking:3201}),c=new zO,l={},u=t.maxTextureSize,h={0:1,1:0,2:2},d=new ys({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new J},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new et;p.setAttribute("position",new jt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new xt(p,d),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=KL;let m=this.type;function v(x,S){const M=e.update(g);d.defines.VSM_SAMPLES!==x.blurSamples&&(d.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new Ba(r.x,r.y)),d.uniforms.shadow_pass.value=x.map.texture,d.uniforms.resolution.value=x.mapSize,d.uniforms.radius.value=x.radius,n.setRenderTarget(x.mapPass),n.clear(),n.renderBufferDirect(S,null,M,d,g,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,n.setRenderTarget(x.map),n.clear(),n.renderBufferDirect(S,null,M,f,g,null)}function y(x,S,M,E){let b=null;const C=!0===M.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(void 0!==C)b=C;else if(b=!0===M.isPointLight?c:a,n.localClippingEnabled&&!0===S.clipShadows&&Array.isArray(S.clippingPlanes)&&0!==S.clippingPlanes.length||S.displacementMap&&0!==S.displacementScale||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){const O=b.uuid,B=S.uuid;let L=l[O];void 0===L&&(L={},l[O]=L);let F=L[B];void 0===F&&(F=b.clone(),L[B]=F),b=F}return b.visible=S.visible,b.wireframe=S.wireframe,b.side=E===Xs?null!==S.shadowSide?S.shadowSide:S.side:null!==S.shadowSide?S.shadowSide:h[S.side],b.alphaMap=S.alphaMap,b.alphaTest=S.alphaTest,b.map=S.map,b.clipShadows=S.clipShadows,b.clippingPlanes=S.clippingPlanes,b.clipIntersection=S.clipIntersection,b.displacementMap=S.displacementMap,b.displacementScale=S.displacementScale,b.displacementBias=S.displacementBias,b.wireframeLinewidth=S.wireframeLinewidth,b.linewidth=S.linewidth,!0===M.isPointLight&&!0===b.isMeshDistanceMaterial&&(n.properties.get(b).light=M),b}function w(x,S,M,E,b){if(!1===x.visible)return;if(x.layers.test(S.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&b===Xs)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,x.matrixWorld);const B=e.update(x),L=x.material;if(Array.isArray(L)){const F=B.groups;for(let k=0,W=F.length;k<W;k++){const H=F[k],X=L[H.materialIndex];if(X&&X.visible){const Q=y(x,X,E,b);n.renderBufferDirect(M,null,B,Q,x,H)}}}else if(L.visible){const F=y(x,L,E,b);n.renderBufferDirect(M,null,B,F,x,null)}}const O=x.children;for(let B=0,L=O.length;B<L;B++)w(O[B],S,M,E,b)}this.render=function(x,S,M){if(!1===_.enabled||!1===_.autoUpdate&&!1===_.needsUpdate||0===x.length)return;const E=n.getRenderTarget(),b=n.getActiveCubeFace(),C=n.getActiveMipmapLevel(),O=n.state;O.setBlending(0),O.buffers.color.setClear(1,1,1,1),O.buffers.depth.setTest(!0),O.setScissorTest(!1);const B=m!==Xs&&this.type===Xs,L=m===Xs&&this.type!==Xs;for(let F=0,k=x.length;F<k;F++){const W=x[F],H=W.shadow;if(void 0===H){console.warn("THREE.WebGLShadowMap:",W,"has no shadow.");continue}if(!1===H.autoUpdate&&!1===H.needsUpdate)continue;r.copy(H.mapSize);const X=H.getFrameExtents();if(r.multiply(X),s.copy(H.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/X.x),r.x=s.x*X.x,H.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/X.y),r.y=s.y*X.y,H.mapSize.y=s.y)),null===H.map||!0===B||!0===L){const te=this.type!==Xs?{minFilter:dn,magFilter:dn}:{};null!==H.map&&H.map.dispose(),H.map=new Ba(r.x,r.y,te),H.map.texture.name=W.name+".shadowMap",H.camera.updateProjectionMatrix()}n.setRenderTarget(H.map),n.clear();const Q=H.getViewportCount();for(let te=0;te<Q;te++){const U=H.getViewport(te);o.set(s.x*U.x,s.y*U.y,s.x*U.z,s.y*U.w),O.viewport(o),H.updateMatrices(W,te),i=H.getFrustum(),w(S,M,H.camera,W,this.type)}!0!==H.isPointLightShadow&&this.type===Xs&&v(H,M),H.needsUpdate=!1}m=this.type,_.needsUpdate=!1,n.setRenderTarget(E,b,C)}}function ree(n,e,t){const i=t.isWebGL2,a=new function r(){let N=!1;const we=new It;let $=null;const ce=new It(0,0,0,0);return{setMask:function(_e){$!==_e&&!N&&(n.colorMask(_e,_e,_e,_e),$=_e)},setLocked:function(_e){N=_e},setClear:function(_e,dt,Tt,zt,tr){!0===tr&&(_e*=zt,dt*=zt,Tt*=zt),we.set(_e,dt,Tt,zt),!1===ce.equals(we)&&(n.clearColor(_e,dt,Tt,zt),ce.copy(we))},reset:function(){N=!1,$=null,ce.set(-1,0,0,0)}}},c=new function s(){let N=!1,we=null,$=null,ce=null;return{setTest:function(_e){_e?Pe(n.DEPTH_TEST):Te(n.DEPTH_TEST)},setMask:function(_e){we!==_e&&!N&&(n.depthMask(_e),we=_e)},setFunc:function(_e){if($!==_e){switch(_e){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}$=_e}},setLocked:function(_e){N=_e},setClear:function(_e){ce!==_e&&(n.clearDepth(_e),ce=_e)},reset:function(){N=!1,we=null,$=null,ce=null}}},l=new function o(){let N=!1,we=null,$=null,ce=null,_e=null,dt=null,Tt=null,zt=null,tr=null;return{setTest:function($t){N||($t?Pe(n.STENCIL_TEST):Te(n.STENCIL_TEST))},setMask:function($t){we!==$t&&!N&&(n.stencilMask($t),we=$t)},setFunc:function($t,Es,vi){($!==$t||ce!==Es||_e!==vi)&&(n.stencilFunc($t,Es,vi),$=$t,ce=Es,_e=vi)},setOp:function($t,Es,vi){(dt!==$t||Tt!==Es||zt!==vi)&&(n.stencilOp($t,Es,vi),dt=$t,Tt=Es,zt=vi)},setLocked:function($t){N=$t},setClear:function($t){tr!==$t&&(n.clearStencil($t),tr=$t)},reset:function(){N=!1,we=null,$=null,ce=null,_e=null,dt=null,Tt=null,zt=null,tr=null}}},u=new WeakMap,h=new WeakMap;let d={},f={},p=new WeakMap,g=[],_=null,m=!1,v=null,y=null,w=null,x=null,S=null,M=null,E=null,b=!1,C=null,O=null,B=null,L=null,F=null;const k=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,H=0;const X=n.getParameter(n.VERSION);-1!==X.indexOf("WebGL")?(H=parseFloat(/^WebGL (\d)/.exec(X)[1]),W=H>=1):-1!==X.indexOf("OpenGL ES")&&(H=parseFloat(/^OpenGL ES (\d)/.exec(X)[1]),W=H>=2);let Q=null,te={};const U=n.getParameter(n.SCISSOR_BOX),q=n.getParameter(n.VIEWPORT),ae=(new It).fromArray(U),oe=(new It).fromArray(q);function le(N,we,$,ce){const _e=new Uint8Array(4),dt=n.createTexture();n.bindTexture(N,dt),n.texParameteri(N,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(N,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Tt=0;Tt<$;Tt++)!i||N!==n.TEXTURE_3D&&N!==n.TEXTURE_2D_ARRAY?n.texImage2D(we+Tt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,_e):n.texImage3D(we,0,n.RGBA,1,1,ce,0,n.RGBA,n.UNSIGNED_BYTE,_e);return dt}const Ee={};function Pe(N){!0!==d[N]&&(n.enable(N),d[N]=!0)}function Te(N){!1!==d[N]&&(n.disable(N),d[N]=!1)}Ee[n.TEXTURE_2D]=le(n.TEXTURE_2D,n.TEXTURE_2D,1),Ee[n.TEXTURE_CUBE_MAP]=le(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Ee[n.TEXTURE_2D_ARRAY]=le(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ee[n.TEXTURE_3D]=le(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),c.setClear(1),l.setClear(0),Pe(n.DEPTH_TEST),c.setFunc(3),re(!1),Fe(1),Pe(n.CULL_FACE),ne(0);const R={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)R[103]=n.MIN,R[104]=n.MAX;else{const N=e.get("EXT_blend_minmax");null!==N&&(R[103]=N.MIN_EXT,R[104]=N.MAX_EXT)}const ge={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA};function ne(N,we,$,ce,_e,dt,Tt,zt){if(0!==N){if(!1===m&&(Pe(n.BLEND),m=!0),5===N)_e=_e||we,dt=dt||$,Tt=Tt||ce,(we!==y||_e!==S)&&(n.blendEquationSeparate(R[we],R[_e]),y=we,S=_e),($!==w||ce!==x||dt!==M||Tt!==E)&&(n.blendFuncSeparate(ge[$],ge[ce],ge[dt],ge[Tt]),w=$,x=ce,M=dt,E=Tt),v=N,b=!1;else if(N!==v||zt!==b){if((100!==y||100!==S)&&(n.blendEquation(n.FUNC_ADD),y=100,S=100),zt)switch(N){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",N)}else switch(N){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",N)}w=null,x=null,M=null,E=null,v=N,b=zt}}else!0===m&&(Te(n.BLEND),m=!1)}function re(N){C!==N&&(n.frontFace(N?n.CW:n.CCW),C=N)}function Fe(N){0!==N?(Pe(n.CULL_FACE),N!==O&&n.cullFace(1===N?n.BACK:2===N?n.FRONT:n.FRONT_AND_BACK)):Te(n.CULL_FACE),O=N}function Ae(N,we,$){N?(Pe(n.POLYGON_OFFSET_FILL),(L!==we||F!==$)&&(n.polygonOffset(we,$),L=we,F=$)):Te(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:c,stencil:l},enable:Pe,disable:Te,bindFramebuffer:function ct(N,we){return f[N]!==we&&(n.bindFramebuffer(N,we),f[N]=we,i&&(N===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=we),N===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=we)),!0)},drawBuffers:function tt(N,we){let $=g,ce=!1;if(N)if($=p.get(we),void 0===$&&($=[],p.set(we,$)),N.isWebGLMultipleRenderTargets){const _e=N.texture;if($.length!==_e.length||$[0]!==n.COLOR_ATTACHMENT0){for(let dt=0,Tt=_e.length;dt<Tt;dt++)$[dt]=n.COLOR_ATTACHMENT0+dt;$.length=_e.length,ce=!0}}else $[0]!==n.COLOR_ATTACHMENT0&&($[0]=n.COLOR_ATTACHMENT0,ce=!0);else $[0]!==n.BACK&&($[0]=n.BACK,ce=!0);ce&&(t.isWebGL2?n.drawBuffers($):e.get("WEBGL_draw_buffers").drawBuffersWEBGL($))},useProgram:function Ne(N){return _!==N&&(n.useProgram(N),_=N,!0)},setBlending:ne,setMaterial:function de(N,we){2===N.side?Te(n.CULL_FACE):Pe(n.CULL_FACE);let $=1===N.side;we&&($=!$),re($),1===N.blending&&!1===N.transparent?ne(0):ne(N.blending,N.blendEquation,N.blendSrc,N.blendDst,N.blendEquationAlpha,N.blendSrcAlpha,N.blendDstAlpha,N.premultipliedAlpha),c.setFunc(N.depthFunc),c.setTest(N.depthTest),c.setMask(N.depthWrite),a.setMask(N.colorWrite);const ce=N.stencilWrite;l.setTest(ce),ce&&(l.setMask(N.stencilWriteMask),l.setFunc(N.stencilFunc,N.stencilRef,N.stencilFuncMask),l.setOp(N.stencilFail,N.stencilZFail,N.stencilZPass)),Ae(N.polygonOffset,N.polygonOffsetFactor,N.polygonOffsetUnits),!0===N.alphaToCoverage?Pe(n.SAMPLE_ALPHA_TO_COVERAGE):Te(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:re,setCullFace:Fe,setLineWidth:function Ce(N){N!==B&&(W&&n.lineWidth(N),B=N)},setPolygonOffset:Ae,setScissorTest:function ze(N){N?Pe(n.SCISSOR_TEST):Te(n.SCISSOR_TEST)},activeTexture:function ht(N){void 0===N&&(N=n.TEXTURE0+k-1),Q!==N&&(n.activeTexture(N),Q=N)},bindTexture:function qt(N,we,$){void 0===$&&($=null===Q?n.TEXTURE0+k-1:Q);let ce=te[$];void 0===ce&&(ce={type:void 0,texture:void 0},te[$]=ce),(ce.type!==N||ce.texture!==we)&&(Q!==$&&(n.activeTexture($),Q=$),n.bindTexture(N,we||Ee[N]),ce.type=N,ce.texture=we)},unbindTexture:function I(){const N=te[Q];void 0!==N&&void 0!==N.type&&(n.bindTexture(N.type,null),N.type=void 0,N.texture=void 0)},compressedTexImage2D:function T(){try{n.compressedTexImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},compressedTexImage3D:function G(){try{n.compressedTexImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texImage2D:function P(){try{n.texImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texImage3D:function ie(){try{n.texImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},updateUBOMapping:function be(N,we){let $=h.get(we);void 0===$&&($=new WeakMap,h.set(we,$));let ce=$.get(N);void 0===ce&&(ce=n.getUniformBlockIndex(we,N.name),$.set(N,ce))},uniformBlockBinding:function Qe(N,we){const ce=h.get(we).get(N);u.get(we)!==ce&&(n.uniformBlockBinding(we,ce,N.__bindingPointIndex),u.set(we,ce))},texStorage2D:function pe(){try{n.texStorage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texStorage3D:function j(){try{n.texStorage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texSubImage2D:function ue(){try{n.texSubImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},texSubImage3D:function se(){try{n.texSubImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},compressedTexSubImage2D:function fe(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},compressedTexSubImage3D:function Oe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(N){console.error("THREE.WebGLState:",N)}},scissor:function Me(N){!1===ae.equals(N)&&(n.scissor(N.x,N.y,N.z,N.w),ae.copy(N))},viewport:function ve(N){!1===oe.equals(N)&&(n.viewport(N.x,N.y,N.z,N.w),oe.copy(N))},reset:function yt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},Q=null,te={},f={},p=new WeakMap,g=[],_=null,m=!1,v=null,y=null,w=null,x=null,S=null,M=null,E=null,b=!1,C=null,O=null,B=null,L=null,F=null,ae.set(0,0,n.canvas.width,n.canvas.height),oe.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),l.reset()}}}function see(n,e,t,i,r,s,o){const a=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let g;const _=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(I,T){return m?new OffscreenCanvas(I,T):xd("canvas")}function y(I,T,G,ue){let se=1;if((I.width>ue||I.height>ue)&&(se=ue/Math.max(I.width,I.height)),se<1||!0===T){if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap){const fe=T?Jm:Math.floor,Oe=fe(se*I.width),pe=fe(se*I.height);void 0===g&&(g=v(Oe,pe));const j=G?v(Oe,pe):g;return j.width=Oe,j.height=pe,j.getContext("2d").drawImage(I,0,0,Oe,pe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+I.width+"x"+I.height+") to ("+Oe+"x"+pe+")."),j}return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+I.width+"x"+I.height+")."),I}return I}function w(I){return nb(I.width)&&nb(I.height)}function S(I,T){return I.generateMipmaps&&T&&I.minFilter!==dn&&I.minFilter!==Xt}function M(I){n.generateMipmap(I)}function E(I,T,G,ue,se=!1){if(!1===a)return T;if(null!==I){if(void 0!==n[I])return n[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let fe=T;return T===n.RED&&(G===n.FLOAT&&(fe=n.R32F),G===n.HALF_FLOAT&&(fe=n.R16F),G===n.UNSIGNED_BYTE&&(fe=n.R8)),T===n.RED_INTEGER&&(G===n.UNSIGNED_BYTE&&(fe=n.R8UI),G===n.UNSIGNED_SHORT&&(fe=n.R16UI),G===n.UNSIGNED_INT&&(fe=n.R32UI),G===n.BYTE&&(fe=n.R8I),G===n.SHORT&&(fe=n.R16I),G===n.INT&&(fe=n.R32I)),T===n.RG&&(G===n.FLOAT&&(fe=n.RG32F),G===n.HALF_FLOAT&&(fe=n.RG16F),G===n.UNSIGNED_BYTE&&(fe=n.RG8)),T===n.RGBA&&(G===n.FLOAT&&(fe=n.RGBA32F),G===n.HALF_FLOAT&&(fe=n.RGBA16F),G===n.UNSIGNED_BYTE&&(fe=ue===wt&&!1===se?n.SRGB8_ALPHA8:n.RGBA8),G===n.UNSIGNED_SHORT_4_4_4_4&&(fe=n.RGBA4),G===n.UNSIGNED_SHORT_5_5_5_1&&(fe=n.RGB5_A1)),(fe===n.R16F||fe===n.R32F||fe===n.RG16F||fe===n.RG32F||fe===n.RGBA16F||fe===n.RGBA32F)&&e.get("EXT_color_buffer_float"),fe}function b(I,T,G){return!0===S(I,G)||I.isFramebufferTexture&&I.minFilter!==dn&&I.minFilter!==Xt?Math.log2(Math.max(T.width,T.height))+1:void 0!==I.mipmaps&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?T.mipmaps.length:1}function C(I){return I===dn||1004===I||1005===I?n.NEAREST:n.LINEAR}function O(I){const T=I.target;T.removeEventListener("dispose",O),function L(I){const T=i.get(I);if(void 0===T.__webglInit)return;const G=I.source,ue=_.get(G);if(ue){const se=ue[T.__cacheKey];se.usedTimes--,0===se.usedTimes&&F(I),0===Object.keys(ue).length&&_.delete(G)}i.remove(I)}(T),T.isVideoTexture&&p.delete(T)}function B(I){const T=I.target;T.removeEventListener("dispose",B),function k(I){const T=I.texture,G=i.get(I),ue=i.get(T);if(void 0!==ue.__webglTexture&&(n.deleteTexture(ue.__webglTexture),o.memory.textures--),I.depthTexture&&I.depthTexture.dispose(),I.isWebGLCubeRenderTarget)for(let se=0;se<6;se++){if(Array.isArray(G.__webglFramebuffer[se]))for(let fe=0;fe<G.__webglFramebuffer[se].length;fe++)n.deleteFramebuffer(G.__webglFramebuffer[se][fe]);else n.deleteFramebuffer(G.__webglFramebuffer[se]);G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer[se])}else{if(Array.isArray(G.__webglFramebuffer))for(let se=0;se<G.__webglFramebuffer.length;se++)n.deleteFramebuffer(G.__webglFramebuffer[se]);else n.deleteFramebuffer(G.__webglFramebuffer);if(G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&n.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer)for(let se=0;se<G.__webglColorRenderbuffer.length;se++)G.__webglColorRenderbuffer[se]&&n.deleteRenderbuffer(G.__webglColorRenderbuffer[se]);G.__webglDepthRenderbuffer&&n.deleteRenderbuffer(G.__webglDepthRenderbuffer)}if(I.isWebGLMultipleRenderTargets)for(let se=0,fe=T.length;se<fe;se++){const Oe=i.get(T[se]);Oe.__webglTexture&&(n.deleteTexture(Oe.__webglTexture),o.memory.textures--),i.remove(T[se])}i.remove(T),i.remove(I)}(T)}function F(I){const T=i.get(I);n.deleteTexture(T.__webglTexture),delete _.get(I.source)[T.__cacheKey],o.memory.textures--}let W=0;function te(I,T){const G=i.get(I);if(I.isVideoTexture&&function ht(I){const T=o.render.frame;p.get(I)!==T&&(p.set(I,T),I.update())}(I),!1===I.isRenderTargetTexture&&I.version>0&&G.__version!==I.version){const ue=I.image;if(null===ue)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ue.complete)return void ct(G,I,T);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,G.__webglTexture,n.TEXTURE0+T)}const oe={[Ra]:n.REPEAT,[ti]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},le={[dn]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[Xt]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[Zs]:n.LINEAR_MIPMAP_LINEAR},Ee={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Pe(I,T,G){if(G?(n.texParameteri(I,n.TEXTURE_WRAP_S,oe[T.wrapS]),n.texParameteri(I,n.TEXTURE_WRAP_T,oe[T.wrapT]),(I===n.TEXTURE_3D||I===n.TEXTURE_2D_ARRAY)&&n.texParameteri(I,n.TEXTURE_WRAP_R,oe[T.wrapR]),n.texParameteri(I,n.TEXTURE_MAG_FILTER,le[T.magFilter]),n.texParameteri(I,n.TEXTURE_MIN_FILTER,le[T.minFilter])):(n.texParameteri(I,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(I,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(I===n.TEXTURE_3D||I===n.TEXTURE_2D_ARRAY)&&n.texParameteri(I,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(T.wrapS!==ti||T.wrapT!==ti)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(I,n.TEXTURE_MAG_FILTER,C(T.magFilter)),n.texParameteri(I,n.TEXTURE_MIN_FILTER,C(T.minFilter)),T.minFilter!==dn&&T.minFilter!==Xt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),T.compareFunction&&(n.texParameteri(I,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(I,n.TEXTURE_COMPARE_FUNC,Ee[T.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const ue=e.get("EXT_texture_filter_anisotropic");if(T.magFilter===dn||1005!==T.minFilter&&T.minFilter!==Zs||T.type===Ks&&!1===e.has("OES_texture_float_linear")||!1===a&&T.type===vd&&!1===e.has("OES_texture_half_float_linear"))return;(T.anisotropy>1||i.get(T).__currentAnisotropy)&&(n.texParameterf(I,ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(T.anisotropy,r.getMaxAnisotropy())),i.get(T).__currentAnisotropy=T.anisotropy)}}function Te(I,T){let G=!1;void 0===I.__webglInit&&(I.__webglInit=!0,T.addEventListener("dispose",O));const ue=T.source;let se=_.get(ue);void 0===se&&(se={},_.set(ue,se));const fe=function Q(I){const T=[];return T.push(I.wrapS),T.push(I.wrapT),T.push(I.wrapR||0),T.push(I.magFilter),T.push(I.minFilter),T.push(I.anisotropy),T.push(I.internalFormat),T.push(I.format),T.push(I.type),T.push(I.generateMipmaps),T.push(I.premultiplyAlpha),T.push(I.flipY),T.push(I.unpackAlignment),T.push(I.colorSpace),T.join()}(T);if(fe!==I.__cacheKey){void 0===se[fe]&&(se[fe]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,G=!0),se[fe].usedTimes++;const Oe=se[I.__cacheKey];void 0!==Oe&&(se[I.__cacheKey].usedTimes--,0===Oe.usedTimes&&F(T)),I.__cacheKey=fe,I.__webglTexture=se[fe].texture}return G}function ct(I,T,G){let ue=n.TEXTURE_2D;(T.isDataArrayTexture||T.isCompressedArrayTexture)&&(ue=n.TEXTURE_2D_ARRAY),T.isData3DTexture&&(ue=n.TEXTURE_3D);const se=Te(I,T),fe=T.source;t.bindTexture(ue,I.__webglTexture,n.TEXTURE0+G);const Oe=i.get(fe);if(fe.version!==Oe.__version||!0===se){t.activeTexture(n.TEXTURE0+G),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,T.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,T.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,T.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const pe=function x(I){return!a&&(I.wrapS!==ti||I.wrapT!==ti||I.minFilter!==dn&&I.minFilter!==Xt)}(T)&&!1===w(T.image);let j=y(T.image,pe,!1,u);j=qt(T,j);const P=w(j)||a,ie=s.convert(T.format,T.colorSpace);let be,Me=s.convert(T.type),ve=E(T.internalFormat,ie,Me,T.colorSpace,T.isVideoTexture);Pe(ue,T,P);const Qe=T.mipmaps,yt=a&&!0!==T.isVideoTexture,N=void 0===Oe.__version||!0===se,we=b(T,j,P);if(T.isDepthTexture)ve=n.DEPTH_COMPONENT,a?ve=T.type===Ks?n.DEPTH_COMPONENT32F:T.type===zo?n.DEPTH_COMPONENT24:T.type===Pa?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:T.type===Ks&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),T.format===La&&ve===n.DEPTH_COMPONENT&&1012!==T.type&&T.type!==zo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),T.type=zo,Me=s.convert(T.type)),T.format===kl&&ve===n.DEPTH_COMPONENT&&(ve=n.DEPTH_STENCIL,T.type!==Pa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),T.type=Pa,Me=s.convert(T.type))),N&&(yt?t.texStorage2D(n.TEXTURE_2D,1,ve,j.width,j.height):t.texImage2D(n.TEXTURE_2D,0,ve,j.width,j.height,0,ie,Me,null));else if(T.isDataTexture)if(Qe.length>0&&P){yt&&N&&t.texStorage2D(n.TEXTURE_2D,we,ve,Qe[0].width,Qe[0].height);for(let $=0,ce=Qe.length;$<ce;$++)be=Qe[$],yt?t.texSubImage2D(n.TEXTURE_2D,$,0,0,be.width,be.height,ie,Me,be.data):t.texImage2D(n.TEXTURE_2D,$,ve,be.width,be.height,0,ie,Me,be.data);T.generateMipmaps=!1}else yt?(N&&t.texStorage2D(n.TEXTURE_2D,we,ve,j.width,j.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,j.width,j.height,ie,Me,j.data)):t.texImage2D(n.TEXTURE_2D,0,ve,j.width,j.height,0,ie,Me,j.data);else if(T.isCompressedTexture)if(T.isCompressedArrayTexture){yt&&N&&t.texStorage3D(n.TEXTURE_2D_ARRAY,we,ve,Qe[0].width,Qe[0].height,j.depth);for(let $=0,ce=Qe.length;$<ce;$++)be=Qe[$],T.format!==xr?null!==ie?yt?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,$,0,0,0,be.width,be.height,j.depth,ie,be.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,$,ve,be.width,be.height,j.depth,0,be.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):yt?t.texSubImage3D(n.TEXTURE_2D_ARRAY,$,0,0,0,be.width,be.height,j.depth,ie,Me,be.data):t.texImage3D(n.TEXTURE_2D_ARRAY,$,ve,be.width,be.height,j.depth,0,ie,Me,be.data)}else{yt&&N&&t.texStorage2D(n.TEXTURE_2D,we,ve,Qe[0].width,Qe[0].height);for(let $=0,ce=Qe.length;$<ce;$++)be=Qe[$],T.format!==xr?null!==ie?yt?t.compressedTexSubImage2D(n.TEXTURE_2D,$,0,0,be.width,be.height,ie,be.data):t.compressedTexImage2D(n.TEXTURE_2D,$,ve,be.width,be.height,0,be.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):yt?t.texSubImage2D(n.TEXTURE_2D,$,0,0,be.width,be.height,ie,Me,be.data):t.texImage2D(n.TEXTURE_2D,$,ve,be.width,be.height,0,ie,Me,be.data)}else if(T.isDataArrayTexture)yt?(N&&t.texStorage3D(n.TEXTURE_2D_ARRAY,we,ve,j.width,j.height,j.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,j.width,j.height,j.depth,ie,Me,j.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,ve,j.width,j.height,j.depth,0,ie,Me,j.data);else if(T.isData3DTexture)yt?(N&&t.texStorage3D(n.TEXTURE_3D,we,ve,j.width,j.height,j.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,j.width,j.height,j.depth,ie,Me,j.data)):t.texImage3D(n.TEXTURE_3D,0,ve,j.width,j.height,j.depth,0,ie,Me,j.data);else if(T.isFramebufferTexture){if(N)if(yt)t.texStorage2D(n.TEXTURE_2D,we,ve,j.width,j.height);else{let $=j.width,ce=j.height;for(let _e=0;_e<we;_e++)t.texImage2D(n.TEXTURE_2D,_e,ve,$,ce,0,ie,Me,null),$>>=1,ce>>=1}}else if(Qe.length>0&&P){yt&&N&&t.texStorage2D(n.TEXTURE_2D,we,ve,Qe[0].width,Qe[0].height);for(let $=0,ce=Qe.length;$<ce;$++)be=Qe[$],yt?t.texSubImage2D(n.TEXTURE_2D,$,0,0,ie,Me,be):t.texImage2D(n.TEXTURE_2D,$,ve,ie,Me,be);T.generateMipmaps=!1}else yt?(N&&t.texStorage2D(n.TEXTURE_2D,we,ve,j.width,j.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ie,Me,j)):t.texImage2D(n.TEXTURE_2D,0,ve,ie,Me,j);S(T,P)&&M(ue),Oe.__version=fe.version,T.onUpdate&&T.onUpdate(T)}I.__version=T.version}function Ne(I,T,G,ue,se,fe){const Oe=s.convert(G.format,G.colorSpace),pe=s.convert(G.type),j=E(G.internalFormat,Oe,pe,G.colorSpace);if(!i.get(T).__hasExternalTextures){const ie=Math.max(1,T.width>>fe),Me=Math.max(1,T.height>>fe);se===n.TEXTURE_3D||se===n.TEXTURE_2D_ARRAY?t.texImage3D(se,fe,j,ie,Me,T.depth,0,Oe,pe,null):t.texImage2D(se,fe,j,ie,Me,0,Oe,pe,null)}t.bindFramebuffer(n.FRAMEBUFFER,I),ze(T)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ue,se,i.get(G).__webglTexture,0,Ae(T)):(se===n.TEXTURE_2D||se>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&se<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ue,se,i.get(G).__webglTexture,fe),t.bindFramebuffer(n.FRAMEBUFFER,null)}function R(I,T,G){if(n.bindRenderbuffer(n.RENDERBUFFER,I),T.depthBuffer&&!T.stencilBuffer){let ue=n.DEPTH_COMPONENT16;if(G||ze(T)){const se=T.depthTexture;se&&se.isDepthTexture&&(se.type===Ks?ue=n.DEPTH_COMPONENT32F:se.type===zo&&(ue=n.DEPTH_COMPONENT24));const fe=Ae(T);ze(T)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,fe,ue,T.width,T.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,fe,ue,T.width,T.height)}else n.renderbufferStorage(n.RENDERBUFFER,ue,T.width,T.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,I)}else if(T.depthBuffer&&T.stencilBuffer){const ue=Ae(T);G&&!1===ze(T)?n.renderbufferStorageMultisample(n.RENDERBUFFER,ue,n.DEPTH24_STENCIL8,T.width,T.height):ze(T)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ue,n.DEPTH24_STENCIL8,T.width,T.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,T.width,T.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,I)}else{const ue=!0===T.isWebGLMultipleRenderTargets?T.texture:[T.texture];for(let se=0;se<ue.length;se++){const fe=ue[se],Oe=s.convert(fe.format,fe.colorSpace),pe=s.convert(fe.type),j=E(fe.internalFormat,Oe,pe,fe.colorSpace),P=Ae(T);G&&!1===ze(T)?n.renderbufferStorageMultisample(n.RENDERBUFFER,P,j,T.width,T.height):ze(T)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,P,j,T.width,T.height):n.renderbufferStorage(n.RENDERBUFFER,j,T.width,T.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ne(I){const T=i.get(I),G=!0===I.isWebGLCubeRenderTarget;if(I.depthTexture&&!T.__autoAllocateDepthBuffer){if(G)throw new Error("target.depthTexture not supported in Cube render targets");!function ge(I,T){if(T&&T.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,I),!T.depthTexture||!T.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(T.depthTexture).__webglTexture||T.depthTexture.image.width!==T.width||T.depthTexture.image.height!==T.height)&&(T.depthTexture.image.width=T.width,T.depthTexture.image.height=T.height,T.depthTexture.needsUpdate=!0),te(T.depthTexture,0);const ue=i.get(T.depthTexture).__webglTexture,se=Ae(T);if(T.depthTexture.format===La)ze(T)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ue,0,se):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ue,0);else{if(T.depthTexture.format!==kl)throw new Error("Unknown depthTexture format");ze(T)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ue,0,se):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ue,0)}}(T.__webglFramebuffer,I)}else if(G){T.__webglDepthbuffer=[];for(let ue=0;ue<6;ue++)t.bindFramebuffer(n.FRAMEBUFFER,T.__webglFramebuffer[ue]),T.__webglDepthbuffer[ue]=n.createRenderbuffer(),R(T.__webglDepthbuffer[ue],I,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,T.__webglFramebuffer),T.__webglDepthbuffer=n.createRenderbuffer(),R(T.__webglDepthbuffer,I,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ae(I){return Math.min(h,I.samples)}function ze(I){const T=i.get(I);return a&&I.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==T.__useRenderToTexture}function qt(I,T){const G=I.colorSpace,ue=I.format,se=I.type;return!0===I.isCompressedTexture||!0===I.isVideoTexture||1035===I.format||G!==Rn&&""!==G&&(G===wt||G===Ym?!1===a?!0===e.has("EXT_sRGB")&&ue===xr?(I.format=1035,I.minFilter=Xt,I.generateMipmaps=!1):T=qN.sRGBToLinear(T):(ue!==xr||se!==Vo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",G)),T}this.allocateTextureUnit=function X(){const I=W;return I>=c&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+c),W+=1,I},this.resetTextureUnits=function H(){W=0},this.setTexture2D=te,this.setTexture2DArray=function U(I,T){const G=i.get(I);I.version>0&&G.__version!==I.version?ct(G,I,T):t.bindTexture(n.TEXTURE_2D_ARRAY,G.__webglTexture,n.TEXTURE0+T)},this.setTexture3D=function q(I,T){const G=i.get(I);I.version>0&&G.__version!==I.version?ct(G,I,T):t.bindTexture(n.TEXTURE_3D,G.__webglTexture,n.TEXTURE0+T)},this.setTextureCube=function ae(I,T){const G=i.get(I);I.version>0&&G.__version!==I.version?function tt(I,T,G){if(6!==T.image.length)return;const ue=Te(I,T),se=T.source;t.bindTexture(n.TEXTURE_CUBE_MAP,I.__webglTexture,n.TEXTURE0+G);const fe=i.get(se);if(se.version!==fe.__version||!0===ue){t.activeTexture(n.TEXTURE0+G),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,T.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,T.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,T.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const Oe=T.isCompressedTexture||T.image[0].isCompressedTexture,pe=T.image[0]&&T.image[0].isDataTexture,j=[];for(let $=0;$<6;$++)j[$]=Oe||pe?pe?T.image[$].image:T.image[$]:y(T.image[$],!1,!0,l),j[$]=qt(T,j[$]);const P=j[0],ie=w(P)||a,Me=s.convert(T.format,T.colorSpace),ve=s.convert(T.type),be=E(T.internalFormat,Me,ve,T.colorSpace),Qe=a&&!0!==T.isVideoTexture,yt=void 0===fe.__version||!0===ue;let we,N=b(T,P,ie);if(Pe(n.TEXTURE_CUBE_MAP,T,ie),Oe){Qe&&yt&&t.texStorage2D(n.TEXTURE_CUBE_MAP,N,be,P.width,P.height);for(let $=0;$<6;$++){we=j[$].mipmaps;for(let ce=0;ce<we.length;ce++){const _e=we[ce];T.format!==xr?null!==Me?Qe?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,ce,0,0,_e.width,_e.height,Me,_e.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,ce,be,_e.width,_e.height,0,_e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Qe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,ce,0,0,_e.width,_e.height,Me,ve,_e.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,ce,be,_e.width,_e.height,0,Me,ve,_e.data)}}}else{we=T.mipmaps,Qe&&yt&&(we.length>0&&N++,t.texStorage2D(n.TEXTURE_CUBE_MAP,N,be,j[0].width,j[0].height));for(let $=0;$<6;$++)if(pe){Qe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,0,0,0,j[$].width,j[$].height,Me,ve,j[$].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,0,be,j[$].width,j[$].height,0,Me,ve,j[$].data);for(let ce=0;ce<we.length;ce++){const dt=we[ce].image[$].image;Qe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,ce+1,0,0,dt.width,dt.height,Me,ve,dt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,ce+1,be,dt.width,dt.height,0,Me,ve,dt.data)}}else{Qe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,0,0,0,Me,ve,j[$]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,0,be,Me,ve,j[$]);for(let ce=0;ce<we.length;ce++){const _e=we[ce];Qe?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,ce+1,0,0,Me,ve,_e.image[$]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+$,ce+1,be,Me,ve,_e.image[$])}}}S(T,ie)&&M(n.TEXTURE_CUBE_MAP),fe.__version=se.version,T.onUpdate&&T.onUpdate(T)}I.__version=T.version}(G,I,T):t.bindTexture(n.TEXTURE_CUBE_MAP,G.__webglTexture,n.TEXTURE0+T)},this.rebindTextures=function de(I,T,G){const ue=i.get(I);void 0!==T&&Ne(ue.__webglFramebuffer,I,I.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==G&&ne(I)},this.setupRenderTarget=function re(I){const T=I.texture,G=i.get(I),ue=i.get(T);I.addEventListener("dispose",B),!0!==I.isWebGLMultipleRenderTargets&&(void 0===ue.__webglTexture&&(ue.__webglTexture=n.createTexture()),ue.__version=T.version,o.memory.textures++);const se=!0===I.isWebGLCubeRenderTarget,fe=!0===I.isWebGLMultipleRenderTargets,Oe=w(I)||a;if(se){G.__webglFramebuffer=[];for(let pe=0;pe<6;pe++)if(a&&T.mipmaps&&T.mipmaps.length>0){G.__webglFramebuffer[pe]=[];for(let j=0;j<T.mipmaps.length;j++)G.__webglFramebuffer[pe][j]=n.createFramebuffer()}else G.__webglFramebuffer[pe]=n.createFramebuffer()}else{if(a&&T.mipmaps&&T.mipmaps.length>0){G.__webglFramebuffer=[];for(let pe=0;pe<T.mipmaps.length;pe++)G.__webglFramebuffer[pe]=n.createFramebuffer()}else G.__webglFramebuffer=n.createFramebuffer();if(fe)if(r.drawBuffers){const pe=I.texture;for(let j=0,P=pe.length;j<P;j++){const ie=i.get(pe[j]);void 0===ie.__webglTexture&&(ie.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&I.samples>0&&!1===ze(I)){const pe=fe?T:[T];G.__webglMultisampledFramebuffer=n.createFramebuffer(),G.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,G.__webglMultisampledFramebuffer);for(let j=0;j<pe.length;j++){const P=pe[j];G.__webglColorRenderbuffer[j]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,G.__webglColorRenderbuffer[j]);const ie=s.convert(P.format,P.colorSpace),Me=s.convert(P.type),ve=E(P.internalFormat,ie,Me,P.colorSpace,!0===I.isXRRenderTarget),be=Ae(I);n.renderbufferStorageMultisample(n.RENDERBUFFER,be,ve,I.width,I.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+j,n.RENDERBUFFER,G.__webglColorRenderbuffer[j])}n.bindRenderbuffer(n.RENDERBUFFER,null),I.depthBuffer&&(G.__webglDepthRenderbuffer=n.createRenderbuffer(),R(G.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(se){t.bindTexture(n.TEXTURE_CUBE_MAP,ue.__webglTexture),Pe(n.TEXTURE_CUBE_MAP,T,Oe);for(let pe=0;pe<6;pe++)if(a&&T.mipmaps&&T.mipmaps.length>0)for(let j=0;j<T.mipmaps.length;j++)Ne(G.__webglFramebuffer[pe][j],I,T,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+pe,j);else Ne(G.__webglFramebuffer[pe],I,T,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0);S(T,Oe)&&M(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(fe){const pe=I.texture;for(let j=0,P=pe.length;j<P;j++){const ie=pe[j],Me=i.get(ie);t.bindTexture(n.TEXTURE_2D,Me.__webglTexture),Pe(n.TEXTURE_2D,ie,Oe),Ne(G.__webglFramebuffer,I,ie,n.COLOR_ATTACHMENT0+j,n.TEXTURE_2D,0),S(ie,Oe)&&M(n.TEXTURE_2D)}t.unbindTexture()}else{let pe=n.TEXTURE_2D;if((I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(a?pe=I.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(pe,ue.__webglTexture),Pe(pe,T,Oe),a&&T.mipmaps&&T.mipmaps.length>0)for(let j=0;j<T.mipmaps.length;j++)Ne(G.__webglFramebuffer[j],I,T,n.COLOR_ATTACHMENT0,pe,j);else Ne(G.__webglFramebuffer,I,T,n.COLOR_ATTACHMENT0,pe,0);S(T,Oe)&&M(pe),t.unbindTexture()}I.depthBuffer&&ne(I)},this.updateRenderTargetMipmap=function Fe(I){const T=w(I)||a,G=!0===I.isWebGLMultipleRenderTargets?I.texture:[I.texture];for(let ue=0,se=G.length;ue<se;ue++){const fe=G[ue];if(S(fe,T)){const Oe=I.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,pe=i.get(fe).__webglTexture;t.bindTexture(Oe,pe),M(Oe),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ce(I){if(a&&I.samples>0&&!1===ze(I)){const T=I.isWebGLMultipleRenderTargets?I.texture:[I.texture],G=I.width,ue=I.height;let se=n.COLOR_BUFFER_BIT;const fe=[],Oe=I.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,pe=i.get(I),j=!0===I.isWebGLMultipleRenderTargets;if(j)for(let P=0;P<T.length;P++)t.bindFramebuffer(n.FRAMEBUFFER,pe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+P,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,pe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+P,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,pe.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,pe.__webglFramebuffer);for(let P=0;P<T.length;P++){fe.push(n.COLOR_ATTACHMENT0+P),I.depthBuffer&&fe.push(Oe);const ie=void 0!==pe.__ignoreDepthValues&&pe.__ignoreDepthValues;if(!1===ie&&(I.depthBuffer&&(se|=n.DEPTH_BUFFER_BIT),I.stencilBuffer&&(se|=n.STENCIL_BUFFER_BIT)),j&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,pe.__webglColorRenderbuffer[P]),!0===ie&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Oe]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Oe])),j){const Me=i.get(T[P]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Me,0)}n.blitFramebuffer(0,0,G,ue,0,0,G,ue,se,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,fe)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),j)for(let P=0;P<T.length;P++){t.bindFramebuffer(n.FRAMEBUFFER,pe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+P,n.RENDERBUFFER,pe.__webglColorRenderbuffer[P]);const ie=i.get(T[P]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,pe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+P,n.TEXTURE_2D,ie,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,pe.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ne,this.setupFrameBufferTexture=Ne,this.useMultisampledRTT=ze}function aee(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const c=o===wt||o===Ym?1:0;if(s===Vo)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===zo)return n.UNSIGNED_INT;if(s===Ks)return n.FLOAT;if(s===vd)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===xr)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===La)return n.DEPTH_COMPONENT;if(s===kl)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(1===c){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return 1===c?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return 1===c?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return 1===c?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Pa?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class cee extends Un{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Wr extends sn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const lee={type:"move"};class Db{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Wr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Wr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new A,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new A),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Wr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new A,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new A),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){o=!0;for(const g of e.hand.values()){const _=t.getJointPose(g,i),m=this._getHandJoint(l,g);null!==_&&(m.matrix.fromArray(_.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=_.radius),m.visible=null!==_}const d=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),f=.02,p=.005;l.inputState.pinching&&d>f+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=f-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(lee)))}return null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==s),null!==l&&(l.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Wr;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class uee extends br{constructor(e,t,i,r,s,o,a,c,l,u){if((u=void 0!==u?u:La)!==La&&u!==kl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===La&&(i=zo),void 0===i&&u===kl&&(i=Pa),super(null,r,s,o,a,c,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:dn,this.minFilter=void 0!==c?c:dn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class hee extends ka{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",c=1,l=null,u=null,h=null,d=null,f=null,p=null;const g=t.getContextAttributes();let _=null,m=null;const v=[],y=[],w=new Un;w.layers.enable(1),w.viewport=new It;const x=new Un;x.layers.enable(2),x.viewport=new It;const S=[w,x],M=new cee;M.layers.enable(1),M.layers.enable(2);let E=null,b=null;function C(U){const q=y.indexOf(U.inputSource);if(-1===q)return;const ae=v[q];void 0!==ae&&(ae.update(U.inputSource,U.frame,l||o),ae.dispatchEvent({type:U.type,data:U.inputSource}))}function O(){r.removeEventListener("select",C),r.removeEventListener("selectstart",C),r.removeEventListener("selectend",C),r.removeEventListener("squeeze",C),r.removeEventListener("squeezestart",C),r.removeEventListener("squeezeend",C),r.removeEventListener("end",O),r.removeEventListener("inputsourceschange",B);for(let U=0;U<v.length;U++){const q=y[U];null!==q&&(y[U]=null,v[U].disconnect(q))}E=null,b=null,e.setRenderTarget(_),f=null,d=null,h=null,r=null,m=null,te.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function B(U){for(let q=0;q<U.removed.length;q++){const ae=U.removed[q],oe=y.indexOf(ae);oe>=0&&(y[oe]=null,v[oe].disconnect(ae))}for(let q=0;q<U.added.length;q++){const ae=U.added[q];let oe=y.indexOf(ae);if(-1===oe){for(let Ee=0;Ee<v.length;Ee++){if(Ee>=y.length){y.push(ae),oe=Ee;break}if(null===y[Ee]){y[Ee]=ae,oe=Ee;break}}if(-1===oe)break}const le=v[oe];le&&le.connect(ae)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(U){let q=v[U];return void 0===q&&(q=new Db,v[U]=q),q.getTargetRaySpace()},this.getControllerGrip=function(U){let q=v[U];return void 0===q&&(q=new Db,v[U]=q),q.getGripSpace()},this.getHand=function(U){let q=v[U];return void 0===q&&(q=new Db,v[U]=q),q.getHandSpace()},this.setFramebufferScaleFactor=function(U){s=U,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(U){a=U,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(U){l=U},this.getBaseLayer=function(){return null!==d?d:f},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var U=Ll(function*(q){if(r=q,null!==r){if(_=e.getRenderTarget(),r.addEventListener("select",C),r.addEventListener("selectstart",C),r.addEventListener("selectend",C),r.addEventListener("squeeze",C),r.addEventListener("squeezestart",C),r.addEventListener("squeezeend",C),r.addEventListener("end",O),r.addEventListener("inputsourceschange",B),!0!==g.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),m=new Ba(f.framebufferWidth,f.framebufferHeight,{format:xr,type:Vo,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil});else{let ae=null,oe=null,le=null;g.depth&&(le=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ae=g.stencil?kl:La,oe=g.stencil?Pa:zo);const Ee={colorFormat:t.RGBA8,depthFormat:le,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(Ee),r.updateRenderState({layers:[d]}),m=new Ba(d.textureWidth,d.textureHeight,{format:xr,type:Vo,depthTexture:new uee(d.textureWidth,d.textureHeight,oe,void 0,void 0,void 0,void 0,void 0,void 0,ae),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0}),e.properties.get(m).__ignoreDepthValues=d.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(c),l=null,o=yield r.requestReferenceSpace(a),te.setContext(r),te.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(q){return U.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const L=new A,F=new A;function W(U,q){null===q?U.matrixWorld.copy(U.matrix):U.matrixWorld.multiplyMatrices(q.matrixWorld,U.matrix),U.matrixWorldInverse.copy(U.matrixWorld).invert()}this.updateCamera=function(U){if(null===r)return;M.near=x.near=w.near=U.near,M.far=x.far=w.far=U.far,(E!==M.near||b!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),E=M.near,b=M.far);const q=U.parent,ae=M.cameras;W(M,q);for(let oe=0;oe<ae.length;oe++)W(ae[oe],q);2===ae.length?function k(U,q,ae){L.setFromMatrixPosition(q.matrixWorld),F.setFromMatrixPosition(ae.matrixWorld);const oe=L.distanceTo(F),le=q.projectionMatrix.elements,Ee=ae.projectionMatrix.elements,Pe=le[14]/(le[10]-1),Te=le[14]/(le[10]+1),ct=(le[9]+1)/le[5],tt=(le[9]-1)/le[5],Ne=(le[8]-1)/le[0],R=(Ee[8]+1)/Ee[0],ge=Pe*Ne,ne=Pe*R,de=oe/(-Ne+R),re=de*-Ne;q.matrixWorld.decompose(U.position,U.quaternion,U.scale),U.translateX(re),U.translateZ(de),U.matrixWorld.compose(U.position,U.quaternion,U.scale),U.matrixWorldInverse.copy(U.matrixWorld).invert();const Fe=Pe+de,Ce=Te+de;U.projectionMatrix.makePerspective(ge-re,ne+(oe-re),ct*Te/Ce*Fe,tt*Te/Ce*Fe,Fe,Ce),U.projectionMatrixInverse.copy(U.projectionMatrix).invert()}(M,w,x):M.projectionMatrix.copy(w.projectionMatrix),function H(U,q,ae){null===ae?U.matrix.copy(q.matrixWorld):(U.matrix.copy(ae.matrixWorld),U.matrix.invert(),U.matrix.multiply(q.matrixWorld)),U.matrix.decompose(U.position,U.quaternion,U.scale),U.updateMatrixWorld(!0),U.projectionMatrix.copy(q.projectionMatrix),U.projectionMatrixInverse.copy(q.projectionMatrixInverse),U.isPerspectiveCamera&&(U.fov=2*zl*Math.atan(1/U.projectionMatrix.elements[5]),U.zoom=1)}(U,M,q)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==d||null!==f)return c},this.setFoveation=function(U){c=U,null!==d&&(d.fixedFoveation=U),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=U)};let X=null;const te=new fO;te.setAnimationLoop(function Q(U,q){if(u=q.getViewerPose(l||o),p=q,null!==u){const ae=u.views;null!==f&&(e.setRenderTargetFramebuffer(m,f.framebuffer),e.setRenderTarget(m));let oe=!1;ae.length!==M.cameras.length&&(M.cameras.length=0,oe=!0);for(let le=0;le<ae.length;le++){const Ee=ae[le];let Pe=null;if(null!==f)Pe=f.getViewport(Ee);else{const ct=h.getViewSubImage(d,Ee);Pe=ct.viewport,0===le&&(e.setRenderTargetTextures(m,ct.colorTexture,d.ignoreDepthValues?void 0:ct.depthStencilTexture),e.setRenderTarget(m))}let Te=S[le];void 0===Te&&(Te=new Un,Te.layers.enable(le),Te.viewport=new It,S[le]=Te),Te.matrix.fromArray(Ee.transform.matrix),Te.matrix.decompose(Te.position,Te.quaternion,Te.scale),Te.projectionMatrix.fromArray(Ee.projectionMatrix),Te.projectionMatrixInverse.copy(Te.projectionMatrix).invert(),Te.viewport.set(Pe.x,Pe.y,Pe.width,Pe.height),0===le&&(M.matrix.copy(Te.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===oe&&M.cameras.push(Te)}}for(let ae=0;ae<v.length;ae++){const oe=y[ae],le=v[ae];null!==oe&&void 0!==le&&le.update(oe,q,l||o)}X&&X(U,q),q.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:q}),p=null}),this.setAnimationLoop=function(U){X=U},this.dispose=function(){}}}function dee(n,e){function t(_,m){!0===_.matrixAutoUpdate&&_.updateMatrix(),m.value.copy(_.matrix)}function s(_,m){_.opacity.value=m.opacity,m.color&&_.diffuse.value.copy(m.color),m.emissive&&_.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(_.map.value=m.map,t(m.map,_.mapTransform)),m.alphaMap&&(_.alphaMap.value=m.alphaMap,t(m.alphaMap,_.alphaMapTransform)),m.bumpMap&&(_.bumpMap.value=m.bumpMap,t(m.bumpMap,_.bumpMapTransform),_.bumpScale.value=m.bumpScale,1===m.side&&(_.bumpScale.value*=-1)),m.normalMap&&(_.normalMap.value=m.normalMap,t(m.normalMap,_.normalMapTransform),_.normalScale.value.copy(m.normalScale),1===m.side&&_.normalScale.value.negate()),m.displacementMap&&(_.displacementMap.value=m.displacementMap,t(m.displacementMap,_.displacementMapTransform),_.displacementScale.value=m.displacementScale,_.displacementBias.value=m.displacementBias),m.emissiveMap&&(_.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,_.emissiveMapTransform)),m.specularMap&&(_.specularMap.value=m.specularMap,t(m.specularMap,_.specularMapTransform)),m.alphaTest>0&&(_.alphaTest.value=m.alphaTest);const v=e.get(m).envMap;if(v&&(_.envMap.value=v,_.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,_.reflectivity.value=m.reflectivity,_.ior.value=m.ior,_.refractionRatio.value=m.refractionRatio),m.lightMap){_.lightMap.value=m.lightMap;const y=!0===n._useLegacyLights?Math.PI:1;_.lightMapIntensity.value=m.lightMapIntensity*y,t(m.lightMap,_.lightMapTransform)}m.aoMap&&(_.aoMap.value=m.aoMap,_.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,_.aoMapTransform))}return{refreshFogUniforms:function i(_,m){m.color.getRGB(_.fogColor.value,dO(n)),m.isFog?(_.fogNear.value=m.near,_.fogFar.value=m.far):m.isFogExp2&&(_.fogDensity.value=m.density)},refreshMaterialUniforms:function r(_,m,v,y,w){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(_,m):m.isMeshToonMaterial?(s(_,m),function h(_,m){m.gradientMap&&(_.gradientMap.value=m.gradientMap)}(_,m)):m.isMeshPhongMaterial?(s(_,m),function u(_,m){_.specular.value.copy(m.specular),_.shininess.value=Math.max(m.shininess,1e-4)}(_,m)):m.isMeshStandardMaterial?(s(_,m),function d(_,m){_.metalness.value=m.metalness,m.metalnessMap&&(_.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,_.metalnessMapTransform)),_.roughness.value=m.roughness,m.roughnessMap&&(_.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,_.roughnessMapTransform)),e.get(m).envMap&&(_.envMapIntensity.value=m.envMapIntensity)}(_,m),m.isMeshPhysicalMaterial&&function f(_,m,v){_.ior.value=m.ior,m.sheen>0&&(_.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),_.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(_.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,_.sheenColorMapTransform)),m.sheenRoughnessMap&&(_.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,_.sheenRoughnessMapTransform))),m.clearcoat>0&&(_.clearcoat.value=m.clearcoat,_.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(_.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,_.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,_.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(_.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,_.clearcoatNormalMapTransform),_.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),1===m.side&&_.clearcoatNormalScale.value.negate())),m.iridescence>0&&(_.iridescence.value=m.iridescence,_.iridescenceIOR.value=m.iridescenceIOR,_.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(_.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,_.iridescenceMapTransform)),m.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,_.iridescenceThicknessMapTransform))),m.transmission>0&&(_.transmission.value=m.transmission,_.transmissionSamplerMap.value=v.texture,_.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(_.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,_.transmissionMapTransform)),_.thickness.value=m.thickness,m.thicknessMap&&(_.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,_.thicknessMapTransform)),_.attenuationDistance.value=m.attenuationDistance,_.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(_.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(_.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,_.anisotropyMapTransform))),_.specularIntensity.value=m.specularIntensity,_.specularColor.value.copy(m.specularColor),m.specularColorMap&&(_.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,_.specularColorMapTransform)),m.specularIntensityMap&&(_.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,_.specularIntensityMapTransform))}(_,m,w)):m.isMeshMatcapMaterial?(s(_,m),function p(_,m){m.matcap&&(_.matcap.value=m.matcap)}(_,m)):m.isMeshDepthMaterial?s(_,m):m.isMeshDistanceMaterial?(s(_,m),function g(_,m){const v=e.get(m).light;_.referencePosition.value.setFromMatrixPosition(v.matrixWorld),_.nearDistance.value=v.shadow.camera.near,_.farDistance.value=v.shadow.camera.far}(_,m)):m.isMeshNormalMaterial?s(_,m):m.isLineBasicMaterial?(function o(_,m){_.diffuse.value.copy(m.color),_.opacity.value=m.opacity,m.map&&(_.map.value=m.map,t(m.map,_.mapTransform))}(_,m),m.isLineDashedMaterial&&function a(_,m){_.dashSize.value=m.dashSize,_.totalSize.value=m.dashSize+m.gapSize,_.scale.value=m.scale}(_,m)):m.isPointsMaterial?function c(_,m,v,y){_.diffuse.value.copy(m.color),_.opacity.value=m.opacity,_.size.value=m.size*v,_.scale.value=.5*y,m.map&&(_.map.value=m.map,t(m.map,_.uvTransform)),m.alphaMap&&(_.alphaMap.value=m.alphaMap,t(m.alphaMap,_.alphaMapTransform)),m.alphaTest>0&&(_.alphaTest.value=m.alphaTest)}(_,m,v,y):m.isSpriteMaterial?function l(_,m){_.diffuse.value.copy(m.color),_.opacity.value=m.opacity,_.rotation.value=m.rotation,m.map&&(_.map.value=m.map,t(m.map,_.mapTransform)),m.alphaMap&&(_.alphaMap.value=m.alphaMap,t(m.alphaMap,_.alphaMapTransform)),m.alphaTest>0&&(_.alphaTest.value=m.alphaTest)}(_,m):m.isShadowMaterial?(_.color.value.copy(m.color),_.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function fee(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function f(v,y,w){const x=v.value;if(void 0===w[y]){if("number"==typeof x)w[y]=x;else{const S=Array.isArray(x)?x:[x],M=[];for(let E=0;E<S.length;E++)M.push(S[E].clone());w[y]=M}return!0}if("number"==typeof x){if(w[y]!==x)return w[y]=x,!0}else{const S=Array.isArray(w[y])?w[y]:[w[y]],M=Array.isArray(x)?x:[x];for(let E=0;E<S.length;E++){const b=S[E];if(!1===b.equals(M[E]))return b.copy(M[E]),!0}}return!1}function g(v){const y={boundary:0,storage:0};return"number"==typeof v?(y.boundary=4,y.storage=4):v.isVector2?(y.boundary=8,y.storage=8):v.isVector3||v.isColor?(y.boundary=16,y.storage=12):v.isVector4?(y.boundary=16,y.storage=16):v.isMatrix3?(y.boundary=48,y.storage=48):v.isMatrix4?(y.boundary=64,y.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),y}function _(v){const y=v.target;y.removeEventListener("dispose",_);const w=o.indexOf(y.__bindingPointIndex);o.splice(w,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}return{bind:function c(v,y){i.uniformBlockBinding(v,y.program)},update:function l(v,y){let w=r[v.id];void 0===w&&(function p(v){const y=v.uniforms;let w=0;let S=0;for(let M=0,E=y.length;M<E;M++){const b=y[M],C={boundary:0,storage:0},O=Array.isArray(b.value)?b.value:[b.value];for(let B=0,L=O.length;B<L;B++){const k=g(O[B]);C.boundary+=k.boundary,C.storage+=k.storage}b.__data=new Float32Array(C.storage/Float32Array.BYTES_PER_ELEMENT),b.__offset=w,M>0&&(S=w%16,0!==S&&16-S-C.boundary<0&&(w+=16-S,b.__offset=w)),w+=C.storage}S=w%16,S>0&&(w+=16-S),v.__size=w,v.__cache={}}(v),w=function u(v){const y=function h(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=y;const w=n.createBuffer(),x=v.__size,S=v.usage;return n.bindBuffer(n.UNIFORM_BUFFER,w),n.bufferData(n.UNIFORM_BUFFER,x,S),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,y,w),w}(v),r[v.id]=w,v.addEventListener("dispose",_)),i.updateUBOMapping(v,y.program);const S=e.render.frame;s[v.id]!==S&&(function d(v){const w=v.uniforms,x=v.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[v.id]);for(let S=0,M=w.length;S<M;S++){const E=w[S];if(!0===f(E,S,x)){const b=E.__offset,C=Array.isArray(E.value)?E.value:[E.value];let O=0;for(let B=0;B<C.length;B++){const L=C[B],F=g(L);"number"==typeof L?(E.__data[0]=L,n.bufferSubData(n.UNIFORM_BUFFER,b+O,E.__data)):L.isMatrix3?(E.__data[0]=L.elements[0],E.__data[1]=L.elements[1],E.__data[2]=L.elements[2],E.__data[3]=L.elements[0],E.__data[4]=L.elements[3],E.__data[5]=L.elements[4],E.__data[6]=L.elements[5],E.__data[7]=L.elements[0],E.__data[8]=L.elements[6],E.__data[9]=L.elements[7],E.__data[10]=L.elements[8],E.__data[11]=L.elements[0]):(L.toArray(E.__data,O),O+=F.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,b,E.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(v),s[v.id]=S)},dispose:function m(){for(const v in r)n.deleteBuffer(r[v]);o=[],r={},s={}}}}class HO{constructor(e={}){const{canvas:t=zY(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=e;let d;this.isWebGLRenderer=!0,d=null!==i?i.getContextAttributes().alpha:o;const f=new Uint32Array(4),p=new Int32Array(4);let g=null,_=null;const m=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=wt,this._useLegacyLights=!1,this.toneMapping=Ys,this.toneMappingExposure=1;const y=this;let w=!1,x=0,S=0,M=null,E=-1,b=null;const C=new It,O=new It;let B=null;const L=new Y(0);let F=0,k=t.width,W=t.height,H=1,X=null,Q=null;const te=new It(0,0,k,W),U=new It(0,0,k,W);let q=!1;const ae=new Mb;let oe=!1,le=!1,Ee=null;const Pe=new Ve,Te=new J,ct=new A,tt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ne(){return null===M?H:1}let ne,de,re,Fe,Ce,Ae,ze,ht,qt,I,T,G,ue,se,fe,Oe,pe,j,P,ie,Me,ve,be,Qe,R=i;function ge(D,V){for(let Z=0;Z<D.length;Z++){const K=t.getContext(D[Z],V);if(null!==K)return K}return null}try{const D={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r156"),t.addEventListener("webglcontextlost",we,!1),t.addEventListener("webglcontextrestored",$,!1),t.addEventListener("webglcontextcreationerror",ce,!1),null===R){const V=["webgl2","webgl","experimental-webgl"];if(!0===y.isWebGL1Renderer&&V.shift(),R=ge(V,D),null===R)throw ge(V)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&R instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===R.getShaderPrecisionFormat&&(R.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}function yt(){ne=new EJ(R),de=new yJ(R,ne,e),ne.init(de),ve=new aee(R,ne,de),re=new ree(R,ne,de),Fe=new AJ(R),Ce=new $Q,Ae=new see(R,ne,re,Ce,de,ve,Fe),ze=new xJ(y),ht=new SJ(y),qt=new vZ(R,de),be=new _J(R,ne,qt,de),I=new CJ(R,qt,Fe,be),T=new PJ(R,I,qt,Fe),P=new RJ(R,de,Ae),Oe=new wJ(Ce),G=new jQ(y,ze,ht,ne,de,be,Oe),ue=new dee(y,Ce),se=new qQ,fe=new eee(ne,de),j=new gJ(y,ze,ht,re,T,d,c),pe=new iee(y,T,de),Qe=new fee(R,Fe,de,re),ie=new vJ(R,ne,Fe,de),Me=new TJ(R,ne,Fe,de),Fe.programs=G.programs,y.capabilities=de,y.extensions=ne,y.properties=Ce,y.renderLists=se,y.shadowMap=pe,y.state=re,y.info=Fe}yt();const N=new hee(y,R);function we(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),w=!0}function $(){console.log("THREE.WebGLRenderer: Context Restored."),w=!1;const D=Fe.autoReset,V=pe.enabled,Z=pe.autoUpdate,z=pe.needsUpdate,K=pe.type;yt(),Fe.autoReset=D,pe.enabled=V,pe.autoUpdate=Z,pe.needsUpdate=z,pe.type=K}function ce(D){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function _e(D){const V=D.target;V.removeEventListener("dispose",_e),function dt(D){(function Tt(D){const V=Ce.get(D).programs;void 0!==V&&(V.forEach(function(Z){G.releaseProgram(Z)}),D.isShaderMaterial&&G.releaseShaderCache(D))})(D),Ce.remove(D)}(V)}this.xr=N,this.getContext=function(){return R},this.getContextAttributes=function(){return R.getContextAttributes()},this.forceContextLoss=function(){const D=ne.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=ne.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return H},this.setPixelRatio=function(D){void 0!==D&&(H=D,this.setSize(k,W,!1))},this.getSize=function(D){return D.set(k,W)},this.setSize=function(D,V,Z=!0){N.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(k=D,W=V,t.width=Math.floor(D*H),t.height=Math.floor(V*H),!0===Z&&(t.style.width=D+"px",t.style.height=V+"px"),this.setViewport(0,0,D,V))},this.getDrawingBufferSize=function(D){return D.set(k*H,W*H).floor()},this.setDrawingBufferSize=function(D,V,Z){k=D,W=V,H=Z,t.width=Math.floor(D*Z),t.height=Math.floor(V*Z),this.setViewport(0,0,D,V)},this.getCurrentViewport=function(D){return D.copy(C)},this.getViewport=function(D){return D.copy(te)},this.setViewport=function(D,V,Z,z){D.isVector4?te.set(D.x,D.y,D.z,D.w):te.set(D,V,Z,z),re.viewport(C.copy(te).multiplyScalar(H).floor())},this.getScissor=function(D){return D.copy(U)},this.setScissor=function(D,V,Z,z){D.isVector4?U.set(D.x,D.y,D.z,D.w):U.set(D,V,Z,z),re.scissor(O.copy(U).multiplyScalar(H).floor())},this.getScissorTest=function(){return q},this.setScissorTest=function(D){re.setScissorTest(q=D)},this.setOpaqueSort=function(D){X=D},this.setTransparentSort=function(D){Q=D},this.getClearColor=function(D){return D.copy(j.getClearColor())},this.setClearColor=function(){j.setClearColor.apply(j,arguments)},this.getClearAlpha=function(){return j.getClearAlpha()},this.setClearAlpha=function(){j.setClearAlpha.apply(j,arguments)},this.clear=function(D=!0,V=!0,Z=!0){let z=0;if(D){let K=!1;if(null!==M){const Ie=M.texture.format;K=1033===Ie||1031===Ie||1029===Ie}if(K){const Ie=M.texture.type,Ue=Ie===Vo||Ie===zo||1012===Ie||Ie===Pa||1017===Ie||1018===Ie,Ye=j.getClearColor(),Ze=j.getClearAlpha(),ft=Ye.r,$e=Ye.g,ot=Ye.b;Ue?(f[0]=ft,f[1]=$e,f[2]=ot,f[3]=Ze,R.clearBufferuiv(R.COLOR,0,f)):(p[0]=ft,p[1]=$e,p[2]=ot,p[3]=Ze,R.clearBufferiv(R.COLOR,0,p))}else z|=R.COLOR_BUFFER_BIT}V&&(z|=R.DEPTH_BUFFER_BIT),Z&&(z|=R.STENCIL_BUFFER_BIT),R.clear(z)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",we,!1),t.removeEventListener("webglcontextrestored",$,!1),t.removeEventListener("webglcontextcreationerror",ce,!1),se.dispose(),fe.dispose(),Ce.dispose(),ze.dispose(),ht.dispose(),T.dispose(),be.dispose(),Qe.dispose(),G.dispose(),N.dispose(),N.removeEventListener("sessionstart",$t),N.removeEventListener("sessionend",Es),Ee&&(Ee.dispose(),Ee=null),vi.stop()},this.renderBufferDirect=function(D,V,Z,z,K,Ie){null===V&&(V=tt);const Ue=K.isMesh&&K.matrixWorld.determinant()<0,Ye=function Ire(D,V,Z,z,K){!0!==V.isScene&&(V=tt),Ae.resetTextureUnits();const Ie=V.fog,Ye=null===M?y.outputColorSpace:!0===M.isXRRenderTarget?M.texture.colorSpace:Rn,Ze=(z.isMeshStandardMaterial?ht:ze).get(z.envMap||(z.isMeshStandardMaterial?V.environment:null)),ft=!0===z.vertexColors&&!!Z.attributes.color&&4===Z.attributes.color.itemSize,$e=!!Z.attributes.tangent&&(!!z.normalMap||z.anisotropy>0),ot=!!Z.morphAttributes.position,cn=!!Z.morphAttributes.normal,pn=!!Z.morphAttributes.color;let Cr=Ys;z.toneMapped&&(null===M||!0===M.isXRRenderTarget)&&(Cr=y.toneMapping);const uo=Z.morphAttributes.position||Z.morphAttributes.normal||Z.morphAttributes.color,bn=void 0!==uo?uo.length:0,mt=Ce.get(z),iS=_.state.lights;!0!==oe||!0!==le&&D===b||Oe.setState(z,D,D===b&&z.id===E);let Mn=!1;z.version===mt.__version?(mt.needsLights&&mt.lightsStateVersion!==iS.state.version||mt.outputColorSpace!==Ye||K.isInstancedMesh&&!1===mt.instancing||!K.isInstancedMesh&&!0===mt.instancing||K.isSkinnedMesh&&!1===mt.skinning||!K.isSkinnedMesh&&!0===mt.skinning||K.isInstancedMesh&&!0===mt.instancingColor&&null===K.instanceColor||K.isInstancedMesh&&!1===mt.instancingColor&&null!==K.instanceColor||mt.envMap!==Ze||!0===z.fog&&mt.fog!==Ie||void 0!==mt.numClippingPlanes&&(mt.numClippingPlanes!==Oe.numPlanes||mt.numIntersection!==Oe.numIntersection)||mt.vertexAlphas!==ft||mt.vertexTangents!==$e||mt.morphTargets!==ot||mt.morphNormals!==cn||mt.morphColors!==pn||mt.toneMapping!==Cr||!0===de.isWebGL2&&mt.morphTargetsCount!==bn)&&(Mn=!0):(Mn=!0,mt.__version=z.version);let ac=mt.currentProgram;!0===Mn&&(ac=w_(z,V,K));let pk=!1,rf=!1,rS=!1;const yi=ac.getUniforms(),cc=mt.uniforms;if(re.useProgram(ac.program)&&(pk=!0,rf=!0,rS=!0),z.id!==E&&(E=z.id,rf=!0),pk||b!==D){yi.setValue(R,"projectionMatrix",D.projectionMatrix),yi.setValue(R,"viewMatrix",D.matrixWorldInverse);const nr=yi.map.cameraPosition;void 0!==nr&&nr.setValue(R,ct.setFromMatrixPosition(D.matrixWorld)),de.logarithmicDepthBuffer&&yi.setValue(R,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),(z.isMeshPhongMaterial||z.isMeshToonMaterial||z.isMeshLambertMaterial||z.isMeshBasicMaterial||z.isMeshStandardMaterial||z.isShaderMaterial)&&yi.setValue(R,"isOrthographic",!0===D.isOrthographicCamera),b!==D&&(b=D,rf=!0,rS=!0)}if(K.isSkinnedMesh){yi.setOptional(R,K,"bindMatrix"),yi.setOptional(R,K,"bindMatrixInverse");const nr=K.skeleton;nr&&(de.floatVertexTextures?(null===nr.boneTexture&&nr.computeBoneTexture(),yi.setValue(R,"boneTexture",nr.boneTexture,Ae),yi.setValue(R,"boneTextureSize",nr.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const sS=Z.morphAttributes;if((void 0!==sS.position||void 0!==sS.normal||void 0!==sS.color&&!0===de.isWebGL2)&&P.update(K,Z,ac),(rf||mt.receiveShadow!==K.receiveShadow)&&(mt.receiveShadow=K.receiveShadow,yi.setValue(R,"receiveShadow",K.receiveShadow)),z.isMeshGouraudMaterial&&null!==z.envMap&&(cc.envMap.value=Ze,cc.flipEnvMap.value=Ze.isCubeTexture&&!1===Ze.isRenderTargetTexture?-1:1),rf&&(yi.setValue(R,"toneMappingExposure",y.toneMappingExposure),mt.needsLights&&function Rre(D,V){D.ambientLightColor.needsUpdate=V,D.lightProbe.needsUpdate=V,D.directionalLights.needsUpdate=V,D.directionalLightShadows.needsUpdate=V,D.pointLights.needsUpdate=V,D.pointLightShadows.needsUpdate=V,D.spotLights.needsUpdate=V,D.spotLightShadows.needsUpdate=V,D.rectAreaLights.needsUpdate=V,D.hemisphereLights.needsUpdate=V}(cc,rS),Ie&&!0===z.fog&&ue.refreshFogUniforms(cc,Ie),ue.refreshMaterialUniforms(cc,z,H,W,Ee),bg.upload(R,mt.uniformsList,cc,Ae)),z.isShaderMaterial&&!0===z.uniformsNeedUpdate&&(bg.upload(R,mt.uniformsList,cc,Ae),z.uniformsNeedUpdate=!1),z.isSpriteMaterial&&yi.setValue(R,"center",K.center),yi.setValue(R,"modelViewMatrix",K.modelViewMatrix),yi.setValue(R,"normalMatrix",K.normalMatrix),yi.setValue(R,"modelMatrix",K.matrixWorld),z.isShaderMaterial||z.isRawShaderMaterial){const nr=z.uniformsGroups;for(let oS=0,Lre=nr.length;oS<Lre;oS++)if(de.isWebGL2){const mk=nr[oS];Qe.update(mk,ac),Qe.bind(mk,ac)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return ac}(D,V,Z,z,K);re.setMaterial(z,Ue);let Ze=Z.index,ft=1;if(!0===z.wireframe){if(Ze=I.getWireframeAttribute(Z),void 0===Ze)return;ft=2}const $e=Z.drawRange,ot=Z.attributes.position;let cn=$e.start*ft,pn=($e.start+$e.count)*ft;null!==Ie&&(cn=Math.max(cn,Ie.start*ft),pn=Math.min(pn,(Ie.start+Ie.count)*ft)),null!==Ze?(cn=Math.max(cn,0),pn=Math.min(pn,Ze.count)):null!=ot&&(cn=Math.max(cn,0),pn=Math.min(pn,ot.count));const Cr=pn-cn;if(Cr<0||Cr===1/0)return;be.setup(K,z,Ye,Z,Ze);let uo,bn=ie;if(null!==Ze&&(uo=qt.get(Ze),bn=Me,bn.setIndex(uo)),K.isMesh)!0===z.wireframe?(re.setLineWidth(z.wireframeLinewidth*Ne()),bn.setMode(R.LINES)):bn.setMode(R.TRIANGLES);else if(K.isLine){let mt=z.linewidth;void 0===mt&&(mt=1),re.setLineWidth(mt*Ne()),bn.setMode(K.isLineSegments?R.LINES:K.isLineLoop?R.LINE_LOOP:R.LINE_STRIP)}else K.isPoints?bn.setMode(R.POINTS):K.isSprite&&bn.setMode(R.TRIANGLES);if(K.isInstancedMesh)bn.renderInstances(cn,Cr,K.count);else if(Z.isInstancedBufferGeometry){const iS=Math.min(Z.instanceCount,void 0!==Z._maxInstanceCount?Z._maxInstanceCount:1/0);bn.renderInstances(cn,Cr,iS)}else bn.render(cn,Cr)},this.compile=function(D,V){function Z(z,K,Ie){!0===z.transparent&&2===z.side&&!1===z.forceSinglePass?(z.side=1,z.needsUpdate=!0,w_(z,K,Ie),z.side=0,z.needsUpdate=!0,w_(z,K,Ie),z.side=2):w_(z,K,Ie)}_=fe.get(D),_.init(),v.push(_),D.traverseVisible(function(z){z.isLight&&z.layers.test(V.layers)&&(_.pushLight(z),z.castShadow&&_.pushShadow(z))}),_.setupLights(y._useLegacyLights),D.traverse(function(z){const K=z.material;if(K)if(Array.isArray(K))for(let Ie=0;Ie<K.length;Ie++)Z(K[Ie],D,z);else Z(K,D,z)}),v.pop(),_=null};let zt=null;function $t(){vi.stop()}function Es(){vi.start()}const vi=new fO;function uk(D,V,Z,z){if(!1===D.visible)return;if(D.layers.test(V.layers))if(D.isGroup)Z=D.renderOrder;else if(D.isLOD)!0===D.autoUpdate&&D.update(V);else if(D.isLight)_.pushLight(D),D.castShadow&&_.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||ae.intersectsSprite(D)){z&&ct.setFromMatrixPosition(D.matrixWorld).applyMatrix4(Pe);const Ue=T.update(D),Ye=D.material;Ye.visible&&g.push(D,Ue,Ye,Z,ct.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(!D.frustumCulled||ae.intersectsObject(D))){const Ue=T.update(D),Ye=D.material;if(z&&(void 0!==D.boundingSphere?(null===D.boundingSphere&&D.computeBoundingSphere(),ct.copy(D.boundingSphere.center)):(null===Ue.boundingSphere&&Ue.computeBoundingSphere(),ct.copy(Ue.boundingSphere.center)),ct.applyMatrix4(D.matrixWorld).applyMatrix4(Pe)),Array.isArray(Ye)){const Ze=Ue.groups;for(let ft=0,$e=Ze.length;ft<$e;ft++){const ot=Ze[ft],cn=Ye[ot.materialIndex];cn&&cn.visible&&g.push(D,Ue,cn,Z,ct.z,ot)}}else Ye.visible&&g.push(D,Ue,Ye,Z,ct.z,null)}const Ie=D.children;for(let Ue=0,Ye=Ie.length;Ue<Ye;Ue++)uk(Ie[Ue],V,Z,z)}function hk(D,V,Z,z){const K=D.opaque,Ie=D.transmissive,Ue=D.transparent;_.setupLightsView(Z),!0===oe&&Oe.setGlobalState(y.clippingPlanes,Z),Ie.length>0&&function Dre(D,V,Z,z){const K=de.isWebGL2;null===Ee&&(Ee=new Ba(1,1,{generateMipmaps:!0,type:ne.has("EXT_color_buffer_half_float")?vd:Vo,minFilter:Zs,samples:K?4:0})),y.getDrawingBufferSize(Te),K?Ee.setSize(Te.x,Te.y):Ee.setSize(Jm(Te.x),Jm(Te.y));const Ie=y.getRenderTarget();y.setRenderTarget(Ee),y.getClearColor(L),F=y.getClearAlpha(),F<1&&y.setClearColor(16777215,.5),y.clear();const Ue=y.toneMapping;y.toneMapping=Ys,y_(D,Z,z),Ae.updateMultisampleRenderTarget(Ee),Ae.updateRenderTargetMipmap(Ee);let Ye=!1;for(let Ze=0,ft=V.length;Ze<ft;Ze++){const $e=V[Ze],ot=$e.object,cn=$e.geometry,pn=$e.material,Cr=$e.group;if(2===pn.side&&ot.layers.test(z.layers)){const uo=pn.side;pn.side=1,pn.needsUpdate=!0,dk(ot,Z,z,cn,pn,Cr),pn.side=uo,pn.needsUpdate=!0,Ye=!0}}!0===Ye&&(Ae.updateMultisampleRenderTarget(Ee),Ae.updateRenderTargetMipmap(Ee)),y.setRenderTarget(Ie),y.setClearColor(L,F),y.toneMapping=Ue}(K,Ie,V,Z),z&&re.viewport(C.copy(z)),K.length>0&&y_(K,V,Z),Ie.length>0&&y_(Ie,V,Z),Ue.length>0&&y_(Ue,V,Z),re.buffers.depth.setTest(!0),re.buffers.depth.setMask(!0),re.buffers.color.setMask(!0),re.setPolygonOffset(!1)}function y_(D,V,Z){const z=!0===V.isScene?V.overrideMaterial:null;for(let K=0,Ie=D.length;K<Ie;K++){const Ue=D[K],Ye=Ue.object,Ze=Ue.geometry,ft=null===z?Ue.material:z,$e=Ue.group;Ye.layers.test(Z.layers)&&dk(Ye,V,Z,Ze,ft,$e)}}function dk(D,V,Z,z,K,Ie){D.onBeforeRender(y,V,Z,z,K,Ie),D.modelViewMatrix.multiplyMatrices(Z.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),K.onBeforeRender(y,V,Z,z,D,Ie),!0===K.transparent&&2===K.side&&!1===K.forceSinglePass?(K.side=1,K.needsUpdate=!0,y.renderBufferDirect(Z,V,z,K,D,Ie),K.side=0,K.needsUpdate=!0,y.renderBufferDirect(Z,V,z,K,D,Ie),K.side=2):y.renderBufferDirect(Z,V,z,K,D,Ie),D.onAfterRender(y,V,Z,z,K,Ie)}function w_(D,V,Z){!0!==V.isScene&&(V=tt);const z=Ce.get(D),K=_.state.lights,Ue=K.state.version,Ye=G.getParameters(D,K.state,_.state.shadowsArray,V,Z),Ze=G.getProgramCacheKey(Ye);let ft=z.programs;z.environment=D.isMeshStandardMaterial?V.environment:null,z.fog=V.fog,z.envMap=(D.isMeshStandardMaterial?ht:ze).get(D.envMap||z.environment),void 0===ft&&(D.addEventListener("dispose",_e),ft=new Map,z.programs=ft);let $e=ft.get(Ze);if(void 0!==$e){if(z.currentProgram===$e&&z.lightsStateVersion===Ue)return fk(D,Ye),$e}else Ye.uniforms=G.getUniforms(D),D.onBuild(Z,Ye,y),D.onBeforeCompile(Ye,y),$e=G.acquireProgram(Ye,Ze),ft.set(Ze,$e),z.uniforms=Ye.uniforms;const ot=z.uniforms;(!D.isShaderMaterial&&!D.isRawShaderMaterial||!0===D.clipping)&&(ot.clippingPlanes=Oe.uniform),fk(D,Ye),z.needsLights=function Pre(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&!0===D.lights}(D),z.lightsStateVersion=Ue,z.needsLights&&(ot.ambientLightColor.value=K.state.ambient,ot.lightProbe.value=K.state.probe,ot.directionalLights.value=K.state.directional,ot.directionalLightShadows.value=K.state.directionalShadow,ot.spotLights.value=K.state.spot,ot.spotLightShadows.value=K.state.spotShadow,ot.rectAreaLights.value=K.state.rectArea,ot.ltc_1.value=K.state.rectAreaLTC1,ot.ltc_2.value=K.state.rectAreaLTC2,ot.pointLights.value=K.state.point,ot.pointLightShadows.value=K.state.pointShadow,ot.hemisphereLights.value=K.state.hemi,ot.directionalShadowMap.value=K.state.directionalShadowMap,ot.directionalShadowMatrix.value=K.state.directionalShadowMatrix,ot.spotShadowMap.value=K.state.spotShadowMap,ot.spotLightMatrix.value=K.state.spotLightMatrix,ot.spotLightMap.value=K.state.spotLightMap,ot.pointShadowMap.value=K.state.pointShadowMap,ot.pointShadowMatrix.value=K.state.pointShadowMatrix);const cn=$e.getUniforms(),pn=bg.seqWithValue(cn.seq,ot);return z.currentProgram=$e,z.uniformsList=pn,$e}function fk(D,V){const Z=Ce.get(D);Z.outputColorSpace=V.outputColorSpace,Z.instancing=V.instancing,Z.instancingColor=V.instancingColor,Z.skinning=V.skinning,Z.morphTargets=V.morphTargets,Z.morphNormals=V.morphNormals,Z.morphColors=V.morphColors,Z.morphTargetsCount=V.morphTargetsCount,Z.numClippingPlanes=V.numClippingPlanes,Z.numIntersection=V.numClipIntersection,Z.vertexAlphas=V.vertexAlphas,Z.vertexTangents=V.vertexTangents,Z.toneMapping=V.toneMapping}vi.setAnimationLoop(function tr(D){zt&&zt(D)}),typeof self<"u"&&vi.setContext(self),this.setAnimationLoop=function(D){zt=D,N.setAnimationLoop(D),null===D?vi.stop():vi.start()},N.addEventListener("sessionstart",$t),N.addEventListener("sessionend",Es),this.render=function(D,V){if(void 0===V||!0===V.isCamera){if(!0!==w){if(!0===D.matrixWorldAutoUpdate&&D.updateMatrixWorld(),null===V.parent&&!0===V.matrixWorldAutoUpdate&&V.updateMatrixWorld(),!0===N.enabled&&!0===N.isPresenting&&(!0===N.cameraAutoUpdate&&N.updateCamera(V),V=N.getCamera()),!0===D.isScene&&D.onBeforeRender(y,D,V,M),_=fe.get(D,v.length),_.init(),v.push(_),Pe.multiplyMatrices(V.projectionMatrix,V.matrixWorldInverse),ae.setFromProjectionMatrix(Pe),le=this.localClippingEnabled,oe=Oe.init(this.clippingPlanes,le),g=se.get(D,m.length),g.init(),m.push(g),uk(D,V,0,y.sortObjects),g.finish(),!0===y.sortObjects&&g.sort(X,Q),this.info.render.frame++,!0===oe&&Oe.beginShadows(),pe.render(_.state.shadowsArray,D,V),!0===oe&&Oe.endShadows(),!0===this.info.autoReset&&this.info.reset(),j.render(g,D),_.setupLights(y._useLegacyLights),V.isArrayCamera){const z=V.cameras;for(let K=0,Ie=z.length;K<Ie;K++){const Ue=z[K];hk(g,D,Ue,Ue.viewport)}}else hk(g,D,V);null!==M&&(Ae.updateMultisampleRenderTarget(M),Ae.updateRenderTargetMipmap(M)),!0===D.isScene&&D.onAfterRender(y,D,V),be.resetDefaultState(),E=-1,b=null,v.pop(),_=v.length>0?v[v.length-1]:null,m.pop(),g=m.length>0?m[m.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(D,V,Z){Ce.get(D.texture).__webglTexture=V,Ce.get(D.depthTexture).__webglTexture=Z;const z=Ce.get(D);z.__hasExternalTextures=!0,z.__hasExternalTextures&&(z.__autoAllocateDepthBuffer=void 0===Z,z.__autoAllocateDepthBuffer||!0===ne.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),z.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(D,V){const Z=Ce.get(D);Z.__webglFramebuffer=V,Z.__useDefaultFramebuffer=void 0===V},this.setRenderTarget=function(D,V=0,Z=0){M=D,x=V,S=Z;let z=!0,K=null,Ie=!1,Ue=!1;if(D){const Ze=Ce.get(D);void 0!==Ze.__useDefaultFramebuffer?(re.bindFramebuffer(R.FRAMEBUFFER,null),z=!1):void 0===Ze.__webglFramebuffer?Ae.setupRenderTarget(D):Ze.__hasExternalTextures&&Ae.rebindTextures(D,Ce.get(D.texture).__webglTexture,Ce.get(D.depthTexture).__webglTexture);const ft=D.texture;(ft.isData3DTexture||ft.isDataArrayTexture||ft.isCompressedArrayTexture)&&(Ue=!0);const $e=Ce.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(K=Array.isArray($e[V])?$e[V][Z]:$e[V],Ie=!0):K=de.isWebGL2&&D.samples>0&&!1===Ae.useMultisampledRTT(D)?Ce.get(D).__webglMultisampledFramebuffer:Array.isArray($e)?$e[Z]:$e,C.copy(D.viewport),O.copy(D.scissor),B=D.scissorTest}else C.copy(te).multiplyScalar(H).floor(),O.copy(U).multiplyScalar(H).floor(),B=q;if(re.bindFramebuffer(R.FRAMEBUFFER,K)&&de.drawBuffers&&z&&re.drawBuffers(D,K),re.viewport(C),re.scissor(O),re.setScissorTest(B),Ie){const Ze=Ce.get(D.texture);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+V,Ze.__webglTexture,Z)}else if(Ue){const Ze=Ce.get(D.texture);R.framebufferTextureLayer(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,Ze.__webglTexture,Z||0,V||0)}E=-1},this.readRenderTargetPixels=function(D,V,Z,z,K,Ie,Ue){if(!D||!D.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ye=Ce.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&void 0!==Ue&&(Ye=Ye[Ue]),Ye){re.bindFramebuffer(R.FRAMEBUFFER,Ye);try{const Ze=D.texture,ft=Ze.format,$e=Ze.type;if(ft!==xr&&ve.convert(ft)!==R.getParameter(R.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ot=$e===vd&&(ne.has("EXT_color_buffer_half_float")||de.isWebGL2&&ne.has("EXT_color_buffer_float"));if(!($e===Vo||ve.convert($e)===R.getParameter(R.IMPLEMENTATION_COLOR_READ_TYPE)||$e===Ks&&(de.isWebGL2||ne.has("OES_texture_float")||ne.has("WEBGL_color_buffer_float"))||ot))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");V>=0&&V<=D.width-z&&Z>=0&&Z<=D.height-K&&R.readPixels(V,Z,z,K,ve.convert(ft),ve.convert($e),Ie)}finally{const Ze=null!==M?Ce.get(M).__webglFramebuffer:null;re.bindFramebuffer(R.FRAMEBUFFER,Ze)}}},this.copyFramebufferToTexture=function(D,V,Z=0){const z=Math.pow(2,-Z),K=Math.floor(V.image.width*z),Ie=Math.floor(V.image.height*z);Ae.setTexture2D(V,0),R.copyTexSubImage2D(R.TEXTURE_2D,Z,0,0,D.x,D.y,K,Ie),re.unbindTexture()},this.copyTextureToTexture=function(D,V,Z,z=0){const K=V.image.width,Ie=V.image.height,Ue=ve.convert(Z.format),Ye=ve.convert(Z.type);Ae.setTexture2D(Z,0),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,Z.flipY),R.pixelStorei(R.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z.premultiplyAlpha),R.pixelStorei(R.UNPACK_ALIGNMENT,Z.unpackAlignment),V.isDataTexture?R.texSubImage2D(R.TEXTURE_2D,z,D.x,D.y,K,Ie,Ue,Ye,V.image.data):V.isCompressedTexture?R.compressedTexSubImage2D(R.TEXTURE_2D,z,D.x,D.y,V.mipmaps[0].width,V.mipmaps[0].height,Ue,V.mipmaps[0].data):R.texSubImage2D(R.TEXTURE_2D,z,D.x,D.y,Ue,Ye,V.image),0===z&&Z.generateMipmaps&&R.generateMipmap(R.TEXTURE_2D),re.unbindTexture()},this.copyTextureToTexture3D=function(D,V,Z,z,K=0){if(y.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ie=D.max.x-D.min.x+1,Ue=D.max.y-D.min.y+1,Ye=D.max.z-D.min.z+1,Ze=ve.convert(z.format),ft=ve.convert(z.type);let $e;if(z.isData3DTexture)Ae.setTexture3D(z,0),$e=R.TEXTURE_3D;else{if(!z.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Ae.setTexture2DArray(z,0),$e=R.TEXTURE_2D_ARRAY}R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,z.flipY),R.pixelStorei(R.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),R.pixelStorei(R.UNPACK_ALIGNMENT,z.unpackAlignment);const ot=R.getParameter(R.UNPACK_ROW_LENGTH),cn=R.getParameter(R.UNPACK_IMAGE_HEIGHT),pn=R.getParameter(R.UNPACK_SKIP_PIXELS),Cr=R.getParameter(R.UNPACK_SKIP_ROWS),uo=R.getParameter(R.UNPACK_SKIP_IMAGES),bn=Z.isCompressedTexture?Z.mipmaps[0]:Z.image;R.pixelStorei(R.UNPACK_ROW_LENGTH,bn.width),R.pixelStorei(R.UNPACK_IMAGE_HEIGHT,bn.height),R.pixelStorei(R.UNPACK_SKIP_PIXELS,D.min.x),R.pixelStorei(R.UNPACK_SKIP_ROWS,D.min.y),R.pixelStorei(R.UNPACK_SKIP_IMAGES,D.min.z),Z.isDataTexture||Z.isData3DTexture?R.texSubImage3D($e,K,V.x,V.y,V.z,Ie,Ue,Ye,Ze,ft,bn.data):Z.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),R.compressedTexSubImage3D($e,K,V.x,V.y,V.z,Ie,Ue,Ye,Ze,bn.data)):R.texSubImage3D($e,K,V.x,V.y,V.z,Ie,Ue,Ye,Ze,ft,bn),R.pixelStorei(R.UNPACK_ROW_LENGTH,ot),R.pixelStorei(R.UNPACK_IMAGE_HEIGHT,cn),R.pixelStorei(R.UNPACK_SKIP_PIXELS,pn),R.pixelStorei(R.UNPACK_SKIP_ROWS,Cr),R.pixelStorei(R.UNPACK_SKIP_IMAGES,uo),0===K&&z.generateMipmaps&&R.generateMipmap($e),re.unbindTexture()},this.initTexture=function(D){D.isCubeTexture?Ae.setTextureCube(D,0):D.isData3DTexture?Ae.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?Ae.setTexture2DArray(D,0):Ae.setTexture2D(D,0),re.unbindTexture()},this.resetState=function(){x=0,S=0,M=null,re.reset(),be.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Js}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===wt?Na:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Na?wt:Rn}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class pee extends HO{}).prototype.isWebGL1Renderer=!0;class Mg{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Y(e),this.near=t,this.far=i}clone(){return new Mg(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class GO extends sn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Rb{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=qi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=qi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=qi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _i=new A;class Xa{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)_i.fromBufferAttribute(this,t),_i.applyMatrix4(e),this.setXYZ(t,_i.x,_i.y,_i.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)_i.fromBufferAttribute(this,t),_i.applyNormalMatrix(e),this.setXYZ(t,_i.x,_i.y,_i.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)_i.fromBufferAttribute(this,t),_i.transformDirection(e),this.setXYZ(t,_i.x,_i.y,_i.z);return this}setX(e,t){return this.normalized&&(t=it(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=it(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=it(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=it(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Pi(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Pi(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Pi(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Pi(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=it(t,this.array),i=it(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=it(t,this.array),i=it(i,this.array),r=it(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=it(t,this.array),i=it(i,this.array),r=it(r,this.array),s=it(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new jt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Xa(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const YO=new A,ZO=new It,KO=new It,_ee=new A,JO=new Ve,gu=new A,Lb=new Vr,QO=new Ve,Nb=new Ha;class e2 extends xt{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ve,this.bindMatrixInverse=new Ve,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new _s),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)gu.fromBufferAttribute(t,i),this.applyBoneTransform(i,gu),this.boundingBox.expandByPoint(gu)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Vr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)gu.fromBufferAttribute(t,i),this.applyBoneTransform(i,gu),this.boundingSphere.expandByPoint(gu)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Lb.copy(this.boundingSphere),Lb.applyMatrix4(r),!1!==e.ray.intersectsSphere(Lb)&&(QO.copy(r).invert(),Nb.copy(e.ray).applyMatrix4(QO),(null===this.boundingBox||!1!==Nb.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,Nb)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new It,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;ZO.fromBufferAttribute(r.attributes.skinIndex,e),KO.fromBufferAttribute(r.attributes.skinWeight,e),YO.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=KO.getComponent(s);if(0!==o){const a=ZO.getComponent(s);JO.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(_ee.copy(YO).applyMatrix4(JO),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class Ob extends sn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Pd extends br{constructor(e=null,t=1,i=1,r,s,o,a,c,l=dn,u=dn,h,d){super(null,o,a,c,l,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const t2=new Ve,vee=new Ve;class Ag{constructor(e=[],t=[]){this.uuid=qi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Ve)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Ve;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)t2.multiplyMatrices(e[s]?e[s].matrixWorld:vee,t[s]),t2.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new Ag(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=jN(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Pd(t,e,e,xr,Ks);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Ob),this.bones.push(o),this.boneInverses.push((new Ve).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class Ld extends jt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const _u=new Ve,n2=new Ve,Dg=[],i2=new _s,yee=new Ve,Nd=new xt,Od=new Vr;class r2 extends xt{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ld(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,yee)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new _s),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,_u),i2.copy(e.boundingBox).applyMatrix4(_u),this.boundingBox.union(i2)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Vr),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,_u),Od.copy(e.boundingSphere).applyMatrix4(_u),this.boundingSphere.union(Od)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Nd.geometry=this.geometry,Nd.material=this.material,void 0!==Nd.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),Od.copy(this.boundingSphere),Od.applyMatrix4(i),!1!==e.ray.intersectsSphere(Od)))for(let s=0;s<r;s++){this.getMatrixAt(s,_u),n2.multiplyMatrices(i,_u),Nd.matrixWorld=n2,Nd.raycast(e,Dg);for(let o=0,a=Dg.length;o<a;o++){const c=Dg[o];c.instanceId=s,c.object=this,t.push(c)}Dg.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Ld(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ri extends Li{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Y(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const s2=new A,o2=new A,a2=new Ve,Fb=new Ha,Ig=new Vr;class ao extends sn{constructor(e=new et,t=new ri){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)s2.fromBufferAttribute(t,r-1),o2.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=s2.distanceTo(o2);e.setAttribute("lineDistance",new Re(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Ig.copy(i.boundingSphere),Ig.applyMatrix4(r),Ig.radius+=s,!1===e.ray.intersectsSphere(Ig))return;a2.copy(r).invert(),Fb.copy(e.ray).applyMatrix4(a2);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=new A,u=new A,h=new A,d=new A,f=this.isLineSegments?2:1,p=i.index,_=i.attributes.position;if(null!==p)for(let y=Math.max(0,o.start),w=Math.min(p.count,o.start+o.count)-1;y<w;y+=f){const x=p.getX(y),S=p.getX(y+1);if(l.fromBufferAttribute(_,x),u.fromBufferAttribute(_,S),Fb.distanceSqToSegment(l,u,d,h)>c)continue;d.applyMatrix4(this.matrixWorld);const E=e.ray.origin.distanceTo(d);E<e.near||E>e.far||t.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),w=Math.min(_.count,o.start+o.count)-1;y<w;y+=f){if(l.fromBufferAttribute(_,y),u.fromBufferAttribute(_,y+1),Fb.distanceSqToSegment(l,u,d,h)>c)continue;d.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(d);S<e.near||S>e.far||t.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const c2=new A,l2=new A;class Rg extends ao{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)c2.fromBufferAttribute(t,r),l2.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+c2.distanceTo(l2);e.setAttribute("lineDistance",new Re(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class u2 extends ao{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class kb extends Li{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Y(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const h2=new Ve,Ub=new Ha,Pg=new Vr,Lg=new A;class d2 extends sn{constructor(e=new et,t=new kb){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Pg.copy(i.boundingSphere),Pg.applyMatrix4(r),Pg.radius+=s,!1===e.ray.intersectsSphere(Pg))return;h2.copy(r).invert(),Ub.copy(e.ray).applyMatrix4(h2);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=i.index,h=i.attributes.position;if(null!==l)for(let p=Math.max(0,o.start),g=Math.min(l.count,o.start+o.count);p<g;p++){const _=l.getX(p);Lg.fromBufferAttribute(h,_),f2(Lg,_,c,r,e,t,this)}else for(let p=Math.max(0,o.start),g=Math.min(h.count,o.start+o.count);p<g;p++)Lg.fromBufferAttribute(h,p),f2(Lg,p,c,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function f2(n,e,t,i,r,s,o){const a=Ub.distanceSqToPoint(n);if(a<t){const c=new A;Ub.closestPointToPoint(n,c),c.applyMatrix4(i);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}class xee extends br{constructor(e,t,i,r,s,o,a,c,l){super(e,t,i,r,s,o,a,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class xs{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let l,a=0,c=s-1;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),l=i[r]-o,l<0)a=r+1;else{if(!(l>0)){c=r;break}c=r-1}if(r=c,i[r]===o)return r/(s-1);const u=i[r];return(r+(o-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new J:new A);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new A,r=[],s=[],o=[],a=new A,c=new Ve;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new A);s[0]=new A,o[0]=new A;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),d<=l&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(rn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(c.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(rn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(c.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Bb extends xs{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t){const i=t||new J,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=c-this.aX,f=l-this.aY;c=d*u-f*h+this.aX,l=d*h+f*u+this.aY}return i.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function Vb(){let n=0,e=0,t=0,i=0;function r(s,o,a,c){n=s,e=a,t=-3*s+3*o-2*a-c,i=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,l){r(o,a,l*(a-s),l*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,l,u,h){let d=(o-s)/l-(a-s)/(l+u)+(a-o)/u,f=(a-o)/u-(c-o)/(u+h)+(c-a)/h;d*=u,f*=u,r(o,a,d,f)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}const Ng=new A,zb=new Vb,Hb=new Vb,Gb=new Vb;function p2(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function Fd(n,e,t,i){return function See(n,e){const t=1-n;return t*t*e}(n,e)+function Eee(n,e){return 2*(1-n)*n*e}(n,t)+function Cee(n,e){return n*n*e}(n,i)}function kd(n,e,t,i,r){return function Tee(n,e){const t=1-n;return t*t*t*e}(n,e)+function Aee(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function Dee(n,e){return 3*(1-n)*n*n*e}(n,i)+function Iee(n,e){return n*n*n*e}(n,r)}class m2 extends xs{constructor(e=new J,t=new J,i=new J,r=new J){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new J){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(kd(e,r.x,s.x,o.x,a.x),kd(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Wb extends xs{constructor(e=new J,t=new J){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new J){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new J){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class g2 extends xs{constructor(e=new J,t=new J,i=new J){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new J){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Fd(e,r.x,s.x,o.x),Fd(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class v2 extends xs{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new J){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,c=r[0===o?o:o-1],l=r[o],u=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return i.set(p2(a,c.x,l.x,u.x,h.x),p2(a,c.y,l.y,u.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new J).fromArray(r))}return this}}var jb=Object.freeze({__proto__:null,ArcCurve:class bee extends Bb{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class Mee extends xs{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new A){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let l,u,a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===c&&a===s-1&&(a=s-2,c=1),this.closed||a>0?l=r[(a-1)%s]:(Ng.subVectors(r[0],r[1]).add(r[0]),l=Ng);const h=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(Ng.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=Ng),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let p=Math.pow(l.distanceToSquared(h),f),g=Math.pow(h.distanceToSquared(d),f),_=Math.pow(d.distanceToSquared(u),f);g<1e-4&&(g=1),p<1e-4&&(p=g),_<1e-4&&(_=g),zb.initNonuniformCatmullRom(l.x,h.x,d.x,u.x,p,g,_),Hb.initNonuniformCatmullRom(l.y,h.y,d.y,u.y,p,g,_),Gb.initNonuniformCatmullRom(l.z,h.z,d.z,u.z,p,g,_)}else"catmullrom"===this.curveType&&(zb.initCatmullRom(l.x,h.x,d.x,u.x,this.tension),Hb.initCatmullRom(l.y,h.y,d.y,u.y,this.tension),Gb.initCatmullRom(l.z,h.z,d.z,u.z,this.tension));return i.set(zb.calc(c),Hb.calc(c),Gb.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new A).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:m2,CubicBezierCurve3:class Ree extends xs{constructor(e=new A,t=new A,i=new A,r=new A){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new A){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(kd(e,r.x,s.x,o.x,a.x),kd(e,r.y,s.y,o.y,a.y),kd(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:Bb,LineCurve:Wb,LineCurve3:class Pee extends xs{constructor(e=new A,t=new A){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new A){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new A){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:g2,QuadraticBezierCurve3:class _2 extends xs{constructor(e=new A,t=new A,i=new A){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new A){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Fd(e,r.x,s.x,o.x),Fd(e,r.y,s.y,o.y),Fd(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:v2});class Lee extends xs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Wb(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],c=a.getLength();return a.getPointAt(0===c?0:1-o/c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],c=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let l=0;l<c.length;l++){const u=c[l];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new jb[r.type]).fromJSON(r))}return this}}class Og extends Lee{constructor(e){super(),this.type="Path",this.currentPoint=new J,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new Wb(this.currentPoint.clone(),new J(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new g2(this.currentPoint.clone(),new J(e,t),new J(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new m2(this.currentPoint.clone(),new J(e,t),new J(i,r),new J(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new v2(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,c){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,c),this}absellipse(e,t,i,r,s,o,a,c){const l=new Bb(e,t,i,r,s,o,a,c);if(this.curves.length>0){const h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class qa extends et{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function c(v,y,w,x){const S=x+1,M=[];for(let E=0;E<=S;E++){M[E]=[];const b=v.clone().lerp(w,E/S),C=y.clone().lerp(w,E/S),O=S-E;for(let B=0;B<=O;B++)M[E][B]=0===B&&E===S?b:b.clone().lerp(C,B/O)}for(let E=0;E<S;E++)for(let b=0;b<2*(S-E)-1;b++){const C=Math.floor(b/2);b%2==0?(d(M[E][C+1]),d(M[E+1][C]),d(M[E][C])):(d(M[E][C+1]),d(M[E+1][C+1]),d(M[E+1][C]))}}function d(v){s.push(v.x,v.y,v.z)}function f(v,y){const w=3*v;y.x=e[w+0],y.y=e[w+1],y.z=e[w+2]}function g(v,y,w,x){x<0&&1===v.x&&(o[y]=v.x-1),0===w.x&&0===w.z&&(o[y]=x/2/Math.PI+.5)}function _(v){return Math.atan2(v.z,-v.x)}function m(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}(function a(v){const y=new A,w=new A,x=new A;for(let S=0;S<t.length;S+=3)f(t[S+0],y),f(t[S+1],w),f(t[S+2],x),c(y,w,x,v)})(r),function l(v){const y=new A;for(let w=0;w<s.length;w+=3)y.x=s[w+0],y.y=s[w+1],y.z=s[w+2],y.normalize().multiplyScalar(v),s[w+0]=y.x,s[w+1]=y.y,s[w+2]=y.z}(i),function u(){const v=new A;for(let y=0;y<s.length;y+=3){v.x=s[y+0],v.y=s[y+1],v.z=s[y+2];const w=_(v)/2/Math.PI+.5,x=m(v)/Math.PI+.5;o.push(w,1-x)}(function p(){const v=new A,y=new A,w=new A,x=new A,S=new J,M=new J,E=new J;for(let b=0,C=0;b<s.length;b+=9,C+=6){v.set(s[b+0],s[b+1],s[b+2]),y.set(s[b+3],s[b+4],s[b+5]),w.set(s[b+6],s[b+7],s[b+8]),S.set(o[C+0],o[C+1]),M.set(o[C+2],o[C+3]),E.set(o[C+4],o[C+5]),x.copy(v).add(y).add(w).divideScalar(3);const O=_(x);g(S,C+0,v,O),g(M,C+2,y,O),g(E,C+4,w,O)}})(),function h(){for(let v=0;v<o.length;v+=6){const y=o[v+0],w=o[v+2],x=o[v+4],S=Math.max(y,w,x),M=Math.min(y,w,x);S>.9&&M<.1&&(y<.2&&(o[v+0]+=1),w<.2&&(o[v+2]+=1),x<.2&&(o[v+4]+=1))}}()}(),this.setAttribute("position",new Re(s,3)),this.setAttribute("normal",new Re(s.slice(),3)),this.setAttribute("uv",new Re(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qa(e.vertices,e.indices,e.radius,e.details)}}const kg=new A,Ug=new A,Zb=new A,Bg=new Ki;class y2 extends et{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(Ua*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,l=[0,0,0],u=["a","b","c"],h=new Array(3),d={},f=[];for(let p=0;p<c;p+=3){o?(l[0]=o.getX(p),l[1]=o.getX(p+1),l[2]=o.getX(p+2)):(l[0]=p,l[1]=p+1,l[2]=p+2);const{a:g,b:_,c:m}=Bg;if(g.fromBufferAttribute(a,l[0]),_.fromBufferAttribute(a,l[1]),m.fromBufferAttribute(a,l[2]),Bg.getNormal(Zb),h[0]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,h[1]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,h[2]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(let v=0;v<3;v++){const y=(v+1)%3,w=h[v],x=h[y],S=Bg[u[v]],M=Bg[u[y]],E=`${w}_${x}`,b=`${x}_${w}`;b in d&&d[b]?(Zb.dot(d[b].normal)<=s&&(f.push(S.x,S.y,S.z),f.push(M.x,M.y,M.z)),d[b]=null):E in d||(d[E]={index0:l[v],index1:l[y],normal:Zb.clone()})}}for(const p in d)if(d[p]){const{index0:g,index1:_}=d[p];kg.fromBufferAttribute(a,g),Ug.fromBufferAttribute(a,_),f.push(kg.x,kg.y,kg.z),f.push(Ug.x,Ug.y,Ug.z)}this.setAttribute("position",new Re(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class $o extends Og{constructor(e){super(e),this.uuid=qi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new Og).fromJSON(r))}return this}}function w2(n,e,t,i,r){let s,o;if(r===function Zee(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=M2(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=M2(s,n[s],n[s+1],o);return o&&Vg(o,o.next)&&(zd(o),o=o.next),o}function Ya(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!Vg(t,t.next)&&0!==Jt(t.prev,t,t.next))t=t.next;else{if(zd(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function Bd(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function Wee(n,e,t,i){let r=n;do{0===r.z&&(r.z=Kb(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function jee(n){let e,t,i,r,s,o,a,c,l=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<l&&(a++,i=i.nextZ,i);e++);for(c=l;a>0||c>0&&i;)0!==a&&(0===c||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,c--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,l*=2}while(o>1)}(r)}(n,i,r,s);let c,l,a=n;for(;n.prev!==n.next;)if(c=n.prev,l=n.next,s?Fee(n,i,r,s):Oee(n))e.push(c.i/t|0),e.push(n.i/t|0),e.push(l.i/t|0),zd(n),n=l.next,a=l.next;else if((n=l)===a){o?1===o?Bd(n=kee(Ya(n),e,t),e,t,i,r,s,2):2===o&&Uee(n,e,t,i,r,s):Bd(Ya(n),e,t,i,r,s,1);break}}function Oee(n){const e=n.prev,t=n,i=n.next;if(Jt(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,c=t.y,l=i.y,u=r<s?r<o?r:o:s<o?s:o,h=a<c?a<l?a:l:c<l?c:l,d=r>s?r>o?r:o:s>o?s:o,f=a>c?a>l?a:l:c>l?c:l;let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&vu(r,a,s,c,o,l,p.x,p.y)&&Jt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Fee(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Jt(r,s,o)>=0)return!1;const a=r.x,c=s.x,l=o.x,u=r.y,h=s.y,d=o.y,f=a<c?a<l?a:l:c<l?c:l,p=u<h?u<d?u:d:h<d?h:d,g=a>c?a>l?a:l:c>l?c:l,_=u>h?u>d?u:d:h>d?h:d,m=Kb(f,p,e,t,i),v=Kb(g,_,e,t,i);let y=n.prevZ,w=n.nextZ;for(;y&&y.z>=m&&w&&w.z<=v;){if(y.x>=f&&y.x<=g&&y.y>=p&&y.y<=_&&y!==r&&y!==o&&vu(a,u,c,h,l,d,y.x,y.y)&&Jt(y.prev,y,y.next)>=0||(y=y.prevZ,w.x>=f&&w.x<=g&&w.y>=p&&w.y<=_&&w!==r&&w!==o&&vu(a,u,c,h,l,d,w.x,w.y)&&Jt(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;y&&y.z>=m;){if(y.x>=f&&y.x<=g&&y.y>=p&&y.y<=_&&y!==r&&y!==o&&vu(a,u,c,h,l,d,y.x,y.y)&&Jt(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;w&&w.z<=v;){if(w.x>=f&&w.x<=g&&w.y>=p&&w.y<=_&&w!==r&&w!==o&&vu(a,u,c,h,l,d,w.x,w.y)&&Jt(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function kee(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!Vg(r,s)&&x2(r,i,i.next,s)&&Vd(r,s)&&Vd(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),zd(i),zd(i.next),i=n=s),i=i.next}while(i!==n);return Ya(i)}function Uee(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Xee(o,a)){let c=b2(o,a);return o=Ya(o,o.next),c=Ya(c,c.next),Bd(o,e,t,i,r,s,0),void Bd(c,e,t,i,r,s,0)}a=a.next}o=o.next}while(o!==n)}function Vee(n,e){return n.x-e.x}function zee(n,e){const t=function Hee(n,e){let r,t=e,i=-1/0;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=s&&d>i&&(i=d,r=t.x<t.next.x?t:t.next,d===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,c=r.x,l=r.y;let h,u=1/0;t=r;do{s>=t.x&&t.x>=c&&s!==t.x&&vu(o<l?s:i,o,c,l,o<l?i:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),Vd(t,n)&&(h<u||h===u&&(t.x>r.x||t.x===r.x&&Gee(r,t)))&&(r=t,u=h)),t=t.next}while(t!==a);return r}(n,e);if(!t)return e;const i=b2(t,n);return Ya(i,i.next),Ya(t,t.next)}function Gee(n,e){return Jt(n.prev,n,e.prev)<0&&Jt(e.next,n,n.next)<0}function Kb(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function $ee(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function vu(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function Xee(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function qee(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&x2(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(Vd(n,e)&&Vd(e,n)&&function Yee(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(Jt(n.prev,n,e.prev)||Jt(n,e.prev,e))||Vg(n,e)&&Jt(n.prev,n,n.next)>0&&Jt(e.prev,e,e.next)>0)}function Jt(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Vg(n,e){return n.x===e.x&&n.y===e.y}function x2(n,e,t,i){const r=Hg(Jt(n,e,t)),s=Hg(Jt(n,e,i)),o=Hg(Jt(t,i,n)),a=Hg(Jt(t,i,e));return!!(r!==s&&o!==a||0===r&&zg(n,t,e)||0===s&&zg(n,i,e)||0===o&&zg(t,n,i)||0===a&&zg(t,e,i))}function zg(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Hg(n){return n>0?1:n<0?-1:0}function Vd(n,e){return Jt(n.prev,n,n.next)<0?Jt(n,e,n.next)>=0&&Jt(n,n.prev,e)>=0:Jt(n,e,n.prev)<0||Jt(n,n.next,e)<0}function b2(n,e){const t=new Jb(n.i,n.x,n.y),i=new Jb(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function M2(n,e,t,i){const r=new Jb(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function zd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Jb(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class co{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return co.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];S2(e),E2(i,e);let o=e.length;t.forEach(S2);for(let c=0;c<t.length;c++)r.push(o),o+=t[c].length,E2(i,t[c]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=w2(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,l,u,h,d,f;if(i&&(s=function Bee(n,e,t,i){const r=[];let s,o,a,c,l;for(s=0,o=e.length;s<o;s++)a=e[s]*i,c=s<o-1?e[s+1]*i:n.length,l=w2(n,a,c,i,!1),l===l.next&&(l.steiner=!0),r.push($ee(l));for(r.sort(Vee),s=0;s<r.length;s++)t=zee(r[s],t);return t}(n,e,s,t)),n.length>80*t){a=l=n[0],c=u=n[1];for(let p=t;p<r;p+=t)h=n[p],d=n[p+1],h<a&&(a=h),d<c&&(c=d),h>l&&(l=h),d>u&&(u=d);f=Math.max(l-a,u-c),f=0!==f?32767/f:0}return Bd(s,o,t,a,c,f,0),o}(i,r);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}}function S2(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function E2(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Gg extends et{constructor(e=new $o([new J(.5,.5),new J(-.5,.5),new J(-.5,-.5),new J(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,c=e.length;a<c;a++)o(e[a]);function o(a){const c=[],l=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1,h=void 0!==t.depth?t.depth:1;let d=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,p=void 0!==t.bevelSize?t.bevelSize:f-.1,g=void 0!==t.bevelOffset?t.bevelOffset:0,_=void 0!==t.bevelSegments?t.bevelSegments:3;const m=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:Kee;let y,x,S,M,E,w=!1;m&&(y=m.getSpacedPoints(u),w=!0,d=!1,x=m.computeFrenetFrames(u,!1),S=new A,M=new A,E=new A),d||(_=0,f=0,p=0,g=0);const b=a.extractPoints(l);let C=b.shape;const O=b.holes;if(!co.isClockWise(C)){C=C.reverse();for(let R=0,ge=O.length;R<ge;R++){const ne=O[R];co.isClockWise(ne)&&(O[R]=ne.reverse())}}const L=co.triangulateShape(C,O),F=C;for(let R=0,ge=O.length;R<ge;R++)C=C.concat(O[R]);function k(R,ge,ne){return ge||console.error("THREE.ExtrudeGeometry: vec does not exist"),R.clone().addScaledVector(ge,ne)}const W=C.length,H=L.length;function X(R,ge,ne){let de,re,Fe;const Ce=R.x-ge.x,Ae=R.y-ge.y,ze=ne.x-R.x,ht=ne.y-R.y,qt=Ce*Ce+Ae*Ae;if(Math.abs(Ce*ht-Ae*ze)>Number.EPSILON){const T=Math.sqrt(qt),G=Math.sqrt(ze*ze+ht*ht),ue=ge.x-Ae/T,se=ge.y+Ce/T,pe=((ne.x-ht/G-ue)*ht-(ne.y+ze/G-se)*ze)/(Ce*ht-Ae*ze);de=ue+Ce*pe-R.x,re=se+Ae*pe-R.y;const j=de*de+re*re;if(j<=2)return new J(de,re);Fe=Math.sqrt(j/2)}else{let T=!1;Ce>Number.EPSILON?ze>Number.EPSILON&&(T=!0):Ce<-Number.EPSILON?ze<-Number.EPSILON&&(T=!0):Math.sign(Ae)===Math.sign(ht)&&(T=!0),T?(de=-Ae,re=Ce,Fe=Math.sqrt(qt)):(de=Ce,re=Ae,Fe=Math.sqrt(qt/2))}return new J(de/Fe,re/Fe)}const Q=[];for(let R=0,ge=F.length,ne=ge-1,de=R+1;R<ge;R++,ne++,de++)ne===ge&&(ne=0),de===ge&&(de=0),Q[R]=X(F[R],F[ne],F[de]);const te=[];let U,q=Q.concat();for(let R=0,ge=O.length;R<ge;R++){const ne=O[R];U=[];for(let de=0,re=ne.length,Fe=re-1,Ce=de+1;de<re;de++,Fe++,Ce++)Fe===re&&(Fe=0),Ce===re&&(Ce=0),U[de]=X(ne[de],ne[Fe],ne[Ce]);te.push(U),q=q.concat(U)}for(let R=0;R<_;R++){const ge=R/_,ne=f*Math.cos(ge*Math.PI/2),de=p*Math.sin(ge*Math.PI/2)+g;for(let re=0,Fe=F.length;re<Fe;re++){const Ce=k(F[re],Q[re],de);Pe(Ce.x,Ce.y,-ne)}for(let re=0,Fe=O.length;re<Fe;re++){const Ce=O[re];U=te[re];for(let Ae=0,ze=Ce.length;Ae<ze;Ae++){const ht=k(Ce[Ae],U[Ae],de);Pe(ht.x,ht.y,-ne)}}}const ae=p+g;for(let R=0;R<W;R++){const ge=d?k(C[R],q[R],ae):C[R];w?(M.copy(x.normals[0]).multiplyScalar(ge.x),S.copy(x.binormals[0]).multiplyScalar(ge.y),E.copy(y[0]).add(M).add(S),Pe(E.x,E.y,E.z)):Pe(ge.x,ge.y,0)}for(let R=1;R<=u;R++)for(let ge=0;ge<W;ge++){const ne=d?k(C[ge],q[ge],ae):C[ge];w?(M.copy(x.normals[R]).multiplyScalar(ne.x),S.copy(x.binormals[R]).multiplyScalar(ne.y),E.copy(y[R]).add(M).add(S),Pe(E.x,E.y,E.z)):Pe(ne.x,ne.y,h/u*R)}for(let R=_-1;R>=0;R--){const ge=R/_,ne=f*Math.cos(ge*Math.PI/2),de=p*Math.sin(ge*Math.PI/2)+g;for(let re=0,Fe=F.length;re<Fe;re++){const Ce=k(F[re],Q[re],de);Pe(Ce.x,Ce.y,h+ne)}for(let re=0,Fe=O.length;re<Fe;re++){const Ce=O[re];U=te[re];for(let Ae=0,ze=Ce.length;Ae<ze;Ae++){const ht=k(Ce[Ae],U[Ae],de);w?Pe(ht.x,ht.y+y[u-1].y,y[u-1].x+ne):Pe(ht.x,ht.y,h+ne)}}}function Ee(R,ge){let ne=R.length;for(;--ne>=0;){const de=ne;let re=ne-1;re<0&&(re=R.length-1);for(let Fe=0,Ce=u+2*_;Fe<Ce;Fe++){const Ae=W*Fe,ze=W*(Fe+1);ct(ge+de+Ae,ge+re+Ae,ge+re+ze,ge+de+ze)}}}function Pe(R,ge,ne){c.push(R),c.push(ge),c.push(ne)}function Te(R,ge,ne){tt(R),tt(ge),tt(ne);const de=r.length/3,re=v.generateTopUV(i,r,de-3,de-2,de-1);Ne(re[0]),Ne(re[1]),Ne(re[2])}function ct(R,ge,ne,de){tt(R),tt(ge),tt(de),tt(ge),tt(ne),tt(de);const re=r.length/3,Fe=v.generateSideWallUV(i,r,re-6,re-3,re-2,re-1);Ne(Fe[0]),Ne(Fe[1]),Ne(Fe[3]),Ne(Fe[1]),Ne(Fe[2]),Ne(Fe[3])}function tt(R){r.push(c[3*R+0]),r.push(c[3*R+1]),r.push(c[3*R+2])}function Ne(R){s.push(R.x),s.push(R.y)}(function oe(){const R=r.length/3;if(d){let ge=0,ne=W*ge;for(let de=0;de<H;de++){const re=L[de];Te(re[2]+ne,re[1]+ne,re[0]+ne)}ge=u+2*_,ne=W*ge;for(let de=0;de<H;de++){const re=L[de];Te(re[0]+ne,re[1]+ne,re[2]+ne)}}else{for(let ge=0;ge<H;ge++){const ne=L[ge];Te(ne[2],ne[1],ne[0])}for(let ge=0;ge<H;ge++){const ne=L[ge];Te(ne[0]+W*u,ne[1]+W*u,ne[2]+W*u)}}i.addGroup(R,r.length/3-R,0)})(),function le(){const R=r.length/3;let ge=0;Ee(F,ge),ge+=F.length;for(let ne=0,de=O.length;ne<de;ne++){const re=O[ne];Ee(re,ge),ge+=re.length}i.addGroup(R,r.length/3-R,1)}()}this.setAttribute("position",new Re(r,3)),this.setAttribute("uv",new Re(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function Jee(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new jb[r.type]).fromJSON(r)),new Gg(i,e.options)}}const Kee={generateTopUV:function(n,e,t,i,r){const a=e[3*i],c=e[3*i+1],l=e[3*r],u=e[3*r+1];return[new J(e[3*t],e[3*t+1]),new J(a,c),new J(l,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],c=e[3*t+2],l=e[3*i],u=e[3*i+1],h=e[3*i+2],d=e[3*r],f=e[3*r+1],p=e[3*r+2],g=e[3*s],_=e[3*s+1],m=e[3*s+2];return Math.abs(a-u)<Math.abs(o-l)?[new J(o,1-c),new J(l,1-h),new J(d,1-p),new J(g,1-m)]:[new J(a,1-c),new J(u,1-h),new J(f,1-p),new J(_,1-m)]}};class Wg extends qa{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Wg(e.radius,e.detail)}}class yu extends et{constructor(e=.5,t=1,i=32,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i);const a=[],c=[],l=[],u=[];let h=e;const d=(t-e)/(r=Math.max(1,r)),f=new A,p=new J;for(let g=0;g<=r;g++){for(let _=0;_<=i;_++){const m=s+_/i*o;f.x=h*Math.cos(m),f.y=h*Math.sin(m),c.push(f.x,f.y,f.z),l.push(0,0,1),p.x=(f.x/t+1)/2,p.y=(f.y/t+1)/2,u.push(p.x,p.y)}h+=d}for(let g=0;g<r;g++){const _=g*(i+1);for(let m=0;m<i;m++){const v=m+_,w=v+i+1,x=v+i+2,S=v+1;a.push(v,w,S),a.push(w,x,S)}}this.setIndex(a),this.setAttribute("position",new Re(c,3)),this.setAttribute("normal",new Re(l,3)),this.setAttribute("uv",new Re(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yu(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Za extends et{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const c=Math.min(o+a,Math.PI);let l=0;const u=[],h=new A,d=new A,f=[],p=[],g=[],_=[];for(let m=0;m<=i;m++){const v=[],y=m/i;let w=0;0===m&&0===o?w=.5/t:m===i&&c===Math.PI&&(w=-.5/t);for(let x=0;x<=t;x++){const S=x/t;h.x=-e*Math.cos(r+S*s)*Math.sin(o+y*a),h.y=e*Math.cos(o+y*a),h.z=e*Math.sin(r+S*s)*Math.sin(o+y*a),p.push(h.x,h.y,h.z),d.copy(h).normalize(),g.push(d.x,d.y,d.z),_.push(S+w,1-y),v.push(l++)}u.push(v)}for(let m=0;m<i;m++)for(let v=0;v<t;v++){const w=u[m][v],x=u[m+1][v],S=u[m+1][v+1];(0!==m||o>0)&&f.push(u[m][v+1],w,S),(m!==i-1||c<Math.PI)&&f.push(w,x,S)}this.setIndex(f),this.setAttribute("position",new Re(p,3)),this.setAttribute("normal",new Re(g,3)),this.setAttribute("uv",new Re(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Za(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Ka extends Li{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Y(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new J(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bs extends Ka{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new J(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return rn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Y(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Y(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Y(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Xo extends Li{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Y(16777215),this.specular=new Y(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new J(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Gm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class A2 extends Li{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new J(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class $g extends Li{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Y(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new J(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Gm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function Sr(n,e,t){return rM(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)}function Ja(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function rM(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function D2(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function sM(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=n[a+c]}return r}function oM(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class Hd{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class cte extends Hd{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===c)switch(this.getSettings_().endingEnd){case 2401:o=e,c=2*i-t;break;case 2402:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}const l=.5*(i-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),g=p*p,_=g*p,m=-d*_+2*d*g-d*p,v=(1+d)*_+(-1.5-2*d)*g+(-.5+d)*p+1,y=(-1-f)*_+(1.5+f)*g+.5*p,w=f*_-f*g;for(let x=0;x!==a;++x)s[x]=m*o[u+x]+v*o[l+x]+y*o[c+x]+w*o[h+x];return s}}class I2 extends Hd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(i-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[l+d]*h+o[c+d]*u;return s}}class lte extends Hd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ms{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ja(t,this.TimeBufferType),this.values=Ja(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Ja(e.times,Array),values:Ja(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new lte(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new I2(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new cte(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case yd:t=this.InterpolantFactoryMethodDiscrete;break;case Ul:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return yd;case this.InterpolantFactoryMethodLinear:return Ul;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Sr(i,s,o),this.values=Sr(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=i[a];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(null!==o&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(void 0!==r&&rM(r))for(let a=0,c=r.length;a!==c;++a){const l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){const e=Sr(this.times),t=Sr(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const l=e[a];if(l!==e[a+1]&&(1!==a||l!==e[0]))if(r)c=!0;else{const h=a*i,d=h-i,f=h+i;for(let p=0;p!==i;++p){const g=t[h+p];if(g!==t[d+p]||g!==t[f+p]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const h=a*i,d=o*i;for(let f=0;f!==i;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,l=0;l!==i;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=Sr(e,0,o),this.values=Sr(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=Sr(this.times,0),t=Sr(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ms.prototype.TimeBufferType=Float32Array,Ms.prototype.ValueBufferType=Float32Array,Ms.prototype.DefaultInterpolation=Ul;class wu extends Ms{}wu.prototype.ValueTypeName="bool",wu.prototype.ValueBufferType=Array,wu.prototype.DefaultInterpolation=yd,wu.prototype.InterpolantFactoryMethodLinear=void 0,wu.prototype.InterpolantFactoryMethodSmooth=void 0;class R2 extends Ms{}R2.prototype.ValueTypeName="color";class xu extends Ms{}xu.prototype.ValueTypeName="number";class ute extends Hd{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let l=e*a;for(let u=l+a;l!==u;l+=4)Hn.slerpFlat(s,0,o,l-a,o,l,c);return s}}class Qa extends Ms{InterpolantFactoryMethodLinear(e){return new ute(this.times,this.values,this.getValueSize(),e)}}Qa.prototype.ValueTypeName="quaternion",Qa.prototype.DefaultInterpolation=Ul,Qa.prototype.InterpolantFactoryMethodSmooth=void 0;class bu extends Ms{}bu.prototype.ValueTypeName="string",bu.prototype.ValueBufferType=Array,bu.prototype.DefaultInterpolation=yd,bu.prototype.InterpolantFactoryMethodLinear=void 0,bu.prototype.InterpolantFactoryMethodSmooth=void 0;class Mu extends Ms{}Mu.prototype.ValueTypeName="vector";class Gd{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=qi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(dte(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Ms.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],l=[];c.push((a+s-1)%s,a,(a+1)%s),l.push(0,1,0);const u=D2(c);c=sM(c,1,u),l=sM(l,1,u),!r&&0===c[0]&&(c.push(s),l.push(l[0])),o.push(new xu(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const l=e[a],u=l.name.match(s);if(u&&u.length>1){const h=u[1];let d=r[h];d||(r[h]=d=[]),d.push(l)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,d,f,p,g){if(0!==f.length){const _=[],m=[];oM(f,_,m,p),0!==_.length&&g.push(new h(d,_,m))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let h=0;h<l.length;h++){const d=l[h].keys;if(d&&0!==d.length)if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let g=0;g<d[p].morphTargets.length;g++)f[d[p].morphTargets[g]]=-1;for(const g in f){const _=[],m=[];for(let v=0;v!==d[p].morphTargets.length;++v){const y=d[p];_.push(y.time),m.push(y.morphTarget===g?1:0)}r.push(new xu(".morphTargetInfluence["+g+"]",_,m))}c=f.length*o}else{const f=".bones["+t[h].name+"]";i(Mu,f+".position",d,"pos",r),i(Qa,f+".quaternion",d,"rot",r),i(Mu,f+".scale",d,"scl",r)}}return 0===r.length?null:new this(s,c,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function dte(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function hte(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return xu;case"vector":case"vector2":case"vector3":case"vector4":return Mu;case"color":return R2;case"quaternion":return Qa;case"bool":case"boolean":return wu;case"string":return bu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];oM(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Su={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class P2{constructor(e,t,i){const r=this;let c,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,h){return l.push(u,h),this},this.removeHandler=function(u){const h=l.indexOf(u);return-1!==h&&l.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=l.length;h<d;h+=2){const f=l[h],p=l[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const fte=new P2;let ec=(()=>{class n{constructor(t){this.manager=void 0!==t?t:fte,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const lo={};class pte extends Error{constructor(e,t){super(e),this.response=t}}class Qi extends ec{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Su.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==lo[e])return void lo[e].push({onLoad:t,onProgress:i,onError:r});lo[e]=[],lo[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(l=>{if(200===l.status||0===l.status){if(0===l.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===l.body||void 0===l.body.getReader)return l;const u=lo[e],h=l.body.getReader(),d=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),f=d?parseInt(d):0,p=0!==f;let g=0;const _=new ReadableStream({start(m){!function v(){h.read().then(({done:y,value:w})=>{if(y)m.close();else{g+=w.byteLength;const x=new ProgressEvent("progress",{lengthComputable:p,loaded:g,total:f});for(let S=0,M=u.length;S<M;S++){const E=u[S];E.onProgress&&E.onProgress(x)}m.enqueue(w),v()}})}()}});return new Response(_)}throw new pte(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return l.json();default:if(void 0===a)return l.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return l.arrayBuffer().then(p=>f.decode(p))}}}).then(l=>{Su.add(e,l);const u=lo[e];delete lo[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onLoad&&f.onLoad(l)}}).catch(l=>{const u=lo[e];if(void 0===u)throw this.manager.itemError(e),l;delete lo[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Xg extends ec{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Su.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=xd("img");function c(){u(),Su.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class aM extends ec{constructor(e){super(e)}load(e,t,i,r){const s=new br,o=new Xg(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class qg extends sn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Y(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class cM extends qg{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Y(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const lM=new Ve,L2=new A,N2=new A;class uM{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new J(512,512),this.map=null,this.mapPass=null,this.matrix=new Ve,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Mb,this._frameExtents=new J(1,1),this._viewportCount=1,this._viewports=[new It(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;L2.setFromMatrixPosition(e.matrixWorld),t.position.copy(L2),N2.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(N2),t.updateMatrixWorld(),lM.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lM),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(lM)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class mte extends uM{constructor(){super(new Un(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*zl*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class hM extends qg{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.target=new sn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new mte}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const O2=new Ve,Wd=new A,dM=new A;class gte extends uM{constructor(){super(new Un(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new J(4,2),this._viewportCount=6,this._viewports=[new It(2,1,1,1),new It(0,1,1,1),new It(3,1,1,1),new It(1,1,1,1),new It(3,0,1,1),new It(1,0,1,1)],this._cubeDirections=[new A(1,0,0),new A(-1,0,0),new A(0,0,1),new A(0,0,-1),new A(0,1,0),new A(0,-1,0)],this._cubeUps=[new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,0,1),new A(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Wd.setFromMatrixPosition(e.matrixWorld),i.position.copy(Wd),dM.copy(i.position),dM.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(dM),i.updateMatrixWorld(),r.makeTranslation(-Wd.x,-Wd.y,-Wd.z),O2.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(O2)}}class fM extends qg{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new gte}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class _te extends uM{constructor(){super(new yg(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Yg extends qg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(sn.DEFAULT_UP),this.updateMatrix(),this.target=new sn,this.shadow=new _te}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class jd{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class bte extends et{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class F2 extends ec{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Qi(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(f,p){if(void 0!==t[p])return t[p];const _=f.interleavedBuffers[p],m=function s(f,p){if(void 0!==i[p])return i[p];const m=new Uint32Array(f.arrayBuffers[p]).buffer;return i[p]=m,m}(f,_.buffer),v=Gl(_.type,m),y=new Rb(v,_.stride);return y.uuid=_.uuid,t[p]=y,y}const o=e.isInstancedBufferGeometry?new bte:new et,a=e.data.index;if(void 0!==a){const f=Gl(a.type,a.array);o.setIndex(new jt(f,1))}const c=e.data.attributes;for(const f in c){const p=c[f];let g;if(p.isInterleavedBufferAttribute){const _=r(e.data,p.data);g=new Xa(_,p.itemSize,p.offset,p.normalized)}else{const _=Gl(p.type,p.array);g=new(p.isInstancedBufferAttribute?Ld:jt)(_,p.itemSize,p.normalized)}void 0!==p.name&&(g.name=p.name),void 0!==p.usage&&g.setUsage(p.usage),void 0!==p.updateRange&&(g.updateRange.offset=p.updateRange.offset,g.updateRange.count=p.updateRange.count),o.setAttribute(f,g)}const l=e.data.morphAttributes;if(l)for(const f in l){const p=l[f],g=[];for(let _=0,m=p.length;_<m;_++){const v=p[_];let y;if(v.isInterleavedBufferAttribute){const w=r(e.data,v.data);y=new Xa(w,v.itemSize,v.offset,v.normalized)}else{const w=Gl(v.type,v.array);y=new jt(w,v.itemSize,v.normalized)}void 0!==v.name&&(y.name=v.name),g.push(y)}o.morphAttributes[f]=g}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==h)for(let f=0,p=h.length;f!==p;++f){const g=h[f];o.addGroup(g.start,g.count,g.materialIndex)}const d=e.data.boundingSphere;if(void 0!==d){const f=new A;void 0!==d.center&&f.fromArray(d.center),o.boundingSphere=new Vr(f,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Ste extends ec{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Su.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){Su.add(e,c),t&&t(c),s.manager.itemEnd(e)}).catch(function(c){r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}class H2{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=G2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=G2();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function G2(){return(typeof performance>"u"?Date:performance).now()}const mM="\\[\\]\\.:\\/",Ate=new RegExp("["+mM+"]","g"),gM="[^"+mM+"]",Dte="[^"+mM.replace("\\.","")+"]",Nte=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",gM)+/(WCOD+)?/.source.replace("WCOD",Dte)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gM)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gM)+"$"),Ote=["material","materials","bones","map"];class Fte{constructor(e,t,i){const r=i||Vt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Vt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Ate,"")}static parseTrackName(t){const i=Nte.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Ote.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const c=o[a];if(c.name===i||c.uuid===i)return c;const l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===u){u=h;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=Fte,n})();Vt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Vt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Vt.prototype.GetterByBindingType=[Vt.prototype._getValue_direct,Vt.prototype._getValue_array,Vt.prototype._getValue_arrayElement,Vt.prototype._getValue_toArray],Vt.prototype.SetterByBindingTypeAndVersioning=[[Vt.prototype._setValue_direct,Vt.prototype._setValue_direct_setNeedsUpdate,Vt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Vt.prototype._setValue_array,Vt.prototype._setValue_array_setNeedsUpdate,Vt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Vt.prototype._setValue_arrayElement,Vt.prototype._setValue_arrayElement_setNeedsUpdate,Vt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Vt.prototype._setValue_fromArray,Vt.prototype._setValue_fromArray_setNeedsUpdate,Vt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class _M{constructor(e,t,i=0,r=1/0){this.ray=new Ha(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new fb,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return vM(e,this,i,t),i.sort(X2),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)vM(e[r],this,i,t);return i.sort(X2),i}}function X2(n,e){return n.distance-e.distance}function vM(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)vM(r[s],e,t,!0)}}class q2{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(rn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}function $d(n){return $d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$d(n)}function rt(n,e,t){return(e=function Hte(n){var e=function zte(n,e){if("object"!==$d(n)||null===n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var i=t.call(n,e||"default");if("object"!==$d(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"===$d(e)?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"156"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="156");var rF=class{constructor(e,t){rt(this,"target",void 0),rt(this,"name",void 0),rt(this,"intersected",void 0),rt(this,"wasIntersected",!1),rt(this,"distance",void 0),this.target=e,this.name=t,this.intersected=!1,this.distance=0}},Oi=class{constructor(e,t=null){rt(this,"type",void 0),rt(this,"cancelBubble",void 0),rt(this,"originalEvent",void 0),rt(this,"coords",new J(0,0)),rt(this,"distance",0),rt(this,"intersected",!1),this.cancelBubble=!1,this.type=e,this.originalEvent=t}stopPropagation(){this.cancelBubble=!0}},Gte=class{constructor(e,t,i,r){rt(this,"renderer",void 0),rt(this,"camera",void 0),rt(this,"domElement",void 0),rt(this,"bindEventsOnBodyElement",void 0),rt(this,"autoAdd",void 0),rt(this,"scene",void 0),rt(this,"mouse",void 0),rt(this,"supportsPointerEvents",void 0),rt(this,"interactiveObjects",void 0),rt(this,"closestObject",void 0),rt(this,"raycaster",void 0),rt(this,"treatTouchEventsAsMouseEvents",void 0),rt(this,"dispose",()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentPointerMove):this.domElement.removeEventListener("pointermove",this.onDocumentPointerMove),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove):this.domElement.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd)}),rt(this,"add",(s,o=[])=>{if(s&&!this.interactiveObjects.find(a=>a.target===s))if(o.length>0)o.forEach(a=>{let c=s.getObjectByName(a);if(c){let l=new rF(c,a);this.interactiveObjects.push(l)}});else{let a=new rF(s,s.name);this.interactiveObjects.push(a)}}),rt(this,"remove",(s,o=[])=>{!s||(o.length>0?o.forEach(a=>{let c=s.getObjectByName(a);c&&(this.interactiveObjects=this.interactiveObjects.filter(l=>l.target!==c))}):this.interactiveObjects=this.interactiveObjects.filter(a=>a.target!==s))}),rt(this,"update",()=>{this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(c=>{c.target&&this.checkIntersection(c)}),this.interactiveObjects.sort(function(c,l){return c.distance-l.distance});let o,a,s=this.interactiveObjects.find(c=>c.intersected)??null;if(s!=this.closestObject){if(this.closestObject){let c=new Oi("mouseout");this.dispatch(this.closestObject,c)}if(s){let c=new Oi("mouseover");this.dispatch(s,c)}this.closestObject=s}this.interactiveObjects.forEach(c=>{!c.intersected&&c.wasIntersected&&(o||(o=new Oi("mouseleave")),this.dispatch(c,o))}),this.interactiveObjects.forEach(c=>{c.intersected&&!c.wasIntersected&&(a||(a=new Oi("mouseenter")),this.dispatch(c,a))})}),rt(this,"checkIntersection",s=>{let o=this.raycaster.intersectObjects([s.target],!0);if(s.wasIntersected=s.intersected,o.length>0){let a=o[0].distance;o.forEach(c=>{c.distance<a&&(a=c.distance)}),s.intersected=!0,s.distance=a}else s.intersected=!1}),rt(this,"onDocumentMouseMove",s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY);let o=new Oi("mousemove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),rt(this,"onDocumentPointerMove",s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY);let o=new Oi("pointermove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),rt(this,"onTouchMove",s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY);let o=new Oi(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),rt(this,"onMouseClick",s=>{this.update();let o=new Oi("click",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})}),rt(this,"onMouseDown",s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY),this.update();let o=new Oi("mousedown",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})}),rt(this,"onPointerDown",s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY),this.update();let o=new Oi("pointerdown",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})}),rt(this,"onTouchStart",s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY),this.update();let o=new Oi(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})}),rt(this,"onMouseUp",s=>{let o=new Oi("mouseup",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),rt(this,"onPointerUp",s=>{let o=new Oi("pointerup",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),rt(this,"onTouchEnd",s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY),this.update();let o=new Oi(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),rt(this,"dispatch",(s,o)=>{s.target&&!o.cancelBubble&&(o.coords=this.mouse,o.distance=s.distance,o.intersected=s.intersected,s.target.dispatchEvent(o))}),rt(this,"mapPositionToPoint",(s,o,a)=>{let c=this.renderer.domElement.getBoundingClientRect();s.x=(o-c.left)/c.width*2-1,s.y=-(a-c.top)/c.height*2+1}),this.renderer=e,this.camera=t,this.domElement=i,this.bindEventsOnBodyElement=!(r&&typeof r.bindEventsOnBodyElement<"u")||r.bindEventsOnBodyElement,this.scene=r&&typeof r.scene<"u"?r.scene:null,this.scene&&(this.scene.onBeforeRender=()=>{this.autoAdd&&null!==this.scene&&this.scene.traverse(s=>{this.add(s),s.addEventListener("removed",o=>{this.remove(o.target)})}),this.update()}),this.autoAdd=!!(r&&typeof r.autoAdd<"u")&&r.autoAdd,this.autoAdd&&null===this.scene&&console.error("Attention: Options.scene needs to be set when using options.autoAdd"),this.mouse=new J(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new _M,i.addEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?i.ownerDocument.addEventListener("pointermove",this.onDocumentPointerMove):i.addEventListener("pointermove",this.onDocumentPointerMove),i.addEventListener("pointerdown",this.onPointerDown),i.addEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?i.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):i.addEventListener("mousemove",this.onDocumentMouseMove),i.addEventListener("mousedown",this.onMouseDown),i.addEventListener("mouseup",this.onMouseUp),i.addEventListener("touchstart",this.onTouchStart,{passive:!0}),i.addEventListener("touchmove",this.onTouchMove,{passive:!0}),i.addEventListener("touchend",this.onTouchEnd,{passive:!0}),this.treatTouchEventsAsMouseEvents=!0}};let Xd=(()=>{var n;class e{constructor(){this.colliders={},this.ui={},this.pointer=new J,this.colliderOptions={name:"object",mesh:null,cb:i=>{console.log("Collided ",i)}},this.intersectedObjects=[],this.raycasterOptions={origin:new A(0,0,0),direction:null,near:0,far:10},this.raycaster=new _M,this.tempMatrix=new Ve}initInteractionManager(i,r,s){return this.interactionManager=new Gte(i,r,s),this.interactionManager.update.bind(this)}addToInteractions(i){this.interactionManager.add(i)}raycast(){return this.intersectedObjects.reduce((r,s)=>{const o=this.raycaster.intersectObject(s,!0);return o[0]&&(!r||o[0].distance<r.distance)?(o[0].object=s,o[0]):r},null)}intersectObjects(i){let r;return i.pointer&&null!==i.pointer.x&&null!==i.pointer.y?this.raycaster.setFromCamera(i.pointer,i.camera):(console.log("setting the ray from controller"),this.tempMatrix.identity().extractRotation(i.controller.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(i.controller.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(this.tempMatrix)),r=this.raycast(),r&&this.colliders[r.object.uuid]()}removeFromColliders(i){this.colliders=this.colliders.filter(r=>r.name!==i)}setRay(i){this.raycaster.setFromCamera(i.pointer,i.camera)}addToColliders(i){this.intersectedObjects.push(i.mesh),Object.assign({},this.colliderOptions,i),this.colliders[i.mesh.uuid]=i.cb}update(){this.interactionManager.update()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),sF=(()=>{var n;class e{constructor(){this.meshBasicMaterial=new wn,this.normalMaterial=new A2,this.meshLambert=new $g,this.standardMaterial=new Ka({roughness:.05,metalness:1}),this.materials={matte:new Xo({specular:4802889,shininess:1}),flat:new $g({}),colors:new Xo({color:16777215,specular:16777215,shininess:2,vertexColors:!0}),multiColors:new Xo({shininess:2,vertexColors:!0}),plastic:new Xo({specular:12698049,shininess:250})},this.params={color:16777215,transmission:1,opacity:1,metalness:0,roughness:0,ior:1.5,thickness:.01,attenuationDistance:1,specularIntensity:1,envMapIntensity:1}}getMaterial(i){return new bs(this.params)}getStandardMaterial(){return this.standardMaterial.clone()}getMeshPhysicalMaterial(i){}getMaterialByName(i){return this.materials[i]}getBasicMaterial(){return this.standardMaterial}getRandomColoredMaterial(){return new Ka({color:16777215*Math.random()})}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();class Ss{constructor(e,t,i,r,s="div"){this.parent=e,this.object=t,this.property=i,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement("div"),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),Ss.nextNameID=Ss.nextNameID||0,this.$name.id="lil-gui-name-"+ ++Ss.nextNameID,this.$widget=document.createElement(s),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",o=>o.stopPropagation()),this.domElement.addEventListener("keyup",o=>o.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class Wte extends Ss{constructor(e,t,i){super(e,t,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function xM(n){let e,t;return(e=n.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=n.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=n.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const jte={isPrimitive:!0,match:n=>"string"==typeof n,fromHexString:xM,toHexString:xM},qd={isPrimitive:!0,match:n=>"number"==typeof n,fromHexString:n=>parseInt(n.substring(1),16),toHexString:n=>"#"+n.toString(16).padStart(6,0)},$te=[jte,qd,{isPrimitive:!1,match:n=>Array.isArray(n),fromHexString(n,e,t=1){const i=qd.fromHexString(n);e[0]=(i>>16&255)/255*t,e[1]=(i>>8&255)/255*t,e[2]=(255&i)/255*t},toHexString:([n,e,t],i=1)=>qd.toHexString(n*(i=255/i)<<16^e*i<<8^t*i<<0)},{isPrimitive:!1,match:n=>Object(n)===n,fromHexString(n,e,t=1){const i=qd.fromHexString(n);e.r=(i>>16&255)/255*t,e.g=(i>>8&255)/255*t,e.b=(255&i)/255*t},toHexString:({r:n,g:e,b:t},i=1)=>qd.toHexString(n*(i=255/i)<<16^e*i<<8^t*i<<0)}];class qte extends Ss{constructor(e,t,i,r){super(e,t,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=function Xte(n){return $te.find(e=>e.match(n))}(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=xM(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class bM extends Ss{constructor(e,t,i){super(e,t,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class Yte extends Ss{constructor(e,t,i,r,s,o){super(e,t,i,"number"),this._initInput(),this.min(r),this.max(s);const a=void 0!==o;this.step(a?o:this._getImplicitStep(),a),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const i=v=>{const y=parseFloat(this.$input.value);isNaN(y)||(this._snapClampSetValue(y+v),this.$input.value=this.getValue())};let a,c,l,u,h,o=!1;const p=v=>{if(o){const y=v.clientX-a;Math.abs(v.clientY-c)>5?(v.preventDefault(),this.$input.blur(),o=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(y)>5&&g()}o||(h-=(v.clientY-l)*this._step*this._arrowKeyMultiplier(v),u+h>this._max?h=this._max-u:u+h<this._min&&(h=this._min-u),this._snapClampSetValue(u+h)),l=v.clientY},g=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",g)};this.$input.addEventListener("input",()=>{let v=parseFloat(this.$input.value);isNaN(v)||(this._stepExplicit&&(v=this._snap(v)),this.setValue(this._clamp(v)))}),this.$input.addEventListener("keydown",v=>{"Enter"===v.key&&this.$input.blur(),"ArrowUp"===v.code&&(v.preventDefault(),i(this._step*this._arrowKeyMultiplier(v))),"ArrowDown"===v.code&&(v.preventDefault(),i(this._step*this._arrowKeyMultiplier(v)*-1))}),this.$input.addEventListener("wheel",v=>{this._inputFocused&&(v.preventDefault(),i(this._step*this._normalizeMouseWheel(v)))},{passive:!1}),this.$input.addEventListener("mousedown",v=>{a=v.clientX,c=l=v.clientY,o=!0,u=this.getValue(),h=0,window.addEventListener("mousemove",p),window.addEventListener("mouseup",g)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=m=>{const v=this.$slider.getBoundingClientRect();let y=((m,v,y,w,x)=>(m-v)/(y-v)*(this._max-w)+w)(m,v.left,v.right,this._min);this._snapClampSetValue(y)},r=m=>{t(m.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)};let a,c,o=!1;const l=m=>{m.preventDefault(),this._setDraggingStyle(!0),t(m.touches[0].clientX),o=!1},h=m=>{if(o){const y=m.touches[0].clientY-c;Math.abs(m.touches[0].clientX-a)>Math.abs(y)?l(m):(window.removeEventListener("touchmove",h),window.removeEventListener("touchend",d))}else m.preventDefault(),t(m.touches[0].clientX)},d=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",d)},f=this._callOnFinishChange.bind(this);let g;this.$slider.addEventListener("mousedown",m=>{this._setDraggingStyle(!0),t(m.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)}),this.$slider.addEventListener("touchstart",m=>{m.touches.length>1||(this._hasScrollBar?(a=m.touches[0].clientX,c=m.touches[0].clientY,o=!0):l(m),window.addEventListener("touchmove",h,{passive:!1}),window.addEventListener("touchend",d))},{passive:!1}),this.$slider.addEventListener("wheel",m=>{if(Math.abs(m.deltaX)<Math.abs(m.deltaY)&&this._hasScrollBar)return;m.preventDefault();const y=this._normalizeMouseWheel(m)*this._step;this._snapClampSetValue(this.getValue()+y),this.$input.value=this.getValue(),clearTimeout(g),g=setTimeout(f,400)},{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:i}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,i=-e.wheelDelta/120,i*=this._stepExplicit?1:10),t+-i}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class Zte extends Ss{constructor(e,t,i,r){super(e,t,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this._values=Array.isArray(r)?r:Object.values(r),this._names=Array.isArray(r)?r:Object.keys(r),this._names.forEach(s=>{const o=document.createElement("option");o.innerHTML=s,this.$select.appendChild(o)}),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.updateDisplay()}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=-1===t?e:this._names[t],this}}class Kte extends Ss{constructor(e,t,i){super(e,t,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{"Enter"===r.code&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let oF=!1;class MM{constructor({parent:e,autoPlace:t=void 0===e,container:i,width:r,title:s="Controls",closeFolders:o=!1,injectStyles:a=!0,touchStyles:c=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",l=>{("Enter"===l.code||"Space"===l.code)&&(l.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),c&&this.domElement.classList.add("allow-touch-styles"),!oF&&a&&(function Qte(n){const e=document.createElement("style");e.innerHTML=n;const t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}('.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  background-color: var(--background-color);\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean .widget {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: " ";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: "lil-gui";\n  content: "\u2195";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background-color: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background-color: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background-color: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: "lil-gui";\n  content: "\u25be";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: "\u25b8";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: "Empty";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui input {\n  -webkit-tap-highlight-color: transparent;\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input::-webkit-outer-spin-button,\n.lil-gui input::-webkit-inner-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n.lil-gui input[type=number] {\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  -webkit-appearance: none;\n  height: var(--checkbox-size);\n  width: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: "lil-gui";\n  content: "\u2713";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: 1px solid var(--widget-color);\n  text-align: center;\n  line-height: calc(var(--widget-height) - 4px);\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n    border-color: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    border-color: var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: "lil-gui";\n  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");\n}'),oF=!0),i?i.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this._closeFolders=o}add(e,t,i,r,s){if(Object(i)===i)return new Zte(this,e,t,i);const o=e[t];switch(typeof o){case"number":return new Yte(this,e,t,i,r,s);case"boolean":return new Wte(this,e,t);case"string":return new Kte(this,e,t);case"function":return new bM(this,e,t)}console.error("gui.add failed\n\tproperty:",t,"\n\tobject:",e,"\n\tvalue:",o)}addColor(e,t,i=1){return new qte(this,e,t,i)}addFolder(e){const t=new MM({parent:this,title:e});return this.root._closeFolders&&t.close(),t}load(e,t=!0){return e.controllers&&this.controllers.forEach(i=>{i instanceof bM||i._name in e.controllers&&i.load(e.controllers[i._name])}),t&&e.folders&&this.folders.forEach(i=>{i._title in e.folders&&i.load(e.folders[i._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof bM)){if(i._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);t.controllers[i._name]=i.save()}}),e&&this.folders.forEach(i=>{if(i._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);t.folders[i._title]=i.save()}),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{this.$children.style.height=this.$children.clientHeight+"px",this.domElement.classList.add("transition");const i=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(i=>i.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),void 0!==this._onChange&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),void 0!==this._onOpenClose&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}const ene=MM;let Yd=(()=>{var n;class e{constructor(){this.positionOptions={min:-20,max:20},this.intensityOptions={min:0,max:10,precision:1}}addToDebug(i){this.gui||(this.gui=new ene({closeFolders:!0}),this.gui.open(!1));const r=this.gui.addFolder(`${i.name||i.obj.name}`);for(const[s,o]of Object.entries(i.properties))switch(s){case"Position":this.addPosition(i,r,o);break;case"Color":this.addColor(i,r,o);break;case"Intensity":this.addIntensity(i,r,o);break;case"Rotation":this.addRotation(i,r,o);break;case"Scale":this.addScale(i,r,o);break;case"LookAt":const a=r.addFolder("LookAt");this.addPosition(i,a,o);break;default:r.add(i.obj,s,i.min,i.max,i.precision)}}addScale(i,r,s){const o=r.addFolder("Scale"),a=Object.assign({},{min:0,max:100,precision:1},s);o.add(i.obj.scale,"x",a.min,a.max,a.precision),o.add(i.obj.scale,"y",a.min,a.max,a.precision),o.add(i.obj.scale,"z",a.min,a.max,a.precision)}addRotation(i,r,s){const o=r.addFolder("Rotation"),a=Object.assign({},{min:0,max:360,precision:1},s);o.add(i.obj.rotation,"x",a.min,a.max,a.precision),o.add(i.obj.rotation,"y",a.min,a.max,a.precision),o.add(i.obj.rotation,"z",a.min,a.max,a.precision)}addIntensity(i,r,s){const o=r.addFolder("Intensity"),a=Object.assign({},this.intensityOptions,s);o.add(i.obj,"intensity",a.min,a.max,a.precision)}addColor(i,r,s){const o=r.addFolder("Color");o.addColor(i.obj,"color").onChange(a=>{i.obj.color.set(a)}),o.open()}addPosition(i,r,s){const o=r.addFolder("Position"),a=Object.assign({},this.positionOptions,s);o.add(i.obj.position,"x",a.min,a.max,a.precision).onChange(c=>{i.obj.position.x=c}),o.add(i.obj.position,"y",a.min,a.max,a.precision).onChange(c=>{}),o.add(i.obj.position,"z",a.min,a.max,a.precision).onChange(c=>{}),o.open()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),aF=(()=>{var n;class e{constructor(i,r,s){this.interactions=i,this.materials=r,this.debug=s,this.boxGeometry=new vs(1,1,1),this.sphereGeometry=new Za(15,32,16),this.basicMaterial=new wn({color:16776960}),this.material=this.materials.getRandomColoredMaterial(),this.boxDefaultOptions={scale:1,position:{x:0,y:1.6,z:2},name:"box",material:this.material,cb:o=>{console.log("Collided with a box ",o)}},this.sphereDefaultOptions={name:"sphere",interactive:!0}}createReticle(){const i=new xt(new yu(.15,.2,32).rotateX(-Math.PI/2),new wn);return i.matrixAutoUpdate=!1,i.visible=!1,this.reticle=i,this.reticle}createIcosahedron(i){const r=Object.assign({radius:1.5,detail:0},i);this.materials.getRandomColoredMaterial(),r.material&&this.materials.getMaterial(r.material);const o=new xt(new Wg(r.radius,r.detail),this.materials.getRandomColoredMaterial());return o.scale.x=1.3,o}createGround(){const i=new cu(1e4,1e4),r=new $g({color:16777215});r.color.setHSL(.095,1,.75);const s=new xt(i,r);return s.position.y=-33,s.rotation.x=-Math.PI/2,s.receiveShadow=!0,s}createSkyDom(i){const r=document.getElementById("vertexShader").textContent,s=document.getElementById("fragmentShader").textContent,o={topColor:{value:new Y(30719)},bottomColor:{value:new Y(16777215)},offset:{value:33},exponent:{value:.6}};o.topColor.value.copy(i.color);const a=new Za(4e3,32,15),c=new ys({uniforms:o,vertexShader:r,fragmentShader:s,side:1});return new xt(a,c)}createBackground(i){}createSphere(i){const r=Object.assign({},this.sphereDefaultOptions,i),s=new xt(this.sphereGeometry,r.material||this.materials.getRandomColoredMaterial());return s.name=r.name,s}createHeart(){const o=(new $o).moveTo(25,25).bezierCurveTo(25,25,20,0,0,0).bezierCurveTo(-30,0,-30,35,-30,35).bezierCurveTo(-30,55,-10,77,25,95).bezierCurveTo(60,77,80,55,80,35).bezierCurveTo(80,35,80,0,50,0).bezierCurveTo(35,0,25,25,25,25);return this.addShape(o,{depth:8,bevelEnabled:!0,bevelSegments:2,steps:2,bevelSize:1,bevelThickness:1},15728640,60,100,0,0,0,Math.PI,.003)}createRoundedRect(i){const s=new $o;return s.moveTo(i.x,i.y+i.radius),s.lineTo(i.x,i.y+i.height-i.radius),s.quadraticCurveTo(i.x,i.y+i.height,i.x+i.radius,i.y+i.height),s.lineTo(i.x+i.width-i.radius,i.y+i.height),s.quadraticCurveTo(i.x+i.width,i.y+i.height,i.x+i.width,i.y+i.height-i.radius),s.lineTo(i.x+i.width,i.y+i.radius),s.quadraticCurveTo(i.x+i.width,i.y,i.x+i.width-i.radius,i.y),s.lineTo(i.x+i.radius,i.y),s.quadraticCurveTo(i.x,i.y,i.x,i.y+i.radius),this.addShape(s,{depth:1,bevelEnabled:!0,bevelSegments:3,steps:3,bevelSize:2,bevelThickness:.5},16777215,i.width/2,0,0,0,0,0,1)}addShape(i,r,s,o,a,c,l,u,h,d){let f=new Gg(i,r),p=new xt(f,new Xo({color:s}));return p.position.set(o,a,c),p.rotation.set(l,u,h),p.scale.set(d,d,d),p}createBox(i){const r=Object.assign({},this.boxDefaultOptions,i),s=new xt(this.boxGeometry,r.material||this.materials.getRandomColoredMaterial());return s.position.set(r.position.x,r.position.y,r.position.z),s.name=r.name,s}createNav(i){const r=new Wr,s=new vs(5,5,5),o=new Xo({color:11184674}),a=new y2(s),c=new Rg(a,new ri({color:0,linewidth:2}));for(let l=-100;l<100;l+=10)for(let u=-100;u<100;u+=10){if(0==l&&0==u)continue;const h=new xt(s,o);h.position.set(l,2.5,u);const d=c.clone();d.position.copy(h.position),r.add(h),r.add(d)}return r.name="nav",r}createBoxes(i){const r=i.number||1e3,s=i.position||40,o=[];for(let a=0;a<r;a++){const c=new xt(this.boxGeometry,this.materials.getRandomColoredMaterial());c.position.x=40*Math.random()-20,c.position.y=1.6*Math.random(),c.position.z=Math.random()*s-20,c.rotation.x=2*Math.random()*Math.PI,c.rotation.y=2*Math.random()*Math.PI,c.rotation.z=2*Math.random()*Math.PI,c.scale.x=Math.random()+.5,c.scale.y=Math.random()+.5,c.scale.z=Math.random()+.5,c.name="box"+a,o.push(c)}return o}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Xd),Se(sF),Se(Yd))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),cF=(()=>{var n;class e{constructor(){this.dirLight=new Yg(16631159,4),this.spotLight=new hM(16769694,15,10,Math.PI/4,.2,1.5)}createSpotLight(i){const r=this.spotLight.clone();return r.castShadow=!0,r.shadow.bias=-1e-4,r.shadow.mapSize.width=4096,r.shadow.mapSize.height=4096,r.shadow.camera.near=.1,r.shadow.camera.far=100,[r]}createHemLight(i){const r=new cM(16165226,10470393,.8);return r.color.setHSL(.6,1,.6),r.groundColor.setHSL(.095,1,.75),r.position.set(-.6,-2,-6),[r]}createPointLight(){const i=new fM(11789055,1.5,13,0);return i.castShadow=!0,i.shadow.bias=-.005,i}createDirLight(i){const s=new Yg(16777215,i?.intensity||2);return s.castShadow=!0,s.color.setHSL(.1,1,.95),s.color.convertLinearToSRGB(),s.position.set(-0,12,-15),s.castShadow=!0,s.shadow.mapSize.width=2048,s.shadow.mapSize.height=2048,s.shadow.camera.left=-50,s.shadow.camera.right=50,s.shadow.camera.top=50,s.shadow.camera.bottom=-50,s.shadow.camera.far=100,s.shadow.bias=-1e-4,s.target.position.set(0,0,-2),[s,s.target]}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const SM=new WeakMap;class tne extends ec{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new Qi(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,r)},i,r)}parse(e,t,i){this.decodeDracoFile(e,t,null,null,wt).catch(i)}decodeDracoFile(e,t,i,r,s=Rn){return this.decodeGeometry(e,{attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s}).then(t)}decodeGeometry(e,t){const i=JSON.stringify(t);if(SM.has(e)){const c=SM.get(e);if(c.key===i)return c.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=this._getWorker(s,e.byteLength).then(c=>(r=c,new Promise((l,u)=>{r._callbacks[s]={resolve:l,reject:u},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),SM.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new et;e.index&&t.setIndex(new jt(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,c=new jt(o,r.itemSize);"color"===s&&(this._assignVertexColorSpace(c,r.vertexColorSpace),c.normalized=!(o instanceof Float32Array)),t.setAttribute(s,c)}return t}_assignVertexColorSpace(e,t){if(t!==wt)return;const i=new Y;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new Qi(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=nne.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function nne(){let n,e;function r(o,a,c,l,u,h){const d=h.num_components(),p=c.num_points()*d,g=p*u.BYTES_PER_ELEMENT,_=function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}(o,u),m=o._malloc(g);a.GetAttributeDataArrayForAllPoints(c,h,_,g,m);const v=new u(o.HEAPF32.buffer,m,p).slice();return o._free(m),{name:l,array:v,itemSize:d}}onmessage=function(o){const a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(u){n.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(n)});break;case"decode":const c=a.buffer,l=a.taskConfig;e.then(u=>{const h=u.draco,d=new h.Decoder;try{const f=function t(o,a,c,l){const u=l.attributeIDs,h=l.attributeTypes;let d,f;const p=a.GetEncodedGeometryType(c);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeArrayToMesh(c,c.byteLength,d);else{if(p!==o.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");d=new o.PointCloud,f=a.DecodeArrayToPointCloud(c,c.byteLength,d)}if(!f.ok()||0===d.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const g={index:null,attributes:[]};for(const _ in u){const m=self[h[_]];let v,y;if(l.useUniqueIDs)y=u[_],v=a.GetAttributeByUniqueId(d,y);else{if(y=a.GetAttributeId(d,o[u[_]]),-1===y)continue;v=a.GetAttribute(d,y)}const w=r(o,a,d,_,m,v);"color"===_&&(w.vertexColorSpace=l.vertexColorSpace),g.attributes.push(w)}return p===o.TRIANGULAR_MESH&&(g.index=function i(o,a,c){const u=3*c.num_faces(),h=4*u,d=o._malloc(h);a.GetTrianglesUInt32Array(c,h,d);const f=new Uint32Array(o.HEAPF32.buffer,d,u).slice();return o._free(d),{array:f,itemSize:1}}(o,a,d)),o.destroy(d),g}(h,d,new Int8Array(c),l),p=f.attributes.map(g=>g.array.buffer);f.index&&p.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},p)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{h.destroy(d)}})}}}function lF(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let c=0;c<a.count;c++)o.push(c);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class uF extends ec{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new cne(t)}),this.register(function(t){return new gne(t)}),this.register(function(t){return new _ne(t)}),this.register(function(t){return new vne(t)}),this.register(function(t){return new une(t)}),this.register(function(t){return new hne(t)}),this.register(function(t){return new dne(t)}),this.register(function(t){return new fne(t)}),this.register(function(t){return new ane(t)}),this.register(function(t){return new pne(t)}),this.register(function(t){return new lne(t)}),this.register(function(t){return new mne(t)}),this.register(function(t){return new sne(t)}),this.register(function(t){return new yne(t)}),this.register(function(t){return new wne(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:jd.extractUrlBase(e),this.manager.itemStart(e);const a=function(l){r?r(l):console.error(l),s.manager.itemError(e),s.manager.itemEnd(e)},c=new Qi(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{s.parse(l,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},c=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===hF){try{o[vt.KHR_BINARY_GLTF]=new xne(e)}catch(h){return void(r&&r(h))}s=JSON.parse(o[vt.KHR_BINARY_GLTF].content)}else s=JSON.parse(c.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new Nne(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const h=this.pluginCallbacks[u](l);a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const h=s.extensionsUsed[u],d=s.extensionsRequired||[];switch(h){case vt.KHR_MATERIALS_UNLIT:o[h]=new one;break;case vt.KHR_DRACO_MESH_COMPRESSION:o[h]=new bne(s,this.dracoLoader);break;case vt.KHR_TEXTURE_TRANSFORM:o[h]=new Mne;break;case vt.KHR_MESH_QUANTIZATION:o[h]=new Sne;break;default:d.indexOf(h)>=0&&void 0===a[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function rne(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const vt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class sne{constructor(e){this.parser=e,this.name=vt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let l;const u=new Y(16777215);void 0!==c.color&&u.setRGB(c.color[0],c.color[1],c.color[2],Rn);const h=void 0!==c.range?c.range:0;switch(c.type){case"directional":l=new Yg(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new fM(u),l.distance=h;break;case"spot":l=new hM(u),l.distance=h,c.spot=c.spot||{},c.spot.innerConeAngle=void 0!==c.spot.innerConeAngle?c.spot.innerConeAngle:0,c.spot.outerConeAngle=void 0!==c.spot.outerConeAngle?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),l.decay=2,Zo(l,c),void 0!==c.intensity&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(l),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(c){return i._getNodeRef(t.cache,a,c)})}}class one{constructor(){this.name=vt.KHR_MATERIALS_UNLIT}getMaterialType(){return wn}extendParams(e,t,i){const r=[];e.color=new Y(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Rn),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,wt))}return Promise.all(r)}}class ane{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class cne{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?bs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new J(a,a)}return Promise.all(s)}}class lne{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?bs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class une{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?bs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Y(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Rn)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,wt)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class hne{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?bs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class dne{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?bs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=(new Y).setRGB(a[0],a[1],a[2],Rn),Promise.all(s)}}class fne{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?bs:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class pne{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?bs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=(new Y).setRGB(a[0],a[1],a[2],Rn),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,wt)),Promise.all(s)}}class mne{constructor(e){this.parser=e,this.name=vt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?bs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class gne{constructor(e){this.parser=e,this.name=vt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class _ne{constructor(e){this.parser=e,this.name=vt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=i.textureLoader;if(a.uri){const l=i.options.manager.getHandler(a.uri);null!==l&&(c=l)}return this.detectSupport().then(function(l){if(l)return i.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class vne{constructor(e){this.parser=e,this.name=vt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=i.textureLoader;if(a.uri){const l=i.options.manager.getHandler(a.uri);null!==l&&(c=l)}return this.detectSupport().then(function(l){if(l)return i.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class yne{constructor(e){this.name=vt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const u=r.count,h=r.byteStride,d=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,h,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(u*h);return o.decodeGltfBuffer(new Uint8Array(f),u,h,d,r.mode,r.filter),f})})}return null}}class wne{constructor(e){this.name=vt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const l of r.primitives)if(l.mode!==Er.TRIANGLES&&l.mode!==Er.TRIANGLE_STRIP&&l.mode!==Er.TRIANGLE_FAN&&void 0!==l.mode)return null;const o=i.extensions[this.name].attributes,a=[],c={};for(const l in o)a.push(this.parser.getDependency("accessor",o[l]).then(u=>(c[l]=u,c[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(l=>{const u=l.pop(),h=u.isGroup?u.children:[u],d=l[0].count,f=[];for(const p of h){const g=new Ve,_=new A,m=new Hn,v=new A(1,1,1),y=new r2(p.geometry,p.material,d);for(let w=0;w<d;w++)c.TRANSLATION&&_.fromBufferAttribute(c.TRANSLATION,w),c.ROTATION&&m.fromBufferAttribute(c.ROTATION,w),c.SCALE&&v.fromBufferAttribute(c.SCALE,w),y.setMatrixAt(w,g.compose(_,m,v));for(const w in c)"TRANSLATION"!==w&&"ROTATION"!==w&&"SCALE"!==w&&p.geometry.setAttribute(w,c[w]);sn.prototype.copy.call(y,p),this.parser.assignFinalMaterial(y),f.push(y)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}}const hF="glTF";class xne{constructor(e){this.name=vt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==hF)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const c=s.getUint32(o,!0);if(o+=4,1313821514===c){const l=new Uint8Array(e,12+o,a);this.content=i.decode(l)}else if(5130562===c){const l=12+o;this.body=e.slice(l,l+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class bne{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=vt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},c={},l={};for(const u in o){const h=AM[u]||u.toLowerCase();a[h]=o[u]}for(const u in e.attributes){const h=AM[u]||u.toLowerCase();if(void 0!==o[u]){const d=i.accessors[e.attributes[u]];l[h]=Eu[d.componentType].name,c[h]=!0===d.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(h){r.decodeDracoFile(u,function(d){for(const f in d.attributes){const g=c[f];void 0!==g&&(d.attributes[f].normalized=g)}h(d)},a,l)})})}}class Mne{constructor(){this.name=vt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Sne{constructor(){this.name=vt.KHR_MESH_QUANTIZATION}}class fF extends Hd{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=2*a,l=3*a,u=r-t,h=(i-t)/u,d=h*h,f=d*h,p=e*l,g=p-l,_=-2*f+3*d,m=f-d,v=1-_,y=m-d+h;for(let w=0;w!==a;w++)s[w]=v*o[g+w+a]+y*(o[g+w+c]*u)+_*o[p+w+a]+m*(o[p+w]*u);return s}}const Ene=new Hn;class Cne extends fF{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return Ene.fromArray(s).normalize().toArray(s),s}}const Er={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Eu={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},pF={9728:dn,9729:Xt,9984:1004,9985:1007,9986:1005,9987:Zs},mF={33071:ti,33648:1002,10497:Ra},TM={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},AM={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Yo={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Tne={CUBICSPLINE:void 0,LINEAR:Ul,STEP:yd};function Ane(n){return void 0===n.DefaultMaterial&&(n.DefaultMaterial=new Ka({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial}function oc(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Zo(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Ine(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Rne(n){let e;const t=n.extensions&&n.extensions[vt.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+IM(t.attributes):n.indices+":"+IM(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+IM(n.targets[i]);return e}function IM(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function RM(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Lne=new Ve;class Nne{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new rne,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new aM(this.options.manager):new Ste(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Qi(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};oc(s,a,r),Zo(a,r),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,c=o.length;a<c;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const c=this.associations.get(o);null!=c&&this.associations.set(a,c);for(const[l,u]of o.children.entries())s(u,a.children[l])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[vt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(jd.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=TM[r.type],c=!0===r.normalized,l=new(0,Eu[r.componentType])(r.count*o);return Promise.resolve(new jt(l,o,c))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],c=TM[r.type],l=Eu[r.componentType],u=l.BYTES_PER_ELEMENT,d=r.byteOffset||0,f=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let g,_;if(f&&f!==u*c){const m=Math.floor(d/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count;let y=t.cache.get(v);y||(g=new l(a,m*f,r.count*f/u),y=new Rb(g,f/u),t.cache.add(v,y)),_=new Xa(y,c,d%f/u,p)}else g=null===a?new l(r.count*c):new l(a,d,r.count*c),_=new jt(g,c,p);if(void 0!==r.sparse){const w=r.sparse.values.byteOffset||0,x=new(0,Eu[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*TM.SCALAR),S=new l(o[2],w,r.sparse.count*c);null!==a&&(_=new jt(_.array.slice(),_.itemSize,_.normalized));for(let M=0,E=x.length;M<E;M++){const b=x[M];if(_.setX(b,S[M*c]),c>=2&&_.setY(b,S[M*c+1]),c>=3&&_.setZ(b,S[M*c+2]),c>=4&&_.setW(b,S[M*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return _})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const c=this.options.manager.getHandler(o.uri);null!==c&&(a=c)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],c=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];const l=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",""===u.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(u.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=pF[d.magFilter]||Xt,u.minFilter=pF[d.minFilter]||Zs,u.wrapS=mF[d.wrapS]||Ra,u.wrapT=mF[d.wrapT]||Ra,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[c]=l,l}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let c=o.uri||"",l=!1;if(void 0!==o.bufferView)c=this.getDependency("bufferView",o.bufferView).then(function(h){l=!0;const d=new Blob([h],{type:o.mimeType});return c=a.createObjectURL(d),c});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(c).then(function(h){return new Promise(function(d,f){let p=d;!0===t.isImageBitmapLoader&&(p=function(g){const _=new br(g);_.needsUpdate=!0,d(_)}),t.load(jd.resolveURL(h,s.path),p,void 0,f)})}).then(function(h){return!0===l&&a.revokeObjectURL(c),h.userData.mimeType=o.mimeType||function Pne(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),h});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[vt.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[vt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=s.associations.get(o);o=s.extensions[vt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,c)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new kb,Li.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(a,c)),i=c}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new ri,Li.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,this.cache.add(a,c)),i=c}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=i.clone(),s&&(c.vertexColors=!0),o&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(i))),i=c}e.material=i}getMaterialType(){return Ka}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=[];if((s.extensions||{})[vt.KHR_MATERIALS_UNLIT]){const h=r[vt.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),l.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new Y(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],Rn),a.opacity=d[3]}void 0!==h.baseColorTexture&&l.push(t.assignTexture(a,"map",h.baseColorTexture,wt)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(l.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==wn&&(l.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new J(1,1),void 0!==s.normalTexture.scale)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}if(void 0!==s.occlusionTexture&&o!==wn&&(l.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==wn){const h=s.emissiveFactor;a.emissive=(new Y).setRGB(h[0],h[1],h[2],Rn)}return void 0!==s.emissiveTexture&&o!==wn&&l.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,wt)),Promise.all(l).then(function(){const h=new o(a);return s.name&&(h.name=s.name),Zo(h,s),t.associations.set(h,{materials:e}),s.extensions&&oc(r,h,s),h})}createUniqueName(e){const t=Vt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[vt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return gF(c,a,t)})}const o=[];for(let a=0,c=e.length;a<c;a++){const l=e[a],u=Rne(l),h=r[u];if(h)o.push(h.promise);else{let d;d=l.extensions&&l.extensions[vt.KHR_DRACO_MESH_COMPRESSION]?s(l):gF(new et,l,t),r[u]={primitive:l,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let c=0,l=o.length;c<l;c++){const u=void 0===o[c].material?Ane(this.cache):this.getDependency("material",o[c].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(c){const l=c.slice(0,c.length-1),u=c[c.length-1],h=[];for(let f=0,p=u.length;f<p;f++){const g=u[f],_=o[f];let m;const v=l[f];if(_.mode===Er.TRIANGLES||_.mode===Er.TRIANGLE_STRIP||_.mode===Er.TRIANGLE_FAN||void 0===_.mode)m=!0===s.isSkinnedMesh?new e2(g,v):new xt(g,v),!0===m.isSkinnedMesh&&m.normalizeSkinWeights(),_.mode===Er.TRIANGLE_STRIP?m.geometry=lF(m.geometry,1):_.mode===Er.TRIANGLE_FAN&&(m.geometry=lF(m.geometry,2));else if(_.mode===Er.LINES)m=new Rg(g,v);else if(_.mode===Er.LINE_STRIP)m=new ao(g,v);else if(_.mode===Er.LINE_LOOP)m=new u2(g,v);else{if(_.mode!==Er.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_.mode);m=new d2(g,v)}Object.keys(m.geometry.morphAttributes).length>0&&Ine(m,s),m.name=t.createUniqueName(s.name||"mesh_"+e),Zo(m,s),_.extensions&&oc(r,m,_),t.assignFinalMaterial(m),h.push(m)}for(let f=0,p=h.length;f<p;f++)t.associations.set(h[f],{meshes:e,primitives:f});if(1===h.length)return s.extensions&&oc(r,h[0],s),h[0];const d=new Wr;s.extensions&&oc(r,d,s),t.associations.set(d,{meshes:e});for(let f=0,p=h.length;f<p;f++)d.add(h[f]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new Un(Hl_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new yg(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Zo(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],c=[];for(let l=0,u=o.length;l<u;l++){const h=o[l];if(h){a.push(h);const d=new Ve;null!==s&&d.fromArray(s.array,16*l),c.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new Ag(a,c)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],c=[],l=[],u=[];for(let h=0,d=r.channels.length;h<d;h++){const f=r.channels[h],p=r.samplers[f.sampler],g=f.target,m=void 0!==r.parameters?r.parameters[p.input]:p.input,v=void 0!==r.parameters?r.parameters[p.output]:p.output;void 0!==g.node&&(o.push(this.getDependency("node",g.node)),a.push(this.getDependency("accessor",m)),c.push(this.getDependency("accessor",v)),l.push(p),u.push(g))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c),Promise.all(l),Promise.all(u)]).then(function(h){const d=h[0],f=h[1],p=h[2],g=h[3],_=h[4],m=[];for(let v=0,y=d.length;v<y;v++){const w=d[v],x=f[v],S=p[v],M=g[v],E=_[v];if(void 0===w)continue;w.updateMatrix&&w.updateMatrix();const b=i._createAnimationTracks(w,x,S,M,E);if(b)for(let C=0;C<b.length;C++)m.push(b[C])}return new Gd(s,void 0,m)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let c=0,l=r.weights.length;c<l;c++)a.morphTargetInfluences[c]=r.weights[c]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let l=0,u=a.length;l<u;l++)o.push(i.getDependency("node",a[l]));const c=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),c]).then(function(l){const u=l[0],h=l[1],d=l[2];null!==d&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(d,Lne)});for(let f=0,p=h.length;f<p;f++)u.add(h[f]);return u})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],c=r._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return c&&a.push(c),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(l){return r._getNodeRef(r.cameraCache,s.camera,l)})),r._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),this.nodeCache[e]=Promise.all(a).then(function(l){let u;if(u=!0===s.isBone?new Ob:l.length>1?new Wr:1===l.length?l[0]:new sn,u!==l[0])for(let h=0,d=l.length;h<d;h++)u.add(l[h]);if(s.name&&(u.userData.name=s.name,u.name=o),Zo(u,s),s.extensions&&oc(i,u,s),void 0!==s.matrix){const h=new Ve;h.fromArray(s.matrix),u.applyMatrix4(h)}else void 0!==s.translation&&u.position.fromArray(s.translation),void 0!==s.rotation&&u.quaternion.fromArray(s.rotation),void 0!==s.scale&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Wr;i.name&&(s.name=r.createUniqueName(i.name)),Zo(s,i),i.extensions&&oc(t,s,i);const o=i.nodes||[],a=[];for(let c=0,l=o.length;c<l;c++)a.push(r.getDependency("node",o[c]));return Promise.all(a).then(function(c){for(let u=0,h=c.length;u<h;u++)s.add(c[u]);return r.associations=(u=>{const h=new Map;for(const[d,f]of r.associations)(d instanceof Li||d instanceof br)&&h.set(d,f);return u.traverse(d=>{const f=r.associations.get(d);null!=f&&h.set(d,f)}),h})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,c=[];let l;switch(Yo[s.path]===Yo.weights?e.traverse(function(d){d.morphTargetInfluences&&c.push(d.name?d.name:d.uuid)}):c.push(a),Yo[s.path]){case Yo.weights:l=xu;break;case Yo.rotation:l=Qa;break;case Yo.position:case Yo.scale:l=Mu;break;default:l=1===i.itemSize?xu:Mu}const u=void 0!==r.interpolation?Tne[r.interpolation]:Ul,h=this._getArrayFromAccessor(i);for(let d=0,f=c.length;d<f;d++){const p=new l(c[d]+"."+Yo[s.path],t.array,h,u);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=RM(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof Qa?Cne:fF)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function gF(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(c){n.setAttribute(a,c)})}for(const o in i){const a=AM[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Yi.workingColorSpace!==Rn&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Yi.workingColorSpace}" not supported.`),Zo(n,e),function One(n,e,t){const i=e.attributes,r=new _s;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],c=a.min,l=a.max;if(void 0===c||void 0===l)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new A(c[0],c[1],c[2]),new A(l[0],l[1],l[2])),a.normalized){const u=RM(Eu[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new A,c=new A;for(let l=0,u=s.length;l<u;l++){const h=s[l];if(void 0!==h.POSITION){const d=t.json.accessors[h.POSITION],f=d.min,p=d.max;if(void 0!==f&&void 0!==p){if(c.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),c.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),c.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const g=RM(Eu[d.componentType]);c.multiplyScalar(g)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new Vr;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function Dne(n,e,t){let i=!1,r=!1,s=!1;for(let l=0,u=e.length;l<u;l++){const h=e[l];if(void 0!==h.POSITION&&(i=!0),void 0!==h.NORMAL&&(r=!0),void 0!==h.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],c=[];for(let l=0,u=e.length;l<u;l++){const h=e[l];if(i){const d=void 0!==h.POSITION?t.getDependency("accessor",h.POSITION):n.attributes.position;o.push(d)}if(r){const d=void 0!==h.NORMAL?t.getDependency("accessor",h.NORMAL):n.attributes.normal;a.push(d)}if(s){const d=void 0!==h.COLOR_0?t.getDependency("accessor",h.COLOR_0):n.attributes.color;c.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(l){const h=l[1],d=l[2];return i&&(n.morphAttributes.position=l[0]),r&&(n.morphAttributes.normal=h),s&&(n.morphAttributes.color=d),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}let _F=(()=>{var n;class e{constructor(i){this.debugService=i,this.gltfLoader=new uF,this.bufferLoader=new F2,this.textureLoader=new aM,this.dracoLoader=new tne,this.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),this.dracoLoader.setDecoderConfig({type:"js"}),this.gltfLoader.setDRACOLoader(this.dracoLoader)}loadBufferGeometry(i,r,s){this.bufferLoader.load(r,function(o){const a=new wn({color:16119285}),c=new xt(o,a);return c.name="json model",i.add(c),c},function(o){console.log(o.loaded/o.total*100+"% loaded")},function(o){console.log("An error happened",o)})}loadModel(i){new wn;const s=new J(15,15);this.gltfLoader.load(i.path,o=>{const a=o.scene;a.position.z=-0,a.scale.set(3,3,3),a.traverse(h=>{h.isMesh&&(h.castShadow=!0,h.receiveShadow=!0,h.castShadow=!0,h.receiveShadow=!0,h.material.map&&(h.material.map.anisotropy=16)),h.isLight&&(h.visible=visible)});const l=a.children[0].material;l.map.repeat=s,l.normalMap.repeat=s,a.children[1].castShadow=!0,i.scene.add(a)})}createScene(i,r,s){const o=new xt(i,s);return o.position.y=-.5,o.scale.set(r,r,r),o.castShadow=!0,o.receiveShadow=!0,o}loadTexture(i){return this.textureLoader.load(i)}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Yd))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var Gn={d:(n,e)=>{for(var t in e)Gn.o(e,t)&&!Gn.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o:(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r:n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},er={};Gn.d(er,{g1:()=>r_,gO:()=>tf,km:()=>i_,zV:()=>Qd,ol:()=>KM,uM:()=>s_,N1:()=>WF,xv:()=>ZM,PH:()=>a_,UH:()=>o_,ZP:()=>lie,Vx:()=>jF});var i_={};Gn.r(i_),Gn.d(i_,{COLUMN:()=>c_,COLUMN_REVERSE:()=>yF,ROW:()=>Kd,ROW_REVERSE:()=>vF,contentDirection:()=>wF});var r_={};Gn.r(r_),Gn.d(r_,{CENTER:()=>LM,END:()=>NM,START:()=>PM,STRETCH:()=>xF,alignItems:()=>bF,warnAboutDeprecatedAlignItems:()=>MF});var s_={};Gn.r(s_),Gn.d(s_,{CENTER:()=>FM,END:()=>kM,SPACE_AROUND:()=>UM,SPACE_BETWEEN:()=>BM,SPACE_EVENLY:()=>VM,START:()=>OM,justifyContent:()=>SF});var o_={};Gn.r(o_),Gn.d(o_,{NORMAL:()=>Jd,NOWRAP:()=>Cu,PRE:()=>l_,PRE_LINE:()=>Tu,PRE_WRAP:()=>u_,WHITE_CHARS:()=>HM,collapseWhitespaceOnInlines:()=>AF,collapseWhitespaceOnString:()=>EF,newlineBreakability:()=>CF,shouldBreak:()=>TF});var a_={};Gn.r(a_),Gn.d(a_,{CENTER:()=>GM,JUSTIFY:()=>WM,JUSTIFY_CENTER:()=>OF,JUSTIFY_LEFT:()=>NF,JUSTIFY_RIGHT:()=>h_,LEFT:()=>PF,RIGHT:()=>LF,textAlign:()=>FF});const pt=(n=>{var e={};return Gn.d(e,n),e})({BufferAttribute:()=>jt,BufferGeometry:()=>et,CanvasTexture:()=>xee,Color:()=>Y,FileLoader:()=>Qi,LinearFilter:()=>Xt,Mesh:()=>xt,Object3D:()=>sn,Plane:()=>oo,PlaneGeometry:()=>cu,ShaderMaterial:()=>ys,TextureLoader:()=>aM,Vector2:()=>J,Vector3:()=>A}),Kd="row",vF="row-reverse",c_="column",yF="column-reverse";function wF(n,e,t,i){let r=t,s="getWidth",o="x",a="y";0===e.indexOf(c_)&&(s="getHeight",o="y",a="x");for(let c=0;c<n.childrenBoxes.length;c++){const l=n.childrenBoxes[c],u=l.id,h=l[s](),d=l.margin||0;r+=d*i,n.childrenPos[u]={[o]:r+h/2*i,[a]:0},r+=i*(h+d)}}const PM="start",LM="center",NM="end",xF="stretch";function bF(n,e){const t=n.getAlignItems();-1===kne.indexOf(t)&&console.warn(`alignItems === '${t}' is not supported`);let i="getWidth",r="x";0===e.indexOf(Kd)&&(i="getHeight",r="y");const s=n[i]()/2-(n.padding||0);n.childrenBoxes.forEach(o=>{let a;switch(t){case NM:case"right":case"bottom":a=0===e.indexOf(Kd)?-s+o[i]()/2+(o.margin||0):s-o[i]()/2-(o.margin||0);break;case PM:case"left":case"top":a=0===e.indexOf(Kd)?s-o[i]()/2-(o.margin||0):-s+o[i]()/2+(o.margin||0)}n.childrenPos[o.id][r]=a||0})}function MF(n){-1!==Une.indexOf(n)&&console.warn(`alignItems === '${n}' is deprecated and will be remove in 7.x.x. Fallback are 'start'|'end'`)}const kne=[PM,LM,NM,xF,"top","right","bottom","left"],Une=["top","right","bottom","left"],OM="start",FM="center",kM="end",UM="space-around",BM="space-between",VM="space-evenly";function SF(n,e,t,i){const r=n.getJustifyContent();-1===Bne.indexOf(r)&&console.warn(`justifyContent === '${r}' is not supported`);const s=0===e.indexOf("row")?"width":"height",o=n.getChildrenSideSum(s),c=("width"===s?n.getInnerWidth():n.getInnerHeight())-o,u=function Vne(n,e){switch(n){case kM:return e;case FM:return e/2}return 0}(r,2*t-o*Math.sign(t)),h=function zne(n,e,t,i){const r=Array(n.length).fill(0);if(e>0)switch(t){case BM:if(n.length>1){const s=e/(n.length-1)*i;r[0]=0;for(let o=1;o<n.length;o++)r[o]=s*o}break;case VM:if(n.length>1){const s=e/(n.length+1)*i;for(let o=0;o<n.length;o++)r[o]=s*(o+1)}break;case UM:if(n.length>1){const s=e/n.length*i,o=s/2;r[0]=o;for(let a=1;a<n.length;a++)r[a]=o+s*a}}return r}(n.childrenBoxes,c,r,i),d=0===e.indexOf("row")?"x":"y";n.childrenBoxes.forEach((f,p)=>{n.childrenPos[f.id][d]-=u-h[p]})}const Bne=[OM,FM,kM,UM,BM,VM];function zM(n){return class extends n{constructor(t){super(t),this.isBoxComponent=!0,this.childrenPos={}}getInnerWidth(){const t=this.getContentDirection();switch(t){case"row":case"row-reverse":return this.width-(2*this.padding||0)||this.getChildrenSideSum("width");case"column":case"column-reverse":return this.getHighestChildSizeOn("width");default:console.error(`Invalid contentDirection : ${t}`)}}getInnerHeight(){const t=this.getContentDirection();switch(t){case"row":case"row-reverse":return this.getHighestChildSizeOn("height");case"column":case"column-reverse":return this.height-(2*this.padding||0)||this.getChildrenSideSum("height");default:console.error(`Invalid contentDirection : ${t}`)}}getChildrenSideSum(t){return this.childrenBoxes.reduce((i,r)=>{const s=2*r.margin||0;return i+("width"===t?r.getWidth()+s:r.getHeight()+s)},0)}setPosFromParentRecords(){this.parentUI&&this.parentUI.childrenPos[this.id]&&(this.position.x=this.parentUI.childrenPos[this.id].x,this.position.y=this.parentUI.childrenPos[this.id].y)}computeChildrenPosition(){if(this.children.length>0){const t=this.getContentDirection();let i;switch(t){case Kd:i=-this.getInnerWidth()/2;break;case vF:i=this.getInnerWidth()/2;break;case c_:i=this.getInnerHeight()/2;break;case yF:i=-this.getInnerHeight()/2}const r=-Math.sign(i);wF(this,t,i,r),SF(this,t,i,r),bF(this,t)}}getHighestChildSizeOn(t){return this.childrenBoxes.reduce((i,r)=>{const s=r.margin||0,o="width"===t?r.getWidth()+2*s:r.getHeight()+2*s;return Math.max(i,o)},0)}getWidth(){return this.parentUI&&"stretch"===this.parentUI.getAlignItems()&&-1!==this.parentUI.getContentDirection().indexOf("column")?this.parentUI.getWidth()-(2*this.parentUI.padding||0):this.width||this.getInnerWidth()+(2*this.padding||0)}getHeight(){return this.parentUI&&"stretch"===this.parentUI.getAlignItems()&&-1!==this.parentUI.getContentDirection().indexOf("row")?this.parentUI.getHeight()-(2*this.parentUI.padding||0):this.height||this.getInnerHeight()+(2*this.padding||0)}}}const HM={"\t":"\t","\n":"\n","\r":"\r"," ":" "},Jd="normal",Cu="nowrap",l_="pre",Tu="pre-line",u_="pre-wrap",EF=function(n,e){switch(e){case Cu:case Jd:n=n.replace(/\n/g," ");case Tu:n=n.replace(/[ ]{2,}/g," ")}return n},CF=function(n){switch(n){case l_:case u_:case Tu:return"mandatory"}},TF=function(n,e,t,i){const r=n[e];switch(i.WHITESPACE){case Jd:case Tu:case u_:if("mandatory"===r.lineBreak)return!0;if(t+(r.xadvance?r.xadvance:r.width)+(r.xoffset?r.xoffset:0)+(r.kerning?r.kerning:0)>i.INNER_WIDTH)return!0;const c=RF(n,e,i);return function Hne(n,e,t,i){return!(!n||!n.glyph||e+t<i.INNER_WIDTH)&&i.BREAKON.indexOf(n.glyph)>-1}(n[e-1],t,c,i);case l_:return"mandatory"===r.lineBreak;default:return!1}},AF=function(n,e){const t=n[0],i=n[n.length-1];switch(e){case u_:t.glyph&&"\n"===t.glyph&&n.length>1&&IF([t],n[1]),i.glyph&&"\n"===i.glyph&&n.length>1&&DF([i],n[n.length-2]);break;case Tu:case Cu:case Jd:let s,r=[];for(let o=0;o<n.length;o++){const a=n[o];if(!(a.glyph&&HM[a.glyph]&&n.length>o))break;r.push(a),s=n[o+1]}IF(r,s),r=[],s=null;for(let o=n.length-1;o>0;o--){const a=n[o];if(!(a.glyph&&HM[a.glyph]&&o>0))break;r.push(a),s=n[o-1]}DF(r,s);break;case l_:break;default:return console.warn(`whiteSpace: '${e}' is not valid`),0}return t.offsetX};function DF(n,e){if(e)for(let t=0;t<n.length;t++){const i=n[t];i.width=0,i.height=0,i.offsetX=e.offsetX+e.width}}function IF(n,e){if(e)for(let t=0;t<n.length;t++){const i=n[t];i.width=0,i.height=0,i.offsetX=e.offsetX}}function RF(n,e,t,i){if(i=i||0,!n[e])return i;const r=n[e],a=r.xadvance?r.xadvance:r.width;return r.lineBreak?i+a:RF(n,e+1,t,i+a+t.LETTERSPACING+(r.xoffset?r.xoffset:0)+(r.kerning?r.kerning:0))}const PF="left",LF="right",GM="center",WM="justify",NF="justify-left",h_="justify-right",OF="justify-center";function FF(n,e,t){for(let i=0;i<n.length;i++){const r=n[i],s=Gne(r,e,t,i===n.length-1);for(let o=0;o<r.length;o++)r[o].offsetX+=s;r.x=s}if(0===e.indexOf(WM))for(let i=0;i<n.length;i++){const r=n[i];if(-1!==e.indexOf("-")&&i===n.length-1)return;const s=t-r.width;if(s<=0)return;let o=0;for(let u=1;u<r.length-1;u++)o+=" "===r[u].glyph?1:0;const a=s/o;let c=1;e===h_&&(r.reverse(),c=-1);let l=0;for(let u=1;u<=r.length-1;u++){const h=r[u];h.offsetX+=l*c,l+=" "===h.glyph?a:0}e===h_&&r.reverse()}}const Gne=(n,e,t,i)=>{switch(e){case NF:case WM:case PF:return-t/2;case h_:case LF:return t/2-n.width;case GM:return-n.width/2;case OF:return i?-n.width/2:-t/2;default:console.warn(`textAlign: '${e}' is not valid`)}};function kF(n){return class extends n{computeInlinesPosition(){const t=this.getWidth()-(2*this.padding||0),i=this.getHeight()-(2*this.padding||0),r=this.getJustifyContent(),s=this.getTextAlign(),o=this.getInterLine(),a=this.computeLines();a.interLine=o;const c=Math.abs(a.height),l=(()=>{switch(r){case"start":return i/2;case"end":return c-i/2;case"center":return c/2;default:console.warn(`justifyContent: '${r}' is not valid`)}})();a.forEach(u=>{u.y+=l,u.forEach(h=>{h.offsetY+=l})}),FF(a,s,t),this.lines=a}calculateBestFit(t){if(0!==this.childrenInlines.length)switch(t){case"grow":this.calculateGrowFit();break;case"shrink":this.calculateShrinkFit();break;case"auto":this.calculateAutoFit()}}calculateGrowFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(u=>u.isText);let l,o=1,a=2,c=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(l=this.calculateHeight(c),l>t){if(c<=o){this.childrenInlines.forEach(u=>{u.isInlineBlock||(u._fitFontSize=u.getFontSize())});break}a=c,c-=(a-o)/2}else{if(Math.abs(t-l)<.075)break;Math.abs(c-a)<5e-10&&(a*=2),o=c,c+=(a-o)/2}}while(++i<=10)}calculateShrinkFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(u=>u.isText);let l,o=0,a=1,c=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(l=this.calculateHeight(c),l>t)a=c,c-=(a-o)/2;else{if(c>=a){this.childrenInlines.forEach(u=>{u.isInlineBlock||(u._fitFontSize=u.getFontSize())});break}if(Math.abs(t-l)<.075)break;o=c,c+=(a-o)/2}}while(++i<=10)}calculateAutoFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(u=>u.isText);let l,o=0,a=2,c=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(l=this.calculateHeight(c),l>t)a=c,c-=(a-o)/2;else{if(Math.abs(t-l)<.075)break;Math.abs(c-a)<5e-10&&(a*=2),o=c,c+=(a-o)/2}}while(++i<=10)}computeLines(){const t=this.getWidth()-(2*this.padding||0),i=[[]];i.height=0;const r=this.getInterLine();this.childrenInlines.reduce((c,l)=>{if(!l.inlines)return;const u=l._fitFontSize||l.getFontSize(),h=l.isText?l.getLetterSpacing()*u:0,d=l.getWhiteSpace(),f=l.getBreakOn(),p={WHITESPACE:d,LETTERSPACING:h,BREAKON:f,INNER_WIDTH:t};return l.inlines.reduce((_,m,v,y)=>{const w=m.kerning?m.kerning:0,x=m.xoffset?m.xoffset:0,S=m.xadvance?m.xadvance:m.width;return TF(y,v,_,p)?(i.push([m]),m.offsetX=x,0===m.width?0:S+h):(i[i.length-1].push(m),m.offsetX=_+x+w,_+S+w+h)},c)},0);let s=0,o=0,a=-r/2;return i.forEach(c=>{if(c.lineHeight=c.reduce((u,h)=>Math.max(u,void 0!==h.lineHeight?h.lineHeight:h.height),0),c.lineBase=c.reduce((u,h)=>Math.max(u,void 0!==h.lineBase?h.lineBase:h.height),0),c.width=0,c.height=c.lineHeight,c[0]){const u=this.getWhiteSpace(),h=AF(c,u);c.forEach(d=>{d.offsetX-=h}),c.width=this.computeLineWidth(c),c.width>s&&(s=c.width),c.forEach(d=>{d.offsetY=a-d.height-d.anchor,d.lineHeight<c.lineHeight&&(d.offsetY-=c.lineBase-d.lineBase)}),c.y=a,o+=c.lineHeight+r,a-=c.lineHeight+r}}),i.height=o,i.width=s,i}calculateHeight(t){this.childrenInlines.forEach(r=>{r.isInlineBlock||(r._fitFontSize=r.getFontSize()*t,r.calculateInlines(r._fitFontSize))});const i=this.computeLines();return Math.abs(i.height)}computeLineWidth(t){const r=t[t.length-1];return r.offsetX+r.width+t[0].offsetX}}}const Wne=new pt.FileLoader,jM=[],d_={},jne=new pt.TextureLoader,$M=[],f_={},si={};function XM(n){if(n._kernings)return;const e={};for(let t=0;t<n.kernings.length;t++){const i=n.kernings[t];0!==i.amount&&(e[String.fromCharCode(i.first,i.second)]=i.amount)}n._kernings=e}const Qd={setFontFamily:function $ne(n,e){"string"==typeof e?function qne(n,e){-1===jM.indexOf(e)&&(jM.push(e),Wne.load(e,t=>{const i=JSON.parse(t);XM(i),d_[e]=i;for(const r of Object.keys(si))e===si[r].jsonURL&&si[r].component._updateFontFamily(i)})),si[n.id]||(si[n.id]={component:n}),si[n.id].jsonURL=e,d_[e]&&n._updateFontFamily(d_[e])}(n,e):(si[n.id]||(si[n.id]={component:n}),XM(e),si[n.id].json=e,n._updateFontFamily(e))},setFontTexture:function Xne(n,e){-1===$M.indexOf(e)&&($M.push(e),jne.load(e,t=>{t.generateMipmaps=!1,t.minFilter=pt.LinearFilter,t.magFilter=pt.LinearFilter,f_[e]=t;for(const i of Object.keys(si))e===si[i].textureURL&&si[i].component._updateFontTexture(t)})),si[n.id]||(si[n.id]={component:n}),si[n.id].textureURL=e,f_[e]&&n._updateFontTexture(f_[e])},getFontOf:function UF(n){const e=si[n.id];return!e&&n.parentUI?UF(n.parentUI):e},addFont:function Yne(n,e,t){t.generateMipmaps=!1,t.minFilter=pt.LinearFilter,t.magFilter=pt.LinearFilter,jM.push(n),d_[n]=e,XM(e),t&&($M.push(n),f_[n]=t)}};let ef=(()=>{class n{static requestUpdate(t,i,r,s){t.traverse(o=>{o.isUI&&(this.requestedUpdates[o.id]?(i&&(this.requestedUpdates[o.id].updateParsing=!0),r&&(this.requestedUpdates[o.id].updateLayout=!0),s&&(this.requestedUpdates[o.id].updateInner=!0)):this.requestedUpdates[o.id]={updateParsing:i,updateLayout:r,updateInner:s,needCallback:i||r||s})})}static register(t){this.components.includes(t)||this.components.push(t)}static disposeOf(t){const i=this.components.indexOf(t);i>-1&&this.components.splice(i,1)}static update(){if(Object.keys(this.requestedUpdates).length>0){const t=this.components.filter(i=>!i.parentUI);t.forEach(i=>this.traverseParsing(i)),t.forEach(i=>this.traverseUpdates(i))}}static traverseParsing(t){const i=this.requestedUpdates[t.id];i&&i.updateParsing&&(t.parseParams(),i.updateParsing=!1),t.childrenUIs.forEach(r=>this.traverseParsing(r))}static traverseUpdates(t){const i=this.requestedUpdates[t.id];delete this.requestedUpdates[t.id],i&&i.updateLayout&&(i.updateLayout=!1,t.updateLayout()),i&&i.updateInner&&(i.updateInner=!1,t.updateInner()),t.childrenUIs.forEach(r=>{this.traverseUpdates(r)}),i&&i.needCallback&&t.onAfterUpdate()}}return n.components=[],n.requestedUpdates={},n})();const Wn={container:null,fontFamily:null,fontSize:.05,fontKerning:"normal",bestFit:"none",offset:.01,interLine:.01,breakOn:"- ,.:?!\n",whiteSpace:Tu,contentDirection:c_,alignItems:LM,justifyContent:OM,textAlign:GM,textType:"MSDF",fontColor:new pt.Color(16777215),fontOpacity:1,fontPXRange:4,fontSupersampling:!0,borderRadius:.01,borderWidth:0,borderColor:new pt.Color("black"),borderOpacity:1,backgroundSize:"cover",backgroundColor:new pt.Color(2236962),backgroundWhiteColor:new pt.Color(16777215),backgroundOpacity:.8,backgroundOpaqueOpacity:1,getDefaultTexture:function Zne(){if(!p_){const n=document.createElement("canvas").getContext("2d");n.canvas.width=1,n.canvas.height=1,n.fillStyle="#ffffff",n.fillRect(0,0,1,1),p_=new pt.CanvasTexture(n.canvas),p_.isDefault=!0}return p_},hiddenOverflow:!1,letterSpacing:0};let p_;function m_(n){return class extends n{constructor(t){super(t),rt(this,"_rebuildParentUI",()=>{this.parentUI=this.parent&&this.parent.isUI?this.parent:null}),this.states={},this.currentState=void 0,this.isUI=!0,this.autoLayout=!0,this.childrenUIs=[],this.childrenBoxes=[],this.childrenTexts=[],this.childrenInlines=[],this.parentUI=null,this.addEventListener("added",this._rebuildParentUI),this.addEventListener("removed",this._rebuildParentUI)}getClippingPlanes(){const t=[];if(this.parentUI){if(this.isBlock&&this.parentUI.getHiddenOverflow()){const i=this.parentUI.getHeight()/2-(this.parentUI.padding||0),r=this.parentUI.getWidth()/2-(this.parentUI.padding||0),s=[new pt.Plane(new pt.Vector3(0,1,0),i),new pt.Plane(new pt.Vector3(0,-1,0),i),new pt.Plane(new pt.Vector3(1,0,0),r),new pt.Plane(new pt.Vector3(-1,0,0),r)];s.forEach(o=>{o.applyMatrix4(this.parent.matrixWorld)}),t.push(...s)}this.parentUI.parentUI&&t.push(...this.parentUI.getClippingPlanes())}return t}getHighestParent(){return this.parentUI?this.parent.getHighestParent():this}_getProperty(t){return void 0===this[t]&&this.parentUI?this.parent._getProperty(t):void 0!==this[t]?this[t]:Wn[t]}getFontSize(){return this._getProperty("fontSize")}getFontKerning(){return this._getProperty("fontKerning")}getLetterSpacing(){return this._getProperty("letterSpacing")}getFontTexture(){return void 0===this.fontTexture&&this.parentUI?this.parent._getProperty("fontTexture"):void 0!==this.fontTexture?this.fontTexture:Wn.getDefaultTexture()}getFontFamily(){return this._getProperty("fontFamily")}getBreakOn(){return this._getProperty("breakOn")}getWhiteSpace(){return this._getProperty("whiteSpace")}getTextAlign(){return this._getProperty("textAlign")}getTextType(){return this._getProperty("textType")}getFontColor(){return this._getProperty("fontColor")}getFontSupersampling(){return this._getProperty("fontSupersampling")}getFontOpacity(){return this._getProperty("fontOpacity")}getFontPXRange(){return this._getProperty("fontPXRange")}getBorderRadius(){return this._getProperty("borderRadius")}getBorderWidth(){return this._getProperty("borderWidth")}getBorderColor(){return this._getProperty("borderColor")}getBorderOpacity(){return this._getProperty("borderOpacity")}getContainer(){return!this.threeOBJ&&this.parent?this.parent.getContainer():this.threeOBJ?this:Wn.container}getParentsNumber(t){return t=t||0,this.parentUI?this.parentUI.getParentsNumber(t+1):t}getBackgroundOpacity(){return this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:Wn.backgroundOpacity}getBackgroundColor(){return this.backgroundColor||Wn.backgroundColor}getBackgroundTexture(){return this.backgroundTexture||Wn.getDefaultTexture()}getAlignContent(){return this.alignContent||Wn.alignContent}getAlignItems(){return this.alignItems||Wn.alignItems}getContentDirection(){return this.contentDirection||Wn.contentDirection}getJustifyContent(){return this.justifyContent||Wn.justifyContent}getInterLine(){return void 0===this.interLine?Wn.interLine:this.interLine}getOffset(){return void 0===this.offset?Wn.offset:this.offset}getBackgroundSize(){return void 0===this.backgroundSize?Wn.backgroundSize:this.backgroundSize}getHiddenOverflow(){return void 0===this.hiddenOverflow?Wn.hiddenOverflow:this.hiddenOverflow}getBestFit(){return void 0===this.bestFit?Wn.bestFit:this.bestFit}_rebuildChildrenLists(){this.childrenUIs=this.children.filter(t=>t.isUI),this.childrenBoxes=this.children.filter(t=>t.isBoxComponent),this.childrenInlines=this.children.filter(t=>t.isInline),this.childrenTexts=this.children.filter(t=>t.isText)}add(){for(const i of Object.keys(arguments))arguments[i].isInline&&this.update(null,!0);const t=super.add(...arguments);return this._rebuildChildrenLists(),t}remove(){for(const i of Object.keys(arguments))arguments[i].isInline&&this.update(null,!0);const t=super.remove(...arguments);return this._rebuildChildrenLists(),t}update(t,i,r){ef.requestUpdate(this,t,i,r)}onAfterUpdate(){}_updateFontFamily(t){this.fontFamily=t,this.traverse(i=>{i.isUI&&i.update(!0,!0,!1)}),this.getHighestParent().update(!1,!0,!1)}_updateFontTexture(t){this.fontTexture=t,this.getHighestParent().update(!1,!0,!1)}set(t){let i,r,s;if(ef.register(this),t&&JSON.stringify(t)!==JSON.stringify({})){t.alignContent&&(t.alignItems=t.alignContent,t.textAlign||(t.textAlign=t.alignContent),console.warn("`alignContent` property has been deprecated, please rely on `alignItems` and `textAlign` instead."),delete t.alignContent),t.alignItems&&MF(t.alignItems);for(const o of Object.keys(t))if(this[o]!=t[o])switch(o){case"content":case"fontSize":case"fontKerning":case"breakOn":case"whiteSpace":this.isText&&(i=!0),r=!0,this[o]=t[o];break;case"bestFit":this.isBlock&&(i=!0,r=!0),this[o]=t[o];break;case"width":case"height":case"padding":(this.isInlineBlock||this.isBlock&&"none"!=this.getBestFit())&&(i=!0),r=!0,this[o]=t[o];break;case"letterSpacing":case"interLine":this.isBlock&&"none"!=this.getBestFit()&&(i=!0),r=!0,this[o]=t[o];break;case"margin":case"contentDirection":case"justifyContent":case"alignContent":case"alignItems":case"textAlign":case"textType":r=!0,this[o]=t[o];break;case"fontColor":case"fontOpacity":case"fontSupersampling":case"offset":case"backgroundColor":case"backgroundOpacity":case"backgroundTexture":case"backgroundSize":case"borderRadius":case"borderWidth":case"borderColor":case"borderOpacity":s=!0,this[o]=t[o];break;case"hiddenOverflow":this[o]=t[o]}t.fontFamily&&Qd.setFontFamily(this,t.fontFamily),t.fontTexture&&Qd.setFontTexture(this,t.fontTexture),this.parentUI&&"none"!=this.parentUI.getBestFit()&&this.parentUI.update(!0,!0,!1),this.update(i,r,s),r&&this.getHighestParent().update(!1,!0,!1)}}setupState(t){this.states[t.state]={attributes:t.attributes,onSet:t.onSet}}setState(t){const i=this.states[t];i?t!==this.currentState&&(this.currentState=t,i.onSet&&i.onSet(),i.attributes&&this.set(i.attributes)):console.warn(`state "${t}" does not exist within this component:`,this.name)}clear(){this.traverse(t=>{ef.disposeOf(t),t.material&&t.material.dispose(),t.geometry&&t.geometry.dispose()})}}}function qM(n){return class extends n{constructor(t){super(t),this.textUniforms={u_texture:{value:this.getFontTexture()},u_color:{value:this.getFontColor()},u_opacity:{value:this.getFontOpacity()},u_pxRange:{value:this.getFontPXRange()},u_useRGSS:{value:this.getFontSupersampling()}},this.backgroundUniforms={u_texture:{value:this.getBackgroundTexture()},u_color:{value:this.getBackgroundColor()},u_opacity:{value:this.getBackgroundOpacity()},u_backgroundMapping:{value:this.getBackgroundSize()},u_borderWidth:{value:this.getBorderWidth()},u_borderColor:{value:this.getBorderColor()},u_borderRadiusTopLeft:{value:this.getBorderRadius()},u_borderRadiusTopRight:{value:this.getBorderRadius()},u_borderRadiusBottomRight:{value:this.getBorderRadius()},u_borderRadiusBottomLeft:{value:this.getBorderRadius()},u_borderOpacity:{value:this.getBorderOpacity()},u_size:{value:new pt.Vector2(1,1)},u_tSize:{value:new pt.Vector2(1,1)}}}updateBackgroundMaterial(){this.backgroundUniforms.u_texture.value=this.getBackgroundTexture(),this.backgroundUniforms.u_tSize.value.set(this.backgroundUniforms.u_texture.value.image.width,this.backgroundUniforms.u_texture.value.image.height),this.size&&this.backgroundUniforms.u_size.value.copy(this.size),this.backgroundUniforms.u_texture.value.isDefault?(this.backgroundUniforms.u_color.value=this.getBackgroundColor(),this.backgroundUniforms.u_opacity.value=this.getBackgroundOpacity()):(this.backgroundUniforms.u_color.value=this.backgroundColor||Wn.backgroundWhiteColor,this.backgroundUniforms.u_opacity.value=this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:Wn.backgroundOpaqueOpacity),this.backgroundUniforms.u_backgroundMapping.value=(()=>{switch(this.getBackgroundSize()){case"stretch":return 0;case"contain":return 1;case"cover":return 2}})();const t=this.getBorderRadius();this.backgroundUniforms.u_borderWidth.value=this.getBorderWidth(),this.backgroundUniforms.u_borderColor.value=this.getBorderColor(),this.backgroundUniforms.u_borderOpacity.value=this.getBorderOpacity(),Array.isArray(t)?(this.backgroundUniforms.u_borderRadiusTopLeft.value=t[0],this.backgroundUniforms.u_borderRadiusTopRight.value=t[1],this.backgroundUniforms.u_borderRadiusBottomRight.value=t[2],this.backgroundUniforms.u_borderRadiusBottomLeft.value=t[3]):(this.backgroundUniforms.u_borderRadiusTopLeft.value=t,this.backgroundUniforms.u_borderRadiusTopRight.value=t,this.backgroundUniforms.u_borderRadiusBottomRight.value=t,this.backgroundUniforms.u_borderRadiusBottomLeft.value=t)}updateTextMaterial(){this.textUniforms.u_texture.value=this.getFontTexture(),this.textUniforms.u_color.value=this.getFontColor(),this.textUniforms.u_opacity.value=this.getFontOpacity(),this.textUniforms.u_pxRange.value=this.getFontPXRange(),this.textUniforms.u_useRGSS.value=this.getFontSupersampling()}getBackgroundMaterial(){return(!this.backgroundMaterial||!this.backgroundUniforms)&&(this.backgroundMaterial=this._makeBackgroundMaterial()),this.backgroundMaterial}getFontMaterial(){return(!this.fontMaterial||!this.textUniforms)&&(this.fontMaterial=this._makeTextMaterial()),this.fontMaterial}_makeTextMaterial(){return new pt.ShaderMaterial({uniforms:this.textUniforms,transparent:!0,clipping:!0,vertexShader:Kne,fragmentShader:Jne,extensions:{derivatives:!0}})}_makeBackgroundMaterial(){return new pt.ShaderMaterial({uniforms:this.backgroundUniforms,transparent:!0,clipping:!0,vertexShader:Qne,fragmentShader:eie,extensions:{derivatives:!0}})}updateClippingPlanes(t){const i=void 0!==t?t:this.getClippingPlanes();JSON.stringify(i)!==JSON.stringify(this.clippingPlanes)&&(this.clippingPlanes=i,this.fontMaterial&&(this.fontMaterial.clippingPlanes=this.clippingPlanes),this.backgroundMaterial&&(this.backgroundMaterial.clippingPlanes=this.clippingPlanes))}}}const Kne="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\tgl_Position.z -= 0.00001;\n\n\t#include <clipping_planes_vertex>\n\n}\n",Jne="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\nuniform float u_pxRange;\nuniform bool u_useRGSS;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\n// functions from the original msdf repo:\n// https://github.com/Chlumsky/msdfgen#using-a-multi-channel-distance-field\n\nfloat median(float r, float g, float b) {\n\treturn max(min(r, g), min(max(r, g), b));\n}\n\nfloat screenPxRange() {\n\tvec2 unitRange = vec2(u_pxRange)/vec2(textureSize(u_texture, 0));\n\tvec2 screenTexSize = vec2(1.0)/fwidth(vUv);\n\treturn max(0.5*dot(unitRange, screenTexSize), 1.0);\n}\n\nfloat tap(vec2 offsetUV) {\n\tvec3 msd = texture( u_texture, offsetUV ).rgb;\n\tfloat sd = median(msd.r, msd.g, msd.b);\n\tfloat screenPxDistance = screenPxRange() * (sd - 0.5);\n\tfloat alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\treturn alpha;\n}\n\nvoid main() {\n\n\tfloat alpha;\n\n\tif ( u_useRGSS ) {\n\n\t\t// shader-based supersampling based on https://bgolus.medium.com/sharper-mipmapping-using-shader-based-supersampling-ed7aadb47bec\n\t\t// per pixel partial derivatives\n\t\tvec2 dx = dFdx(vUv);\n\t\tvec2 dy = dFdy(vUv);\n\n\t\t// rotated grid uv offsets\n\t\tvec2 uvOffsets = vec2(0.125, 0.375);\n\t\tvec2 offsetUV = vec2(0.0, 0.0);\n\n\t\t// supersampled using 2x2 rotated grid\n\t\talpha = 0.0;\n\t\toffsetUV.xy = vUv + uvOffsets.x * dx + uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.x * dx - uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv + uvOffsets.y * dx - uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.y * dx + uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\talpha *= 0.25;\n\n\t} else {\n\n\t\talpha = tap( vUv );\n\n\t}\n\n\n\t// apply the opacity\n\talpha *= u_opacity;\n\n\t// this is useful to avoid z-fighting when quads overlap because of kerning\n\tif ( alpha < 0.02) discard;\n\n\n\tgl_FragColor = vec4( u_color, alpha );\n\n\t#include <clipping_planes_fragment>\n\n}\n",Qne="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <clipping_planes_vertex>\n\n}\n",eie="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\n\nuniform float u_borderRadiusTopLeft;\nuniform float u_borderRadiusTopRight;\nuniform float u_borderRadiusBottomLeft;\nuniform float u_borderRadiusBottomRight;\nuniform float u_borderWidth;\nuniform vec3 u_borderColor;\nuniform float u_borderOpacity;\nuniform vec2 u_size;\nuniform vec2 u_tSize;\nuniform int u_backgroundMapping;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\nfloat getEdgeDist() {\n\tvec2 ndc = vec2( vUv.x * 2.0 - 1.0, vUv.y * 2.0 - 1.0 );\n\tvec2 planeSpaceCoord = vec2( u_size.x * 0.5 * ndc.x, u_size.y * 0.5 * ndc.y );\n\tvec2 corner = u_size * 0.5;\n\tvec2 offsetCorner = corner - abs( planeSpaceCoord );\n\tfloat innerRadDist = min( offsetCorner.x, offsetCorner.y ) * -1.0;\n\tif (vUv.x < 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopLeft, 0.0 ) ) - u_borderRadiusTopLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopRight, 0.0 ) ) - u_borderRadiusTopRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomRight, 0.0 ) ) - u_borderRadiusBottomRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x < 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomLeft, 0.0 ) ) - u_borderRadiusBottomLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n}\n\nvec4 sampleTexture() {\n\tfloat textureRatio = u_tSize.x / u_tSize.y;\n\tfloat panelRatio = u_size.x / u_size.y;\n\tvec2 uv = vUv;\n\tif ( u_backgroundMapping == 1 ) { // contain\n\t\tif ( textureRatio < panelRatio ) { // repeat on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t} else { // repeat on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t}\n\t} else if ( u_backgroundMapping == 2 ) { // cover\n\t\tif ( textureRatio < panelRatio ) { // stretch on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t} else { // stretch on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t}\n\t}\n\treturn texture2D( u_texture, uv ).rgba;\n}\n\nvoid main() {\n\n\tfloat edgeDist = getEdgeDist();\n\tfloat change = fwidth( edgeDist );\n\n\tvec4 textureSample = sampleTexture();\n\tvec3 blendedColor = textureSample.rgb * u_color;\n\n\tfloat alpha = smoothstep( change, 0.0, edgeDist );\n\tfloat blendedOpacity = u_opacity * textureSample.a * alpha;\n\n\tvec4 frameColor = vec4( blendedColor, blendedOpacity );\n\n\tif ( u_borderWidth <= 0.0 ) {\n\t\tgl_FragColor = frameColor;\n\t} else {\n\t\tvec4 borderColor = vec4( u_borderColor, u_borderOpacity * alpha );\n\t\tfloat stp = smoothstep( edgeDist + change, edgeDist, u_borderWidth * -1.0 );\n\t\tgl_FragColor = mix( frameColor, borderColor, stp );\n\t}\n\n\t#include <clipping_planes_fragment>\n}\n";class BF extends pt.Mesh{constructor(e){super(new pt.PlaneGeometry,e),this.castShadow=!0,this.receiveShadow=!0,this.name="MeshUI-Frame"}}let g_=null;function Au(...n){if(!g_)throw new Error("Cannot use mixins with Base null");let e=g_;g_=null;let i,t=n.length;for(;--t>=0;)i=n[t],e=i(e);return e}Au.withBase=n=>(g_=n,Au);class tf extends(Au.withBase(pt.Object3D)(zM,kF,qM,m_)){constructor(e){super(e),this.isBlock=!0,this.size=new pt.Vector2(1,1),this.frame=new BF(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){const e=this.getBestFit();"none"!=e&&this.childrenTexts.length?this.calculateBestFit(e):this.childrenTexts.forEach(t=>{t._fitFontSize=void 0})}updateLayout(){const e=this.getWidth(),t=this.getHeight();e&&t?(this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.autoLayout&&this.setPosFromParentRecords(),this.childrenInlines.length&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.parentUI&&(this.position.z=this.getOffset())):console.warn("Block got no dimension from its parameters or from children parameters")}updateInner(){this.parentUI&&(this.position.z=this.getOffset()),this.frame&&this.updateBackgroundMaterial()}}function VF(n){return class extends n{constructor(t){super(t),this.isInline=!0}}}function zF(n){let e,t,i,r=0;for(let a=0;a<n.length;++a){const c=n[a];if(c.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===e&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===t&&(t=c.itemSize),t!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=c.normalized),i!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=c.array.length}const s=new e(r);let o=0;for(let a=0;a<n.length;++a)s.set(n[a].array,o),o+=n[a].array.length;return new pt.BufferAttribute(s,t,i)}class nie extends pt.PlaneGeometry{constructor(e,t){const i=e.glyph,r=e.fontSize;super(e.width,e.height),null===i.match(/\s/g)?(-1===t.info.charset.indexOf(i)&&console.error(`The character '${i}' is not included in the font characters set.`),this.mapUVs(t,i),this.transformGeometry(e)):(this.nullifyUVs(),this.scale(0,0,1),this.translate(0,r/2,0))}mapUVs(e,t){const i=e.chars.find(u=>u.char===t),r=e.common,s=i.x/r.scaleW,o=(i.x+i.width)/r.scaleW,a=1-(i.y+i.height)/r.scaleH,c=1-i.y/r.scaleH,l=this.attributes.uv;for(let u=0;u<l.count;u++){let h=l.getX(u),d=l.getY(u);[h,d]=(()=>{switch(u){case 0:return[s,c];case 1:return[o,c];case 2:return[s,a];case 3:return[o,a]}})(),l.setXY(u,h,d)}}nullifyUVs(){const e=this.attributes.uv;for(let t=0;t<e.count;t++)e.setXY(t,0,0)}transformGeometry(e){this.translate(e.width/2,e.height/2,0)}}const YM={getGlyphDimensions:function iie(n){const e=n.font,t=n.fontSize,i=n.glyph,r=t/e.info.size,s=e.chars.find(h=>h.char===i);let o=s?s.width*r:t/3,a=s?s.height*r:0;return 0===o&&(o=s?s.xadvance*r:t),0===a&&(a=.7*t),"\n"===i&&(o=0),{width:o,height:a,anchor:s?s.yoffset*r:0,xadvance:s?s.xadvance*r:o,xoffset:s?s.xoffset*r:0}},getGlyphPairKerning:function rie(n,e){const t=n._kernings;return t[e]?t[e]:0},buildText:function sie(){const n=[];this.inlines.forEach((i,r)=>{n[r]=new nie(i,this.getFontFamily()),n[r].translate(i.offsetX,i.offsetY,0)});const e=function tie(n,e=!1){const t=null!==n[0].index,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},a=n[0].morphTargetsRelative,c=new pt.BufferGeometry;let l=0;for(let u=0;u<n.length;++u){const h=n[u];let d=0;if(t!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const f in h.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[f]&&(s[f]=[]),s[f].push(h.attributes[f]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const f in h.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[f]&&(o[f]=[]),o[f].push(h.morphAttributes[f])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(h.userData),e){let f;if(t)f=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;f=h.attributes.position.count}c.addGroup(l,f,u),l+=f}}if(t){let u=0;const h=[];for(let d=0;d<n.length;++d){const f=n[d].index;for(let p=0;p<f.count;++p)h.push(f.getX(p)+u);u+=n[d].attributes.position.count}c.setIndex(h)}for(const u in s){const h=zF(s[u]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;c.setAttribute(u,h)}for(const u in o){const h=o[u][0].length;if(0===h)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[u]=[];for(let d=0;d<h;++d){const f=[];for(let g=0;g<o[u].length;++g)f.push(o[u][g][d]);const p=zF(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;c.morphAttributes[u].push(p)}}return c}(n);return new pt.Mesh(e,this.getFontMaterial())}};function oie(n){return class extends n{createText(){const t=this,i=(()=>{if("MSDF"===this.getTextType())return YM.buildText.call(this);console.warn(`'${this.getTextType()}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)})();return i.renderOrder=1/0,i.onBeforeRender=function(){t.updateClippingPlanes&&t.updateClippingPlanes()},i}getGlyphDimensions(t){if("MSDF"===t.textType)return YM.getGlyphDimensions(t);console.warn(`'${t.textType}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}getGlyphPairKerning(t,i,r){if("MSDF"===t)return YM.getGlyphPairKerning(i,r);console.warn(`'${t}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}}}const aie=function GF(n){n.children.forEach(e=>{e.children.length>0&&GF(e),n.remove(e),ef.disposeOf(e),e.material&&e.material.dispose(),e.geometry&&e.geometry.dispose()}),n.children=[]};class ZM extends(Au.withBase(pt.Object3D)(VF,oie,qM,m_)){constructor(e){super(e),this.isText=!0,this.set(e)}parseParams(){this.calculateInlines(this._fitFontSize||this.getFontSize())}updateLayout(){aie(this),this.inlines&&(this.textContent=this.createText(),this.updateTextMaterial(),this.add(this.textContent)),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.textContent&&this.updateTextMaterial()}calculateInlines(e){const t=this.content,i=this.getFontFamily(),r=this.getBreakOn(),s=this.getTextType(),o=this.getWhiteSpace();if(!i||"string"==typeof i)return void(Qd.getFontOf(this)||console.warn("no font was found"));if(!this.content)return void(this.inlines=null);if(!s)return void console.error("You must provide a 'textType' attribute so three-mesh-ui knows how to render your text.\n See https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type");const a=EF(t,o),c=Array.from?Array.from(a):String(a).split(""),l=e/i.info.size,u=i.common.lineHeight*l,h=i.common.base*l,d=c.map(f=>{const p=this.getGlyphDimensions({textType:s,glyph:f,font:i,fontSize:e});let g=null;return o!==Cu&&(r.includes(f)||f.match(/\s/g))&&(g="possible"),f.match(/\n/g)&&(g=CF(o)),{height:p.height,width:p.width,anchor:p.anchor,xadvance:p.xadvance,xoffset:p.xoffset,lineBreak:g,glyph:f,fontSize:e,lineHeight:u,lineBase:h}});if("none"!==this.getFontKerning())for(let f=1;f<d.length;f++){const p=d[f],_=this.getGlyphPairKerning(s,i,d[f-1].glyph+d[f].glyph);p.kerning=_*(e/i.info.size)}this.inlines=d}}class KM extends(Au.withBase(pt.Object3D)(VF,zM,kF,qM,m_)){constructor(e){super(e),this.isInlineBlock=!0,this.size=new pt.Vector2(1,1),this.frame=new BF(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){this.width||console.warn("inlineBlock has no width. Set to 0.3 by default"),this.height||console.warn("inlineBlock has no height. Set to 0.3 by default"),this.inlines=[{height:this.height||.3,width:this.width||.3,anchor:0,lineBreak:"possible"}]}updateLayout(){const e=this.getWidth(),t=this.getHeight();if(this.inlines){const i=this.inlines[0];this.position.set(i.width/2,i.height/2,0),this.position.x+=i.offsetX,this.position.y+=i.offsetY}this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.childrenInlines.length&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.frame&&this.updateBackgroundMaterial()}}const Ko_fr=[[[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]}],[{width:.2,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ko_eng=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ko_ru=[[[{width:1/12,chars:[{lowerCase:"\u0439",upperCase:"\u0419"},{lowerCase:"q",upperCase:"Q"}]},{width:1/12,chars:[{lowerCase:"\u0446",upperCase:"\u0426"},{lowerCase:"w",upperCase:"W"}]},{width:1/12,chars:[{lowerCase:"\u0443",upperCase:"\u0423"},{lowerCase:"e",upperCase:"E"}]},{width:1/12,chars:[{lowerCase:"\u043a",upperCase:"\u041a"},{lowerCase:"r",upperCase:"R"}]},{width:1/12,chars:[{lowerCase:"\u0435",upperCase:"\u0415"},{lowerCase:"t",upperCase:"T"}]},{width:1/12,chars:[{lowerCase:"\u043d",upperCase:"\u041d"},{lowerCase:"y",upperCase:"Y"}]},{width:1/12,chars:[{lowerCase:"\u0433",upperCase:"\u0413"},{lowerCase:"u",upperCase:"U"}]},{width:1/12,chars:[{lowerCase:"\u0448",upperCase:"\u0428"},{lowerCase:"i",upperCase:"I"}]},{width:1/12,chars:[{lowerCase:"\u0449",upperCase:"\u0429"},{lowerCase:"o",upperCase:"O"}]},{width:1/12,chars:[{lowerCase:"\u0437",upperCase:"\u0417"},{lowerCase:"p",upperCase:"P"}]},{width:1/12,chars:[{lowerCase:"\u0445",upperCase:"\u0425"},{lowerCase:"{",upperCase:"["}]},{width:1/12,chars:[{lowerCase:"\u044a",upperCase:"\u042a"},{lowerCase:"}",upperCase:"]"}]}],[{width:1/12,chars:[{lowerCase:"\u0444",upperCase:"\u0424"},{lowerCase:"a",upperCase:"A"}]},{width:1/12,chars:[{lowerCase:"\u044b",upperCase:"\u042b"},{lowerCase:"s",upperCase:"S"}]},{width:1/12,chars:[{lowerCase:"\u0432",upperCase:"\u0412"},{lowerCase:"d",upperCase:"D"}]},{width:1/12,chars:[{lowerCase:"\u0430",upperCase:"\u0410"},{lowerCase:"f",upperCase:"F"}]},{width:1/12,chars:[{lowerCase:"\u043f",upperCase:"\u041f"},{lowerCase:"g",upperCase:"G"}]},{width:1/12,chars:[{lowerCase:"\u0440",upperCase:"\u0420"},{lowerCase:"h",upperCase:"H"}]},{width:1/12,chars:[{lowerCase:"\u043e",upperCase:"\u041e"},{lowerCase:"j",upperCase:"J"}]},{width:1/12,chars:[{lowerCase:"\u043b",upperCase:"\u041b"},{lowerCase:"k",upperCase:"K"}]},{width:1/12,chars:[{lowerCase:"\u0434",upperCase:"\u0414"},{lowerCase:"l",upperCase:"L"}]},{width:1/12,chars:[{lowerCase:"\u0436",upperCase:"\u0416"},{lowerCase:":",upperCase:";"}]},{width:1/12,chars:[{lowerCase:"\u044d",upperCase:"\u042d"},{lowerCase:'"',upperCase:"'"}]},{width:1/12,chars:[{lowerCase:"\u0451",upperCase:"\u0401"},{lowerCase:"|",upperCase:"\\"}]}],[{width:.125,command:"shift",chars:[{icon:"shift"}]},{width:1/12,chars:[{lowerCase:"\u044f",upperCase:"\u042f"},{lowerCase:"z",upperCase:"Z"}]},{width:1/12,chars:[{lowerCase:"\u0447",upperCase:"\u0427"},{lowerCase:"x",upperCase:"X"}]},{width:1/12,chars:[{lowerCase:"\u0441",upperCase:"\u0421"},{lowerCase:"c",upperCase:"C"}]},{width:1/12,chars:[{lowerCase:"\u043c",upperCase:"\u041c"},{lowerCase:"v",upperCase:"V"}]},{width:1/12,chars:[{lowerCase:"\u0438",upperCase:"\u0418"},{lowerCase:"b",upperCase:"B"}]},{width:1/12,chars:[{lowerCase:"\u0442",upperCase:"\u0422"},{lowerCase:"n",upperCase:"N"}]},{width:1/12,chars:[{lowerCase:"\u044c",upperCase:"\u042c"},{lowerCase:"m",upperCase:"M"}]},{width:1/12,chars:[{lowerCase:"\u0431",upperCase:"\u0411"},{lowerCase:",",upperCase:""}]},{width:1/12,chars:[{lowerCase:"\u044e",upperCase:"\u042e"},{lowerCase:".",upperCase:""}]},{width:.125,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.3,command:"switch",chars:[{lowerCase:"\u0410\u0411\u0412"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ko_de=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"\xfc",upperCase:"\xdc"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"\xf6",upperCase:"\xd6"}]},{width:1/11,chars:[{lowerCase:"\xe4",upperCase:"\xc4"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ko_es=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"\xf1",upperCase:"\xd1"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ko_el=[[[{width:.1,chars:[{lowerCase:";",upperCase:":"},{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"\u03c2",upperCase:"\u03c2"},{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"\u03b5",upperCase:"\u0395"},{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"\u03c1",upperCase:"\u03a1"},{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"\u03c4",upperCase:"\u03a4"},{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"\u03c5",upperCase:"\u03a5"},{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"\u03b8",upperCase:"\u0398"},{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"\u03b9",upperCase:"\u0399"},{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"\u03bf",upperCase:"\u039f"},{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"\u03c0",upperCase:"\u03a0"},{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"\u03b1",upperCase:"\u0391"},{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"\u03c3",upperCase:"\u03a3"},{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"\u03b4",upperCase:"\u0394"},{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"\u03c6",upperCase:"\u03a6"},{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"\u03b3",upperCase:"\u0393"},{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"\u03b7",upperCase:"\u0397"},{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"\u03be",upperCase:"\u039e"},{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"\u03ba",upperCase:"\u039a"},{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"\u03bb",upperCase:"\u039b"},{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"\u03b6",upperCase:"\u0396"},{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"\u03c7",upperCase:"\u03a7"},{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"\u03c8",upperCase:"\u03a8"},{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"\u03c9",upperCase:"\u03a9"},{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"\u03b2",upperCase:"\u0392"},{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"\u03bd",upperCase:"\u039d"},{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"\u03bc",upperCase:"\u039c"},{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ko_nord=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"\xe5",upperCase:"\xc5"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"\xe6",upperCase:"\xc6"}]},{width:1/11,chars:[{lowerCase:"\xf8",upperCase:"\xd8"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],cie=new pt.TextureLoader;class WF extends(Au.withBase(pt.Object3D)(zM,m_)){constructor(e){let t;if(e||(e={}),e.width||(e.width=1),e.height||(e.height=.4),e.margin||(e.margin=.003),e.padding||(e.padding=.01),super(e),this.currentPanel=0,this.isLowerCase=!0,this.charsetCount=1,e.language||navigator.language)switch(e.language||navigator.language){case"fr":case"fr-CH":case"fr-CA":t=Ko_fr;break;case"ru":this.charsetCount=2,t=Ko_ru;break;case"de":case"de-DE":case"de-AT":case"de-LI":case"de-CH":t=Ko_de;break;case"es":case"es-419":case"es-AR":case"es-CL":case"es-CO":case"es-ES":case"es-CR":case"es-US":case"es-HN":case"es-MX":case"es-PE":case"es-UY":case"es-VE":t=Ko_es;break;case"el":this.charsetCount=2,t=Ko_el;break;case"nord":t=Ko_nord;break;default:t=Ko_eng}else t=Ko_eng;this.keys=[],this.panels=t.map(i=>{const r=e.height/i.length-2*e.margin,s=new tf({width:e.width+2*e.padding,height:e.height+2*e.padding,offset:0,padding:e.padding,fontFamily:e.fontFamily,fontTexture:e.fontTexture,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity});return s.charset=0,s.add(...i.map(o=>{const a=new tf({width:e.width,height:r,margin:e.margin,contentDirection:"row",justifyContent:"center"});a.frame.visible=!1;const c=[];return o.forEach(l=>{const u=new tf({width:e.width*l.width-2*e.margin,height:r,margin:e.margin,justifyContent:"center",offset:0}),h=l.chars[s.charset].lowerCase||l.chars[s.charset].icon||"undif";if("enter"===h&&e.enterTexture||"shift"===h&&e.shiftTexture||"backspace"===h&&e.backspaceTexture){const d=(()=>{switch(h){case"backspace":return e.backspaceTexture;case"enter":return e.enterTexture;case"shift":return e.shiftTexture;default:console.warn("There is no icon image for this key")}})();cie.load(d,f=>{u.add(new KM({width:.65*u.width,height:.65*u.height,backgroundSize:"contain",backgroundTexture:f}))})}else u.add(new ZM({content:h,offset:0}));u.type="Key",u.info=l,u.info.input=h,u.panel=s,c.push(u),this.keys.push(u)}),a.add(...c),a})),s}),this.add(this.panels[0]),this.set(e)}setNextPanel(){this.panels.forEach(e=>{this.remove(e)}),this.currentPanel=(this.currentPanel+1)%this.panels.length,this.add(this.panels[this.currentPanel]),this.update(!0,!0,!0)}setNextCharset(){this.panels[this.currentPanel].charset=(this.panels[this.currentPanel].charset+1)%this.charsetCount,this.keys.forEach(e=>{if(!this.panels[this.currentPanel].getObjectById(e.id))return;const i=e.info.chars[e.panel.charset]||e.info.chars[0],r=this.isLowerCase||!i.upperCase?i.lowerCase:i.upperCase;if(!e.childrenTexts.length)return;const s=e.childrenTexts[0];e.info.input=r,s.set({content:r}),s.update(!0,!0,!0)})}toggleCase(){this.isLowerCase=!this.isLowerCase,this.keys.forEach(e=>{const t=e.info.chars[e.panel.charset]||e.info.chars[0],i=this.isLowerCase||!t.upperCase?t.lowerCase:t.upperCase;if(!e.childrenTexts.length)return;const r=e.childrenTexts[0];e.info.input=i,r.set({content:i}),r.update(!0,!0,!0)})}parseParams(){}updateLayout(){}updateInner(){}}const jF=()=>ef.update(),$F={Block:tf,Text:ZM,InlineBlock:KM,Keyboard:WF,FontLibrary:Qd,update:jF,TextAlign:a_,Whitespace:o_,JustifyContent:s_,AlignItems:r_,ContentDirection:i_};typeof global<"u"&&(global.ThreeMeshUI=$F);const lie=$F;var Du=er.gO,JM=er.xv,uie=er.Vx;new Y(7837819),new Y(8280859),new Y(4612974),new Y(8295294),new Y(9547681),new Y(3233839),new Y(3568944),new Y(16442160),new Y(8832927),new Y(1131367),new Y(6382612),new Y(12295171),new Y(9061405),new Y(10199343),new Y(14799969);const jr={white:new Y(16777215),black:new Y(0),grey:new Y(8421504),background:new Y(0),bg:new Y(10526880),gray:new Y(7829367),darkGreen:new Y(25600),midGreen:new Y(941139),lightGreen:new Y(557426),red:new Y(12063238),buttonBackground:new Y(7829367),buttonFontColor:new Y(2236962),hoveredBackground:new Y(10066329),hoveredFontColor:new Y(16777215)};new Y(16711680),new Y(16759552),new Y(16776960),new Y(65280),new Y(255),new Y(9699517),new Y(13107435);let XF=(()=>{var n;class e{constructor(i){this.interactions=i,this.FontJSON="assets/fonts/Roboto-msdf.json",this.FontImage="assets/fonts/Roboto-msdf.png",this.selectState=!1,this.containerOptions={justifyContent:"center",contentDirection:"row-reverse",fontSize:.07,padding:.02,borderRadius:.11,height:.5,width:1.3,textAlign:"left",fontFamily:this.FontJSON,fontTexture:this.FontImage,backgroundColor:jr.red,rotations:{x:-.55,y:0,z:0},position:{x:0,y:0,z:3},name:"ui panel container",buttons:{prev:{},next:{},upvote:{},moreInfo:{},tweet:{},takePicture:{}},hoveredStateAttributes:{state:"hovered",attributes:{offset:.035,backgroundColor:new Y(10066329),backgroundOpacity:1,fontColor:new Y(16777215)}},idleStateAttributes:{state:"idle",attributes:{offset:.035,backgroundColor:new Y(6710886),backgroundOpacity:.3,fontColor:new Y(16777215)}},selectedAttributes:{offset:.02,backgroundColor:jr.buttonBackground,fontColor:jr.buttonFontColor}},this.buttonOptions={width:.4,height:.15,justifyContent:"center",offset:.05,margin:.02,borderRadius:.075},this.defaultOptions={name:"Button Panel Container",buttons:[{name:"Next Button",text:"Next",onClick:r=>{console.log("Next Button is clicked")},onHover:r=>{console.log("Next Button is hovered")},buttonOptions:{width:.4,height:.15,justifyContent:"center",offset:.05,margin:.02,borderRadius:.075}},{name:"Prev Button",text:"Previous",onClick:r=>{console.log("Previous Button is clicked")},onHover:r=>{console.log("Previous Button is hovered")},buttonOptions:{width:.4,height:.15,justifyContent:"center",offset:.05,margin:.02,borderRadius:.075}}]},this.idleStateAttributes={state:"idle",attributes:{width:.4,height:.15,offset:.035,backgroundColor:new Y(6710886),backgroundOpacity:.3,fontColor:new Y(16777215)},onSet:r=>{}},this.hoveredStateAttributes={state:"hovered",attributes:{width:.4,height:.15,offset:.035,backgroundColor:new Y(10066329),backgroundOpacity:1,fontColor:new Y(16777215)},onSet:r=>{}},this.selectedAttributes={offset:.02,backgroundColor:new Y(7829367),fontColor:new Y(2236962)},this.hemLight=new cM(8421504,6316128),this.selected=0,this.selection=[1,2,3]}createMoreInfoPanels(i){const r=new Du({ref:"container",padding:.025,fontFamily:this.FontJSON,fontTexture:this.FontImage,fontColor:new Y(16777215),backgroundOpacity:.5,width:1,height:1});r.name=`More Info Panel ${i.id}`;const s=new Du({height:.2,width:.9,margin:.025,justifyContent:"center",fontSize:.09}),o=new JM({content:`${i.title}: ${i.votes} `});o.name=`${i.id} Text`,s.add(o),s.name=`Painting ${i.id} title`,this.title=s,r.add(this.title);const a=new Du({height:.53,width:.9,margin:.01,padding:.02,fontSize:.025,alignItems:"start",textAlign:"justify",backgroundOpacity:0,bestFit:"auto"}).add(new JM({content:i.description}));a.name="Artwork Description";const c=new Du({contentDirection:"row",padding:.02,margin:.025,backgroundOpacity:.2,height:.65,width:.9,justifyContent:"center",bestFit:"auto"});return c.name="Content Container",this.description=a,c.add(this.description),r.add(c),r}updateInfoPanel(i){this.description.children[1].set({content:String(i.description)}),this.title.children[1].set({content:`${i.title}: ${i.votes} `})}updateVote(i){const r=`${i.text.content.split(":")[0]} : ${i.votes}`;i.text.set({content:r})}createInteractiveButtons(i){const r=Object.assign({},this.defaultOptions,i),s=new Du({justifyContent:"center",contentDirection:"row-reverse",fontFamily:this.FontJSON,fontTexture:this.FontImage,fontSize:.07,padding:.02,borderRadius:.11,height:.2,width:i.buttons.length/2});return s.name=r.name,this.container=s,r.buttons.forEach((o,a)=>{const c=this.createButton(r.id,o);this.container.add(c)}),s}createButton(i,r){const s=new Du(this.buttonOptions);return s.name=`Frame ${i} ${r.name}`,s.add(new JM({content:r.text,name:`${r.name} Text`})),s.setupState({state:"selected",attributes:this.selectedAttributes}),s.setupState(this.idleStateAttributes),s.setupState(this.hoveredStateAttributes),s.position.set(-.5,0,0),this.interactions.addToInteractions(s),this.interactions.addToColliders({mesh:s,name:r.name,cb:()=>{r.onClick(i)}}),s.addEventListener("click",()=>{r.onClick(i)}),s}update(){uie()}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Xd))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),qF=(()=>{var n;class e{constructor(i,r,s,o,a,c,l){this.objectsService=i,this.interactionsService=r,this.lightsService=s,this.loadersService=o,this.materialsService=a,this.uiService=c,this.debug=l,this.frameDistance=7,this.angle=0,this.frames=[],this.locations=[],this.focusFactor=4,this.framesGroup=new Wr,this.frameButton=this.objectsService.createIcosahedron({radius:.12,detail:0}),this.likeButton=this.objectsService.createHeart()}createFrames(i=[],r=[],s){return this.framesGroup.name="Frames Group",this.angle=2*Math.PI/i.length,this.frames=i.map((o,a)=>this.placeFrame(this.createFrame(o,r,a),a)),this.framesGroup.add(...this.frames),this.framesGroup.position.set(0,1.6,0),this.focusFrame(0),s&&s(),this.framesGroup}placeFrame(i,r=0){const s=r*this.angle,o=Math.sin(s)*this.frameDistance,a=-Math.cos(s)*this.frameDistance;i.position.set(o,0,a),i.scale.set(1.3,1.3,1.3),i.rotation.y=s,i.userData.originalPosition=i.position.clone();const c=this.lightsService.createDirLight({intensity:.4})[0];return c.castShadow=!0,c.position.set(Math.sin(s),2,Math.cos(s)),c.name=`${i.name} dir light`,c.target.position.set(o,0,a),c.target.updateWorldMatrix(),i}createFrame(i,r=[],s){const o=new Wr;o.name=` ${i.title} frame group`;const a=new vs(1.5,2,.2),c=new vs(i?.width/100,i?.height/100,.3),l=this.loadersService.loadTexture(i.textureUrl);l.colorSpace=wt,l.minFilter=l.magFilter=Xt,l.mapping=300;const u=new Xo({map:l,color:16777215}),h=new Ka({color:16777215}),d=new xt(a,h),f=new xt(c,u);d.name=` ${i.title} frame mesh`||"frame",f.name=` ${i.title} canvas mesh`||"frame canvas";const p=this.lightsService.createSpotLight();p[0].target=d,o.add(d,f,...p),o.rotateY(Math.PI);const g=this.uiService.createInteractiveButtons({buttons:r,id:i.id}),_=this.uiService.createMoreInfoPanels({id:i.id,title:i.title,description:i.description,votes:i.votes});return _.quaternion.copy(d.quaternion),g.position.x=0,g.position.y=-1.2,g.rotateY(Math.PI),g.rotateX(-.55),_.position.x=1.3,_.rotateY(-72),o.add(_,g),o}createButton(i,r){let s;return"heart"===i.shape?(s=this.likeButton.clone(),s.rotateZ(Math.PI/4)):s=this.frameButton.clone(),s.name=`Frame ${r} ${i.name}`,s.position.set(i.position.x,i.position.y,i.position.z),this.interactionsService.addToInteractions(s),this.interactionsService.addToColliders({mesh:s,name:i.name,cb:()=>{i.onClick(r)}}),s.addEventListener("click",o=>{i.onClick(r)}),s}focusFrame(i){const r=this.frames[i],a=new A(r.position.x/this.frameDistance*this.focusFactor,r.position.y,r.position.z/this.frameDistance*this.focusFactor);this.moveFrame(r,a)}resetPosition(i){const r=this.frames[i];this.moveFrame(r,r.userData.originalPosition)}moveFrame(i,r){pd.to(i.position,{x:r.x,y:r.y,z:r.z,duration:2.5})}rotateFrames(i=72){const r=Hl_degToRad(i)+this.framesGroup.rotation.y;pd.to(this.framesGroup.rotation,{y:r,duration:1})}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(aF),Se(Xd),Se(cF),Se(_F),Se(sF),Se(XF),Se(Yd))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const pie={camera:{name:"Default Camera",type:"Perspective",near:.1,far:200,fov:45,width:window.innerWidth||500,height:window.innerHeight||700,position:{x:0,y:1.6,z:0},rotation:{x:0,y:0,z:0}},width:window.innerWidth||400,height:window.innerHeight||700,lights:{name:"Default Light",type:"directional",x:2,y:10,z:-2,color:16777215,intensity:2,width:10,near:.1,far:30,castShadow:!0,useHelpers:!1,helper:!0},xrMode:"inline",controls:{type:"orbit"},background:jr.background,fog:{color:0,near:1500,far:4e3}};let mie=(()=>{var n;class e{constructor(){this.dummyCamera=new sn,this.dolly=new sn,this.theta=0,this.radius=5}createCamera(i){return this.camera=new Un(i.fov,i.width/i.height,i.near,i.far),this.camera.position.set(i.position.x,i.position.y,20),this.camera.rotation.set(0,0,0),this.camera.name=i.name,this.camera}addDolly(){return this.dolly.add(this.camera),this.camera?.add(this.dummyCamera),this.dolly}moveDolly(i,r,s){}moveCamera(i,r,s,o){pd.to(this.camera.position,{x:i,y:r,z:s,duration:o})}rotateCamera(i,r,s){pd.to(this.camera.rotation,{x:i,y:r,z:s,duration:3.2})}animateCamera(i){this.theta+=.1,i.camera.position.x=this.radius*Math.sin(Hl_degToRad(this.theta)),i.camera.position.y=this.radius*Math.sin(Hl_degToRad(this.theta)),i.camera.position.z=this.radius*Math.cos(Hl_degToRad(this.theta)),i.camera.lookAt(i.look)}updateCamera(i){i.look&&i.lookAt(i.look),i.camera.updateMatrixWorld()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const YF={type:"change"},QM={type:"start"},ZF={type:"end"},__=new Ha,KF=new oo,gie=Math.cos(70*Hl_DEG2RAD);class _ie extends ka{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new A,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(P){P.addEventListener("keydown",T),this._domElementKeyEvents=P},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",T),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(YF),i.update(),s=r.NONE},this.update=function(){const P=new A,ie=(new Hn).setFromUnitVectors(e.up,new A(0,1,0)),Me=ie.clone().invert(),ve=new A,be=new Hn,Qe=new A,yt=2*Math.PI;return function(we=null){const $=i.object.position;P.copy($).sub(i.target),P.applyQuaternion(ie),a.setFromVector3(P),i.autoRotate&&s===r.NONE&&O(function b(P){return null!==P?2*Math.PI/60*i.autoRotateSpeed*P:2*Math.PI/60/60*i.autoRotateSpeed}(we)),i.enableDamping?(a.theta+=c.theta*i.dampingFactor,a.phi+=c.phi*i.dampingFactor):(a.theta+=c.theta,a.phi+=c.phi);let ce=i.minAzimuthAngle,_e=i.maxAzimuthAngle;isFinite(ce)&&isFinite(_e)&&(ce<-Math.PI?ce+=yt:ce>Math.PI&&(ce-=yt),_e<-Math.PI?_e+=yt:_e>Math.PI&&(_e-=yt),a.theta=ce<=_e?Math.max(ce,Math.min(_e,a.theta)):a.theta>(ce+_e)/2?Math.max(ce,a.theta):Math.min(_e,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),a.radius=Q(i.zoomToCursor&&S||i.object.isOrthographicCamera?a.radius:a.radius*l),P.setFromSpherical(a),P.applyQuaternion(Me),$.copy(i.target).add(P),i.object.lookAt(i.target),!0===i.enableDamping?(c.theta*=1-i.dampingFactor,c.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(c.set(0,0,0),u.set(0,0,0));let dt=!1;if(i.zoomToCursor&&S){let Tt=null;if(i.object.isPerspectiveCamera){const zt=P.length();Tt=Q(zt*l),i.object.position.addScaledVector(w,zt-Tt),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const zt=new A(x.x,x.y,0);zt.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/l)),i.object.updateProjectionMatrix(),dt=!0;const tr=new A(x.x,x.y,0);tr.unproject(i.object),i.object.position.sub(tr).add(zt),i.object.updateMatrixWorld(),Tt=P.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==Tt&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Tt).add(i.object.position):(__.origin.copy(i.object.position),__.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(__.direction))<gie?e.lookAt(i.target):(KF.setFromNormalAndCoplanarPoint(i.object.up,i.target),__.intersectPlane(KF,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/l)),i.object.updateProjectionMatrix(),dt=!0);return l=1,S=!1,!!(dt||ve.distanceToSquared(i.object.position)>o||8*(1-be.dot(i.object.quaternion))>o||Qe.distanceToSquared(i.target)>0)&&(i.dispatchEvent(YF),ve.copy(i.object.position),be.copy(i.object.quaternion),Qe.copy(i.target),dt=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",se),i.domElement.removeEventListener("pointerdown",Ce),i.domElement.removeEventListener("pointercancel",ze),i.domElement.removeEventListener("wheel",I),i.domElement.removeEventListener("pointermove",Ae),i.domElement.removeEventListener("pointerup",ze),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",T),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new q2,c=new q2;let l=1;const u=new A,h=new J,d=new J,f=new J,p=new J,g=new J,_=new J,m=new J,v=new J,y=new J,w=new A,x=new J;let S=!1;const M=[],E={};function C(){return Math.pow(.95,i.zoomSpeed)}function O(P){c.theta-=P}function B(P){c.phi-=P}const L=function(){const P=new A;return function(Me,ve){P.setFromMatrixColumn(ve,0),P.multiplyScalar(-Me),u.add(P)}}(),F=function(){const P=new A;return function(Me,ve){!0===i.screenSpacePanning?P.setFromMatrixColumn(ve,1):(P.setFromMatrixColumn(ve,0),P.crossVectors(i.object.up,P)),P.multiplyScalar(Me),u.add(P)}}(),k=function(){const P=new A;return function(Me,ve){const be=i.domElement;if(i.object.isPerspectiveCamera){P.copy(i.object.position).sub(i.target);let yt=P.length();yt*=Math.tan(i.object.fov/2*Math.PI/180),L(2*Me*yt/be.clientHeight,i.object.matrix),F(2*ve*yt/be.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(L(Me*(i.object.right-i.object.left)/i.object.zoom/be.clientWidth,i.object.matrix),F(ve*(i.object.top-i.object.bottom)/i.object.zoom/be.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function W(P){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?l/=P:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function H(P){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?l*=P:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function X(P){if(!i.zoomToCursor)return;S=!0;const ie=i.domElement.getBoundingClientRect(),ve=P.clientY-ie.top,Qe=ie.height;x.x=(P.clientX-ie.left)/ie.width*2-1,x.y=-ve/Qe*2+1,w.set(x.x,x.y,1).unproject(i.object).sub(i.object.position).normalize()}function Q(P){return Math.max(i.minDistance,Math.min(i.maxDistance,P))}function te(P){h.set(P.clientX,P.clientY)}function q(P){p.set(P.clientX,P.clientY)}function Te(){1===M.length?h.set(M[0].pageX,M[0].pageY):h.set(.5*(M[0].pageX+M[1].pageX),.5*(M[0].pageY+M[1].pageY))}function ct(){1===M.length?p.set(M[0].pageX,M[0].pageY):p.set(.5*(M[0].pageX+M[1].pageX),.5*(M[0].pageY+M[1].pageY))}function tt(){const P=M[0].pageX-M[1].pageX,ie=M[0].pageY-M[1].pageY,Me=Math.sqrt(P*P+ie*ie);m.set(0,Me)}function ge(P){if(1==M.length)d.set(P.pageX,P.pageY);else{const Me=j(P);d.set(.5*(P.pageX+Me.x),.5*(P.pageY+Me.y))}f.subVectors(d,h).multiplyScalar(i.rotateSpeed);const ie=i.domElement;O(2*Math.PI*f.x/ie.clientHeight),B(2*Math.PI*f.y/ie.clientHeight),h.copy(d)}function ne(P){if(1===M.length)g.set(P.pageX,P.pageY);else{const ie=j(P);g.set(.5*(P.pageX+ie.x),.5*(P.pageY+ie.y))}_.subVectors(g,p).multiplyScalar(i.panSpeed),k(_.x,_.y),p.copy(g)}function de(P){const ie=j(P),Me=P.pageX-ie.x,ve=P.pageY-ie.y,be=Math.sqrt(Me*Me+ve*ve);v.set(0,be),y.set(0,Math.pow(v.y/m.y,i.zoomSpeed)),W(y.y),m.copy(v)}function Ce(P){!1!==i.enabled&&(0===M.length&&(i.domElement.setPointerCapture(P.pointerId),i.domElement.addEventListener("pointermove",Ae),i.domElement.addEventListener("pointerup",ze)),function fe(P){M.push(P)}(P),"touch"===P.pointerType?function G(P){switch(pe(P),M.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Te(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;ct(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Ne(){i.enableZoom&&tt(),i.enablePan&&ct()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function R(){i.enableZoom&&tt(),i.enableRotate&&Te()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(QM)}(P):function ht(P){let ie;switch(P.button){case 0:ie=i.mouseButtons.LEFT;break;case 1:ie=i.mouseButtons.MIDDLE;break;case 2:ie=i.mouseButtons.RIGHT;break;default:ie=-1}switch(ie){case 1:if(!1===i.enableZoom)return;(function U(P){X(P),m.set(P.clientX,P.clientY)})(P),s=r.DOLLY;break;case 0:if(P.ctrlKey||P.metaKey||P.shiftKey){if(!1===i.enablePan)return;q(P),s=r.PAN}else{if(!1===i.enableRotate)return;te(P),s=r.ROTATE}break;case 2:if(P.ctrlKey||P.metaKey||P.shiftKey){if(!1===i.enableRotate)return;te(P),s=r.ROTATE}else{if(!1===i.enablePan)return;q(P),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(QM)}(P))}function Ae(P){!1!==i.enabled&&("touch"===P.pointerType?function ue(P){switch(pe(P),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;ge(P),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;ne(P),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function re(P){i.enableZoom&&de(P),i.enablePan&&ne(P)})(P),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function Fe(P){i.enableZoom&&de(P),i.enableRotate&&ge(P)})(P),i.update();break;default:s=r.NONE}}(P):function qt(P){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function ae(P){d.set(P.clientX,P.clientY),f.subVectors(d,h).multiplyScalar(i.rotateSpeed);const ie=i.domElement;O(2*Math.PI*f.x/ie.clientHeight),B(2*Math.PI*f.y/ie.clientHeight),h.copy(d),i.update()}(P);break;case r.DOLLY:if(!1===i.enableZoom)return;!function oe(P){v.set(P.clientX,P.clientY),y.subVectors(v,m),y.y>0?W(C()):y.y<0&&H(C()),m.copy(v),i.update()}(P);break;case r.PAN:if(!1===i.enablePan)return;!function le(P){g.set(P.clientX,P.clientY),_.subVectors(g,p).multiplyScalar(i.panSpeed),k(_.x,_.y),p.copy(g),i.update()}(P)}}(P))}function ze(P){(function Oe(P){delete E[P.pointerId];for(let ie=0;ie<M.length;ie++)if(M[ie].pointerId==P.pointerId)return void M.splice(ie,1)})(P),0===M.length&&(i.domElement.releasePointerCapture(P.pointerId),i.domElement.removeEventListener("pointermove",Ae),i.domElement.removeEventListener("pointerup",ze)),i.dispatchEvent(ZF),s=r.NONE}function I(P){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(P.preventDefault(),i.dispatchEvent(QM),function Ee(P){X(P),P.deltaY<0?H(C()):P.deltaY>0&&W(C()),i.update()}(P),i.dispatchEvent(ZF))}function T(P){!1===i.enabled||!1===i.enablePan||function Pe(P){let ie=!1;switch(P.code){case i.keys.UP:P.ctrlKey||P.metaKey||P.shiftKey?B(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):k(0,i.keyPanSpeed),ie=!0;break;case i.keys.BOTTOM:P.ctrlKey||P.metaKey||P.shiftKey?B(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):k(0,-i.keyPanSpeed),ie=!0;break;case i.keys.LEFT:P.ctrlKey||P.metaKey||P.shiftKey?O(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):k(i.keyPanSpeed,0),ie=!0;break;case i.keys.RIGHT:P.ctrlKey||P.metaKey||P.shiftKey?O(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):k(-i.keyPanSpeed,0),ie=!0}ie&&(P.preventDefault(),i.update())}(P)}function se(P){!1!==i.enabled&&P.preventDefault()}function pe(P){let ie=E[P.pointerId];void 0===ie&&(ie=new J,E[P.pointerId]=ie),ie.set(P.pageX,P.pageY)}function j(P){return E[(P.pointerId===M[0].pointerId?M[1]:M[0]).pointerId]}i.domElement.addEventListener("contextmenu",se),i.domElement.addEventListener("pointerdown",Ce),i.domElement.addEventListener("pointercancel",ze),i.domElement.addEventListener("wheel",I,{passive:!1}),this.update()}}let vie=(()=>{var n;class e{constructor(i){this.debug=i,this.raycaster=new _M,this.tempMatrix=new Ve,this.workingMatrix=new Ve,this.workingVector=new A,this.origin=new A,this.userData={selectPressed:!1}}createControls(i){if(this.renderer=i.renderer,"orbit"===i.type)return this.createOrbitControls(i);"immersive-vr"===i.xrMode&&this.createControllers()}createOrbitControls(i){return this.controls=new _ie(i.camera,i.canvas),this.controls.target.set(0,1.6,0),this.controls.enableDamping=!0,this.controls.dampingFactor=.001,this.controls.panSpeed=1,this.controls.rotateSpeed=.8,this.controls.minDistance=i.minDistance||.1,this.controls.maxDistance=i.maxDistance||200,this.controls.minPolarAngle=Math.PI/2,this.controls.maxPolarAngle=Math.PI/2,this.controls.screenSpacePanning=!1,this.controls.zoomSpeed=.5,this.controls.listenToKeyEvents(window),this.controls.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.controls.touches={ONE:0,TWO:2},this.debug.addToDebug({obj:this.controls,name:"Orbit Controls",properties:{panSpeed:{min:0,max:1,precision:.001},rotateSpeed:{min:0,max:1,precision:.001},zoomSpeed:{min:0,max:1,precision:.001}}}),this.controls}createControllers(){this.controls.dispose()}handleControllers(i,r){this.controllers?.userData.selectPressed&&console.log("Select Pressed ")}updateControls(){}get selectPressed(){return void 0!==this.controllers&&this.controllers[0].userData.selectPressed||this.controllers[1].userData.selectPressed}getControllerIntersections(i,r){return console.log("getIntersections controller ",i),i.updateMatrixWorld(),this.tempMatrix.identity().extractRotation(i.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(i.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(this.tempMatrix),this.raycaster.intersectObjects(r,!1)}onPinchEndLeft(i){console.log("Pinch end Left ",i)}onPinchEndRight(i){console.log("Pinch end Right ",i)}onPinchStartLeft(i){console.log("Pinch start Left ",i)}onPinchStartRight(i){console.log("Pinch start Right ",i)}onSelectStart(i){console.log("SelectStart controller service  ",i),this.userData.selectPressed=!0}onSelectEnd(i){console.log("SelectEnd controller service  ",i),this.userData.selectPressed=!1}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Yd))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var v_=1e-6,nf=typeof Float32Array<"u"?Float32Array:Array,JF=Math.random;function QF(){var n=new nf(3);return nf!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function wie(n){var e=new nf(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function ek(n){return Math.hypot(n[0],n[1],n[2])}function xie(n,e,t){var i=new nf(3);return i[0]=n,i[1]=e,i[2]=t,i}function bie(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function Mie(n,e,t,i){return n[0]=e,n[1]=t,n[2]=i,n}function Sie(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function tk(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function nk(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}function ik(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n}function Eie(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n}function Cie(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n}function Tie(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function Aie(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function Die(n,e){return n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n}function Iie(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function Rie(n,e,t,i){return n[0]=e[0]+t[0]*i,n[1]=e[1]+t[1]*i,n[2]=e[2]+t[2]*i,n}function rk(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])}function sk(n,e){var t=e[0]-n[0],i=e[1]-n[1],r=e[2]-n[2];return t*t+i*i+r*r}function ok(n){var e=n[0],t=n[1],i=n[2];return e*e+t*t+i*i}function Pie(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function Lie(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}function Nie(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s,n}function ak(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Oie(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],c=t[2];return n[0]=r*c-s*a,n[1]=s*o-i*c,n[2]=i*a-r*o,n}function Fie(n,e,t,i){var r=e[0],s=e[1],o=e[2];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n}function kie(n,e,t,i,r,s){var o=s*s,a=o*(2*s-3)+1,c=o*(s-2)+s,l=o*(s-1),u=o*(3-2*s);return n[0]=e[0]*a+t[0]*c+i[0]*l+r[0]*u,n[1]=e[1]*a+t[1]*c+i[1]*l+r[1]*u,n[2]=e[2]*a+t[2]*c+i[2]*l+r[2]*u,n}function Uie(n,e,t,i,r,s){var o=1-s,a=o*o,c=s*s,l=a*o,u=3*s*a,h=3*c*o,d=c*s;return n[0]=e[0]*l+t[0]*u+i[0]*h+r[0]*d,n[1]=e[1]*l+t[1]*u+i[1]*h+r[1]*d,n[2]=e[2]*l+t[2]*u+i[2]*h+r[2]*d,n}function Bie(n,e){e=e||1;var t=2*JF()*Math.PI,i=2*JF()-1,r=Math.sqrt(1-i*i)*e;return n[0]=Math.cos(t)*r,n[1]=Math.sin(t)*r,n[2]=i*e,n}function Vie(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function zie(n,e,t){var i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function Hie(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],c=e[1],l=e[2],u=r*l-s*c,h=s*a-i*l,d=i*c-r*a,f=r*d-s*h,p=s*u-i*d,g=i*h-r*u,_=2*t[3];return h*=_,d*=_,p*=2,g*=2,n[0]=a+(u*=_)+(f*=2),n[1]=c+h+p,n[2]=l+d+g,n}function Gie(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function Wie(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function jie(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function $ie(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),h=u&&ak(n,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}function Xie(n){return n[0]=0,n[1]=0,n[2]=0,n}function qie(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function Yie(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]}function Zie(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2];return Math.abs(t-s)<=v_*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(i-o)<=v_*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-a)<=v_*Math.max(1,Math.abs(r),Math.abs(a))}Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var Kie=tk,Jie=nk,Qie=ik,ere=rk,tre=sk,nre=ek,ire=ok,rre=function(){var n=QF();return function(e,t,i,r,s,o){var a,c;for(t||(t=3),i||(i=0),c=r?Math.min(r*t+i,e.length):e.length,a=i;a<c;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],s(n,n,o),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2];return e}}();class sre{static createButton(e){const t=document.createElement("button");function i(c){let l=null;function u(f){return h.apply(this,arguments)}function h(){return h=Ll(function*(f){f.addEventListener("end",d),yield e.xr.setSession(f),t.textContent="STOP XR",l=f}),h.apply(this,arguments)}function d(){l.removeEventListener("end",d),t.textContent="START XR",l=null}t.style.display="",t.style.cursor="pointer",t.style.left="calc(50% - 50px)",t.style.width="100px",t.textContent="START XR",t.onmouseenter=function(){t.style.opacity="1.0"},t.onmouseleave=function(){t.style.opacity="0.5"},t.onclick=function(){null===l?navigator.xr.requestSession(c,{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]}).then(u):l.end()}}function r(){t.style.display="",t.style.cursor="auto",t.style.left="calc(50% - 75px)",t.style.width="150px",t.onmouseenter=null,t.onmouseleave=null,t.onclick=null}function o(c){r(),console.warn("Exception when trying to call xr.isSessionSupported",c),t.textContent="XR NOT ALLOWED"}function a(c){c.style.position="absolute",c.style.bottom="20px",c.style.padding="12px 6px",c.style.border="1px solid #fff",c.style.borderRadius="4px",c.style.background="rgba(0,0,0,0.1)",c.style.color="#fff",c.style.font="normal 13px sans-serif",c.style.textAlign="center",c.style.opacity="0.5",c.style.outline="none",c.style.zIndex="999"}if("xr"in navigator)return t.id="XRButton",t.style.display="none",a(t),navigator.xr.isSessionSupported("immersive-ar").then(function(c){c?i("immersive-ar"):navigator.xr.isSessionSupported("immersive-vr").then(function(l){l?i("immersive-vr"):function s(){r(),t.textContent="XR NOT SUPPORTED"}()}).catch(o)}).catch(o),t;{const c=document.createElement("a");return!1===window.isSecureContext?(c.href=document.location.href.replace(/^http:/,"https:"),c.innerHTML="WEBXR NEEDS HTTPS"):(c.href="https://immersiveweb.dev/",c.innerHTML="WEBXR NOT AVAILABLE"),c.style.left="calc(50% - 90px)",c.style.width="180px",c.style.textDecoration="none",a(c),c}}}const an={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function ck(n){return eS.apply(this,arguments)}function eS(){return eS=Ll(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)}),eS.apply(this,arguments)}function tS(){return tS=Ll(function*(n){if(!n)throw new Error("No basePath supplied");return yield ck(`${n}/profilesList.json`)}),tS.apply(this,arguments)}function nS(){return nS=Ll(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function ore(n){return tS.apply(this,arguments)}(e);let s;if(n.profiles.some(c=>{const l=r[c];return l&&(s={profileId:c,profilePath:`${e}/${l.path}`,deprecated:!!l.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const c=r[t];if(!c)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${c.path}`,deprecated:!!c.deprecated}}const o=yield ck(s.profilePath);let a;if(i){let c;if(c="any"===n.handedness?o.layouts[Object.keys(o.layouts)[0]]:o.layouts[n.handedness],!c)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);c.assetPath&&(a=s.profilePath.replace("profile.json",c.assetPath))}return{profile:o,assetPath:a}}),nS.apply(this,arguments)}const cre={xAxis:0,yAxis:0,button:0,state:an.ComponentState.DEFAULT};class ure{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===an.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(cre)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:o}=function lre(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const o=Math.atan2(e,n);t=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case an.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case an.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?o:.5;break;case an.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case an.ComponentProperty.STATE:this.value=this.valueNodeProperty===an.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class hre{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new ure(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:an.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=an.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=an.ComponentState.PRESSED:(t.touched||this.values.button>an.ButtonTouchThreshold)&&(this.values.state=an.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===an.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>an.AxisTouchThreshold&&(this.values.state=an.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===an.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>an.AxisTouchThreshold&&(this.values.state=an.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class dre{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new hre(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class mre extends sn{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:o,value:a,valueNodeProperty:c}=i;r&&(c===an.VisualResponseProperty.VISIBILITY?r.visible=a:c===an.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,o.quaternion,a),r.position.lerpVectors(s.position,o.position,a)))})}))}}function lk(n,e){(function gre(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===an.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const o=new Za(.001),a=new wn({color:255}),c=new xt(o,a);t.touchPointNode.add(c)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(o=>{const{valueNodeName:a,minNodeName:c,maxNodeName:l,valueNodeProperty:u}=o;if(u===an.VisualResponseProperty.TRANSFORM){if(o.minNode=e.getObjectByName(c),o.maxNode=e.getObjectByName(l),!o.minNode)return void console.warn(`Could not find ${c} in the model`);if(!o.maxNode)return void console.warn(`Could not find ${l} in the model`)}o.valueNode=e.getObjectByName(a),o.valueNode||console.warn(`Could not find ${a} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class _re{constructor(e=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new uF)}createControllerModel(e){const t=new mre;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function are(n,e){return nS.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:o,assetPath:a})=>{t.motionController=new dre(s,o,a);const c=this._assetCache[t.motionController.assetUrl];if(c)i=c.scene.clone(),lk(t,i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,l=>{this._assetCache[t.motionController.assetUrl]=l,i=l.scene.clone(),lk(t,i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(o=>{console.warn(o)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}let vre=(()=>{var n;class e{constructor(i){this.interactions=i,this.xrMode=Cf("inline"),this.appConfig=window.appConfig,this.vrSupported=!1,this.arSupported=!1,this.userData={isSelecting:!1}}checkXRSupport(i){return!(!this.vrSupported&&!this.arSupported)||!!navigator.xr&&(this.initXR(i),navigator.xr.isSessionSupported("immersive-vr").then(r=>{this.vrSupported=!0,this.xrMode.set("immersive-vr")}),navigator.xr.isSessionSupported("immersive-ar").then(r=>{this.arSupported=!0}),!0)}handleControllers(){}onDeviceChange(i){this.checkXRSupport()}onSessionEnd(i){}onInputSourcesChange(i){for(let r of i.added);}onSessionStart(i){i.addEventListener("end",this.onSessionEnd),i.addEventListener("inputsourceschange",this.onInputSourcesChange),i.requestReferenceSpace(i.isImmersive?"local-floor":"viewer").then(s=>{i.isImmersive&&(this.xrImmersiveRefSpace=s)})}initXR(i){this.renderer=i.renderer,this.webXRManager=i.renderer.xr,this.webXRManager.enabled=!0,navigator.xr.requestSession("inline").then(r=>{this.inlineSession=r,this.session=this.webXRManager.getSession(),console.log("Inline session starting "),this.onSessionStart(r)}),this.scene=i.scene,document.body.appendChild(sre.createButton(this.renderer)),this.session=this.webXRManager.getSession(),this.initVR(),"immersive-vr"===this.xrMode()?this.initVR():"immersive-ar"===this.xrMode()&&this.initAR()}initVR(){this.controllerLeft=this.initController(this.renderer.xr.getController(0),0),this.controllerRight=this.initController(this.renderer.xr.getController(1),1)}initController(i,r){i.addEventListener("selectstart",this.onSelectStart.bind(this)),i.addEventListener("select",this.onSelect.bind(this)),i.addEventListener("selectend",this.onSelectEnd.bind(this)),i.addEventListener("connected",l=>{let u,h;return"tracked-pointer"===(console.log("Controller connected",l.data.targetRayMode),l.data.targetRayMode)?(u=new et,u.setAttribute("position",new Re([0,0,0,0,0,-1],3)),u.setAttribute("color",new Re([.5,.5,.5,0,0,0],3)),h=new ri({vertexColors:!0,blending:2}),new ao(u,h)):(u=new yu(.02,.04,32).translate(0,0,-1),h=new wn({opacity:.5,transparent:!0}),new xt(u,h))}),i.addEventListener("disconnected",function(){console.log("Controller disconnected")});const s=new _re,o=this.renderer.xr.getControllerGrip(r);o.add(s.createControllerModel(o)),this.scene.add(o);const a=(new et).setFromPoints([new A(0,0,0),new A(0,0,-1)]),c=new ao(a);return c.name="line",c.scale.z=5,i.add(c.clone()),this.scene.add(i),i}onSqueze(i){console.log("Squuze event VR",i)}onSelectStart(i){console.log("Select Start VR event ",i),this.userData.isSelecting=!0}onSelect(i){console.log("Select VR event ",i),this.interactions.intersectObjects({controller:this.controllerLeft,scene:this.scene,select:!0}),this.interactions.intersectObjects({controller:this.controllerRight,scene:this.scene,select:!0})}onSelectEnd(i){console.log("Select End VR event ",i),this.userData.isSelecting=!1}initAR(){}updateInputSources(i=this.session,r,s,o=this.scene){let a=Iu;for(let c of i.inputSources){let l=r.getPose(c.targetRaySpace,s);if(!l)continue;"tracked-pointer"==c.targetRayMode&&o.inputRenderer.addLaserPointer(l.transform);let u=new Ha(l.transform),h=2,d=a.fromValues(u.origin.x,u.origin.y,u.origin.z);if(a.add(d,d,[u.direction.x*h,u.direction.y*h,u.direction.z*h]),o.inputRenderer.addCursor(d),c.gripSpace){let f=r.getPose(c.gripSpace,s);f&&o.inputRenderer.addController(f.transform.matrix,c.handedness)}}}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(Xd))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),yre=(()=>{var n;class e{constructor(i,r,s,o,a,c,l,u){this.cameraService=i,this.controllerService=r,this.ngZone=s,this.interactionsService=o,this.lightsService=a,this.objectsService=c,this.webXRService=l,this.debug=u,this.scene=new GO,this.renderFunctions=[],this.clock=new H2,this.width=window.innerWidth,this.height=window.innerHeight,this.pointer=new J,this.toneMappingOptions={None:Ys,Linear:sN,Reinhard:oN,Cineon:aN,ACESFilmic:Hx,Custom:cN},this.params={exposure:1,toneMapping:"ACESFilmic",blurriness:.3,intensity:1}}initScene(i,r){const s=Object.assign({},pie,r);this.canvas=i,s.camera.width=this.width,s.camera.height=this.height,this.camera=this.cameraService.createCamera(s.camera),this.dolly=this.cameraService.addDolly(),this.scene.add(this.dolly),this.scene.background=s.background||new Y("skyblue"),s.fog&&(this.scene.fog=new Mg(s.fog.color,s.fog.near,s.fog.far)),this.renderer=new HO({canvas:i,antialias:!0,powerPreference:"high-performance",preserveDrawingBuffer:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=JL,this.renderer.toneMapping=Hx,this.renderer.toneMappingExposure=1.5,this.scene.backgroundBlurriness=.3,this.rect=this.renderer.domElement.getBoundingClientRect();const o=this.lightsService.createHemLight({intensity:.5});this.spotLights=this.lightsService.createSpotLight(),this.spotlight=this.spotLights[0],this.spotlight.position.set(0,7,1.16),this.spotlight.target.position.set(0,0,-4),this.spotlight=this.spotLights[0];const a=this.lightsService.createSpotLight();a[0].position.set(0,-2,.64),this.camera.add(a[0]),this.scene.add(...o);const c=this.objectsService.createIcosahedron({radius:.3,detail:0,material:"MeshPhysicalMaterial"});c.position.set(0,1,-10),c.material.opacity=.6,this.pointLight=this.lightsService.createPointLight(),this.pointLight.position.y=2.2,c.add(this.pointLight),this.icoLight=c,this.scene.add(this.icoLight),this.controllerService.createControls({type:"orbit",camera:this.camera,renderer:this.renderer,canvas:i}),this.renderFunctions.push(this.controllerService.updateControls),window.addEventListener("resize",this.onResize.bind(this));const u=this.interactionsService.initInteractionManager(this.renderer,this.camera,i);return this.renderFunctions.push(u),this.webXRService.checkXRSupport({renderer:this.renderer,camera:this.camera,scene:this.scene}),this.ngZone.runOutsideAngular(()=>this.renderer.setAnimationLoop(()=>this.render())),this.afterSceneInit()}createCornerLights(){this.icoLight1=this.icoLight.clone();const i=this.lightsService.createPointLight();this.icoLight1.add(i),this.icoLight1.position.set(-10,1,7.6),this.icoLight2=this.icoLight.clone(),this.icoLight2.add(i),this.icoLight2.position.set(10,1,7.6),this.scene.add(this.icoLight1,this.icoLight2),this.renderFunctions.push(this.animateLights.bind(this))}animateLights(i){this.icoLight.rotation.y+=.01,this.icoLight1.rotation.y+=.01,this.icoLight2.rotation.y+=.01}afterSceneInit(i){this.cameraService.moveCamera(0,1.6,.001,8),this.createCornerLights(),this.interactionsManager=this.interactionsService.initInteractionManager(this.renderer,this.camera,this.canvas)}onTouchStart(i){this.pointer.x=(i.touches[0].clientX-this.rect.left)/(this.rect.right-this.rect.left)*2-1,this.pointer.y=-(i.touches[0].clientY-this.rect.top)/(this.rect.bottom-this.rect.top)*2+1}onPointerDown(i){this.pointer.x=(i.clientX-this.rect.left)/(this.rect.right-this.rect.left)*2-1,this.pointer.y=-(i.clientY-this.rect.top)/(this.rect.bottom-this.rect.top)*2+1,this.interactionsService.intersectObjects({pointer:this.pointer,camera:this.camera,scene:this.scene})}render(){const i=this.clock.getDelta();this.controllerService.updateControls(),this.cameraService.updateCamera({camera:this.camera,scene:this.scene}),this.renderFunctions.forEach(r=>r(i)),this.renderer.render(this.scene,this.camera)}addToScene(i){i instanceof Array?this.scene.add(...i):this.scene.add(i)}onResize(i,r,s){console.log("Resizing ",i),r=r||window.innerWidth,s=s||window.innerHeight,this.camera.aspect=r/s,this.camera.updateProjectionMatrix(),this.renderer.setSize(r,s),this.renderer.setPixelRatio(window.devicePixelRatio)}onDeviceChange(i){}}return(n=e).\u0275fac=function(i){return new(i||n)(Se(mie),Se(vie),Se(At),Se(Xd),Se(cF),Se(aF),Se(vre),Se(Yd))},n.\u0275prov=De({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),wre=(()=>{var n;class e{constructor(){this.tweetHref="https://twitter.com/intent/tweet?text=Checkout%20Angular%20WebXR%20art%20gallery!&hashtags=Angular,WebXR,AngularSignals&url=https://webxr.art&image=assets/images/gallery.png"}onTweet(i){}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=ea({type:n,selectors:[["art-tweet"]],decls:4,vars:1,consts:[["aria-label","Tweet Angular WebXR Gallery","target","_blank","rel","noopener","data-size","large","title","Twitter","appTweet","",1,"twitter-share-button",3,"href","newTweetEvent"],["id","twitter-logo","height","24","data-name","Logo","xmlns","http://www.w3.org/2000/svg","viewBox","0 0 400 400"],["width","400","height","400","fill","none"],["d","M153.62,301.59c94.34,0,145.94-78.16,145.94-145.94,0-2.22,0-4.43-.15-6.63A104.36,104.36,0,0,0,325,122.47a102.38,102.38,0,0,1-29.46,8.07,51.47,51.47,0,0,0,22.55-28.37,102.79,102.79,0,0,1-32.57,12.45,51.34,51.34,0,0,0-87.41,46.78A145.62,145.62,0,0,1,92.4,107.81a51.33,51.33,0,0,0,15.88,68.47A50.91,50.91,0,0,1,85,169.86c0,.21,0,.43,0,.65a51.31,51.31,0,0,0,41.15,50.28,51.21,51.21,0,0,1-23.16.88,51.35,51.35,0,0,0,47.92,35.62,102.92,102.92,0,0,1-63.7,22A104.41,104.41,0,0,1,75,278.55a145.21,145.21,0,0,0,78.62,23","fill","#fff"]],template:function(i,r){1&i&&(hi(0,"a",0),nl("newTweetEvent",function(o){return r.onTweet(o)}),Af(),hi(1,"svg",1),Fs(2,"rect",2)(3,"path",3),as()()),2&i&&c0("href",r.tweetHref,ly)},styles:['[_nghost-%COMP%]{display:block;position:fixed;top:0;right:50px;z-index:1005}#twitter-logo[_ngcontent-%COMP%]{height:40px;margin:0 8px}image[_ngcontent-%COMP%]{src:"assets/images/gallery.png"}#twitter-logo[_ngcontent-%COMP%]:hover{opacity:.8}']}),e})(),xre=(()=>{var n;class e{constructor(){this.text="START XR",this.sessionMode="inline"}onClick(i){if(console.log("XR Button component Clicked "),null===this.currentSession){const r={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};navigator.xr?.requestSession(this.sessionMode,r).then(s=>this.onSessionStarted)}else this.currentSession.end()}onXRNotSupported(i){this.text="XR NOT SUPPORTED"}onSessionStarted(i){var r=this;return Ll(function*(){yield r.renderer.xr.setSession(i),r.text="STOP XR",r.currentSession=i})()}onSessionEnded(i){this.currentSession.removeEventListener("end",this.onSessionEnded),this.text="START XR",this.currentSession=null}onMouseEnter(i){}onMouseLeave(i){}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=ea({type:n,selectors:[["art-webxr-button"]],decls:2,vars:1,consts:[[3,"onmouseenter","click"]],template:function(i,r){1&i&&(hi(0,"button",0),nl("onmouseenter",function(o){return r.onMouseEnter(o)})("click",function(o){return r.onClick(o)}),il(1),as()),2&i&&(Cy(1),u0(r.text))}}),e})();const bre=["canvas"],Mre=[{path:"",component:(()=>{var n;class e{get canvasEl(){return this.canvas.nativeElement}constructor(i,r,s,o,a){this.artworksService=i,this.framesService=r,this.loadersService=s,this.sceneService=o,this.ui=a,this.artworks=[],this.artworksLength=0,this.selectedIndex=Cf(0),this.focused=0,this.info=function nB(n,e){const t=Object.create(iB);t.computation=n,e?.equal&&(t.equal=e.equal);const i=()=>{if(cE(t),aE(t),t.value===Ef)throw t.error;return t.value};return i[vo]=t,i}(()=>{this.selectedIndex()})}ngOnInit(){this.artworks=this.artworksService.getArtworks();const i=this.sceneService.initScene(this.canvasEl);this.loadersService.loadModel({path:"assets/models/VRGalleryOriginal1510Comp4.glb",scene:this.sceneService.scene}),this.buttons=[{name:"Next Button",text:"Next",onClick:s=>{this.changeSelection(s,1)},position:{x:-.75,y:0,z:-0},rotation:{}},{name:"Upvote Button",text:"Upvote",onClick:s=>{this.upvoteSelection(s)},position:{x:-.8,y:.8,z:-.1},rotation:{}},{name:"Previous Button",text:"Previous",onClick:s=>{this.changeSelection(s,-1)},position:{x:.75,y:0,z:-0},rotation:{}}],this.frames=this.framesService.createFrames(this.artworks,this.buttons,i),this.sceneService.addToScene(this.frames),this.sceneService.renderFunctions.push(this.ui.update),this.artworksLength=this.artworks.length,this.selectedArtwork=Cf(this.artworks[0],{equal:this.compareSelected})}compareSelected(i,r){return!i||i.id===r.id}showInfo(i){}onSelectArtwork(i,r){this.framesService.focusFrame(this.selectedArtwork().id)}changeSelection(i,r){let s;console.log("Change selection event ",i,r),this.framesService.resetPosition(this.focused),1===r?(s=i<this.artworksLength-1?i+1:0,this.framesService.rotateFrames(72)):-1===r&&(s=0===i?this.artworksLength-1:i-1,this.framesService.rotateFrames(-72)),this.focused=s,this.framesService.focusFrame(s)}upvoteSelection(i){const s=this.frames.children[i].getObjectByName(`${i} Text`),o=this.artworksService.upvoteArtwork(i);this.ui.updateVote({votes:o,text:s})}onKeyDown(i){}onPointerDown(i){}onTouchStart(i){}onPointerMove(i){}onPointerUp(i){}onCanvasClick(i){}onObjectHover(i){}onDeviceChange(i){}onTouchEnd(i){}}return(n=e).\u0275fac=function(i){return new(i||n)(ke(_q),ke(qF),ke(_F),ke(yre),ke(XF))},n.\u0275cmp=ea({type:n,selectors:[["art-gallery"]],viewQuery:function(i,r){if(1&i&&XD(bre,7),2&i){let s;C0(s=function T0(){return function PW(n,e){return n[Yr].queries[e].queryList}(ee(),NE())}())&&(r.canvas=s.first)}},decls:4,vars:1,consts:[[3,"click","pointermove","pointerup","pointerdown","mousemove","mouseenter","touchstart","touchend","ondevicechange","resize","keydown"],["canvas",""]],template:function(i,r){if(1&i&&(Fs(0,"art-tweet"),hi(1,"canvas",0,1),nl("click",function(o){return r.onCanvasClick(o)})("pointermove",function(o){return r.onPointerMove(o)})("pointerup",function(o){return r.onPointerUp(o)})("pointerdown",function(o){return r.sceneService.onPointerDown(o)})("mousemove",function(o){return r.onPointerMove(o)})("mouseenter",function(o){return r.onObjectHover(o)})("touchstart",function(o){return r.onTouchStart(o)})("touchend",function(o){return r.onTouchEnd(o)})("ondevicechange",function(o){return r.onDeviceChange(o)})("resize",function(o){return r.sceneService.onResize(o)},!1,Vv)("keydown",function(o){return r.onKeyDown(o)},!1,Vv),as(),Fs(3,"art-webxr-button")),2&i){const s=function uD(n){return function _c(n,e){return n[e]}(function PB(){return Ge.lFrame.contextLView}(),je+n)}(2);Cy(1),Ep("aria-label",s)}},dependencies:[wre,xre],styles:["#canvas[_ngcontent-%COMP%]{width:100%;height:100%;display:block}"],changeDetection:0}),e})(),title:"WebXR Gallery"},{path:"**",component:(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=ea({type:n,selectors:[["art-error"]],decls:2,vars:0,template:function(i,r){1&i&&(hi(0,"p"),il(1,"error works!"),as())}}),e})(),title:"Error Page"}];let Sre=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=Ds({type:n}),n.\u0275inj=Xr({imports:[PP.forRoot(Mre),PP]}),e})(),Ere=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=ea({type:n,selectors:[["art-root"]],decls:15,vars:0,consts:[["role","main",1,"content"],["href","https://github.com/angular/angular","target","_blank","rel","noopener"],[1,"github-star-badge"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",1,"material-icons"],["d","M0 0h24v24H0z","fill","none"],["d","M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z","fill","#1976d2"]],template:function(i,r){1&i&&(hi(0,"div",0),Fs(1,"router-outlet"),hi(2,"footer"),il(3," Love Angular?\xa0 "),hi(4,"a",1),il(5," Give our repo a star. "),hi(6,"div",2),Af(),hi(7,"svg",3),Fs(8,"path",4)(9,"path",5),as(),il(10," Star "),as()(),function VE(){!function VB(){Ge.lFrame.currentNamespace=null}()}(),hi(11,"a",1),Af(),hi(12,"svg",3),Fs(13,"path",6)(14,"path",4),as()()()())},dependencies:[Vw],styles:['[_nghost-%COMP%] {\n    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n    font-size: 14px;\n    color: #333;\n    box-sizing: border-box;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    margin: 0;\n  }\n\n  body[_ngcontent-%COMP%] {\n    margin-top: 0;\n  }\n\n  h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%] {\n    margin: 8px 0;\n  }\n\n  p[_ngcontent-%COMP%] {\n    margin: 0;\n  }\n\n  .spacer[_ngcontent-%COMP%] {\n    flex: 1;\n  }\n\n  .toolbar[_ngcontent-%COMP%] {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 60px;\n    display: flex;\n    align-items: center;\n    background-color: #1976d2;\n    color: white;\n    font-weight: 600;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n    margin: 0 16px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #twitter-logo[_ngcontent-%COMP%] {\n    height: 40px;\n    margin: 0 8px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #youtube-logo[_ngcontent-%COMP%] {\n    height: 40px;\n    margin: 0 16px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #twitter-logo[_ngcontent-%COMP%]:hover, .toolbar[_ngcontent-%COMP%]   #youtube-logo[_ngcontent-%COMP%]:hover {\n    opacity: 0.8;\n  }\n\n  .content[_ngcontent-%COMP%] {\n    display: flex;\n    \n\n    padding: 0;\n    \n\n    flex-direction: column;\n    align-items: center;\n  }\n\n  svg.material-icons[_ngcontent-%COMP%] {\n    height: 24px;\n    width: auto;\n  }\n\n  svg.material-icons[_ngcontent-%COMP%]:not(:last-child) {\n    margin-right: 8px;\n  }\n\n\n  \n\n  @media screen and (max-width: 767px) {\n\n    .card-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.circle-link), .terminal[_ngcontent-%COMP%] {\n      width: 100%;\n    }\n\n    .card[_ngcontent-%COMP%]:not(.highlight-card) {\n      height: 16px;\n      margin: 8px 0;\n    }\n\n    .card.highlight-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n      margin-left: 72px;\n    }\n\n    svg#rocket-smoke[_ngcontent-%COMP%] {\n      right: 120px;\n      transform: rotate(-5deg);\n    }\n  }\n\n  @media screen and (max-width: 575px) {\n    svg#rocket-smoke[_ngcontent-%COMP%] {\n      display: none;\n      visibility: hidden;\n    }\n  }']}),e})(),Cre=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=Ds({type:n}),n.\u0275inj=Xr({imports:[cR]}),e})(),Tre=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=Ds({type:n}),n.\u0275inj=Xr({providers:[qF]}),e})(),Are=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=Ds({type:n,bootstrap:[Ere]}),n.\u0275inj=Xr({imports:[M6,Sre,Cre,Tre]}),e})();x6().bootstrapModule(Are).catch(n=>console.error(n))}},x_=>{x_(x_.s=392)}]);