"use strict";(self.webpackChunkangular_webxr_gallery=self.webpackChunkangular_webxr_gallery||[]).push([[179],{580:(A0,DA,D0)=>{var ad={};function IA(n,e){return Object.is(n,e)}D0.r(ad),D0.d(ad,{add:()=>Tue,angle:()=>Yue,bezier:()=>zue,ceil:()=>Aue,clone:()=>Eue,copy:()=>Mue,create:()=>CV,cross:()=>Uue,dist:()=>ihe,distance:()=>RV,div:()=>nhe,divide:()=>IV,dot:()=>LV,equals:()=>Que,exactEquals:()=>Jue,floor:()=>Due,forEach:()=>ahe,fromValues:()=>Sue,hermite:()=>Vue,inverse:()=>Fue,len:()=>she,length:()=>TV,lerp:()=>Bue,max:()=>Rue,min:()=>Iue,mul:()=>the,multiply:()=>DV,negate:()=>Oue,normalize:()=>kue,random:()=>Hue,rotateX:()=>$ue,rotateY:()=>que,rotateZ:()=>Xue,round:()=>Pue,scale:()=>Nue,scaleAndAdd:()=>Lue,set:()=>Cue,sqrDist:()=>rhe,sqrLen:()=>ohe,squaredDistance:()=>PV,squaredLength:()=>NV,str:()=>Kue,sub:()=>ehe,subtract:()=>AV,transformMat3:()=>Wue,transformMat4:()=>Gue,transformQuat:()=>jue,zero:()=>Zue});let zn=null,cd=!1,lm=1;const Xo=Symbol("SIGNAL");function dn(n){const e=zn;return zn=n,e}const I0={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function R0(n){if(cd)throw new Error("");if(null===zn)return;zn.consumerOnSignalRead(n);const e=zn.nextProducerIndex++;Cl(zn),e<zn.producerNode.length&&zn.producerNode[e]!==n&&ld(zn)&&um(zn.producerNode[e],zn.producerIndexOfThis[e]),zn.producerNode[e]!==n&&(zn.producerNode[e]=n,zn.producerIndexOfThis[e]=ld(zn)?OA(n,zn,e):0),zn.producerLastReadVersion[e]=n.version}function RA(n){if((!ld(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==lm)){if(!n.producerMustRecompute(n)&&!O0(n))return n.dirty=!1,void(n.lastCleanEpoch=lm);n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=lm}}function PA(n){if(void 0===n.liveConsumerNode)return;const e=cd;cd=!0;try{for(const t of n.liveConsumerNode)t.dirty||NA(t)}finally{cd=e}}function P0(){return!1!==zn?.consumerAllowSignalWrites}function NA(n){n.dirty=!0,PA(n),n.consumerMarkedDirty?.(n)}function N0(n){return n&&(n.nextProducerIndex=0),dn(n)}function L0(n,e){if(dn(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(ld(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)um(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function O0(n){Cl(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(RA(t),i!==t.version))return!0}return!1}function OA(n,e,t){if(FA(n),Cl(n),0===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=OA(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function um(n,e){if(FA(n),Cl(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)um(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];Cl(r),r.producerIndexOfThis[i]=e}}function ld(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Cl(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function FA(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}const F0=Symbol("UNSET"),k0=Symbol("COMPUTING"),hm=Symbol("ERRORED"),lG={...I0,value:F0,dirty:!0,error:null,equal:IA,producerMustRecompute:n=>n.value===F0||n.value===k0,producerRecomputeValue(n){if(n.value===k0)throw new Error("Detected cycle in computations.");const e=n.value;n.value=k0;const t=N0(n);let i;try{i=n.computation()}catch(r){i=hm,n.error=r}finally{L0(n,t)}e!==F0&&e!==hm&&i!==hm&&n.equal(e,i)?n.value=e:(n.value=i,n.version++)}};let kA=function uG(){throw new Error};function U0(){kA()}let B0=null;function UA(n,e){P0()||U0();const t=n.value;Object.is(t,e)||n.equal(t,e)||(n.value=e,function BA(n){n.version++,function aG(){lm++}(),PA(n),B0?.()}(n))}const pG={...I0,equal:IA,value:void 0};function Ct(n){return"function"==typeof n}function V0(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const z0=V0(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function dm(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Zi{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Ct(i))try{i()}catch(s){e=s instanceof z0?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{GA(s)}catch(o){e=e??[],o instanceof z0?e=[...e,...o.errors]:e.push(o)}}if(e)throw new z0(e)}}add(e){var t;if(e&&e!==this)if(this.closed)GA(e);else{if(e instanceof Zi){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&dm(t,e)}remove(e){const{_finalizers:t}=this;t&&dm(t,e),e instanceof Zi&&e._removeParent(this)}}Zi.EMPTY=(()=>{const n=new Zi;return n.closed=!0,n})();const zA=Zi.EMPTY;function HA(n){return n instanceof Zi||n&&"closed"in n&&Ct(n.remove)&&Ct(n.add)&&Ct(n.unsubscribe)}function GA(n){Ct(n)?n():n.unsubscribe()}const $a={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},fm={setTimeout(n,e,...t){const{delegate:i}=fm;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=fm;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function WA(n){fm.setTimeout(()=>{const{onUnhandledError:e}=$a;if(!e)throw n;e(n)})}function ud(){}const gG=H0("C",void 0,void 0);function H0(n,e,t){return{kind:n,value:e,error:t}}let qa=null;function pm(n){if($a.useDeprecatedSynchronousErrorHandling){const e=!qa;if(e&&(qa={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=qa;if(qa=null,t)throw i}}else n()}class G0 extends Zi{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,HA(e)&&e.add(this)):this.destination=EG}static create(e,t,i){return new hd(e,t,i)}next(e){this.isStopped?j0(function vG(n){return H0("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?j0(function _G(n){return H0("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?j0(gG,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const wG=Function.prototype.bind;function W0(n,e){return wG.call(n,e)}class xG{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){mm(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){mm(i)}else mm(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){mm(t)}}}class hd extends G0{constructor(e,t,i){let r;if(super(),Ct(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&$a.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&W0(e.next,s),error:e.error&&W0(e.error,s),complete:e.complete&&W0(e.complete,s)}):r=e}this.destination=new xG(r)}}function mm(n){$a.useDeprecatedSynchronousErrorHandling?function yG(n){$a.useDeprecatedSynchronousErrorHandling&&qa&&(qa.errorThrown=!0,qa.error=n)}(n):WA(n)}function j0(n,e){const{onStoppedNotification:t}=$a;t&&fm.setTimeout(()=>t(n,e))}const EG={closed:!0,next:ud,error:function bG(n){throw n},complete:ud},$0="function"==typeof Symbol&&Symbol.observable||"@@observable";function Yo(n){return n}function jA(n){return 0===n.length?Yo:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let sn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function CG(n){return n&&n instanceof G0||function MG(n){return n&&Ct(n.next)&&Ct(n.error)&&Ct(n.complete)}(n)&&HA(n)}(t)?t:new hd(t,i,r);return pm(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=$A(i))((r,s)=>{const o=new hd({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[$0](){return this}pipe(...t){return jA(t)(this)}toPromise(t){return new(t=$A(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function $A(n){var e;return null!==(e=n??$a.Promise)&&void 0!==e?e:Promise}const TG=V0(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ki=(()=>{class n extends sn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new qA(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new TG}next(t){pm(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){pm(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){pm(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?zA:(this.currentObservers=null,s.push(t),new Zi(()=>{this.currentObservers=null,dm(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new sn;return t.source=this,t}}return n.create=(e,t)=>new qA(e,t),n})();class qA extends Ki{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:zA}}function XA(n){return Ct(n?.lift)}function bn(n){return e=>{if(XA(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Rn(n,e,t,i,r){return new AG(n,e,t,i,r)}class AG extends G0{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function At(n,e){return bn((t,i)=>{let r=0;t.subscribe(Rn(i,s=>{i.next(n.call(e,s,r++))}))})}function Zo(n){return this instanceof Zo?(this.v=n,this):new Zo(n)}function JA(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Z0(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){!function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const K0=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function QA(n){return Ct(n?.then)}function e1(n){return Ct(n[$0])}function t1(n){return Symbol.asyncIterator&&Ct(n?.[Symbol.asyncIterator])}function n1(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const i1=function ZG(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function r1(n){return Ct(n?.[i1])}function s1(n){return function KA(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){i[d]&&(r[d]=function(f){return new Promise(function(p,m){s.push([d,f,p,m])>1||a(d,f)})})}function a(d,f){try{!function c(d){d.value instanceof Zo?Promise.resolve(d.value.v).then(l,u):h(s[0][2],d)}(i[d](f))}catch(p){h(s[0][3],p)}}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Zo(t.read());if(r)return yield Zo(void 0);yield yield Zo(i)}}finally{t.releaseLock()}})}function o1(n){return Ct(n?.getReader)}function Pi(n){if(n instanceof sn)return n;if(null!=n){if(e1(n))return function KG(n){return new sn(e=>{const t=n[$0]();if(Ct(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(K0(n))return function JG(n){return new sn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(QA(n))return function QG(n){return new sn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,WA)})}(n);if(t1(n))return a1(n);if(r1(n))return function e4(n){return new sn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(o1(n))return function t4(n){return a1(s1(n))}(n)}throw n1(n)}function a1(n){return new sn(e=>{(function n4(n,e){var t,i,r,s;return function YA(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,c)}l((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=JA(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function oo(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Zn(n,e,t=1/0){return Ct(e)?Zn((i,r)=>At((s,o)=>e(i,s,r,o))(Pi(n(i,r))),t):("number"==typeof e&&(t=e),bn((i,r)=>function i4(n,e,t,i,r,s,o,a){const c=[];let l=0,u=0,h=!1;const d=()=>{h&&!c.length&&!l&&e.complete()},f=m=>l<i?p(m):c.push(m),p=m=>{s&&e.next(m),l++;let _=!1;Pi(t(m,u++)).subscribe(Rn(e,g=>{r?.(g),s?f(g):e.next(g)},()=>{_=!0},void 0,()=>{if(_)try{for(l--;c.length&&l<i;){const g=c.shift();o?oo(e,o,()=>p(g)):p(g)}d()}catch(g){e.error(g)}}))};return n.subscribe(Rn(e,f,()=>{h=!0,d()})),()=>{a?.()}}(i,r,n,t)))}function Tl(n=1/0){return Zn(Yo,n)}const Cs=new sn(n=>n.complete());function c1(n){return n&&Ct(n.schedule)}function J0(n){return n[n.length-1]}function dd(n){return c1(J0(n))?n.pop():void 0}function l1(n,e=0){return bn((t,i)=>{t.subscribe(Rn(i,r=>oo(i,n,()=>i.next(r),e),()=>oo(i,n,()=>i.complete(),e),r=>oo(i,n,()=>i.error(r),e)))})}function u1(n,e=0){return bn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function h1(n,e){if(!n)throw new Error("Iterable cannot be null");return new sn(t=>{oo(t,e,()=>{const i=n[Symbol.asyncIterator]();oo(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Kn(n,e){return e?function d4(n,e){if(null!=n){if(e1(n))return function a4(n,e){return Pi(n).pipe(u1(e),l1(e))}(n,e);if(K0(n))return function l4(n,e){return new sn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(QA(n))return function c4(n,e){return Pi(n).pipe(u1(e),l1(e))}(n,e);if(t1(n))return h1(n,e);if(r1(n))return function u4(n,e){return new sn(t=>{let i;return oo(t,e,()=>{i=n[i1](),oo(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Ct(i?.return)&&i.return()})}(n,e);if(o1(n))return function h4(n,e){return h1(s1(n),e)}(n,e)}throw n1(n)}(n,e):Pi(n)}function Q0(...n){const e=dd(n),t=function o4(n,e){return"number"==typeof J0(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Pi(i[0]):Tl(t)(Kn(i,e)):Cs}class Wr extends Ki{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Xe(...n){return Kn(n,dd(n))}function d1(n={}){const{connector:e=(()=>new Ki),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,c,l=0,u=!1,h=!1;const d=()=>{a?.unsubscribe(),a=void 0},f=()=>{d(),o=c=void 0,u=h=!1},p=()=>{const m=o;f(),m?.unsubscribe()};return bn((m,_)=>{l++,!h&&!u&&d();const g=c=c??e();_.add(()=>{l--,0===l&&!h&&!u&&(a=ew(p,r))}),g.subscribe(_),!o&&l>0&&(o=new hd({next:v=>g.next(v),error:v=>{h=!0,d(),a=ew(f,t,v),g.error(v)},complete:()=>{u=!0,d(),a=ew(f,i),g.complete()}}),Pi(m).subscribe(o))})(s)}}function ew(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new hd({next:()=>{i.unsubscribe(),n()}});return Pi(e(...t)).subscribe(i)}function Ni(n,e){return bn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Rn(i,c=>{r?.unsubscribe();let l=0;const u=s++;Pi(n(c,u)).subscribe(r=Rn(i,h=>i.next(e?e(c,h,u,l++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function p4(n,e){return n===e}function Ft(n){for(let e in n)if(n[e]===Ft)return e;throw Error("Could not find renamed property on target object.")}function Pn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Pn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function tw(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const m4=Ft({__forward_ref__:Ft});function nw(n){return n.__forward_ref__=nw,n.toString=function(){return Pn(this())},n}function Ze(n){return _m(n)?n():n}function _m(n){return"function"==typeof n&&n.hasOwnProperty(m4)&&n.__forward_ref__===nw}function iw(n){return n&&!!n.\u0275providers}const f1="https://g.co/ng/security#xss";class ce extends Error{constructor(e,t){super(function Al(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}const fd=Ft({\u0275cmp:Ft}),rw=Ft({\u0275dir:Ft}),sw=Ft({\u0275pipe:Ft}),p1=Ft({\u0275mod:Ft}),ao=Ft({\u0275fac:Ft}),pd=Ft({__NG_ELEMENT_ID__:Ft}),m1=Ft({__NG_ENV_ID__:Ft});function tt(n){return"string"==typeof n?n:null==n?"":String(n)}function ow(n,e){throw new ce(-201,!1)}function Ji(n,e){null==n&&function Ke(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ae(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function us(n){return{providers:n.providers||[],imports:n.imports||[]}}function vm(n){return g1(n,wm)||g1(n,_1)}function g1(n,e){return n.hasOwnProperty(e)?n[e]:null}function ym(n){return n&&(n.hasOwnProperty(aw)||n.hasOwnProperty(S4))?n[aw]:null}const wm=Ft({\u0275prov:Ft}),aw=Ft({\u0275inj:Ft}),_1=Ft({ngInjectableDef:Ft}),S4=Ft({ngInjectorDef:Ft});var yt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(yt||{});let cw;function v1(){return cw}function Qi(n){const e=cw;return cw=n,e}function y1(n,e,t){const i=vm(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&yt.Optional?null:void 0!==e?e:void ow(Pn(n))}const Xt=globalThis;class Ne{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ae({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const md={},fw="__NG_DI_FLAG__",xm="ngTempTokenPath",T4=/\n/gm,x1="__source";let Dl;function Jo(n){const e=Dl;return Dl=n,e}function I4(n,e=yt.Default){if(void 0===Dl)throw new ce(-203,!1);return null===Dl?y1(n,void 0,e):Dl.get(n,e&yt.Optional?null:void 0,e)}function we(n,e=yt.Default){return(v1()||I4)(Ze(n),e)}function ve(n,e=yt.Default){return we(n,bm(e))}function bm(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function pw(n){const e=[];for(let t=0;t<n.length;t++){const i=Ze(n[t]);if(Array.isArray(i)){if(0===i.length)throw new ce(900,!1);let r,s=yt.Default;for(let o=0;o<i.length;o++){const a=i[o],c=R4(a);"number"==typeof c?-1===c?r=a.token:s|=c:r=a}e.push(we(r,s))}else e.push(we(i))}return e}function gd(n,e){return n[fw]=e,n.prototype[fw]=e,n}function R4(n){return n[fw]}function co(n){return{toString:n}.toString()}var Em=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Em||{}),hs=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(hs||{});const Ts={},Dt=[];function E1(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}function mw(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];M1(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function S1(n){return 3===n||4===n||6===n}function M1(n){return 64===n.charCodeAt(0)}function _d(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||C1(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function C1(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const T1="ng-template";function L4(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==E1(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function A1(n){return 4===n.type&&n.value!==T1}function O4(n,e,t){return e===(4!==n.type||t?n.value:T1)}function F4(n,e,t){let i=4;const r=n.attrs||[],s=function B4(n){for(let e=0;e<n.length;e++)if(S1(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&i){if(i=2|1&i,""!==c&&!O4(n,c,t)||""===c&&1===e.length){if(ds(i))return!1;o=!0}}else{const l=8&i?c:e[++a];if(8&i&&null!==n.attrs){if(!L4(n.attrs,l,t)){if(ds(i))return!1;o=!0}continue}const h=k4(8&i?"class":c,r,A1(n),t);if(-1===h){if(ds(i))return!1;o=!0;continue}if(""!==l){let d;d=h>s?"":r[h+1].toLowerCase();const f=8&i?d:null;if(f&&-1!==E1(f,l,0)||2&i&&l!==d){if(ds(i))return!1;o=!0}}}}else{if(!o&&!ds(i)&&!ds(c))return!1;if(o&&ds(c))continue;o=!1,i=c|1&i}}return ds(i)||o}function ds(n){return 0==(1&n)}function k4(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function V4(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function D1(n,e,t=!1){for(let i=0;i<e.length;i++)if(F4(n,e[i],t))return!0;return!1}function I1(n,e){return n?":not("+e.trim()+")":e}function H4(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!ds(o)&&(e+=I1(s,r),r=""),i=o,s=s||!ds(i);t++}return""!==r&&(e+=I1(s,r)),e}function Xa(n){return co(()=>{const e=P1(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Em.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||hs.Emulated,styles:n.styles||Dt,_:null,schemas:n.schemas||null,tView:null,id:""};N1(t);const i=n.dependencies;return t.directiveDefs=Sm(i,!1),t.pipeDefs=Sm(i,!0),t.id=function X4(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function j4(n){return ft(n)||Hn(n)}function $4(n){return null!==n}function As(n){return co(()=>({type:n.type,bootstrap:n.bootstrap||Dt,declarations:n.declarations||Dt,imports:n.imports||Dt,exports:n.exports||Dt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function R1(n,e){if(null==n)return Ts;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function Li(n){return co(()=>{const e=P1(n);return N1(e),e})}function ft(n){return n[fd]||null}function Hn(n){return n[rw]||null}function ci(n){return n[sw]||null}function gi(n,e){const t=n[p1]||null;if(!t&&!0===e)throw new Error(`Type ${Pn(n)} does not have '\u0275mod' property.`);return t}function P1(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Ts,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Dt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:R1(n.inputs,e),outputs:R1(n.outputs),debugInfo:null}}function N1(n){n.features?.forEach(e=>e(n))}function Sm(n,e){if(!n)return null;const t=e?ci:j4;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter($4)}const fn=0,le=1,$e=2,rn=3,fs=4,_i=5,Ds=6,Il=7,Ht=8,Oi=9,Rl=10,nt=11,vd=12,L1=13,Pl=14,on=15,yd=16,Nl=17,Is=18,wd=19,O1=20,ea=21,Mm=22,Ya=23,it=25,gw=1,Rs=7,Ll=9,En=10;var Ol=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n[n.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",n}(Ol||{});function li(n){return Array.isArray(n)&&"object"==typeof n[gw]}function Jn(n){return Array.isArray(n)&&!0===n[gw]}function _w(n){return 0!=(4&n.flags)}function Za(n){return n.componentOffset>-1}function Tm(n){return 1==(1&n.flags)}function ps(n){return!!n.template}function vw(n){return 0!=(512&n[$e])}function Ka(n,e){return n.hasOwnProperty(ao)?n[ao]:null}class J4{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ja(){return B1}function B1(n){return n.type.prototype.ngOnChanges&&(n.setInput=e5),Q4}function Q4(){const n=z1(this),e=n?.current;if(e){const t=n.previous;if(t===Ts)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function e5(n,e,t,i){const r=this.declaredInputs[t],s=z1(n)||function t5(n,e){return n[V1]=e}(n,{previous:Ts,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[r];o[r]=new J4(c&&c.currentValue,e,a===Ts),n[i]=e}Ja.ngInherit=!0;const V1="__ngSimpleChanges__";function z1(n){return n[V1]||null}const Ps=function(n,e,t){};function Yt(n){for(;Array.isArray(n);)n=n[fn];return n}function Fi(n,e){return Yt(e[n.index])}function Ed(n,e){return n.data[e]}function wr(n,e){const t=e[n];return li(t)?t:t[fn]}function Ew(n){return 128==(128&n[$e])}function Ns(n,e){return null==e?null:n[e]}function W1(n){n[Nl]=0}function o5(n){1024&n[$e]||(n[$e]|=1024,Ew(n)&&Am(n))}function $1(n){return 9216&n[$e]||n[Ya]?.dirty}function q1(n){$1(n)&&Am(n)}function Am(n){let e=n[rn];for(;null!==e&&!(Jn(e)&&e[$e]&Ol.HasChildViewsToRefresh||li(e)&&8192&e[$e]);){if(Jn(e))e[$e]|=Ol.HasChildViewsToRefresh;else if(e[$e]|=8192,!Ew(e))break;e=e[rn]}}function Dm(n,e){if(256==(256&n[$e]))throw new ce(911,!1);null===n[ea]&&(n[ea]=[]),n[ea].push(e)}const Je={lFrame:iD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Y1(){return Je.bindingsEnabled}function X(){return Je.lFrame.lView}function Et(){return Je.lFrame.tView}function Ut(){let n=Z1();for(;null!==n&&64===n.type;)n=n.parent;return n}function Z1(){return Je.lFrame.currentTNode}function Ls(n,e){const t=Je.lFrame;t.currentTNode=n,t.isParent=e}function Mw(){return Je.lFrame.isParent}function Os(){return Je.lFrame.bindingIndex++}function y5(n,e){const t=Je.lFrame;t.bindingIndex=t.bindingRootIndex=n,Tw(e)}function Tw(n){Je.lFrame.currentDirectiveIndex=n}function eD(){return Je.lFrame.currentQueryIndex}function Dw(n){Je.lFrame.currentQueryIndex=n}function x5(n){const e=n[le];return 2===e.type?e.declTNode:1===e.type?n[_i]:null}function tD(n,e,t){if(t&yt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&yt.Host||(r=x5(s),null===r||(s=s[Pl],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Je.lFrame=nD();return i.currentTNode=e,i.lView=n,!0}function Iw(n){const e=nD(),t=n[le];Je.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function nD(){const n=Je.lFrame,e=null===n?null:n.child;return null===e?iD(n):e}function iD(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function rD(){const n=Je.lFrame;return Je.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const sD=rD;function Rw(){const n=rD();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function vi(){return Je.lFrame.selectedIndex}function Qa(n){Je.lFrame.selectedIndex=n}function en(){const n=Je.lFrame;return Ed(n.tView,n.selectedIndex)}let cD=!0;function Im(){return cD}function ta(n){cD=n}function Rm(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function Pm(n,e,t){lD(n,e,3,t)}function Nm(n,e,t,i){(3&n[$e])===t&&lD(n,e,t,i)}function Pw(n,e){let t=n[$e];(3&t)===e&&(t&=16383,t+=1,n[$e]=t)}function lD(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let c=void 0!==i?65535&n[Nl]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=i&&a>=i)break}else e[c]<0&&(n[Nl]+=65536),(a<s||-1==s)&&(T5(n,t,e,c),n[Nl]=(4294901760&n[Nl])+c+2),c++}function uD(n,e){Ps(4,n,e);const t=dn(null);try{e.call(n)}finally{dn(t),Ps(5,n,e)}}function T5(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[$e]>>14<n[Nl]>>16&&(3&n[$e])===e&&(n[$e]+=16384,uD(a,s)):uD(a,s)}const Ul=-1;class Md{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Lw(n){return n!==Ul}function Cd(n){return 32767&n}function Td(n,e){let t=function P5(n){return n>>16}(n),i=e;for(;t>0;)i=i[Pl],t--;return i}let Ow=!0;function Lm(n){const e=Ow;return Ow=n,e}const hD=255,dD=5;let N5=0;const Fs={};function Om(n,e){const t=fD(n,e);if(-1!==t)return t;const i=e[le];i.firstCreatePass&&(n.injectorIndex=e.length,Fw(i.data,n),Fw(e,null),Fw(i.blueprint,null));const r=Fm(n,e),s=n.injectorIndex;if(Lw(r)){const o=Cd(r),a=Td(r,e),c=a[le].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function Fw(n,e){n.push(0,0,0,0,0,0,0,0,e)}function fD(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Fm(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=wD(r),null===i)return Ul;if(t++,r=r[Pl],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Ul}function kw(n,e,t){!function L5(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(pd)&&(i=t[pd]),null==i&&(i=t[pd]=N5++);const r=i&hD;e.data[n+(r>>dD)]|=1<<r}(n,e,t)}function pD(n,e,t){if(t&yt.Optional||void 0!==n)return n;ow()}function mD(n,e,t,i){if(t&yt.Optional&&void 0===i&&(i=null),!(t&(yt.Self|yt.Host))){const r=n[Oi],s=Qi(void 0);try{return r?r.get(e,i,t&yt.Optional):y1(e,i,t&yt.Optional)}finally{Qi(s)}}return pD(i,0,t)}function gD(n,e,t,i=yt.Default,r){if(null!==n){if(2048&e[$e]&&!(i&yt.Self)){const o=function B5(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[$e]&&!(512&o[$e]);){const a=_D(s,o,t,i|yt.Self,Fs);if(a!==Fs)return a;let c=s.parent;if(!c){const l=o[O1];if(l){const u=l.get(t,Fs,i);if(u!==Fs)return u}c=wD(o),o=o[Pl]}s=c}return r}(n,e,t,i,Fs);if(o!==Fs)return o}const s=_D(n,e,t,i,Fs);if(s!==Fs)return s}return mD(e,t,i,r)}function _D(n,e,t,i,r){const s=function k5(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(pd)?n[pd]:void 0;return"number"==typeof e?e>=0?e&hD:U5:e}(t);if("function"==typeof s){if(!tD(e,n,i))return i&yt.Host?pD(r,0,i):mD(e,t,i,r);try{let o;if(o=s(i),null!=o||i&yt.Optional)return o;ow()}finally{sD()}}else if("number"==typeof s){let o=null,a=fD(n,e),c=Ul,l=i&yt.Host?e[on][_i]:null;for((-1===a||i&yt.SkipSelf)&&(c=-1===a?Fm(n,e):e[a+8],c!==Ul&&yD(i,!1)?(o=e[le],a=Cd(c),e=Td(c,e)):a=-1);-1!==a;){const u=e[le];if(vD(s,a,u.data)){const h=F5(a,e,t,o,i,l);if(h!==Fs)return h}c=e[a+8],c!==Ul&&yD(i,e[le].data[a+8]===l)&&vD(s,a,e)?(o=u,a=Cd(c),e=Td(c,e)):a=-1}}return r}function F5(n,e,t,i,r,s){const o=e[le],a=o.data[n+8],u=km(a,o,t,null==i?Za(a)&&Ow:i!=o&&0!=(3&a.type),r&yt.Host&&s===a);return null!==u?ec(e,o,u,a):Fs}function km(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,c=n.directiveStart,u=s>>20,d=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<d;f++){const p=o[f];if(f<c&&t===p||f>=c&&p.type===t)return f}if(r){const f=o[c];if(f&&ps(f)&&f.type===t)return c}return null}function ec(n,e,t,i){let r=n[t];const s=e.data;if(function A5(n){return n instanceof Md}(r)){const o=r;o.resolving&&function _4(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ce(-200,`Circular dependency in DI detected for ${n}${t}`)}(function Rt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():tt(n)}(s[t]));const a=Lm(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Qi(o.injectImpl):null;tD(n,i,yt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function C5(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=B1(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==l&&Qi(l),Lm(a),o.resolving=!1,sD()}}return r}function vD(n,e,t){return!!(t[e+(n>>dD)]&1<<n)}function yD(n,e){return!(n&yt.Self||n&yt.Host&&e)}class Gn{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return gD(this._tNode,this._lView,e,bm(i),t)}}function U5(){return new Gn(Ut(),X())}function Uw(n){return co(()=>{const e=n.prototype.constructor,t=e[ao]||Bw(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[ao]||Bw(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Bw(n){return _m(n)?()=>{const e=Bw(Ze(n));return e&&e()}:Ka(n)}function wD(n){const e=n[le],t=e.type;return 2===t?e.declTNode:1===t?n[_i]:null}const Hl="__parameters__";function Wl(n,e,t){return co(()=>{const i=function Vw(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(c,l,u){const h=c.hasOwnProperty(Hl)?c[Hl]:Object.defineProperty(c,Hl,{value:[]})[Hl];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function $l(n,e){n.forEach(t=>Array.isArray(t)?$l(t,e):e(t))}function bD(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Bm(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}const zm=gd(Wl("Optional"),8),Hm=gd(Wl("SkipSelf"),4),Yl=new Ne("ENVIRONMENT_INITIALIZER"),AD=new Ne("INJECTOR",-1),jw=new Ne("INJECTOR_DEF_TYPES");class Wm{get(e,t=md){if(t===md){const i=new Error(`NullInjectorError: No provider for ${Pn(e)}!`);throw i.name="NullInjectorError",i}return t}}function aW(...n){return{\u0275providers:DD(0,n),\u0275fromNgModule:!0}}function DD(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return $l(e,o=>{const a=o;jm(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&ID(r,s),t}function ID(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];qw(r,s=>{e(s,i)})}}function jm(n,e,t,i){if(!(n=Ze(n)))return!1;let r=null,s=ym(n);const o=!s&&ft(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const c=n.ngModule;if(s=ym(c),!s)return!1;r=c}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)jm(l,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;i.add(r);try{$l(s.imports,u=>{jm(u,e,t,i)&&(l||=[],l.push(u))})}finally{}void 0!==l&&ID(l,e)}if(!a){const l=Ka(r)||(()=>new r);e({provide:r,useFactory:l,deps:Dt},r),e({provide:jw,useValue:r,multi:!0},r),e({provide:Yl,useValue:()=>we(r),multi:!0},r)}const c=s.providers;if(null!=c&&!a){const l=n;qw(c,u=>{e(u,l)})}}}return r!==n&&void 0!==n.providers}function qw(n,e){for(let t of n)iw(t)&&(t=t.\u0275providers),Array.isArray(t)?qw(t,e):e(t)}const cW=Ft({provide:String,useValue:Ft});function Xw(n){return null!==n&&"object"==typeof n&&cW in n}function tc(n){return"function"==typeof n}const Yw=new Ne("Set Injector scope."),$m={},uW={};let Zw;function qm(){return void 0===Zw&&(Zw=new Wm),Zw}class jr{}class Zl extends jr{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Jw(e,o=>this.processProvider(o)),this.records.set(AD,Kl(void 0,this)),r.has("environment")&&this.records.set(jr,Kl(void 0,this));const s=this.records.get(Yw);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(jw,Dt,yt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=Jo(this),i=Qi(void 0);try{return e()}finally{Jo(t),Qi(i)}}get(e,t=md,i=yt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(m1))return e[m1](this);i=bm(i);const s=Jo(this),o=Qi(void 0);try{if(!(i&yt.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function mW(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ne}(e)&&vm(e);c=l&&this.injectableDefInScope(l)?Kl(Kw(e),$m):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(i&yt.Self?qm():this.parent).get(e,t=i&yt.Optional&&t===md?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[xm]=a[xm]||[]).unshift(Pn(e)),s)throw a;return function P4(n,e,t,i){const r=n[xm];throw e[x1]&&r.unshift(e[x1]),n.message=function N4(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Pn(e);if(Array.isArray(e))r=e.map(Pn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Pn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(T4,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[xm]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Qi(o),Jo(s)}}resolveInjectorInitializers(){const e=Jo(this),t=Qi(void 0);try{const r=this.get(Yl,Dt,yt.Self);for(const s of r)s()}finally{Jo(e),Qi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Pn(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ce(205,!1)}processProvider(e){let t=tc(e=Ze(e))?e:Ze(e&&e.provide);const i=function dW(n){return Xw(n)?Kl(void 0,n.useValue):Kl(function ND(n,e,t){let i;if(tc(n)){const r=Ze(n);return Ka(r)||Kw(r)}if(Xw(n))i=()=>Ze(n.useValue);else if(function PD(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...pw(n.deps||[]));else if(function RD(n){return!(!n||!n.useExisting)}(n))i=()=>we(Ze(n.useExisting));else{const r=Ze(n&&(n.useClass||n.provide));if(!function fW(n){return!!n.deps}(n))return Ka(r)||Kw(r);i=()=>new r(...pw(n.deps))}return i}(n),$m)}(e);if(tc(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Kl(void 0,$m,!0),r.factory=()=>pw(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===$m&&(t.value=uW,t.value=t.factory()),"object"==typeof t.value&&t.value&&function pW(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ze(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function Kw(n){const e=vm(n),t=null!==e?e.factory:Ka(n);if(null!==t)return t;if(n instanceof Ne)throw new ce(204,!1);if(n instanceof Function)return function hW(n){const e=n.length;if(e>0)throw function Dd(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new ce(204,!1);const t=function E4(n){return n&&(n[wm]||n[_1])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new ce(204,!1)}function Kl(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Jw(n,e){for(const t of n)Array.isArray(t)?Jw(t,e):t&&iw(t)?Jw(t.\u0275providers,e):e(t)}function nc(n,e){n instanceof Zl&&n.assertNotDestroyed();const i=Jo(n),r=Qi(void 0);try{return e()}finally{Jo(i),Qi(r)}}function kD(n,e=null,t=null,i){const r=UD(n,e,t,i);return r.resolveInjectorInitializers(),r}function UD(n,e=null,t=null,i,r=new Set){const s=[t||Dt,aW(n)];return i=i||("object"==typeof n?void 0:Pn(n)),new Zl(s,e||qm(),i||null,r)}let tx,nr=(()=>{var n;class e{static create(i,r){if(Array.isArray(i))return kD({name:""},r,i,"");{const s=i.name??"";return kD({name:s},i.parent,i.providers,s)}}}return(n=e).THROW_IF_NOT_FOUND=md,n.NULL=new Wm,n.\u0275prov=Ae({token:n,providedIn:"any",factory:()=>we(AD)}),n.__NG_ELEMENT_ID__=-1,e})();const Ym=new Ne("AppId",{providedIn:"root",factory:()=>SW}),SW="ng",VD=new Ne("Platform Initializer"),ra=new Ne("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),zD=new Ne("CSP nonce",{providedIn:"root",factory:()=>function ia(){if(void 0!==tx)return tx;if(typeof document<"u")return document;throw new ce(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function HD(n){return n.ownerDocument.defaultView}function br(n){return n instanceof Function?n():n}function Qm(n){return 128==(128&n.flags)}var aa=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(aa||{});const ox=new Map;let FW=0;const cx="__ngContext__";function yi(n,e){li(e)?(n[cx]=e[wd],function UW(n){ox.set(n[wd],n)}(e)):n[cx]=e}let lx;function ux(n,e){return lx(n,e)}function Od(n){const e=n[rn];return Jn(e)?e[rn]:e}function oI(n){return cI(n[vd])}function aI(n){return cI(n[fs])}function cI(n){for(;null!==n&&!Jn(n);)n=n[fs];return n}function Ql(n,e,t,i,r){if(null!=i){let s,o=!1;Jn(i)?s=i:li(i)&&(o=!0,i=i[fn]);const a=Yt(i);0===n&&null!==t?null==r?dI(e,t,a):ic(e,t,a,r||null,!0):1===n&&null!==t?ic(e,t,a,r||null,!0):2===n?function og(n,e,t){const i=rg(n,e);i&&function ij(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function oj(n,e,t,i,r){const s=t[Rs];s!==Yt(t)&&Ql(e,n,i,s,r);for(let a=En;a<t.length;a++){const c=t[a];Ud(c[le],c,n,e,i,s)}}(e,n,s,t,r)}}function ng(n,e,t){return n.createElement(e,t)}function uI(n,e){const t=n[Ll],i=t.indexOf(e);t.splice(i,1)}function Fd(n,e){if(n.length<=En)return;const t=En+e,i=n[t];if(i){const r=i[yd];null!==r&&r!==n&&uI(r,i),e>0&&(n[t-1][fs]=i[fs]);const s=Bm(n,En+e);!function YW(n,e){Ud(n,e,e[nt],2,null,null),e[fn]=null,e[_i]=null}(i[le],i);const o=s[Is];null!==o&&o.detachView(s[le]),i[rn]=null,i[fs]=null,i[$e]&=-129}return i}function ig(n,e){if(!(256&e[$e])){const t=e[nt];e[Ya]&&function LA(n){if(Cl(n),ld(n))for(let e=0;e<n.producerNode.length;e++)um(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}(e[Ya]),t.destroyNode&&Ud(n,e,t,3,null,null),function JW(n){let e=n[vd];if(!e)return dx(n[le],n);for(;e;){let t=null;if(li(e))t=e[vd];else{const i=e[En];i&&(t=i)}if(!t){for(;e&&!e[fs]&&e!==n;)li(e)&&dx(e[le],e),e=e[rn];null===e&&(e=n),li(e)&&dx(e[le],e),t=e&&e[fs]}e=t}}(e)}}function dx(n,e){if(!(256&e[$e])){e[$e]&=-129,e[$e]|=256,function nj(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Md)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],c=s[o+1];Ps(4,a,c);try{c.call(a)}finally{Ps(5,a,c)}}else{Ps(4,r,s);try{s.call(r)}finally{Ps(5,r,s)}}}}}(n,e),function tj(n,e){const t=n.cleanup,i=e[Il];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else t[s].call(i[t[s+1]]);null!==i&&(e[Il]=null);const r=e[ea];if(null!==r){e[ea]=null;for(let s=0;s<r.length;s++)(0,r[s])()}}(n,e),1===e[le].type&&e[nt].destroy();const t=e[yd];if(null!==t&&Jn(e[rn])){t!==e[rn]&&uI(t,e);const i=e[Is];null!==i&&i.detachView(n)}!function BW(n){ox.delete(n[wd])}(e)}}function fx(n,e,t){return function hI(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[fn];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===hs.None||s===hs.Emulated)return null}return Fi(i,t)}}(n,e.parent,t)}function ic(n,e,t,i,r){n.insertBefore(e,t,i,r)}function dI(n,e,t){n.appendChild(e,t)}function fI(n,e,t,i,r){null!==i?ic(n,e,t,i,r):dI(n,e,t)}function rg(n,e){return n.parentNode(e)}let px,gI=function mI(n,e,t){return 40&n.type?Fi(n,t):null};function sg(n,e,t,i){const r=fx(n,i,e),s=e[nt],a=function pI(n,e,t){return gI(n,e,t)}(i.parent||e[_i],i,e);if(null!=r)if(Array.isArray(t))for(let c=0;c<t.length;c++)fI(s,r,t[c],a,!1);else fI(s,r,t,a,!1);void 0!==px&&px(s,i,e,t,r)}function kd(n,e){if(null!==e){const t=e.type;if(3&t)return Fi(e,n);if(4&t)return mx(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return kd(n,i);{const r=n[e.index];return Jn(r)?mx(-1,r):Yt(r)}}if(32&t)return ux(e,n)()||Yt(n[e.index]);{const i=vI(n,e);return null!==i?Array.isArray(i)?i[0]:kd(Od(n[on]),i):kd(n,e.next)}}return null}function vI(n,e){return null!==e?n[on][_i].projection[e.projection]:null}function mx(n,e){const t=En+n+1;if(t<e.length){const i=e[t],r=i[le].firstChild;if(null!==r)return kd(i,r)}return e[Rs]}function gx(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],c=t.type;if(o&&0===e&&(a&&yi(Yt(a),i),t.flags|=2),32!=(32&t.flags))if(8&c)gx(n,e,t.child,i,r,s,!1),Ql(e,n,r,a,s);else if(32&c){const l=ux(t,i);let u;for(;u=l();)Ql(e,n,r,u,s);Ql(e,n,r,a,s)}else 16&c?wI(n,e,i,t,r,s):Ql(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Ud(n,e,t,i,r,s){gx(t,i,n.firstChild,e,r,s,!1)}function wI(n,e,t,i,r,s){const o=t[on],c=o[_i].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)Ql(e,n,r,c[l],s);else{let l=c;const u=o[rn];Qm(i)&&(l.flags|=128),gx(n,e,l,u,r,s,!0)}}function xI(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function bI(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&mw(n,e,i),null!==r&&xI(n,e,r),null!==s&&function cj(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}class CI{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${f1})`}}const xj=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var tu=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(tu||{});function Ex(n){const e=function zd(){const n=X();return n&&n[Rl].sanitizer}();return e?e.sanitize(tu.URL,n)||"":function Bd(n,e){const t=function _j(n){return n instanceof CI&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${f1})`)}return t===e}(n,"URL")?function ca(n){return n instanceof CI?n.changingThisBreaksApplicationSecurity:n}(n):function yx(n){return(n=String(n)).match(xj)?n:"unsafe:"+n}(tt(n))}let OI=(n,e,t)=>null;function Rx(n,e,t=!1){return OI(n,e,t)}class Hj{}class UI{}class Wj{resolveComponentFactory(e){throw function Gj(n){const e=Error(`No component factory found for ${Pn(n)}.`);return e.ngComponent=n,e}(e)}}let mg=(()=>{class e{}return e.NULL=new Wj,e})();function jj(){return ru(Ut(),X())}function ru(n,e){return new la(Fi(n,e))}let la=(()=>{class e{constructor(i){this.nativeElement=i}}return e.__NG_ELEMENT_ID__=jj,e})();function $j(n){return n instanceof la?n.nativeElement:n}class VI{}let Xj=(()=>{var n;class e{}return(n=e).\u0275prov=Ae({token:n,providedIn:"root",factory:()=>null}),e})();class _g{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Yj=new _g("17.1.0-next.2"),Lx={};function rc(n,e){const t=function dG(n){const e=Object.create(pG);e.value=n;const t=()=>(R0(e),e.value);return t[Xo]=e,t}(n),i=t[Xo];return e?.equal&&(i.equal=e.equal),t.set=r=>UA(i,r),t.update=r=>function fG(n,e){P0()||U0(),UA(n,e(n.value))}(i,r),t.asReadonly=Kj.bind(t),t}function Kj(){const n=this[Xo];if(void 0===n.readonlyFn){const e=()=>this();e[Xo]=n,n.readonlyFn=e}return n.readonlyFn}function jd(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];null!==s&&i.push(Yt(s)),Jn(s)&&XI(s,i);const o=t.type;if(8&o)jd(n,e,t.child,i);else if(32&o){const a=ux(t,e);let c;for(;c=a();)i.push(c)}else if(16&o){const a=vI(e,t);if(Array.isArray(a))i.push(...a);else{const c=Od(e[on]);jd(c[le],c,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function XI(n,e){for(let t=En;t<n.length;t++){const i=n[t],r=i[le].firstChild;null!==r&&jd(i[le],i,r,e)}n[Rs]!==n[fn]&&e.push(n[Rs])}let YI=[];const u$={...I0,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Am(n.lView)},consumerOnSignalRead(){this.lView[Ya]=this}};function Fx(n){return n.ngOriginalError}class fo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Fx(e);for(;t&&Fx(t);)t=Fx(t);return t||null}}const JI=new Ne("",{providedIn:"root",factory:()=>!1}),st={};function xg(n){nR(Et(),X(),vi()+n,!1)}function nR(n,e,t,i){if(!i)if(3==(3&e[$e])){const s=n.preOrderCheckHooks;null!==s&&Pm(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Nm(e,s,0,t)}Qa(t)}function Ue(n,e=yt.Default){const t=X();return null===t?we(n,e):gD(Ut(),t,Ze(n),e)}function bg(n,e,t,i,r,s,o,a,c,l,u){const h=e.blueprint.slice();return h[fn]=r,h[$e]=140|i,(null!==l||n&&2048&n[$e])&&(h[$e]|=2048),W1(h),h[rn]=h[Pl]=n,h[Ht]=t,h[Rl]=o||n&&n[Rl],h[nt]=a||n&&n[nt],h[Oi]=c||n&&n[Oi]||null,h[_i]=s,h[wd]=function kW(){return FW++}(),h[Ds]=u,h[O1]=l,h[on]=2==e.type?n[on]:h,h}function su(n,e,t,i,r){let s=n.data[e];if(null===s)s=function kx(n,e,t,i,r){const s=Z1(),o=Mw(),c=n.data[e]=function E$(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return function kl(){return null!==Je.skipHydrationRootTNode}()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}(n,e,t,i,r),function v5(){return Je.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Sd(){const n=Je.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Ls(s,!0),s}function $d(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function rR(n,e,t,i,r){const s=vi(),o=2&i;try{Qa(-1),o&&e.length>it&&nR(n,e,it,!1),Ps(o?2:0,r),t(i,r)}finally{Qa(s),Ps(o?3:1,r)}}function Ux(n,e,t){if(_w(e)){const i=dn(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{dn(i)}}}function Bx(n,e,t){Y1()&&(function I$(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Za(t)&&function k$(n,e,t){const i=Fi(e,n),r=sR(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=Eg(n,bg(n,r,null,o,i,e,null,n[Rl].rendererFactory.createRenderer(i,t),null,null,null));n[e.index]=a}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Om(t,e),yi(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const c=n.data[a],l=ec(e,n,a,t);yi(l,e),null!==o&&U$(0,a-r,l,c,0,o),ps(c)&&(wr(t.index,e)[Ht]=ec(e,n,a,t))}}(n,e,t,Fi(t,e)),64==(64&t.flags)&&uR(n,e,t))}function Vx(n,e,t=Fi){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function sR(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=zx(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function zx(n,e,t,i,r,s,o,a,c,l,u){const h=it+i,d=h+r,f=function _$(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:st);return t}(h,d),p="function"==typeof l?l():l;return f[le]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}let oR=n=>null;function aR(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?cR(t,e,r,s):i.hasOwnProperty(r)&&cR(t,e,i[r],s)}return t}function cR(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function Er(n,e,t,i,r,s,o,a){const c=Fi(e,t);let u,l=e.inputs;!a&&null!=l&&(u=l[i])?($x(n,t,u,i,r),Za(e)&&function C$(n,e){const t=wr(e,n);16&t[$e]||(t[$e]|=64)}(t,e.index)):3&e.type&&(i=function M$(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(c,i,r))}function Hx(n,e,t,i){if(Y1()){const r=null===i?null:{"":-1},s=function P$(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(D1(e,o.selectors,!1))if(i||(i=[]),ps(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),Gx(n,e,a.length)}else i.unshift(o),Gx(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&lR(n,e,t,o,r,a),r&&function N$(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new ce(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=_d(t.mergedAttrs,t.attrs)}function lR(n,e,t,i,r,s){for(let l=0;l<i.length;l++)kw(Om(t,e),n,i[l].type);!function O$(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let l=0;l<i.length;l++){const u=i[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=$d(n,e,i.length,null);for(let l=0;l<i.length;l++){const u=i[l];t.mergedAttrs=_d(t.mergedAttrs,u.hostAttrs),F$(n,t,e,c,u),L$(c,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const h=u.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function S$(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<r;u++){const h=s[u],d=t?t.get(h):null,p=d?d.outputs:null;c=aR(h.inputs,u,c,d?d.inputs:null),l=aR(h.outputs,u,l,p);const m=null===c||null===o||A1(e)?null:B$(c,u,o);a.push(m)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(n,t,s)}function uR(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function w5(){return Je.lFrame.currentDirectiveIndex}();try{Qa(s);for(let a=i;a<r;a++){const c=n.data[a],l=e[a];Tw(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&R$(c,l)}}finally{Qa(-1),Tw(o)}}function R$(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Gx(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function L$(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ps(e)&&(t[""]=n)}}function F$(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Ka(r.type)),o=new Md(s,ps(r),Ue);n.blueprint[i]=o,t[i]=o,function A$(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function D$(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,$d(n,t,r.hostVars,st),r)}function ks(n,e,t,i,r,s){const o=Fi(n,e);!function Wx(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?tt(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[nt],o,s,n.value,t,i,r)}function U$(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)hR(i,t,o[a++],o[a++],o[a++])}function hR(n,e,t,i,r){const s=dn(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(i)&&(r=o[i].call(e,r)),null!==n.setInput?n.setInput(e,r,t,i):e[i]=r}finally{dn(s)}}function B$(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function dR(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function fR(n,e){const t=n.contentQueries;if(null!==t){const i=dn(null);try{for(let r=0;r<t.length;r+=2){const o=t[r+1];if(-1!==o){const a=n.data[o];Dw(t[r]),a.contentQueries(2,e[o],o)}}}finally{dn(i)}}}function Eg(n,e){return n[vd]?n[L1][fs]=e:n[vd]=e,n[L1]=e,e}function jx(n,e,t){Dw(0);const i=dn(null);try{e(n,t)}finally{dn(i)}}function pR(n){return n[Il]||(n[Il]=[])}function mR(n){return n.cleanup||(n.cleanup=[])}function Sg(n,e){const t=n[Oi],i=t?t.get(fo,null):null;i&&i.handleError(e)}function $x(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];hR(n.data[o],e[o],i,a,r)}}function _R(n,e,t,i){const r=e[$e];if(256==(256&r))return;e[Rl].inlineEffectRunner?.flush(),Iw(e);let o=null,a=null;(function H$(n){return 2!==n.type})(n)&&(a=function a$(n){return n[Ya]??function c$(n){const e=YI.pop()??Object.create(u$);return e.lView=n,e}(n)}(e),o=N0(a));try{W1(e),function J1(n){return Je.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&rR(n,e,t,2,i);const c=3==(3&r);if(c){const h=n.preOrderCheckHooks;null!==h&&Pm(e,h,null)}else{const h=n.preOrderHooks;null!==h&&Nm(e,h,0,null),Pw(e,0)}if(function G$(n){for(let e=oI(n);null!==e;e=aI(e)){if(!(e[$e]&Ol.HasTransplantedViews))continue;const t=e[Ll];for(let i=0;i<t.length;i++){o5(t[i])}}}(e),vR(e,0),null!==n.contentQueries&&fR(n,e),c){const h=n.contentCheckHooks;null!==h&&Pm(e,h)}else{const h=n.contentHooks;null!==h&&Nm(e,h,1),Pw(e,1)}!function g$(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Qa(~r);else{const s=r,o=t[++i],a=t[++i];y5(o,s),a(2,e[s])}}}finally{Qa(-1)}}(n,e);const l=n.components;null!==l&&xR(e,l,0);const u=n.viewQuery;if(null!==u&&jx(2,u,i),c){const h=n.viewCheckHooks;null!==h&&Pm(e,h)}else{const h=n.viewHooks;null!==h&&Nm(e,h,2),Pw(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Mm]){for(const h of e[Mm])h();e[Mm]=null}e[$e]&=-73}catch(c){throw Am(e),c}finally{null!==a&&(L0(a,o),function l$(n){n.lView[Ya]!==n&&(n.lView=null,YI.push(n))}(a)),Rw()}}function vR(n,e){for(let t=oI(n);null!==t;t=aI(t)){t[$e]&=~Ol.HasChildViewsToRefresh;for(let i=En;i<t.length;i++)yR(t[i],e)}}function W$(n,e,t){yR(wr(e,n),t)}function yR(n,e){Ew(n)&&wR(n,e)}function wR(n,e){const i=n[le],r=n[$e],s=n[Ya];let o=!!(0===e&&16&r);if(o||=!!(64&r&&0===e),o||=!!(1024&r),o||=!(!s?.dirty||!O0(s)),s&&(s.dirty=!1),n[$e]&=-9217,o)_R(i,n,i.template,n[Ht]);else if(8192&r){vR(n,1);const a=i.components;null!==a&&xR(n,a,1)}}function xR(n,e,t){for(let i=0;i<e.length;i++)W$(n,e[i],t)}function qd(n){for(;n;){n[$e]|=64;const e=Od(n);if(vw(n)&&!e)return n;n=e}return null}class Xd{get rootNodes(){const e=this._lView,t=e[le];return jd(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ht]}set context(e){this._lView[Ht]=e}get destroyed(){return 256==(256&this._lView[$e])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[rn];if(Jn(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Fd(e,i),Bm(t,i))}this._attachedToViewContainer=!1}ig(this._lView[le],this._lView)}onDestroy(e){Dm(this._lView,e)}markForCheck(){qd(this._cdRefInjectingView||this._lView)}detach(){this._lView[$e]&=-129}reattach(){q1(this._lView),this._lView[$e]|=128}detectChanges(){!function qx(n,e=!0){const t=n[Rl],i=t.rendererFactory,r=t.afterRenderEventManager;i.begin?.(),r?.begin();try{const o=n[le];_R(o,n,o.template,n[Ht]),function z$(n){let e=0;for(;$1(n);){if(100===e)throw new ce(103,!1);e++,wR(n,1)}}(n)}catch(o){throw e&&Sg(n,o),o}finally{i.end?.(),t.inlineEffectRunner?.flush(),r?.end()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ce(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function KW(n,e){Ud(n,e,e[nt],2,null,null)}(this._lView[le],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ce(902,!1);this._appRef=e}}let Mg=(()=>{class e{}return e.__NG_ELEMENT_ID__=j$,e})();function j$(n){return function $$(n,e,t){if(Za(n)&&!t){const i=wr(n.index,e);return new Xd(i,i)}return 47&n.type?new Xd(e[on],e):null}(Ut(),X(),16==(16&n))}let Cg=(()=>{var n;class e{}return(n=e).__NG_ELEMENT_ID__=Z$,n.__NG_ENV_ID__=t=>t,e})();class Y$ extends Cg{constructor(e){super(),this._lView=e}onDestroy(e){return Dm(this._lView,e),()=>function Sw(n,e){if(null===n[ea])return;const t=n[ea].indexOf(e);-1!==t&&n[ea].splice(t,1)}(this._lView,e)}}function Z$(){return new Y$(X())}const bR=new Set;function sc(n){bR.has(n)||(bR.add(n),performance?.mark?.("mark_use_counter",{detail:{feature:n}}))}function Xx(n){return e=>{setTimeout(n,void 0,e)}}const Ui=class i8 extends Ki{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Xx(s),r&&(r=Xx(r)),o&&(o=Xx(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Zi&&e.add(a),a}};function ER(...n){}class It{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ui(!1),this.onMicrotaskEmpty=new Ui(!1),this.onStable=new Ui(!1),this.onError=new Ui(!1),typeof Zone>"u")throw new ce(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function r8(){const n="function"==typeof Xt.requestAnimationFrame;let e=Xt[n?"requestAnimationFrame":"setTimeout"],t=Xt[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function a8(n){const e=()=>{!function o8(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Xt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Zx(n),n.isCheckStableRunning=!0,Yx(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Zx(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{if(function l8(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(r,s,o,a);try{return SR(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),MR(n)}},onInvoke:(t,i,r,s,o,a,c)=>{try{return SR(n),t.invoke(r,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),MR(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Zx(n),Yx(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!It.isInAngularZone())throw new ce(909,!1)}static assertNotInAngularZone(){if(It.isInAngularZone())throw new ce(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,s8,ER,ER);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const s8={};function Yx(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Zx(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function SR(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function MR(n){n._nesting--,Yx(n)}class c8{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ui,this.onMicrotaskEmpty=new Ui,this.onStable=new Ui,this.onError=new Ui}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const CR=new Ne("",{providedIn:"root",factory:TR});function TR(){const n=ve(It);let e=!0;return Q0(new sn(r=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(e),r.complete()})}),new sn(r=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{It.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,r.next(!0))})})});const o=n.onUnstable.subscribe(()=>{It.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(d1()))}var oc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(oc||{});const AR={destroy(){}};function IR(n,e){!e&&function Qw(n){if(!v1()&&!function D4(){return Dl}())throw new ce(-203,!1)}();const t=e?.injector??ve(nr);if(!function sa(n){return"browser"===(n??ve(nr)).get(ra)}(t))return AR;sc("NgAfterNextRender");const i=t.get(Tg),r=i.handler??=new PR,s=e?.phase??oc.MixedReadWrite,o=()=>{r.unregister(c),a()},a=t.get(Cg).onDestroy(o),c=new RR(t,s,()=>{o(),n()});return r.register(c),{destroy:o}}class RR{constructor(e,t,i){this.phase=t,this.callbackFn=i,this.zone=e.get(It),this.errorHandler=e.get(fo,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}}class PR{constructor(){this.executingCallbacks=!1,this.buckets={[oc.EarlyRead]:new Set,[oc.Write]:new Set,[oc.MixedReadWrite]:new Set,[oc.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new ce(102,!1)}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const t of e)t.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let Tg=(()=>{var n;class e{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth){for(const i of this.internalCallbacks)i();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}}return(n=e).\u0275prov=Ae({token:n,providedIn:"root",factory:()=>new n}),e})();function h8(n,e){const t=wr(e,n),i=t[le];!function d8(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[fn];null!==r&&null===t[Ds]&&(t[Ds]=Rx(r,t[Oi])),Kx(i,t,t[Ht])}function Kx(n,e,t){Iw(e);try{const i=n.viewQuery;null!==i&&jx(1,i,t);const r=n.template;null!==r&&rR(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&fR(n,e),n.staticViewQueries&&jx(2,n.viewQuery,t);const s=n.components;null!==s&&function f8(n,e){for(let t=0;t<e.length;t++)h8(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[$e]&=-5,Rw()}}function Ag(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=tw(r,a):2==s&&(i=tw(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}class NR extends mg{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=ft(e);return new Yd(t,this.ngModule)}}function LR(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class m8{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=bm(i);const r=this.injector.get(e,Lx,i);return r!==Lx||t===Lx?r:this.parentInjector.get(e,t,i)}}class Yd extends UI{get inputs(){const e=this.componentDef,t=e.inputTransforms,i=LR(e.inputs);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return LR(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function G4(n){return n.map(H4).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof jr?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new m8(e,s):e,a=o.get(VI,null);if(null===a)throw new ce(407,!1);const u={rendererFactory:a,sanitizer:o.get(Xj,null),inlineEffectRunner:null,afterRenderEventManager:o.get(Tg,null)},h=a.createRenderer(null,this.componentDef),d=this.componentDef.selectors[0][0]||"div",f=i?function v$(n,e,t,i){const s=i.get(JI,!1)||t===hs.ShadowDom,o=n.selectRootElement(e,s);return function y$(n){oR(n)}(o),o}(h,i,this.componentDef.encapsulation,o):ng(h,d,function p8(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(d)),_=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let g=null;null!==f&&(g=Rx(f,o,!0));const v=zx(0,null,null,1,0,null,null,null,null,null,null),y=bg(null,v,null,_,null,null,u,h,o,null,g);let w,x;Iw(y);try{const E=this.componentDef;let S,M=null;E.findHostDirectiveDefs?(S=[],M=new Map,E.findHostDirectiveDefs(E,S,M),S.push(E)):S=[E];const b=function _8(n,e){const t=n[le],i=it;return n[i]=e,su(t,i,2,"#host",null)}(y,f),C=function v8(n,e,t,i,r,s,o){const a=r[le];!function y8(n,e,t,i){for(const r of n)e.mergedAttrs=_d(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Ag(e,e.mergedAttrs,!0),null!==t&&bI(i,t,e))}(i,n,e,o);let c=null;null!==e&&(c=Rx(e,r[Oi]));const l=s.rendererFactory.createRenderer(e,t);let u=16;t.signals?u=4096:t.onPush&&(u=64);const h=bg(r,sR(t),null,u,r[n.index],n,s,l,null,null,c);return a.firstCreatePass&&Gx(a,n,i.length-1),Eg(r,h),r[n.index]=h}(b,f,E,S,y,u,h);x=Ed(v,it),f&&function x8(n,e,t,i){if(i)mw(n,t,["ng-version",Yj.full]);else{const{attrs:r,classes:s}=function W4(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!ds(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&mw(n,t,r),s&&s.length>0&&xI(n,t,s.join(" "))}}(h,E,f,i),void 0!==t&&function b8(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(x,this.ngContentSelectors,t),w=function w8(n,e,t,i,r,s){const o=Ut(),a=r[le],c=Fi(o,r);lR(a,r,o,t,null,i);for(let u=0;u<t.length;u++)yi(ec(r,a,o.directiveStart+u,o),r);uR(a,r,o),c&&yi(c,r);const l=ec(r,a,o.directiveStart+o.componentOffset,o);if(n[Ht]=r[Ht]=l,null!==s)for(const u of s)u(l,e);return Ux(a,o,n),l}(C,E,S,M,y,[E8]),Kx(v,y,null)}finally{Rw()}return new g8(this.componentType,w,ru(x,y),y,x)}}class g8 extends Hj{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Xd(r,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;$x(s[le],s,r,e,t),this.previousInputValues.set(e,t),qd(wr(this._tNode.index,s))}}get injector(){return new Gn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function E8(){const n=Ut();Rm(X()[le],n)}function Nn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Rg(n,e,t,i){const r=X();return Nn(r,Os(),e)&&(Et(),ks(en(),r,n,e,t,i)),Rg}function Ng(n,e,t){const i=X();return Nn(i,Os(),e)&&Er(Et(),en(),i,n,e,i[nt],t,!1),Ng}function tb(n,e,t,i,r){const o=r?"class":"style";$x(n,t,e.inputs[o],o,i)}let gP=(n,e)=>null;function gu(n,e){return gP(n,e)}function tf(n,e,t,i){const r=e.tView,a=bg(n,r,t,4096&n[$e]?4096:16,null,e,null,null,null,i?.injector??null,i?.dehydratedView??null);a[yd]=n[e.index];const l=n[Is];return null!==l&&(a[Is]=l.createEmbeddedView(r)),Kx(r,a,t),a}function _u(n,e){return!e||Qm(n)}function nf(n,e,t,i=!0){const r=e[le];if(function QW(n,e,t,i){const r=En+i,s=t.length;i>0&&(t[r-1][fs]=e),i<s-En?(e[fs]=t[r],bD(t,En+i,e)):(t.push(e),e[fs]=null),e[rn]=t;const o=e[yd];null!==o&&t!==o&&function ej(n,e){const t=n[Ll];e[on]!==e[rn][rn][on]&&(n[$e]|=Ol.HasTransplantedViews),null===t?n[Ll]=[e]:t.push(e)}(o,e);const a=e[Is];null!==a&&a.insertView(n),q1(e),e[$e]|=128}(r,e,n,t),i){const s=mx(t,n),o=e[nt],a=rg(o,n[Rs]);null!==a&&function ZW(n,e,t,i,r,s){i[fn]=r,i[_i]=e,Ud(n,i,t,1,r,s)}(r,n[_i],o,e,a,s)}}let _s=(()=>{class e{}return e.__NG_ELEMENT_ID__=L6,e})();function L6(){return EP(Ut(),X())}const O6=_s,xP=class extends O6{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return ru(this._hostTNode,this._hostLView)}get injector(){return new Gn(this._hostTNode,this._hostLView)}get parentInjector(){const e=Fm(this._hostTNode,this._hostLView);if(Lw(e)){const t=Td(e,this._hostLView),i=Cd(e);return new Gn(t[le].data[i+8],t)}return new Gn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=bP(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-En}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=gu(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,_u(this._hostTNode,o)),a}createComponent(e,t,i,r,s){const o=e&&!function Ad(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const p=t||{};a=p.index,i=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}const c=o?e:new Yd(ft(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule){const m=(o?l:this.parentInjector).get(jr,null);m&&(s=m)}const u=ft(c.componentType??{}),h=gu(this._lContainer,u?.id??null),f=c.create(l,r,h?.firstChild??null,s);return this.insertImpl(f.hostView,a,_u(this._hostTNode,h)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function s5(n){return Jn(n[rn])}(r)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=r[rn],l=new xP(c,c[_i],c[rn]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return nf(o,r,s,i),e.attachToViewContainerRef(),bD(hb(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=bP(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Fd(this._lContainer,t);i&&(Bm(hb(this._lContainer),t),ig(i[le],i))}detach(e){const t=this._adjustIndex(e,-1),i=Fd(this._lContainer,t);return i&&null!=Bm(hb(this._lContainer),t)?new Xd(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function bP(n){return n[8]}function hb(n){return n[8]||(n[8]=[])}function EP(n,e){let t;const i=e[n.index];return Jn(i)?t=i:(t=dR(i,e,null,n),e[n.index]=t,Eg(e,t)),SP(t,e,n,i),new xP(t,n,e)}let SP=function CP(n,e,t,i){if(n[Rs])return;let r;r=8&t.type?Yt(i):function F6(n,e){const t=n[nt],i=t.createComment(""),r=Fi(e,n);return ic(t,rg(t,r),i,function rj(n,e){return n.nextSibling(e)}(t,r),!1),i}(e,t),n[Rs]=r},db=(n,e,t)=>!1;function vu(n,e,t,i,r,s,o,a){const c=X(),l=Et(),u=n+it,h=l.firstCreatePass?function V6(n,e,t,i,r,s,o,a,c){const l=e.consts,u=su(e,n,4,o||null,Ns(l,a));Hx(e,t,u,Ns(l,c)),Rm(e,u);const h=u.tView=zx(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,l,c,e,t,i,r,s,o):l.data[u];Ls(h,!1);const d=TP(l,c,h,n);Im()&&sg(l,c,d,h),yi(d,c);const f=dR(d,c,d,h);return c[u]=f,Eg(c,f),function MP(n,e,t){return db(n,e,t)}(f,h,c),Tm(h)&&Bx(l,c,h),null!=o&&Vx(c,h,a),vu}let TP=function AP(n,e,t,i){return ta(!0),e[nt].createComment("")};function DP(n,e,t){sc("NgControlFlow");const i=X(),r=Os(),s=function fb(n,e){return n[e]}(i,it+n);if(Nn(i,r,e)){const a=dn(null);try{if(function ub(n,e){const t=Fd(n,e);return void 0!==t&&ig(t[le],t),t}(s,0),-1!==e){const c=function pb(n,e){return Ed(n,e)}(i[le],it+e),l=gu(s,c.tView.ssrId);nf(s,tf(i,c,t,{dehydratedView:l}),0,_u(c,l))}}finally{dn(a)}}else{const a=function wP(n,e){const t=En+e;if(t<n.length)return n[t]}(s,0);void 0!==a&&(a[Ht]=t)}}function mo(n,e,t,i){const r=X(),s=Et(),o=it+n,a=r[nt],c=s.firstCreatePass?function Aq(n,e,t,i,r,s){const o=e.consts,c=su(e,n,2,i,Ns(o,r));return Hx(e,t,c,Ns(o,s)),null!==c.attrs&&Ag(c,c.attrs,!1),null!==c.mergedAttrs&&Ag(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,e,t,i):s.data[o],l=JP(s,r,c,a,e,n);r[o]=l;const u=Tm(c);return Ls(c,!0),bI(a,l,c),32!=(32&c.flags)&&Im()&&sg(s,r,l,c),0===function a5(){return Je.lFrame.elementDepthCount}()&&yi(l,r),function c5(){Je.lFrame.elementDepthCount++}(),u&&(Bx(s,r,c),Ux(s,c,r)),null!==i&&Vx(r,c),mo}function da(){let n=Ut();Mw()?function Cw(){Je.lFrame.isParent=!1}():(n=n.parent,Ls(n,!1));const e=n;(function u5(n){return Je.skipHydrationRootTNode===n})(e)&&function p5(){Je.skipHydrationRootTNode=null}(),function l5(){Je.lFrame.elementDepthCount--}();const t=Et();return t.firstCreatePass&&(Rm(t,n),_w(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function I5(n){return 0!=(8&n.flags)}(e)&&tb(t,e,X(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function R5(n){return 0!=(16&n.flags)}(e)&&tb(t,e,X(),e.stylesWithoutHost,!1),da}function fa(n,e,t,i){return mo(n,e,t,i),da(),fa}let JP=(n,e,t,i,r,s)=>(ta(!0),ng(i,r,function aD(){return Je.lFrame.currentNamespace}()));const Cu="en-US";let sN=Cu;function Xg(n){return!!n&&"function"==typeof n.then}function IN(n){return!!n&&"function"==typeof n.subscribe}function Yg(n,e,t,i){const r=X(),s=Et(),o=Ut();return function PN(n,e,t,i,r,s,o){const a=Tm(i),l=n.firstCreatePass&&mR(n),u=e[Ht],h=pR(e);let d=!0;if(3&i.type||o){const m=Fi(i,e),_=o?o(m):m,g=h.length,v=o?w=>o(Yt(w[i.index])):i.index;let y=null;if(!o&&a&&(y=function RX(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Il],c=r[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=s,y.__ngLastListenerFn__=s,d=!1;else{s=LN(i,e,u,s,!1);const w=t.listen(_,r,s);h.push(s,w),l&&l.push(r,v,g,g+1)}}else s=LN(i,e,u,s,!1);const f=i.outputs;let p;if(d&&null!==f&&(p=f[r])){const m=p.length;if(m)for(let _=0;_<m;_+=2){const x=e[p[_]][p[_+1]].subscribe(s),E=h.length;h.push(s,x),l&&l.push(r,i.index,E,-(E+1))}}}(s,r,r[nt],o,n,e,i),Yg}function NN(n,e,t,i){try{return Ps(6,e,t),!1!==t(i)}catch(r){return Sg(n,r),!1}finally{Ps(7,e,t)}}function LN(n,e,t,i,r){return function s(o){if(o===Function)return i;qd(n.componentOffset>-1?wr(n.index,e):e);let c=NN(e,t,i,o),l=s.__ngNextListenerFn__;for(;l;)c=NN(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&o.preventDefault(),c}}function ON(n=1){return function b5(n){return(Je.lFrame.contextLView=function j1(n,e){for(;n>0;)e=e[Pl],n--;return e}(n,Je.lFrame.contextLView))[Ht]}(n)}function Tb(n,e,t){return Ab(n,"",e,"",t),Tb}function Ab(n,e,t,i,r){const s=X(),o=function au(n,e,t,i){return Nn(n,Os(),t)?e+tt(t)+i:st}(s,e,t,i);return o!==st&&Er(Et(),en(),s,n,o,s[nt],r,!1),Ab}let tL=(n,e,t,i,r)=>(ta(!0),function tg(n,e){return n.createText(e)}(e[nt],i));class hc{}class dL{}class Lb extends hc{constructor(e,t,i){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new NR(this);const r=gi(e);this._bootstrapComponents=br(r.bootstrap),this._r3Injector=UD(e,t,[{provide:hc,useValue:this},{provide:mg,useValue:this.componentFactoryResolver},...i],Pn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Ob extends dL{constructor(e){super(),this.moduleType=e}create(e){return new Lb(this.moduleType,e,[])}}class fL extends hc{constructor(e){super(),this.componentFactoryResolver=new NR(this),this.instance=null;const t=new Zl([...e.providers,{provide:hc,useValue:this},{provide:mg,useValue:this.componentFactoryResolver}],e.parent||qm(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Fb(n,e,t=null){return new fL({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let e9=(()=>{var n;class e{constructor(i){this._injector=i,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(i){if(!i.standalone)return null;if(!this.cachedInjectors.has(i)){const r=DD(0,i.type),s=r.length>0?Fb([r],this._injector,`Standalone[${i.type.name}]`):null;this.cachedInjectors.set(i,s)}return this.cachedInjectors.get(i)}ngOnDestroy(){try{for(const i of this.cachedInjectors.values())null!==i&&i.destroy()}finally{this.cachedInjectors.clear()}}}return(n=e).\u0275prov=Ae({token:n,providedIn:"environment",factory:()=>new n(we(jr))}),e})();function pL(n){sc("NgStandalone"),n.getStandaloneInjector=e=>e.get(e9).getOrCreateStandaloneInjector(n)}function A9(){return this._results[Symbol.iterator]()}class Ub{get changes(){return this._changes||(this._changes=new Ui)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Ub.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=A9)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function tr(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function W5(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let go=(()=>{class e{}return e.__NG_ELEMENT_ID__=R9,e})();const D9=go,I9=class extends D9{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=tf(this._declarationLView,this._declarationTContainer,e,{injector:t,dehydratedView:i});return new Xd(r)}};function R9(){return Jg(Ut(),X())}function Jg(n,e){return 4&n.type?new I9(e,n,ru(n,e)):null}class Bb{constructor(e){this.queryList=e,this.matches=null}clone(){return new Bb(this.queryList)}setDirty(){this.queryList.setDirty()}}class Vb{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Vb(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==PL(e,t).matches&&this.queries[t].setDirty()}}class TL{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class zb{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new zb(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Hb{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Hb(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,P9(t,s)),this.matchTNodeWithReadOption(e,t,km(t,e,s,!1,!1))}else i===go?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,km(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===la||r===_s||r===go&&4&t.type)this.addMatch(t.index,-2);else{const s=km(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function P9(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function L9(n,e,t,i){return-1===t?function N9(n,e){return 11&n.type?ru(n,e):4&n.type?Jg(n,e):null}(e,n):-2===t?function O9(n,e,t){return t===la?ru(e,n):t===go?Jg(e,n):t===_s?EP(e,n):void 0}(n,e,i):ec(n,n[le],t,e)}function AL(n,e,t,i){const r=e[Is].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:L9(e,s[l],o[c+1],t.metadata.read))}r.matches=a}return r.matches}function Gb(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=AL(n,e,r,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)i.push(o[a/2]);else{const l=s[a+1],u=e[-c];for(let h=En;h<u.length;h++){const d=u[h];d[yd]===d[rn]&&Gb(d[le],d,l,i)}if(null!==u[Ll]){const h=u[Ll];for(let d=0;d<h.length;d++){const f=h[d];Gb(f[le],f,l,i)}}}}}return i}function mf(n){const e=X(),t=Et(),i=eD();Dw(i+1);const r=PL(t,i);if(n.dirty&&function r5(n){return 4==(4&n[$e])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Gb(t,e,i,[]):AL(t,e,r,i);n.reset(s,$j),n.notifyOnChanges()}return!0}return!1}function Qg(n,e,t){const i=Et();i.firstCreatePass&&(function RL(n,e,t){null===n.queries&&(n.queries=new zb),n.queries.track(new Hb(e,t))}(i,new TL(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function IL(n,e,t){const i=new Ub(4==(4&t));(function b$(n,e,t,i){const r=pR(e);r.push(t),n.firstCreatePass&&mR(n).push(i,r.length-1)})(n,e,i,i.destroy),null===e[Is]&&(e[Is]=new Vb),e[Is].queries.push(new Bb(i))}(i,X(),e)}function gf(){return function F9(n,e){return n[Is].queries[e].queryList}(X(),eD())}function PL(n,e){return n.queries.getByIndex(e)}const t_=new Ne("Application Initializer");let Xb=(()=>{var n;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r}),this.appInits=ve(t_,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const i=[];for(const s of this.appInits){const o=s();if(Xg(o))i.push(o);else if(IN(o)){const a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});i.push(a)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(i).then(()=>{r()}).catch(s=>{this.reject(s)}),0===i.length&&r(),this.initialized=!0}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),XL=(()=>{var n;class e{log(i){console.log(i)}warn(i){console.warn(i)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})();const _o=new Ne("LocaleId",{providedIn:"root",factory:()=>ve(_o,yt.Optional|yt.SkipSelf)||function o7(){return typeof $localize<"u"&&$localize.locale||Cu}()});let ZL=(()=>{var n;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Wr(!1)}add(){this.hasPendingTasks.next(!0);const i=this.taskId++;return this.pendingTasks.add(i),i}remove(i){this.pendingTasks.delete(i),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();class d7{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let KL=(()=>{var n;class e{compileModuleSync(i){return new Ob(i)}compileModuleAsync(i){return Promise.resolve(this.compileModuleSync(i))}compileModuleAndAllComponentsSync(i){const r=this.compileModuleSync(i),o=br(gi(i).declarations).reduce((a,c)=>{const l=ft(c);return l&&a.push(new Yd(l)),a},[]);return new d7(r,o)}compileModuleAndAllComponentsAsync(i){return Promise.resolve(this.compileModuleAndAllComponentsSync(i))}clearCache(){}clearCacheFor(i){}getModuleId(i){}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const nO=new Ne(""),i_=new Ne("");let Jb,Zb=(()=>{var n;class e{constructor(i,r,s){this._ngZone=i,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Jb||(function k7(n){Jb=n}(s),s.addToWindow(r)),this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{It.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(i)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,r,s){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),i(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:i,timeoutId:o,updateCb:s})}whenStable(i,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(i){this.registry.registerApplication(i,this)}unregisterApplication(i){this.registry.unregisterApplication(i)}findProviders(i,r,s){return[]}}return(n=e).\u0275fac=function(i){return new(i||n)(we(It),we(Kb),we(i_))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})(),Kb=(()=>{var n;class e{constructor(){this._applications=new Map}registerApplication(i,r){this._applications.set(i,r)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,r=!0){return Jb?.findTestabilityInTree(this,i,r)??null}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})(),pa=null;const iO=new Ne("AllowMultipleToken"),Qb=new Ne("PlatformDestroyListeners"),eE=new Ne("appBootstrapListener");function oO(n,e,t=[]){const i=`Platform: ${e}`,r=new Ne(i);return(s=[])=>{let o=tE();if(!o||o.injector.get(iO,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function V7(n){if(pa&&!pa.get(iO,!1))throw new ce(400,!1);(function rO(){!function hG(n){kA=n}(()=>{throw new ce(600,!1)})})(),pa=n;const e=n.get(cO);(function sO(n){n.get(VD,null)?.forEach(t=>t())})(n)}(function aO(n=[],e){return nr.create({name:e,providers:[{provide:Yw,useValue:"platform"},{provide:Qb,useValue:new Set([()=>pa=null])},...n]})}(a,i))}return function H7(n){const e=tE();if(!e)throw new ce(401,!1);return e}()}}function tE(){return pa?.get(cO)??null}let cO=(()=>{var n;class e{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,r){const s=function G7(n="zone.js",e){return"noop"===n?new c8:"zone.js"===n?new It(e):n}(r?.ngZone,function lO(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return s.run(()=>{const o=function QX(n,e,t){return new Lb(n,e,t)}(i.moduleType,this.injector,function pO(n){return[{provide:It,useFactory:n},{provide:Yl,multi:!0,useFactory:()=>{const e=ve(j7,{optional:!0});return()=>e.initialize()}},{provide:fO,useFactory:W7},{provide:CR,useFactory:TR}]}(()=>s)),a=o.injector.get(fo,null);return s.runOutsideAngular(()=>{const c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{r_(this._modules,o),c.unsubscribe()})}),function uO(n,e,t){try{const i=t();return Xg(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(a,s,()=>{const c=o.injector.get(Xb);return c.runInitializers(),c.donePromise.then(()=>(function oN(n){Ji(n,"Expected localeId to be defined"),"string"==typeof n&&(sN=n.toLowerCase().replace(/_/g,"-"))}(o.injector.get(_o,Cu)||Cu),this._moduleDoBootstrap(o),o))})})}bootstrapModule(i,r=[]){const s=hO({},r);return function U7(n,e,t){const i=new Ob(t);return Promise.resolve(i)}(0,0,i).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(i){const r=i.injector.get(dc);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!i.instance.ngDoBootstrap)throw new ce(-403,!1);i.instance.ngDoBootstrap(r)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ce(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const i=this._injector.get(Qb,null);i&&(i.forEach(r=>r()),i.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(n=e).\u0275fac=function(i){return new(i||n)(we(nr))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})();function hO(n,e){return Array.isArray(e)?e.reduce(hO,n):{...n,...e}}let dc=(()=>{var n;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ve(fO),this.zoneIsStable=ve(CR),this.componentTypes=[],this.components=[],this.isStable=ve(ZL).hasPendingTasks.pipe(Ni(i=>i?Xe(!1):this.zoneIsStable),function f4(n,e=Yo){return n=n??p4,bn((t,i)=>{let r,s=!0;t.subscribe(Rn(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),d1()),this._injector=ve(jr)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(i,r){const s=i instanceof UI;if(!this._injector.get(Xb).done)throw!s&&function Qo(n){const e=ft(n)||Hn(n)||ci(n);return null!==e&&e.standalone}(i),new ce(405,!1);let a;a=s?i:this._injector.get(mg).resolveComponentFactory(i),this.componentTypes.push(a.componentType);const c=function B7(n){return n.isBoundToModule}(a)?void 0:this._injector.get(hc),u=a.create(nr.NULL,[],r||a.selector,c),h=u.location.nativeElement,d=u.injector.get(nO,null);return d?.registerApplication(h),u.onDestroy(()=>{this.detachView(u.hostView),r_(this.components,u),d?.unregisterApplication(h)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new ce(101,!1);try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1}}attachView(i){const r=i;this._views.push(r),r.attachToAppRef(this)}detachView(i){const r=i;r_(this._views,r),r.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i);const r=this._injector.get(eE,[]);[...this._bootstrapListeners,...r].forEach(s=>s(i))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(i=>i()),this._views.slice().forEach(i=>i.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(i){return this._destroyListeners.push(i),()=>r_(this._destroyListeners,i)}destroy(){if(this._destroyed)throw new ce(406,!1);const i=this._injector;i.destroy&&!i.destroyed&&i.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();function r_(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const fO=new Ne("",{providedIn:"root",factory:()=>ve(fo).handleError.bind(void 0)});function W7(){const n=ve(It),e=ve(fo);return t=>n.runOutsideAngular(()=>e.handleError(t))}let j7=(()=>{var n;class e{constructor(){this.zone=ve(It),this.applicationRef=ve(dc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const Q7=oO(null,"core",[]);let eY=(()=>{var n;class e{constructor(i){}}return(n=e).\u0275fac=function(i){return new(i||n)(we(dc))},n.\u0275mod=As({type:n}),n.\u0275inj=us({}),e})(),dE=null;function Iu(){return dE}class SY{}const sr=new Ne("DocumentToken");let fE=(()=>{var n;class e{historyGo(i){throw new Error("Not implemented")}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:()=>ve(CY),providedIn:"platform"}),e})();const MY=new Ne("Location Initialized");let CY=(()=>{var n;class e extends fE{constructor(){super(),this._doc=ve(sr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Iu().getBaseHref(this._doc)}onPopState(i){const r=Iu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",i,!1),()=>r.removeEventListener("popstate",i)}onHashChange(i){const r=Iu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",i,!1),()=>r.removeEventListener("hashchange",i)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(i){this._location.pathname=i}pushState(i,r,s){this._history.pushState(i,r,s)}replaceState(i,r,s){this._history.replaceState(i,r,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:()=>new n,providedIn:"platform"}),e})();function pE(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function kO(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function vo(n){return n&&"?"!==n[0]?"?"+n:n}let pc=(()=>{var n;class e{historyGo(i){throw new Error("Not implemented")}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:()=>ve(BO),providedIn:"root"}),e})();const UO=new Ne("appBaseHref");let BO=(()=>{var n;class e extends pc{constructor(i,r){super(),this._platformLocation=i,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??ve(sr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return pE(this._baseHref,i)}path(i=!1){const r=this._platformLocation.pathname+vo(this._platformLocation.search),s=this._platformLocation.hash;return s&&i?`${r}${s}`:r}pushState(i,r,s,o){const a=this.prepareExternalUrl(s+vo(o));this._platformLocation.pushState(i,r,a)}replaceState(i,r,s,o){const a=this.prepareExternalUrl(s+vo(o));this._platformLocation.replaceState(i,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}}return(n=e).\u0275fac=function(i){return new(i||n)(we(fE),we(UO,8))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),TY=(()=>{var n;class e extends pc{constructor(i,r){super(),this._platformLocation=i,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}path(i=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(i){const r=pE(this._baseHref,i);return r.length>0?"#"+r:r}pushState(i,r,s,o){let a=this.prepareExternalUrl(s+vo(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(i,r,a)}replaceState(i,r,s,o){let a=this.prepareExternalUrl(s+vo(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(i,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}}return(n=e).\u0275fac=function(i){return new(i||n)(we(fE),we(UO,8))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})(),xf=(()=>{var n;class e{constructor(i){this._subject=new Ui,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=i;const r=this._locationStrategy.getBaseHref();this._basePath=function IY(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(kO(VO(r))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(i=!1){return this.normalize(this._locationStrategy.path(i))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(i,r=""){return this.path()==this.normalize(i+vo(r))}normalize(i){return e.stripTrailingSlash(function DY(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,VO(i)))}prepareExternalUrl(i){return i&&"/"!==i[0]&&(i="/"+i),this._locationStrategy.prepareExternalUrl(i)}go(i,r="",s=null){this._locationStrategy.pushState(s,"",i,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+vo(r)),s)}replaceState(i,r="",s=null){this._locationStrategy.replaceState(s,"",i,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+vo(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(i=0){this._locationStrategy.historyGo?.(i)}onUrlChange(i){return this._urlChangeListeners.push(i),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(i);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(i="",r){this._urlChangeListeners.forEach(s=>s(i,r))}subscribe(i,r,s){return this._subject.subscribe({next:i,error:r,complete:s})}}return(n=e).normalizeQueryParams=vo,n.joinWithSlash=pE,n.stripTrailingSlash=kO,n.\u0275fac=function(i){return new(i||n)(we(pc))},n.\u0275prov=Ae({token:n,factory:()=>function AY(){return new xf(we(pc))}(),providedIn:"root"}),e})();function VO(n){return n.replace(/\/index.html$/,"")}let tF=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=As({type:n}),n.\u0275inj=us({}),e})();const nF="browser";function iF(n){return n===nF}function rF(n){return"server"===n}let YZ=(()=>{var n;class e{}return(n=e).\u0275prov=Ae({token:n,providedIn:"root",factory:()=>new ZZ(we(sr),window)}),e})();class ZZ{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function KZ(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class xK extends SY{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class RE extends xK{static makeCurrent(){!function EY(n){dE||(dE=n)}(new RE)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function bK(){return Mf=Mf||document.querySelector("base"),Mf?Mf.getAttribute("href"):null}();return null==t?null:function EK(n){return new URL(n,"http://a").pathname}(t)}resetBaseElement(){Mf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function pZ(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Mf=null,MK=(()=>{var n;class e{build(){return new XMLHttpRequest}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();const PE=new Ne("EventManagerPlugins");let cF=(()=>{var n;class e{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(s=>{s.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,r,s){return this._findPluginFor(r).addEventListener(i,r,s)}getZone(){return this._zone}_findPluginFor(i){let r=this._eventNameToPlugin.get(i);if(r)return r;if(r=this._plugins.find(o=>o.supports(i)),!r)throw new ce(5101,!1);return this._eventNameToPlugin.set(i,r),r}}return(n=e).\u0275fac=function(i){return new(i||n)(we(PE),we(It))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();class lF{constructor(e){this._doc=e}}const NE="ng-app-id";let uF=(()=>{var n;class e{constructor(i,r,s,o={}){this.doc=i,this.appId=r,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=rF(o),this.resetHostNodes()}addStyles(i){for(const r of i)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(i){for(const r of i)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const i=this.styleNodesInDOM;i&&(i.forEach(r=>r.remove()),i.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(const r of this.getAllStyles())this.addStyleToHost(i,r)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(const r of this.hostNodes)this.addStyleToHost(r,i)}onStyleRemoved(i){const r=this.styleRef;r.get(i)?.elements?.forEach(s=>s.remove()),r.delete(i)}collectServerRenderedStyles(){const i=this.doc.head?.querySelectorAll(`style[${NE}="${this.appId}"]`);if(i?.length){const r=new Map;return i.forEach(s=>{null!=s.textContent&&r.set(s.textContent,s)}),r}return null}changeUsageCount(i,r){const s=this.styleRef;if(s.has(i)){const o=s.get(i);return o.usage+=r,o.usage}return s.set(i,{usage:r,elements:[]}),r}getStyleElement(i,r){const s=this.styleNodesInDOM,o=s?.get(r);if(o?.parentNode===i)return s.delete(r),o.removeAttribute(NE),o;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(NE,this.appId),i.appendChild(a),a}}addStyleToHost(i,r){const s=this.getStyleElement(i,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(s):o.set(r,{elements:[s],usage:1})}resetHostNodes(){const i=this.hostNodes;i.clear(),i.add(this.doc.head)}}return(n=e).\u0275fac=function(i){return new(i||n)(we(sr),we(Ym),we(zD,8),we(ra))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();const LE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},OE=/%COMP%/g,DK=new Ne("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function dF(n,e){return e.map(t=>t.replace(OE,n))}let fF=(()=>{var n;class e{constructor(i,r,s,o,a,c,l,u=null){this.eventManager=i,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=rF(c),this.defaultRenderer=new FE(i,a,l,this.platformIsServer)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===hs.ShadowDom&&(r={...r,encapsulation:hs.Emulated});const s=this.getOrCreateRenderer(i,r);return s instanceof mF?s.applyToHost(i):s instanceof kE&&s.applyStyles(),s}getOrCreateRenderer(i,r){const s=this.rendererByCompId;let o=s.get(r.id);if(!o){const a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(r.encapsulation){case hs.Emulated:o=new mF(l,u,r,this.appId,h,a,c,d);break;case hs.ShadowDom:return new NK(l,u,i,r,a,c,this.nonce,d);default:o=new kE(l,u,r,h,a,c,d)}s.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}}return(n=e).\u0275fac=function(i){return new(i||n)(we(cF),we(uF),we(Ym),we(DK),we(sr),we(ra),we(It),we(zD))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();class FE{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(LE[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(pF(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(pF(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new ce(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=LE[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=LE[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(aa.DashCase|aa.Important)?e.style.setProperty(t,i,r&aa.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&aa.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if("string"==typeof e&&!(e=Iu().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function pF(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class NK extends FE{constructor(e,t,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=dF(r.id,r.styles);for(const u of l){const h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=u,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class kE extends FE{constructor(e,t,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?dF(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class mF extends kE{constructor(e,t,i,r,s,o,a,c){const l=r+"-"+i.id;super(e,t,i,s,o,a,c,l),this.contentAttr=function IK(n){return"_ngcontent-%COMP%".replace(OE,n)}(l),this.hostAttr=function RK(n){return"_nghost-%COMP%".replace(OE,n)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let LK=(()=>{var n;class e extends lF{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,s){return i.addEventListener(r,s,!1),()=>this.removeEventListener(i,r,s)}removeEventListener(i,r,s){return i.removeEventListener(r,s)}}return(n=e).\u0275fac=function(i){return new(i||n)(we(sr))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();const gF=["alt","control","meta","shift"],OK={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},FK={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let kK=(()=>{var n;class e extends lF{constructor(i){super(i)}supports(i){return null!=e.parseEventName(i)}addEventListener(i,r,s){const o=e.parseEventName(r),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Iu().onAndCancel(i,o.domEventName,a))}static parseEventName(i){const r=i.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const o=e._normalizeKey(r.pop());let a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),gF.forEach(u=>{const h=r.indexOf(u);h>-1&&(r.splice(h,1),a+=u+".")}),a+=o,0!=r.length||0===o.length)return null;const l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(i,r){let s=OK[i.key]||i.key,o="";return r.indexOf("code.")>-1&&(s=i.code,o="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),gF.forEach(a=>{a!==s&&(0,FK[a])(i)&&(o+=a+".")}),o+=s,o===r)}static eventCallback(i,r,s){return o=>{e.matchEventFullKeyCode(o,i)&&s.runGuarded(()=>r(o))}}static _normalizeKey(i){return"esc"===i?"escape":i}}return(n=e).\u0275fac=function(i){return new(i||n)(we(sr))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();const vF=[{provide:ra,useValue:nF},{provide:VD,useValue:function UK(){RE.makeCurrent()},multi:!0},{provide:sr,useFactory:function VK(){return function EW(n){tx=n}(document),document},deps:[]}],zK=oO(Q7,"browser",vF),HK=new Ne(""),yF=[{provide:i_,useClass:class SK{addToWindow(e){Xt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new ce(5103,!1);return s},Xt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Xt.getAllAngularRootElements=()=>e.getAllRootElements(),Xt.frameworkStabilizers||(Xt.frameworkStabilizers=[]),Xt.frameworkStabilizers.push(i=>{const r=Xt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(c){o=o||c,s--,0==s&&i(o)};r.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Iu().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:nO,useClass:Zb,deps:[It,Kb,i_]},{provide:Zb,useClass:Zb,deps:[It,Kb,i_]}],wF=[{provide:Yw,useValue:"root"},{provide:fo,useFactory:function BK(){return new fo},deps:[]},{provide:PE,useClass:LK,multi:!0,deps:[sr,It,ra]},{provide:PE,useClass:kK,multi:!0,deps:[sr]},fF,uF,cF,{provide:VI,useExisting:fF},{provide:class JZ{},useClass:MK,deps:[]},[]];let GK=(()=>{var n;class e{constructor(i){}static withServerTransition(i){return{ngModule:e,providers:[{provide:Ym,useValue:i.appId}]}}}return(n=e).\u0275fac=function(i){return new(i||n)(we(HK,12))},n.\u0275mod=As({type:n}),n.\u0275inj=us({providers:[...wF,...yF],imports:[tF,eY]}),e})(),UE=(()=>{var n;class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}}return(n=e).\u0275fac=function(i){return new(i||n)(we(sr))},n.\u0275prov=Ae({token:n,factory:function(i){let r=null;return r=i?new i:function jK(){return new UE(we(sr))}(),r},providedIn:"root"}),e})();typeof window<"u"&&window;const{isArray:KK}=Array,{getPrototypeOf:JK,prototype:QK,keys:eJ}=Object;const{isArray:iJ}=Array;function SF(n){return At(e=>function rJ(n,e){return iJ(e)?n(...e):n(e)}(n,e))}function VE(...n){const e=dd(n),t=function s4(n){return Ct(J0(n))?n.pop():void 0}(n),{args:i,keys:r}=function tJ(n){if(1===n.length){const e=n[0];if(KK(e))return{args:e,keys:null};if(function nJ(n){return n&&"object"==typeof n&&JK(n)===QK}(e)){const t=eJ(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}(n);if(0===i.length)return Kn([],e);const s=new sn(function oJ(n,e,t=Yo){return i=>{MF(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let c=0;c<r;c++)MF(e,()=>{const l=Kn(n[c],e);let u=!1;l.subscribe(Rn(i,h=>{s[c]=h,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>function sJ(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}(r,o):Yo));return t?s.pipe(SF(t)):s}function MF(n,e,t){n?oo(t,n,e):e()}const S_=V0(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Tf(...n){return function aJ(){return Tl(1)}()(Kn(n,dd(n)))}function M_(n){return new sn(e=>{Pi(n()).subscribe(e)})}function Af(n,e){const t=Ct(n)?n:()=>n,i=r=>r.error(t());return new sn(e?r=>e.schedule(i,0,r):i)}function zE(){return bn((n,e)=>{let t=null;n._refCount++;const i=Rn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class HE extends sn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,XA(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Zi;const t=this.getSubject();e.add(this.source.subscribe(Rn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Zi.EMPTY)}return e}refCount(){return zE()(this)}}function or(n){return n<=0?()=>Cs:bn((e,t)=>{let i=0;e.subscribe(Rn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Mr(n,e){return bn((t,i)=>{let r=0;t.subscribe(Rn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function C_(n){return bn((e,t)=>{let i=!1;e.subscribe(Rn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function CF(n=lJ){return bn((e,t)=>{let i=!1;e.subscribe(Rn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function lJ(){return new S_}function mc(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Mr((r,s)=>n(r,s,i)):Yo,or(1),t?C_(e):CF(()=>new S_))}function Df(n,e){return Ct(e)?Zn(n,e,1):Zn(n,1)}function ui(n,e,t){const i=Ct(n)||e||t?{next:n,error:e,complete:t}:n;return i?bn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Rn(s,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),s.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),s.complete()},c=>{var l;a=!1,null===(l=i.error)||void 0===l||l.call(i,c),s.error(c)},()=>{var c,l;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):Yo}function Pu(n){return bn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Rn(t,void 0,void 0,o=>{s=Pi(n(o,Pu(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function GE(n){return n<=0?()=>Cs:bn((e,t)=>{let i=[];e.subscribe(Rn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function TF(n){return At(()=>n)}function WE(n){return bn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const ct="primary",If=Symbol("RouteTitle");class pJ{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Nu(n){return new pJ(n)}function mJ(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function zs(n,e){const t=n?jE(n):void 0,i=e?jE(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!AF(n[r],e[r]))return!1;return!0}function jE(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function AF(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function DF(n){return n.length>0?n[n.length-1]:null}function ga(n){return function ZK(n){return!!n&&(n instanceof sn||Ct(n.lift)&&Ct(n.subscribe))}(n)?n:Xg(n)?Kn(Promise.resolve(n)):Xe(n)}const _J={exact:function PF(n,e,t){if(!gc(n.segments,e.segments)||!T_(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!PF(n.children[i],e.children[i],t))return!1;return!0},subset:NF},IF={exact:function vJ(n,e){return zs(n,e)},subset:function yJ(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>AF(n[t],e[t]))},ignored:()=>!0};function RF(n,e,t){return _J[t.paths](n.root,e.root,t.matrixParams)&&IF[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function NF(n,e,t){return LF(n,e,e.segments,t)}function LF(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!gc(r,t)||e.hasChildren()||!T_(r,t,i))}if(n.segments.length===t.length){if(!gc(n.segments,t)||!T_(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!NF(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(gc(n.segments,r)&&T_(n.segments,r,i)&&n.children[ct])&&LF(n.children[ct],e,s,i)}}function T_(n,e,t){return e.every((i,r)=>IF[t](n[r].parameters,i.parameters))}class Lu{constructor(e=new Bt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Nu(this.queryParams)),this._queryParamMap}toString(){return bJ.serialize(this)}}class Bt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return A_(this)}}class Rf{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Nu(this.parameters)),this._parameterMap}toString(){return kF(this)}}function gc(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let Ou=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:()=>new $E,providedIn:"root"}),e})();class $E{parse(e){const t=new NJ(e);return new Lu(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Pf(e.root,!0)}`,i=function MJ(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${D_(t)}=${D_(r)}`).join("&"):`${D_(t)}=${D_(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function EJ(n){return encodeURI(n)}(e.fragment)}`:""}`}}const bJ=new $E;function A_(n){return n.segments.map(e=>kF(e)).join("/")}function Pf(n,e){if(!n.hasChildren())return A_(n);if(e){const t=n.children[ct]?Pf(n.children[ct],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==ct&&i.push(`${r}:${Pf(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function xJ(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===ct&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==ct&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===ct?[Pf(n.children[ct],!1)]:[`${r}:${Pf(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[ct]?`${A_(n)}/${t[0]}`:`${A_(n)}/(${t.join("//")})`}}function OF(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function D_(n){return OF(n).replace(/%3B/gi,";")}function qE(n){return OF(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function I_(n){return decodeURIComponent(n)}function FF(n){return I_(n.replace(/\+/g,"%20"))}function kF(n){return`${qE(n.path)}${function SJ(n){return Object.keys(n).map(e=>`;${qE(e)}=${qE(n[e])}`).join("")}(n.parameters)}`}const CJ=/^[^\/()?;#]+/;function XE(n){const e=n.match(CJ);return e?e[0]:""}const TJ=/^[^\/()?;=#]+/,DJ=/^[^=?&#]+/,RJ=/^[^&#]+/;class NJ{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Bt([],{}):new Bt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[ct]=new Bt(e,t)),i}parseSegment(){const e=XE(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ce(4009,!1);return this.capture(e),new Rf(I_(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function AJ(n){const e=n.match(TJ);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=XE(this.remaining);r&&(i=r,this.capture(i))}e[I_(t)]=I_(i)}parseQueryParam(e){const t=function IJ(n){const e=n.match(DJ);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function PJ(n){const e=n.match(RJ);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=FF(t),s=FF(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=XE(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ce(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ct);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[ct]:new Bt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ce(4011,!1)}}function UF(n){return n.segments.length>0?new Bt([],{[ct]:n}):n}function BF(n){const e={};for(const i of Object.keys(n.children)){const s=BF(n.children[i]);if(i===ct&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function LJ(n){if(1===n.numberOfChildren&&n.children[ct]){const e=n.children[ct];return new Bt(n.segments.concat(e.segments),e.children)}return n}(new Bt(n.segments,e))}function _c(n){return n instanceof Lu}function VF(n){let e;const i=function t(s){const o={};for(const c of s.children){const l=t(c);o[c.outlet]=l}const a=new Bt(s.url,o);return s===n&&(e=a),a}(n.root),r=UF(i);return e??r}function zF(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return YE(r,r,r,t,i);const s=function FJ(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new GF(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new GF(t,e,i)}(e);if(s.toRoot())return YE(r,r,new Bt([],{}),t,i);const o=function kJ(n,e,t){if(n.isAbsolute)return new P_(e,!0,0);if(!t)return new P_(e,!1,NaN);if(null===t.parent)return new P_(t,!0,0);const i=R_(n.commands[0])?0:1;return function UJ(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new ce(4005,!1);r=i.segments.length}return new P_(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?Lf(o.segmentGroup,o.index,s.commands):WF(o.segmentGroup,o.index,s.commands);return YE(r,o.segmentGroup,a,t,i)}function R_(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Nf(n){return"object"==typeof n&&null!=n&&n.outlets}function YE(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=n===e?t:HF(n,e,t);const a=UF(BF(o));return new Lu(a,s,r)}function HF(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:HF(s,e,t)}),new Bt(n.segments,i)}class GF{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&R_(i[0]))throw new ce(4003,!1);const r=i.find(Nf);if(r&&r!==DF(i))throw new ce(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class P_{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function WF(n,e,t){if(n||(n=new Bt([],{})),0===n.segments.length&&n.hasChildren())return Lf(n,e,t);const i=function VJ(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(Nf(a))break;const c=`${a}`,l=i<t.length-1?t[i+1]:null;if(r>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!$F(c,l,o))return s;i+=2}else{if(!$F(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new Bt(n.segments.slice(0,i.pathIndex),{});return s.children[ct]=new Bt(n.segments.slice(i.pathIndex),n.children),Lf(s,0,r)}return i.match&&0===r.length?new Bt(n.segments,{}):i.match&&!n.hasChildren()?ZE(n,e,t):i.match?Lf(n,0,r):ZE(n,e,t)}function Lf(n,e,t){if(0===t.length)return new Bt(n.segments,{});{const i=function BJ(n){return Nf(n[0])?n[0].outlets:{[ct]:n}}(t),r={};if(Object.keys(i).some(s=>s!==ct)&&n.children[ct]&&1===n.numberOfChildren&&0===n.children[ct].segments.length){const s=Lf(n.children[ct],e,t);return new Bt(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=WF(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new Bt(n.segments,r)}}function ZE(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Nf(s)){const c=zJ(s.outlets);return new Bt(i,c)}if(0===r&&R_(t[0])){i.push(new Rf(n.segments[e].path,jF(t[0]))),r++;continue}const o=Nf(s)?s.outlets[ct]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&R_(a)?(i.push(new Rf(o,jF(a))),r+=2):(i.push(new Rf(o,{})),r++)}return new Bt(i,{})}function zJ(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=ZE(new Bt([],{}),0,i))}),e}function jF(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function $F(n,e,t){return n==t.path&&zs(e,t.parameters)}const Of="imperative";var St=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(St||{});class Hs{constructor(e,t){this.id=e,this.url=t}}class N_ extends Hs{constructor(e,t,i="imperative",r=null){super(e,t),this.type=St.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Gs extends Hs{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=St.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var Zr=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Zr||{}),L_=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(L_||{});class Fu extends Hs{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=St.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ku extends Hs{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=St.NavigationSkipped}}class O_ extends Hs{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=St.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class qF extends Hs{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=St.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class HJ extends Hs{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=St.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GJ extends Hs{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=St.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class WJ extends Hs{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=St.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jJ extends Hs{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=St.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $J{constructor(e){this.route=e,this.type=St.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class qJ{constructor(e){this.route=e,this.type=St.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class XJ{constructor(e){this.snapshot=e,this.type=St.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class YJ{constructor(e){this.snapshot=e,this.type=St.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ZJ{constructor(e){this.snapshot=e,this.type=St.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class KJ{constructor(e){this.snapshot=e,this.type=St.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class XF{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=St.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class KE{}class JE{constructor(e){this.url=e}}class JJ{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ff,this.attachRef=null}}let Ff=(()=>{var n;class e{constructor(){this.contexts=new Map}onChildOutletCreated(i,r){const s=this.getOrCreateContext(i);s.outlet=r,this.contexts.set(i,s)}onChildOutletDestroyed(i){const r=this.getContext(i);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let r=this.getContext(i);return r||(r=new JJ,this.contexts.set(i,r)),r}getContext(i){return this.contexts.get(i)||null}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();class YF{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=QE(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=QE(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=eS(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return eS(e,this._root).map(t=>t.value)}}function QE(n,e){if(n===e.value)return e;for(const t of e.children){const i=QE(n,t);if(i)return i}return null}function eS(n,e){if(n===e.value)return[e];for(const t of e.children){const i=eS(n,t);if(i.length)return i.unshift(e),i}return[]}class ws{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Uu(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class ZF extends YF{constructor(e,t){super(e),this.snapshot=t,iS(this,e)}toString(){return this.snapshot.toString()}}function KF(n,e){const t=function QJ(n,e){const o=new nS([],{},{},"",{},ct,e,null,{});return new JF("",new ws(o,[]))}(0,e),i=new Wr([new Rf("",{})]),r=new Wr({}),s=new Wr({}),o=new Wr({}),a=new Wr(""),c=new Bu(i,r,o,a,s,ct,e,t.root);return c.snapshot=t.root,new ZF(new ws(c,[]),t)}class Bu{constructor(e,t,i,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(At(l=>l[If]))??Xe(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(At(e=>Nu(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(At(e=>Nu(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function tS(n,e,t="emptyOnly"){let i;const{routeConfig:r}=n;return i=null===e||"always"!==t&&""!==r?.path&&(e.component||e.routeConfig?.loadComponent)?{params:n.params,data:n.data,resolve:{...n.data,...n._resolvedData??{}}}:{params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.data,...r?.data,...n._resolvedData}},r&&e2(r)&&(i.resolve[If]=r.title),i}class nS{get title(){return this.data?.[If]}constructor(e,t,i,r,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Nu(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Nu(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class JF extends YF{constructor(e,t){super(t),this.url=e,iS(this,t)}toString(){return QF(this._root)}}function iS(n,e){e.value._routerState=n,e.children.forEach(t=>iS(n,t))}function QF(n){const e=n.children.length>0?` { ${n.children.map(QF).join(", ")} } `:"";return`${n.value}${e}`}function rS(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,zs(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),zs(e.params,t.params)||n.paramsSubject.next(t.params),function gJ(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!zs(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),zs(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function sS(n,e){const t=zs(n.params,e.params)&&function wJ(n,e){return gc(n,e)&&n.every((t,i)=>zs(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||sS(n.parent,e.parent))}function e2(n){return"string"==typeof n.title||null===n.title}let oS=(()=>{var n;class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ct,this.activateEvents=new Ui,this.deactivateEvents=new Ui,this.attachEvents=new Ui,this.detachEvents=new Ui,this.parentContexts=ve(Ff),this.location=ve(_s),this.changeDetector=ve(Mg),this.environmentInjector=ve(jr),this.inputBinder=ve(F_,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){const{firstChange:r,previousValue:s}=i.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ce(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ce(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ce(4012,!1);this.location.detach();const i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,r){this.activated=i,this._activatedRoute=r,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){const i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,r){if(this.isActivated)throw new ce(4013,!1);this._activatedRoute=i;const s=this.location,a=i.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new eQ(i,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275dir=Li({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ja]}),e})();class eQ{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Bu?this.route:e===Ff?this.childContexts:this.parent.get(e,t)}}const F_=new Ne("");let t2=(()=>{var n;class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(i){this.unsubscribeFromRouteData(i),this.subscribeToRouteData(i)}unsubscribeFromRouteData(i){this.outletDataSubscriptions.get(i)?.unsubscribe(),this.outletDataSubscriptions.delete(i)}subscribeToRouteData(i){const{activatedRoute:r}=i,s=VE([r.queryParams,r.params,r.data]).pipe(Ni(([o,a,c],l)=>(c={...o,...a,...c},0===l?Xe(c):Promise.resolve(c)))).subscribe(o=>{if(!i.isActivated||!i.activatedComponentRef||i.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(i);const a=function bY(n){const e=ft(n);if(!e)return null;const t=new Yd(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(a)for(const{templateName:c}of a.inputs)i.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(i)});this.outletDataSubscriptions.set(i,s)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();function kf(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function nQ(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return kf(n,i,r);return kf(n,i)})}(n,e,t);return new ws(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>kf(n,a)),o}}const i=function iQ(n){return new Bu(new Wr(n.url),new Wr(n.params),new Wr(n.queryParams),new Wr(n.fragment),new Wr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>kf(n,s));return new ws(i,r)}}const aS="ngNavigationCancelingError";function n2(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=_c(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=i2(!1,Zr.Redirect,e);return r.url=t,r.navigationBehaviorOptions=i,r}function i2(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[aS]=!0,i.cancellationCode=e,t&&(i.url=t),i}function r2(n){return n&&n[aS]}let s2=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=Xa({type:n,selectors:[["ng-component"]],standalone:!0,features:[pL],decls:1,vars:0,template:function(i,r){1&i&&fa(0,"router-outlet")},dependencies:[oS],encapsulation:2}),e})();function cS(n){const e=n.children&&n.children.map(cS),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ct&&(t.component=s2),t}function Ws(n){return n.outlet||ct}function Uf(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class hQ{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),rS(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Uu(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Uu(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=Uu(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=Uu(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new KJ(s.value.snapshot))}),e.children.length&&this.forwardEvent(new YJ(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(rS(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),rS(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Uf(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class o2{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class k_{constructor(e,t){this.component=e,this.route=t}}function dQ(n,e,t){const i=n._root;return Bf(i,e?e._root:null,t,[i.value])}function Vu(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function b4(n){return null!==vm(n)}(n)?e.get(n):n:i}function Bf(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Uu(e);return n.children.forEach(o=>{(function pQ(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function mQ(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!gc(n.url,e.url);case"pathParamsOrQueryParamsChange":return!gc(n.url,e.url)||!zs(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!sS(n,e)||!zs(n.queryParams,e.queryParams);default:return!sS(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new o2(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Bf(n,e,s.component?a?a.children:null:t,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new k_(a.outlet.component,o))}else o&&Vf(e,a,r),r.canActivateChecks.push(new o2(i)),Bf(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Vf(a,t.getContext(o),r)),r}function Vf(n,e,t){const i=Uu(n),r=n.value;Object.entries(i).forEach(([s,o])=>{Vf(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new k_(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function zf(n){return"function"==typeof n}function a2(n){return n instanceof S_||"EmptyError"===n?.name}const U_=Symbol("INITIAL_VALUE");function zu(){return Ni(n=>VE(n.map(e=>e.pipe(or(1),function cJ(...n){const e=dd(n);return bn((t,i)=>{(e?Tf(n,t,e):Tf(n,t)).subscribe(i)})}(U_)))).pipe(At(e=>{for(const t of e)if(!0!==t){if(t===U_)return U_;if(!1===t||t instanceof Lu)return t}return!0}),Mr(e=>e!==U_),or(1)))}function c2(n){return function SG(...n){return jA(n)}(ui(e=>{if(_c(e))throw n2(0,e)}),At(e=>!0===e))}class lS{constructor(e){this.segmentGroup=e||null}}class uS extends Error{constructor(e){super(),this.urlTree=e}}function Hu(n){return Af(new lS(n))}class OQ{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new ce(4002,!1)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Xe(i);if(r.numberOfChildren>1||!r.children[ct])return Af(new ce(4e3,!1));r=r.children[ct]}}applyRedirectCommands(e,t,i){const r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t.startsWith("/"))throw new uS(r);return r}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Lu(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,i,r)}),new Bt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new ce(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const hS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function FQ(n,e,t,i,r){const s=dS(n,e,t);return s.matched?(i=function sQ(n,e){return n.providers&&!n._injector&&(n._injector=Fb(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function PQ(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?Xe(r.map(o=>{const a=Vu(o,n);return ga(function xQ(n){return n&&zf(n.canMatch)}(a)?a.canMatch(e,t):nc(n,()=>a(e,t)))})).pipe(zu(),c2()):Xe(!0)}(i,e,t).pipe(At(o=>!0===o?s:{...hS}))):Xe(s)}function dS(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...hS}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||mJ)(t,n,e);if(!r)return{...hS};const s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function l2(n,e,t,i){return t.length>0&&function BQ(n,e,t){return t.some(i=>B_(n,e,i)&&Ws(i)!==ct)}(n,t,i)?{segmentGroup:new Bt(e,UQ(i,new Bt(t,n.children))),slicedSegments:[]}:0===t.length&&function VQ(n,e,t){return t.some(i=>B_(n,e,i))}(n,t,i)?{segmentGroup:new Bt(n.segments,kQ(n,0,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Bt(n.segments,n.children),slicedSegments:t}}function kQ(n,e,t,i,r){const s={};for(const o of i)if(B_(n,t,o)&&!r[Ws(o)]){const a=new Bt([],{});s[Ws(o)]=a}return{...r,...s}}function UQ(n,e){const t={};t[ct]=e;for(const i of n)if(""===i.path&&Ws(i)!==ct){const r=new Bt([],{});t[Ws(i)]=r}return t}function B_(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class GQ{}class $Q{constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new OQ(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ce(4002,!1)}recognize(){const e=l2(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(At(t=>{const i=new nS([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ct,this.rootComponentType,null,{}),r=new ws(i,t),s=new JF("",r),o=function OJ(n,e,t=null,i=null){return zF(VF(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ct).pipe(Pu(i=>{if(i instanceof uS)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof lS?this.noMatchError(i):i}))}inheritParamsAndData(e,t){const i=e.value,r=tS(i,t,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,i))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0).pipe(At(s=>s instanceof ws?[s]:[]))}processChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Kn(r).pipe(Df(s=>{const o=i.children[s],a=function lQ(n,e){const t=n.filter(i=>Ws(i)===e);return t.push(...n.filter(i=>Ws(i)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function hJ(n,e){return bn(function uJ(n,e,t,i,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Rn(o,u=>{const h=l++;c=a?n(c,u,h):(a=!0,u),i&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}(n,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),C_(null),function dJ(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Mr((r,s)=>n(r,s,i)):Yo,GE(1),t?C_(e):CF(()=>new S_))}(),Zn(s=>{if(null===s)return Hu(i);const o=u2(s);return function qQ(n){n.sort((e,t)=>e.value.outlet===ct?-1:t.value.outlet===ct?1:e.value.outlet.localeCompare(t.value.outlet))}(o),Xe(o)}))}processSegment(e,t,i,r,s,o){return Kn(t).pipe(Df(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,i,r,s,o).pipe(Pu(c=>{if(c instanceof lS)return Xe(null);throw c}))),mc(a=>!!a),Pu(a=>{if(a2(a))return function HQ(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?Xe(new GQ):Hu(i);throw a}))}processSegmentAgainstRoute(e,t,i,r,s,o,a){return function zQ(n,e,t,i){return!!(Ws(n)===i||i!==ct&&B_(e,t,n))&&("**"===n.path||dS(e,n,t).matched)}(i,r,s,o)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):Hu(r):Hu(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}="**"===r.path?h2(s):dS(t,r,s);if(!a)return Hu(t);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const h=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,l);return this.applyRedirects.lineralizeSegments(r,h).pipe(Zn(d=>this.processSegment(e,i,t,d.concat(u),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){let o;return"**"===i.path?(o=Xe(h2(r)),t.children={}):o=FQ(t,i,r,e),o.pipe(Ni(a=>a.matched?this.getChildConfig(e=i._injector??e,i,r).pipe(Ni(({routes:c})=>{const l=i._loadedInjector??e,{consumedSegments:u,remainingSegments:h,parameters:d}=a,f=new nS(u,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function YQ(n){return n.data||{}}(i),Ws(i),i.component??i._loadedComponent??null,i,function ZQ(n){return n.resolve||{}}(i)),{segmentGroup:p,slicedSegments:m}=l2(t,u,h,c);if(0===m.length&&p.hasChildren())return this.processChildren(l,c,p).pipe(At(g=>null===g?null:new ws(f,g)));if(0===c.length&&0===m.length)return Xe(new ws(f,[]));const _=Ws(i)===s;return this.processSegment(l,c,p,m,_?ct:s,!0).pipe(At(g=>new ws(f,g instanceof ws?[g]:[])))})):Hu(t)))}getChildConfig(e,t,i){return t.children?Xe({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Xe({routes:t._loadedRoutes,injector:t._loadedInjector}):function RQ(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?Xe(!0):Xe(r.map(o=>{const a=Vu(o,n);return ga(function _Q(n){return n&&zf(n.canLoad)}(a)?a.canLoad(e,t):nc(n,()=>a(e,t)))})).pipe(zu(),c2())}(e,t,i).pipe(Zn(r=>r?this.configLoader.loadChildren(e,t).pipe(ui(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function LQ(n){return Af(i2(!1,Zr.GuardRejected))}())):Xe({routes:[],injector:e})}}function XQ(n){const e=n.value.routeConfig;return e&&""===e.path}function u2(n){const e=[],t=new Set;for(const i of n){if(!XQ(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=u2(i.children);e.push(new ws(i.value,r))}return e.filter(i=>!t.has(i))}function h2(n){return{matched:!0,parameters:n.length>0?DF(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function d2(n){const e=n.children.map(t=>d2(t)).flat();return[n,...e]}function fS(n){return Ni(e=>{const t=n(e);return t?Kn(t).pipe(At(()=>e)):Xe(e)})}let f2=(()=>{var n;class e{buildTitle(i){let r,s=i.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(o=>o.outlet===ct);return r}getResolvedTitleForRoute(i){return i.data[If]}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:()=>ve(nee),providedIn:"root"}),e})(),nee=(()=>{var n;class e extends f2{constructor(i){super(),this.title=i}updateTitle(i){const r=this.buildTitle(i);void 0!==r&&this.title.setTitle(r)}}return(n=e).\u0275fac=function(i){return new(i||n)(we(UE))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const Gu=new Ne("",{providedIn:"root",factory:()=>({})}),Wu=new Ne("ROUTES");let pS=(()=>{var n;class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ve(KL)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Xe(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);const r=ga(i.loadComponent()).pipe(At(p2),ui(o=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=o}),WE(()=>{this.componentLoaders.delete(i)})),s=new HE(r,()=>new Ki).pipe(zE());return this.componentLoaders.set(i,s),s}loadChildren(i,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Xe({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const o=function iee(n,e,t,i){return ga(n.loadChildren()).pipe(At(p2),Zn(r=>r instanceof dL||Array.isArray(r)?Xe(r):Kn(e.compileModuleAsync(r))),At(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(Wu,[],{optional:!0,self:!0}).flat()),{routes:o.map(cS),injector:s}}))}(r,this.compiler,i,this.onLoadEndListener).pipe(WE(()=>{this.childrenLoaders.delete(r)})),a=new HE(o,()=>new Ki).pipe(zE());return this.childrenLoaders.set(r,a),a}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();function p2(n){return function ree(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let mS=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:()=>ve(see),providedIn:"root"}),e})(),see=(()=>{var n;class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,r){return i}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const m2=new Ne(""),g2=new Ne("");function oee(n,e,t){const i=n.get(g2),r=n.get(sr);return n.get(It).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,Promise.resolve();let s;const o=new Promise(l=>{s=l}),a=r.startViewTransition(()=>(s(),function aee(n){return new Promise(e=>{IR(e,{injector:n})})}(n))),{onViewTransitionCreated:c}=i;return c&&nc(n,()=>c({transition:a,from:e,to:t})),o})}let V_=(()=>{var n;class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ki,this.transitionAbortSubject=new Ki,this.configLoader=ve(pS),this.environmentInjector=ve(jr),this.urlSerializer=ve(Ou),this.rootContexts=ve(Ff),this.location=ve(xf),this.inputBindingEnabled=null!==ve(F_,{optional:!0}),this.titleStrategy=ve(f2),this.options=ve(Gu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ve(mS),this.createViewTransition=ve(m2,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Xe(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new qJ(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new $J(s))}complete(){this.transitions?.complete()}handleNavigationRequest(i){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...i,id:r})}setupNavigations(i,r,s){return this.transitions=new Wr({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Of,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Mr(o=>0!==o.id),At(o=>({...o,extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ni(o=>{this.currentTransition=o;let a=!1,c=!1;return Xe(o).pipe(ui(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ni(l=>{const u=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!u&&"reload"!==(l.extras.onSameUrlNavigation??i.onSameUrlNavigation)){const d="";return this.events.next(new ku(l.id,this.urlSerializer.serialize(l.rawUrl),d,L_.IgnoredSameUrlNavigation)),l.resolve(null),Cs}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Xe(l).pipe(Ni(d=>{const f=this.transitions?.getValue();return this.events.next(new N_(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),f!==this.transitions?.getValue()?Cs:Promise.resolve(d)}),function KQ(n,e,t,i,r,s){return Zn(o=>function WQ(n,e,t,i,r,s,o="emptyOnly"){return new $Q(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(At(({state:a,tree:c})=>({...o,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),ui(d=>{o.targetSnapshot=d.targetSnapshot,o.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects};const f=new qF(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:d,extractedUrl:f,source:p,restoredState:m,extras:_}=l,g=new N_(d,this.urlSerializer.serialize(f),p,m);this.events.next(g);const v=KF(0,this.rootComponentType).snapshot;return this.currentTransition=o={...l,targetSnapshot:v,urlAfterRedirects:f,extras:{..._,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=f,Xe(o)}{const d="";return this.events.next(new ku(l.id,this.urlSerializer.serialize(l.extractedUrl),d,L_.IgnoredByUrlHandlingStrategy)),l.resolve(null),Cs}}),ui(l=>{const u=new HJ(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),At(l=>(this.currentTransition=o={...l,guards:dQ(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},o)),function EQ(n,e){return Zn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Xe({...t,guardsResult:!0}):function SQ(n,e,t,i){return Kn(n).pipe(Zn(r=>function IQ(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||0===s.length)return Xe(!0);const o=s.map(a=>{const c=Uf(e)??r,l=Vu(a,c);return ga(function wQ(n){return n&&zf(n.canDeactivate)}(l)?l.canDeactivate(n,e,t,i):nc(c,()=>l(n,e,t,i))).pipe(mc())});return Xe(o).pipe(zu())}(r.component,r.route,t,e,i)),mc(r=>!0!==r,!0))}(o,i,r,n).pipe(Zn(a=>a&&function gQ(n){return"boolean"==typeof n}(a)?function MQ(n,e,t,i){return Kn(e).pipe(Df(r=>Tf(function TQ(n,e){return null!==n&&e&&e(new XJ(n)),Xe(!0)}(r.route.parent,i),function CQ(n,e){return null!==n&&e&&e(new ZJ(n)),Xe(!0)}(r.route,i),function DQ(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function fQ(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>M_(()=>Xe(o.guards.map(c=>{const l=Uf(o.node)??t,u=Vu(c,l);return ga(function yQ(n){return n&&zf(n.canActivateChild)}(u)?u.canActivateChild(i,n):nc(l,()=>u(i,n))).pipe(mc())})).pipe(zu())));return Xe(s).pipe(zu())}(n,r.path,t),function AQ(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Xe(!0);const r=i.map(s=>M_(()=>{const o=Uf(e)??t,a=Vu(s,o);return ga(function vQ(n){return n&&zf(n.canActivate)}(a)?a.canActivate(e,n):nc(o,()=>a(e,n))).pipe(mc())}));return Xe(r).pipe(zu())}(n,r.route,t))),mc(r=>!0!==r,!0))}(i,s,n,e):Xe(a)),At(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),ui(l=>{if(o.guardsResult=l.guardsResult,_c(l.guardsResult))throw n2(0,l.guardsResult);const u=new GJ(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),Mr(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",Zr.GuardRejected),!1)),fS(l=>{if(l.guards.canActivateChecks.length)return Xe(l).pipe(ui(u=>{const h=new WJ(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}),Ni(u=>{let h=!1;return Xe(u).pipe(function JQ(n,e){return Zn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Xe(t);const s=new Set(r.map(c=>c.route)),o=new Set;for(const c of s)if(!o.has(c))for(const l of d2(c))o.add(l);let a=0;return Kn(o).pipe(Df(c=>s.has(c)?function QQ(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!e2(r)&&(s[If]=r.title),function eee(n,e,t,i){const r=jE(n);if(0===r.length)return Xe({});const s={};return Kn(r).pipe(Zn(o=>function tee(n,e,t,i){const r=Uf(e)??i,s=Vu(n,r);return ga(s.resolve?s.resolve(e,t):nc(r,()=>s(e,t)))}(n[o],e,t,i).pipe(mc(),ui(a=>{s[o]=a}))),GE(1),TF(s),Pu(o=>a2(o)?Cs:Af(o)))}(s,n,e,i).pipe(At(o=>(n._resolvedData=o,n.data=tS(n,n.parent,t).resolve,null)))}(c,i,n,e):(c.data=tS(c,c.parent,n).resolve,Xe(void 0))),ui(()=>a++),GE(1),Zn(c=>a===o.size?Xe(t):Cs))})}(this.paramsInheritanceStrategy,this.environmentInjector),ui({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(u,"",Zr.NoDataFromResolver)}}))}),ui(u=>{const h=new jJ(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}))}),fS(l=>{const u=h=>{const d=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(h.routeConfig).pipe(ui(f=>{h.component=f}),At(()=>{})));for(const f of h.children)d.push(...u(f));return d};return VE(u(l.targetSnapshot.root)).pipe(C_(),or(1))}),fS(()=>this.afterPreactivation()),Ni(()=>{const{currentSnapshot:l,targetSnapshot:u}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return h?Kn(h).pipe(At(()=>o)):Xe(o)}),At(l=>{const u=function tQ(n,e,t){const i=kf(n,e._root,t?t._root:void 0);return new ZF(i,e)}(i.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o={...l,targetRouterState:u},this.currentNavigation.targetRouterState=u,o}),ui(()=>{this.events.next(new KE)}),((n,e,t,i)=>At(r=>(new hQ(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,i.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),or(1),ui({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Gs(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),function fJ(n){return bn((e,t)=>{Pi(n).subscribe(Rn(t,()=>t.complete(),ud)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe(ui(l=>{throw l}))),WE(()=>{a||c||this.cancelNavigationTransition(o,"",Zr.SupersededByNewNavigation),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Pu(l=>{if(c=!0,r2(l))this.events.next(new Fu(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),function rQ(n){return r2(n)&&_c(n.url)}(l)?this.events.next(new JE(l.url)):o.resolve(!1);else{this.events.next(new O_(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(i.errorHandler(l))}catch(u){o.reject(u)}}return Cs}))}))}cancelNavigationTransition(i,r,s){const o=new Fu(i.id,this.urlSerializer.serialize(i.extractedUrl),r,s);this.events.next(o),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();function cee(n){return n!==Of}let lee=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:()=>ve(hee),providedIn:"root"}),e})();class uee{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let hee=(()=>{var n;class e extends uee{}return(n=e).\u0275fac=(()=>{let t;return function(r){return(t||(t=Uw(n)))(r||n)}})(),n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})(),_2=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:()=>ve(dee),providedIn:"root"}),e})(),dee=(()=>{var n;class e extends _2{constructor(){super(...arguments),this.location=ve(xf),this.urlSerializer=ve(Ou),this.options=ve(Gu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ve(mS),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Lu,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=KF(0,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(r=>{"popstate"===r.type&&i(r.url,r.state)})}handleRouterEvent(i,r){if(i instanceof N_)this.stateMemento=this.createStateMemento();else if(i instanceof ku)this.rawUrlTree=r.initialUrl;else if(i instanceof qF){if("eager"===this.urlUpdateStrategy&&!r.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(s,r)}}else i instanceof KE?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):i instanceof Fu&&(i.code===Zr.GuardRejected||i.code===Zr.NoDataFromResolver)?this.restoreHistory(r):i instanceof O_?this.restoreHistory(r,!0):i instanceof Gs&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,r){const s=this.urlSerializer.serialize(i);if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){const a={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(s,"",a)}else{const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(s,"",o)}}restoreHistory(i,r=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.currentUrlTree===i.finalUrl&&0===o&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,r){return"computed"===this.canceledNavigationResolution?{navigationId:i,\u0275routerPageId:r}:{navigationId:i}}}return(n=e).\u0275fac=(()=>{let t;return function(r){return(t||(t=Uw(n)))(r||n)}})(),n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var Hf=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Hf||{});function v2(n,e){n.events.pipe(Mr(t=>t instanceof Gs||t instanceof Fu||t instanceof O_||t instanceof ku),At(t=>t instanceof Gs||t instanceof ku?Hf.COMPLETE:t instanceof Fu&&(t.code===Zr.Redirect||t.code===Zr.SupersededByNewNavigation)?Hf.REDIRECTING:Hf.FAILED),Mr(t=>t!==Hf.REDIRECTING),or(1)).subscribe(()=>{e()})}function fee(n){throw n}const pee={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},mee={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Kr=(()=>{var n;class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=ve(XL),this.stateManager=ve(_2),this.options=ve(Gu,{optional:!0})||{},this.pendingTasks=ve(ZL),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ve(V_),this.urlSerializer=ve(Ou),this.location=ve(xf),this.urlHandlingStrategy=ve(mS),this._events=new Ki,this.errorHandler=this.options.errorHandler||fee,this.navigated=!1,this.routeReuseStrategy=ve(lee),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ve(Wu,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ve(F_,{optional:!0}),this.eventsSubscription=new Zi,this.isNgZoneEnabled=ve(It)instanceof It&&It.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const i=this.navigationTransitions.events.subscribe(r=>{try{const s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(null!==s&&null!==o)if(this.stateManager.handleRouterEvent(r,o),r instanceof Fu&&r.code!==Zr.Redirect&&r.code!==Zr.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Gs)this.navigated=!0;else if(r instanceof JE){const a=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),c={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||cee(s.source)};this.scheduleNavigation(a,Of,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}(function _ee(n){return!(n instanceof KE||n instanceof JE)})(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Of,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",r)},0)}))}navigateToSyncWithBrowser(i,r,s){const o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){const l={...s};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const c=this.parseUrl(i);this.scheduleNavigation(c,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(cS),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,r={}){const{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=r,u=l?this.currentUrlTree.fragment:a;let d,h=null;switch(c){case"merge":h={...this.currentUrlTree.queryParams,...o};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}null!==h&&(h=this.removeEmptyProps(h));try{d=VF(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof i[0]||!i[0].startsWith("/"))&&(i=[]),d=this.currentUrlTree.root}return zF(d,i,h,u??null)}navigateByUrl(i,r={skipLocationChange:!1}){const s=_c(i)?i:this.parseUrl(i),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Of,null,r)}navigate(i,r={skipLocationChange:!1}){return function gee(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new ce(4008,!1)}(i),this.navigateByUrl(this.createUrlTree(i,r),r)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,r){let s;if(s=!0===r?{...pee}:!1===r?{...mee}:r,_c(i))return RF(this.currentUrlTree,i,s);const o=this.parseUrl(i);return RF(this.currentUrlTree,o,s)}removeEmptyProps(i){return Object.keys(i).reduce((r,s)=>{const o=i[s];return null!=o&&(r[s]=o),r},{})}scheduleNavigation(i,r,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((d,f)=>{c=d,l=f});const h=this.pendingTasks.add();return v2(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:o,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(d=>Promise.reject(d))}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();class y2{}let wee=(()=>{var n;class e{constructor(i,r,s,o,a){this.router=i,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Mr(i=>i instanceof Gs),Df(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,r){const s=[];for(const o of r){o.providers&&!o._injector&&(o._injector=Fb(o.providers,i,`Route: ${o.path}`));const a=o._injector??i,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return Kn(s).pipe(Tl())}preloadConfig(i,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(i,r):Xe(null);const o=s.pipe(Zn(a=>null===a?Xe(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,this.processRoutes(a.injector??i,a.routes))));return r.loadComponent&&!r._loadedComponent?Kn([o,this.loader.loadComponent(r)]).pipe(Tl()):o})}}return(n=e).\u0275fac=function(i){return new(i||n)(we(Kr),we(KL),we(jr),we(y2),we(pS))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();const _S=new Ne("");let w2=(()=>{var n;class e{constructor(i,r,s,o,a={}){this.urlSerializer=i,this.transitions=r,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof N_?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof Gs?(this.lastId=i.id,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.urlAfterRedirects).fragment)):i instanceof ku&&i.code===L_.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof XF&&(i.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(i.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new XF(i,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(n=e).\u0275fac=function(i){!function iR(){throw new Error("invalid")}()},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();function js(n,e){return{\u0275kind:n,\u0275providers:e}}function b2(){const n=ve(nr);return e=>{const t=n.get(dc);if(e!==t.components[0])return;const i=n.get(Kr),r=n.get(E2);1===n.get(vS)&&i.initialNavigation(),n.get(S2,null,yt.Optional)?.setUpPreloading(),n.get(_S,null,yt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const E2=new Ne("",{factory:()=>new Ki}),vS=new Ne("",{providedIn:"root",factory:()=>1}),S2=new Ne("");function See(n){return js(0,[{provide:S2,useExisting:wee},{provide:y2,useExisting:n}])}function Cee(n){return js(9,[{provide:m2,useValue:oee},{provide:g2,useValue:{skipNextTransition:!!n?.skipInitialTransition,...n}}])}const M2=new Ne("ROUTER_FORROOT_GUARD"),Tee=[xf,{provide:Ou,useClass:$E},Kr,Ff,{provide:Bu,useFactory:function x2(n){return n.routerState.root},deps:[Kr]},pS,[]];let C2=(()=>{var n;class e{constructor(i){}static forRoot(i,r){return{ngModule:e,providers:[Tee,[],{provide:Wu,multi:!0,useValue:i},{provide:M2,useFactory:Ree,deps:[[Kr,new zm,new Hm]]},{provide:Gu,useValue:r||{}},r?.useHash?{provide:pc,useClass:TY}:{provide:pc,useClass:BO},{provide:_S,useFactory:()=>{const n=ve(YZ),e=ve(It),t=ve(Gu),i=ve(V_),r=ve(Ou);return t.scrollOffset&&n.setOffset(t.scrollOffset),new w2(r,i,n,e,t)}},r?.preloadingStrategy?See(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Pee(r):[],r?.bindToComponentInputs?js(8,[t2,{provide:F_,useExisting:t2}]).\u0275providers:[],r?.enableViewTransitions?Cee().\u0275providers:[],[{provide:T2,useFactory:b2},{provide:eE,multi:!0,useExisting:T2}]]}}static forChild(i){return{ngModule:e,providers:[{provide:Wu,multi:!0,useValue:i}]}}}return(n=e).\u0275fac=function(i){return new(i||n)(we(M2,8))},n.\u0275mod=As({type:n}),n.\u0275inj=us({}),e})();function Ree(n){return"guarded"}function Pee(n){return["disabled"===n.initialNavigation?js(3,[{provide:t_,multi:!0,useFactory:()=>{const e=ve(Kr);return()=>{e.setUpLocationChangeListener()}}},{provide:vS,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?js(2,[{provide:vS,useValue:0},{provide:t_,multi:!0,deps:[nr],useFactory:e=>{const t=e.get(MY,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Kr),s=e.get(E2);v2(r,()=>{i(!0)}),e.get(V_).afterPreactivation=()=>(i(!0),s.closed?Xe(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const T2=new Ne("");function A2(n,e,t,i,r,s,o){try{var a=n[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(i,r)}function Fn(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(c){A2(s,i,r,o,a,"next",c)}function a(c){A2(s,i,r,o,a,"throw",c)}o(void 0)})}}const I2=1,R2=2,bo=3,H_=0,ste=1,ote=2,So=0,F2=1,k2=2,U2=3,ES=4,B2=5,V2="attached",ya=301,yc=302,Gf=306,Cr=1e3,wi=1001,Cn=1003,an=1006,Mo=1008,wa=1009,xa=1014,qs=1015,$f=1016,wc=1020,Tr=1023,xc=1026,$u=1027,qf=2300,qu=2301,bc=3001,Wt="srgb",Qn="srgb-linear",LS="display-p3",X_="display-p3-linear",Y_="linear",tn="srgb",Z_="rec709",K_="p3",Zu=7680,Sk="300 es",Xs=2e3;class Sc{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const xi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const Mc=Math.PI/180,Ku=180/Math.PI;function Ar(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(xi[255&n]+xi[n>>8&255]+xi[n>>16&255]+xi[n>>24&255]+"-"+xi[255&e]+xi[e>>8&255]+"-"+xi[e>>16&15|64]+xi[e>>24&255]+"-"+xi[63&t|128]+xi[t>>8&255]+"-"+xi[t>>16&255]+xi[t>>24&255]+xi[255&i]+xi[i>>8&255]+xi[i>>16&255]+xi[i>>24&255]).toLowerCase()}function mn(n,e,t){return Math.max(e,Math.min(t,n))}function FS(n,e){return(n%e+e)%e}function Yf(n,e,t){return(1-t)*n+t*e}function kS(n){return 0==(n&n-1)&&0!==n}function Q_(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function ar(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function lt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const Cc_DEG2RAD=Mc,Cc_degToRad=function Vte(n){return n*Mc},Cc_radToDeg=function zte(n){return n*Ku};class Y{constructor(e=0,t=0){Y.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(mn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class pt{constructor(e,t,i,r,s,o,a,c,l){pt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,c,l)}set(e,t,i,r,s,o,a,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=i,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],l=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],m=r[0],_=r[3],g=r[6],v=r[1],y=r[4],w=r[7],x=r[2],E=r[5],S=r[8];return s[0]=o*m+a*v+c*x,s[3]=o*_+a*y+c*E,s[6]=o*g+a*w+c*S,s[1]=l*m+u*v+h*x,s[4]=l*_+u*y+h*E,s[7]=l*g+u*w+h*S,s[2]=d*m+f*v+p*x,s[5]=d*_+f*y+p*E,s[8]=d*g+f*w+p*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-i*s*u+i*a*c+r*s*l-r*o*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=u*o-a*l,d=a*c-u*s,f=l*s-o*c,p=t*h+i*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=h*m,e[1]=(r*l-u*i)*m,e[2]=(a*i-r*o)*m,e[3]=d*m,e[4]=(u*t-r*c)*m,e[5]=(r*s-a*t)*m,e[6]=f*m,e[7]=(i*c-l*t)*m,e[8]=(o*t-i*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(US.makeScale(e,t)),this}rotate(e){return this.premultiply(US.makeRotation(-e)),this}translate(e,t){return this.premultiply(US.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const US=new pt;function Ck(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Zf(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function jte(){const n=Zf("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Tk={};function Kf(n){n in Tk||(Tk[n]=!0,console.warn(n))}const Ak=(new pt).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Dk=(new pt).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),ev={[Qn]:{transfer:Y_,primaries:Z_,toReference:n=>n,fromReference:n=>n},[Wt]:{transfer:tn,primaries:Z_,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[X_]:{transfer:Y_,primaries:K_,toReference:n=>n.applyMatrix3(Dk),fromReference:n=>n.applyMatrix3(Ak)},[LS]:{transfer:tn,primaries:K_,toReference:n=>n.convertSRGBToLinear().applyMatrix3(Dk),fromReference:n=>n.applyMatrix3(Ak).convertLinearToSRGB()}},$te=new Set([Qn,X_]),Lt={enabled:!0,_workingColorSpace:Qn,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!$te.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){return!1!==this.enabled&&e!==t&&e&&t?(0,ev[t].fromReference)((0,ev[e].toReference)(n)):n},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return ev[n].primaries},getTransfer:function(n){return""===n?Y_:ev[n].transfer}};function Qu(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function BS(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let eh;class Ik{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===eh&&(eh=Zf("canvas")),eh.width=e.width,eh.height=e.height;const i=eh.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=eh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Zf("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Qu(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Qu(t[i]/255)):Qu(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let qte=0;class th{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:qte++}),this.uuid=Ar(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(VS(r[o].isDataTexture?r[o].image:r[o]))}else s=VS(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function VS(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Ik.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Xte=0,Qr=(()=>{class n extends Sc{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=wi,s=wi,o=an,a=Mo,c=Tr,l=wa,u=n.DEFAULT_ANISOTROPY,h=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Xte++}),this.uuid=Ar(),this.name="",this.source=new th(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new Y(0,0),this.repeat=new Y(1,1),this.center=new Y(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new pt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof h?this.colorSpace=h:(Kf("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===bc?Wt:""),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Cr:t.x=t.x-Math.floor(t.x);break;case wi:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Cr:t.y=t.y-Math.floor(t.y);break;case wi:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Kf("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Wt?bc:3e3}set encoding(t){Kf("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===bc?Wt:""}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Vt{constructor(e=0,t=0,i=0,r=1){Vt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,l=c[0],u=c[4],h=c[8],d=c[1],f=c[5],p=c[9],m=c[2],_=c[6],g=c[10];if(Math.abs(u-d)<.01&&Math.abs(h-m)<.01&&Math.abs(p-_)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+m)<.1&&Math.abs(p+_)<.1&&Math.abs(l+f+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(l+1)/2,w=(f+1)/2,x=(g+1)/2,E=(u+d)/4,S=(h+m)/4,M=(p+_)/4;return y>w&&y>x?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=E/i,s=S/i):w>x?w<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(w),i=E/r,s=M/r):x<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(x),i=S/s,r=M/s),this.set(i,r,s,t),this}let v=Math.sqrt((_-p)*(_-p)+(h-m)*(h-m)+(d-u)*(d-u));return Math.abs(v)<.001&&(v=1),this.x=(_-p)/v,this.y=(h-m)/v,this.z=(d-u)/v,this.w=Math.acos((l+f+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Yte extends Sc{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Vt(0,0,e,t),this.scissorTest=!1,this.viewport=new Vt(0,0,e,t);const r={width:e,height:t,depth:1};void 0!==i.encoding&&(Kf("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===bc?Wt:""),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:an,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Qr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new th(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Tc extends Yte{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class zS extends Qr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Cn,this.minFilter=Cn,this.wrapR=wi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Rk extends Qr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Cn,this.minFilter=Cn,this.wrapR=wi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class hi{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],l=i[r+1],u=i[r+2],h=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(0===a)return e[t+0]=c,e[t+1]=l,e[t+2]=u,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=m);if(h!==m||c!==d||l!==f||u!==p){let _=1-a;const g=c*d+l*f+u*p+h*m,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){const x=Math.sqrt(y),E=Math.atan2(x,g*v);_=Math.sin(_*E)/x,a=Math.sin(a*E)/x}const w=a*v;if(c=c*_+d*w,l=l*_+f*w,u=u*_+p*w,h=h*_+m*w,_===1-a){const x=1/Math.sqrt(c*c+l*l+u*u+h*h);c*=x,l*=x,u*=x,h*=x}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],c=i[r+1],l=i[r+2],u=i[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+c*f-l*d,e[t+1]=c*p+u*d+l*h-a*f,e[t+2]=l*p+u*f+a*d-c*h,e[t+3]=u*p-a*h-c*d-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(i/2),u=a(r/2),h=a(s/2),d=c(i/2),f=c(r/2),p=c(s/2);switch(o){case"XYZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"YZX":this._x=d*u*h+l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h-d*f*p;break;case"XZY":this._x=d*u*h-l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],h=t[10],d=i+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-c)*f,this._y=(s-l)*f,this._z=(o-r)*f}else if(i>a&&i>h){const f=2*Math.sqrt(1+i-a-h);this._w=(u-c)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+l)/f}else if(a>h){const f=2*Math.sqrt(1+a-i-h);this._w=(s-l)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(c+u)/f}else{const f=2*Math.sqrt(1+h-i-a);this._w=(o-r)/f,this._x=(s+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(mn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=i*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-i*l,this._z=s*u+o*l+i*c-r*a,this._w=o*u-i*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(c),u=Math.atan2(l,a),h=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=o*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class A{constructor(e=0,t=0,i=0){A.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Pk.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Pk.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=2*(o*r-a*i),u=2*(a*t-s*r),h=2*(s*i-o*t);return this.x=t+c*l+o*h-a*u,this.y=i+c*u+a*l-s*h,this.z=r+c*h+s*u-o*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return HS.copy(this).projectOnVector(e),this.sub(HS)}reflect(e){return this.sub(HS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(mn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const HS=new A,Pk=new hi;class Wi{constructor(e=new A(1/0,1/0,1/0),t=new A(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(xs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(xs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=xs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const s=i.getAttribute("position");if(!0===t&&void 0!==s&&!0!==e.isInstancedMesh)for(let o=0,a=s.count;o<a;o++)!0===e.isMesh?e.getVertexPosition(o,xs):xs.fromBufferAttribute(s,o),xs.applyMatrix4(e.matrixWorld),this.expandByPoint(xs);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),tv.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),tv.copy(i.boundingBox)),tv.applyMatrix4(e.matrixWorld),this.union(tv)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,xs),xs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Jf),nv.subVectors(this.max,Jf),nh.subVectors(e.a,Jf),ih.subVectors(e.b,Jf),rh.subVectors(e.c,Jf),ba.subVectors(ih,nh),Ea.subVectors(rh,ih),Ac.subVectors(nh,rh);let t=[0,-ba.z,ba.y,0,-Ea.z,Ea.y,0,-Ac.z,Ac.y,ba.z,0,-ba.x,Ea.z,0,-Ea.x,Ac.z,0,-Ac.x,-ba.y,ba.x,0,-Ea.y,Ea.x,0,-Ac.y,Ac.x,0];return!(!GS(t,nh,ih,rh,nv)||(t=[1,0,0,0,1,0,0,0,1],!GS(t,nh,ih,rh,nv)))&&(iv.crossVectors(ba,Ea),t=[iv.x,iv.y,iv.z],GS(t,nh,ih,rh,nv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,xs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(xs).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Co[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Co[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Co[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Co[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Co[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Co[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Co[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Co[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Co)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Co=[new A,new A,new A,new A,new A,new A,new A,new A],xs=new A,tv=new Wi,nh=new A,ih=new A,rh=new A,ba=new A,Ea=new A,Ac=new A,Jf=new A,nv=new A,iv=new A,Dc=new A;function GS(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Dc.fromArray(n,s);const a=r.x*Math.abs(Dc.x)+r.y*Math.abs(Dc.y)+r.z*Math.abs(Dc.z),c=e.dot(Dc),l=t.dot(Dc),u=i.dot(Dc);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}const Zte=new Wi,Qf=new A,WS=new A;class bi{constructor(e=new A,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):Zte.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Qf.subVectors(e,this.center);const t=Qf.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Qf,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(WS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Qf.copy(e.center).add(WS)),this.expandByPoint(Qf.copy(e.center).sub(WS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const To=new A,jS=new A,rv=new A,Sa=new A,$S=new A,sv=new A,qS=new A;class Ic{constructor(e=new A,t=new A(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,To)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=To.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(To.copy(this.origin).addScaledVector(this.direction,t),To.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){jS.copy(e).add(t).multiplyScalar(.5),rv.copy(t).sub(e).normalize(),Sa.copy(this.origin).sub(jS);const s=.5*e.distanceTo(t),o=-this.direction.dot(rv),a=Sa.dot(this.direction),c=-Sa.dot(rv),l=Sa.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*c-a,d=o*a-c,p=s*u,h>=0)if(d>=-p)if(d<=p){const m=1/u;h*=m,d*=m,f=h*(h+o*d+2*a)+d*(o*h+d+2*c)+l}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l):d<=p?(h=0,d=Math.min(Math.max(-s,-c),s),f=d*(d+2*c)+l):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(jS).addScaledVector(rv,d),f}intersectSphere(e,t){To.subVectors(e.center,this.origin);const i=To.dot(this.direction),r=To.dot(To)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,c=i+o;return c<0?null:this.at(a<0?c:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c;const l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,c=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,c=(e.min.z-d.z)*h),i>c||a>r)||((a>i||i!=i)&&(i=a),(c<r||r!=r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,To)}intersectTriangle(e,t,i,r,s){$S.subVectors(t,e),sv.subVectors(i,e),qS.crossVectors($S,sv);let a,o=this.direction.dot(qS);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Sa.subVectors(this.origin,e);const c=a*this.direction.dot(sv.crossVectors(Sa,sv));if(c<0)return null;const l=a*this.direction.dot($S.cross(Sa));if(l<0||c+l>o)return null;const u=-a*Sa.dot(qS);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ge{constructor(e,t,i,r,s,o,a,c,l,u,h,d,f,p,m,_){Ge.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,c,l,u,h,d,f,p,m,_)}set(e,t,i,r,s,o,a,c,l,u,h,d,f,p,m,_){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=c,g[2]=l,g[6]=u,g[10]=h,g[14]=d,g[3]=f,g[7]=p,g[11]=m,g[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ge).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/sh.setFromMatrixColumn(e,0).length(),s=1/sh.setFromMatrixColumn(e,1).length(),o=1/sh.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=c*u,t[4]=-c*h,t[8]=l,t[1]=f+p*l,t[5]=d-m*l,t[9]=-a*c,t[2]=m-d*l,t[6]=p+f*l,t[10]=o*c}else if("YXZ"===e.order){const d=c*u,f=c*h,p=l*u,m=l*h;t[0]=d+m*a,t[4]=p*a-f,t[8]=o*l,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=m+d*a,t[10]=o*c}else if("ZXY"===e.order){const d=c*u,f=c*h,p=l*u,m=l*h;t[0]=d-m*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=m-d*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if("ZYX"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=c*u,t[4]=p*l-f,t[8]=d*l+m,t[1]=c*h,t[5]=m*l+d,t[9]=f*l-p,t[2]=-l,t[6]=a*c,t[10]=o*c}else if("YZX"===e.order){const d=o*c,f=o*l,p=a*c,m=a*l;t[0]=c*u,t[4]=m-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=f*h+p,t[10]=d-m*h}else if("XZY"===e.order){const d=o*c,f=o*l,p=a*c,m=a*l;t[0]=c*u,t[4]=-h,t[8]=l*u,t[1]=d*h+m,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=m*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Kte,e,Jte)}lookAt(e,t,i){const r=this.elements;return Dr.subVectors(e,t),0===Dr.lengthSq()&&(Dr.z=1),Dr.normalize(),Ma.crossVectors(i,Dr),0===Ma.lengthSq()&&(1===Math.abs(i.z)?Dr.x+=1e-4:Dr.z+=1e-4,Dr.normalize(),Ma.crossVectors(i,Dr)),Ma.normalize(),ov.crossVectors(Dr,Ma),r[0]=Ma.x,r[4]=ov.x,r[8]=Dr.x,r[1]=Ma.y,r[5]=ov.y,r[9]=Dr.y,r[2]=Ma.z,r[6]=ov.z,r[10]=Dr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],l=i[12],u=i[1],h=i[5],d=i[9],f=i[13],p=i[2],m=i[6],_=i[10],g=i[14],v=i[3],y=i[7],w=i[11],x=i[15],E=r[0],S=r[4],M=r[8],b=r[12],C=r[1],L=r[5],F=r[9],B=r[13],R=r[2],k=r[6],V=r[10],z=r[14],re=r[3],q=r[7],ee=r[11],te=r[15];return s[0]=o*E+a*C+c*R+l*re,s[4]=o*S+a*L+c*k+l*q,s[8]=o*M+a*F+c*V+l*ee,s[12]=o*b+a*B+c*z+l*te,s[1]=u*E+h*C+d*R+f*re,s[5]=u*S+h*L+d*k+f*q,s[9]=u*M+h*F+d*V+f*ee,s[13]=u*b+h*B+d*z+f*te,s[2]=p*E+m*C+_*R+g*re,s[6]=p*S+m*L+_*k+g*q,s[10]=p*M+m*F+_*V+g*ee,s[14]=p*b+m*B+_*z+g*te,s[3]=v*E+y*C+w*R+x*re,s[7]=v*S+y*L+w*k+x*q,s[11]=v*M+y*F+w*V+x*ee,s[15]=v*b+y*B+w*z+x*te,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],h=e[6],d=e[10],f=e[14];return e[3]*(+s*c*h-r*l*h-s*a*d+i*l*d+r*a*f-i*c*f)+e[7]*(+t*c*f-t*l*d+s*o*d-r*o*f+r*l*u-s*c*u)+e[11]*(+t*l*h-t*a*f-s*o*h+i*o*f+s*a*u-i*l*u)+e[15]*(-r*a*u-t*c*h+t*a*d+r*o*h-i*o*d+i*c*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],_=e[14],g=e[15],v=h*_*l-m*d*l+m*c*f-a*_*f-h*c*g+a*d*g,y=p*d*l-u*_*l-p*c*f+o*_*f+u*c*g-o*d*g,w=u*m*l-p*h*l+p*a*f-o*m*f-u*a*g+o*h*g,x=p*h*c-u*m*c-p*a*d+o*m*d+u*a*_-o*h*_,E=t*v+i*y+r*w+s*x;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/E;return e[0]=v*S,e[1]=(m*d*s-h*_*s-m*r*f+i*_*f+h*r*g-i*d*g)*S,e[2]=(a*_*s-m*c*s+m*r*l-i*_*l-a*r*g+i*c*g)*S,e[3]=(h*c*s-a*d*s-h*r*l+i*d*l+a*r*f-i*c*f)*S,e[4]=y*S,e[5]=(u*_*s-p*d*s+p*r*f-t*_*f-u*r*g+t*d*g)*S,e[6]=(p*c*s-o*_*s-p*r*l+t*_*l+o*r*g-t*c*g)*S,e[7]=(o*d*s-u*c*s+u*r*l-t*d*l-o*r*f+t*c*f)*S,e[8]=w*S,e[9]=(p*h*s-u*m*s-p*i*f+t*m*f+u*i*g-t*h*g)*S,e[10]=(o*m*s-p*a*s+p*i*l-t*m*l-o*i*g+t*a*g)*S,e[11]=(u*a*s-o*h*s-u*i*l+t*h*l+o*i*f-t*a*f)*S,e[12]=x*S,e[13]=(u*m*r-p*h*r+p*i*d-t*m*d-u*i*_+t*h*_)*S,e[14]=(p*a*r-o*m*r-p*i*c+t*m*c+o*i*_-t*a*_)*S,e[15]=(o*h*r-u*a*r+u*i*c-t*h*c-o*i*d+t*a*d)*S,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+i,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+i,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,h=a+a,d=s*l,f=s*u,p=s*h,m=o*u,_=o*h,g=a*h,v=c*l,y=c*u,w=c*h,x=i.x,E=i.y,S=i.z;return r[0]=(1-(m+g))*x,r[1]=(f+w)*x,r[2]=(p-y)*x,r[3]=0,r[4]=(f-w)*E,r[5]=(1-(d+g))*E,r[6]=(_+v)*E,r[7]=0,r[8]=(p+y)*S,r[9]=(_-v)*S,r[10]=(1-(d+m))*S,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=sh.set(r[0],r[1],r[2]).length();const o=sh.set(r[4],r[5],r[6]).length(),a=sh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],bs.copy(this);const l=1/s,u=1/o,h=1/a;return bs.elements[0]*=l,bs.elements[1]*=l,bs.elements[2]*=l,bs.elements[4]*=u,bs.elements[5]*=u,bs.elements[6]*=u,bs.elements[8]*=h,bs.elements[9]*=h,bs.elements[10]*=h,t.setFromRotationMatrix(bs),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Xs){const c=this.elements,l=2*s/(t-e),u=2*s/(i-r),h=(t+e)/(t-e),d=(i+r)/(i-r);let f,p;if(a===Xs)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-o/(o-s),p=-o*s/(o-s)}return c[0]=l,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=u,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=f,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Xs){const c=this.elements,l=1/(t-e),u=1/(i-r),h=1/(o-s),d=(t+e)*l,f=(i+r)*u;let p,m;if(a===Xs)p=(o+s)*h,m=-2*h;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=s*h,m=-1*h}return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-f,c[2]=0,c[6]=0,c[10]=m,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const sh=new A,bs=new Ge,Kte=new A(0,0,0),Jte=new A(1,1,1),Ma=new A,ov=new A,Dr=new A,Nk=new Ge,Lk=new hi;let Qte=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(mn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-mn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(c,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(mn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-mn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(mn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(c,p));break;case"XZY":this._z=Math.asin(-mn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return Nk.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Nk,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return Lk.setFromEuler(this),this.setFromQuaternion(Lk,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class XS{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let ene=0;const Ok=new A,oh=new hi,Ao=new Ge,av=new A,ep=new A,tne=new A,nne=new hi,Fk=new A(1,0,0),kk=new A(0,1,0),Uk=new A(0,0,1),ine={type:"added"},rne={type:"removed"};let gn=(()=>{class n extends Sc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ene++}),this.uuid=Ar(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new A,i=new Qte,r=new hi,s=new A(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ge},normalMatrix:{value:new pt}}),this.matrix=new Ge,this.matrixWorld=new Ge,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new XS,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return oh.setFromAxisAngle(t,i),this.quaternion.multiply(oh),this}rotateOnWorldAxis(t,i){return oh.setFromAxisAngle(t,i),this.quaternion.premultiply(oh),this}rotateX(t){return this.rotateOnAxis(Fk,t)}rotateY(t){return this.rotateOnAxis(kk,t)}rotateZ(t){return this.rotateOnAxis(Uk,t)}translateOnAxis(t,i){return Ok.copy(t).applyQuaternion(this.quaternion),this.position.add(Ok.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(Fk,t)}translateY(t){return this.translateOnAxis(kk,t)}translateZ(t){return this.translateOnAxis(Uk,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Ao.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?av.copy(t):av.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),ep.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ao.lookAt(ep,av,this.up):Ao.lookAt(av,ep,this.up),this.quaternion.setFromRotationMatrix(Ao),s&&(Ao.extractRotation(s.matrixWorld),oh.setFromRotationMatrix(Ao),this.quaternion.premultiply(oh.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(ine)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(rne)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Ao.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Ao.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ao),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i,r=[]){this[t]===i&&r.push(this);const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(t,i,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ep,t,tne),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ep,nne,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const c=s[o];!0===c.matrixWorldAutoUpdate&&c.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(c,l){return void 0===c[l.uuid]&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),null!==this.boundingSphere&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),null!==this.boundingBox&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){const l=c.shapes;if(Array.isArray(l))for(let u=0,h=l.length;u<h;u++)o(t.shapes,l[u]);else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++)s.animations.push(o(t.animations,this.animations[c]))}if(i){const c=a(t.geometries),l=a(t.materials),u=a(t.textures),h=a(t.images),d=a(t.shapes),f=a(t.skeletons),p=a(t.animations),m=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),h.length>0&&(r.images=h),d.length>0&&(r.shapes=d),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),m.length>0&&(r.nodes=m)}return r.object=s,r;function a(c){const l=[];for(const u in c){const h=c[u];delete h.metadata,l.push(h)}return l}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new A(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Es=new A,Do=new A,YS=new A,Io=new A,ah=new A,ch=new A,Bk=new A,ZS=new A,KS=new A,JS=new A;let cv=!1;class Ir{constructor(e=new A,t=new A,i=new A){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Es.subVectors(e,t),r.cross(Es);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Es.subVectors(r,t),Do.subVectors(i,t),YS.subVectors(e,t);const o=Es.dot(Es),a=Es.dot(Do),c=Es.dot(YS),l=Do.dot(Do),u=Do.dot(YS),h=o*l-a*a;if(0===h)return s.set(-2,-1,-1);const d=1/h,f=(l*c-a*u)*d,p=(o*u-a*c)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Io),Io.x>=0&&Io.y>=0&&Io.x+Io.y<=1}static getUV(e,t,i,r,s,o,a,c){return!1===cv&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),cv=!0),this.getInterpolation(e,t,i,r,s,o,a,c)}static getInterpolation(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,Io),c.setScalar(0),c.addScaledVector(s,Io.x),c.addScaledVector(o,Io.y),c.addScaledVector(a,Io.z),c}static isFrontFacing(e,t,i,r){return Es.subVectors(i,t),Do.subVectors(e,t),Es.cross(Do).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Es.subVectors(this.c,this.b),Do.subVectors(this.a,this.b),.5*Es.cross(Do).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ir.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ir.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return!1===cv&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),cv=!0),Ir.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Ir.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Ir.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ir.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;ah.subVectors(r,i),ch.subVectors(s,i),ZS.subVectors(e,i);const c=ah.dot(ZS),l=ch.dot(ZS);if(c<=0&&l<=0)return t.copy(i);KS.subVectors(e,r);const u=ah.dot(KS),h=ch.dot(KS);if(u>=0&&h<=u)return t.copy(r);const d=c*h-u*l;if(d<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(i).addScaledVector(ah,o);JS.subVectors(e,s);const f=ah.dot(JS),p=ch.dot(JS);if(p>=0&&f<=p)return t.copy(s);const m=f*l-c*p;if(m<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(i).addScaledVector(ch,a);const _=u*p-f*h;if(_<=0&&h-u>=0&&f-p>=0)return Bk.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(Bk,a);const g=1/(_+m+d);return o=m*g,a=d*g,t.copy(i).addScaledVector(ah,o).addScaledVector(ch,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Vk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ca={h:0,s:0,l:0},lv={h:0,s:0,l:0};function QS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class Z{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Wt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Lt.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Lt.workingColorSpace){return this.r=e,this.g=t,this.b=i,Lt.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Lt.workingColorSpace){if(e=FS(e,1),t=mn(t,0,1),i=mn(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=QS(o,s,e+1/3),this.g=QS(o,s,e),this.b=QS(o,s,e-1/3)}return Lt.toWorkingColorSpace(this,r),this}setStyle(e,t=Wt){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Wt){const i=Vk[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Qu(e.r),this.g=Qu(e.g),this.b=Qu(e.b),this}copyLinearToSRGB(e){return this.r=BS(e.r),this.g=BS(e.g),this.b=BS(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Wt){return Lt.fromWorkingColorSpace(Ei.copy(this),e),65536*Math.round(mn(255*Ei.r,0,255))+256*Math.round(mn(255*Ei.g,0,255))+Math.round(mn(255*Ei.b,0,255))}getHexString(e=Wt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Lt.workingColorSpace){Lt.fromWorkingColorSpace(Ei.copy(this),t);const i=Ei.r,r=Ei.g,s=Ei.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let c,l;const u=(a+o)/2;if(a===o)c=0,l=0;else{const h=o-a;switch(l=u<=.5?h/(o+a):h/(2-o-a),o){case i:c=(r-s)/h+(r<s?6:0);break;case r:c=(s-i)/h+2;break;case s:c=(i-r)/h+4}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=Lt.workingColorSpace){return Lt.fromWorkingColorSpace(Ei.copy(this),t),e.r=Ei.r,e.g=Ei.g,e.b=Ei.b,e}getStyle(e=Wt){Lt.fromWorkingColorSpace(Ei.copy(this),e);const t=Ei.r,i=Ei.g,r=Ei.b;return e!==Wt?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(Ca),this.setHSL(Ca.h+e,Ca.s+t,Ca.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Ca),e.getHSL(lv);const i=Yf(Ca.h,lv.h,t),r=Yf(Ca.s,lv.s,t),s=Yf(Ca.l,lv.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ei=new Z;Z.NAMES=Vk;let sne=0;class cr extends Sc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:sne++}),this.uuid=Ar(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Z(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Zu,this.stencilZFail=Zu,this.stencilZPass=Zu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Zu&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Zu&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Zu&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class di extends cr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Z(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=H_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const kn=new A,uv=new Y;class jt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=qs,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return console.warn('THREE.BufferAttribute: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)uv.fromBufferAttribute(this,t),uv.applyMatrix3(e),this.setXY(t,uv.x,uv.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)kn.fromBufferAttribute(this,t),kn.applyMatrix3(e),this.setXYZ(t,kn.x,kn.y,kn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)kn.fromBufferAttribute(this,t),kn.applyMatrix4(e),this.setXYZ(t,kn.x,kn.y,kn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)kn.fromBufferAttribute(this,t),kn.applyNormalMatrix(e),this.setXYZ(t,kn.x,kn.y,kn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)kn.fromBufferAttribute(this,t),kn.transformDirection(e),this.setXYZ(t,kn.x,kn.y,kn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=ar(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=lt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ar(t,this.array)),t}setX(e,t){return this.normalized&&(t=lt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ar(t,this.array)),t}setY(e,t){return this.normalized&&(t=lt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ar(t,this.array)),t}setZ(e,t){return this.normalized&&(t=lt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ar(t,this.array)),t}setW(e,t){return this.normalized&&(t=lt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=lt(t,this.array),i=lt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=lt(t,this.array),i=lt(i,this.array),r=lt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=lt(t,this.array),i=lt(i,this.array),r=lt(r,this.array),s=lt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class zk extends jt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Hk extends jt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Pe extends jt{constructor(e,t,i){super(new Float32Array(e),t,i)}}let ane=0;const es=new Ge,eM=new gn,lh=new A,Rr=new Wi,np=new Wi,ei=new A;class ot extends Sc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ane++}),this.uuid=Ar(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(Ck(e)?Hk:zk)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new pt).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return es.makeRotationFromQuaternion(e),this.applyMatrix4(es),this}rotateX(e){return es.makeRotationX(e),this.applyMatrix4(es),this}rotateY(e){return es.makeRotationY(e),this.applyMatrix4(es),this}rotateZ(e){return es.makeRotationZ(e),this.applyMatrix4(es),this}translate(e,t,i){return es.makeTranslation(e,t,i),this.applyMatrix4(es),this}scale(e,t,i){return es.makeScale(e,t,i),this.applyMatrix4(es),this}lookAt(e){return eM.lookAt(e),eM.updateMatrix(),this.applyMatrix4(eM.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(lh).negate(),this.translate(lh.x,lh.y,lh.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Pe(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Wi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new A(-1/0,-1/0,-1/0),new A(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Rr.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(ei.addVectors(this.boundingBox.min,Rr.min),this.boundingBox.expandByPoint(ei),ei.addVectors(this.boundingBox.max,Rr.max),this.boundingBox.expandByPoint(ei)):(this.boundingBox.expandByPoint(Rr.min),this.boundingBox.expandByPoint(Rr.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new bi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new A,1/0);if(e){const i=this.boundingSphere.center;if(Rr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)np.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(ei.addVectors(Rr.min,np.min),Rr.expandByPoint(ei),ei.addVectors(Rr.max,np.max),Rr.expandByPoint(ei)):(Rr.expandByPoint(np.min),Rr.expandByPoint(np.max));Rr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)ei.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(ei));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)ei.fromBufferAttribute(a,l),c&&(lh.fromBufferAttribute(e,l),ei.add(lh)),r=Math.max(r,i.distanceToSquared(ei))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new jt(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,l=[],u=[];for(let C=0;C<a;C++)l[C]=new A,u[C]=new A;const h=new A,d=new A,f=new A,p=new Y,m=new Y,_=new Y,g=new A,v=new A;function y(C,L,F){h.fromArray(r,3*C),d.fromArray(r,3*L),f.fromArray(r,3*F),p.fromArray(o,2*C),m.fromArray(o,2*L),_.fromArray(o,2*F),d.sub(h),f.sub(h),m.sub(p),_.sub(p);const B=1/(m.x*_.y-_.x*m.y);isFinite(B)&&(g.copy(d).multiplyScalar(_.y).addScaledVector(f,-m.y).multiplyScalar(B),v.copy(f).multiplyScalar(m.x).addScaledVector(d,-_.x).multiplyScalar(B),l[C].add(g),l[L].add(g),l[F].add(g),u[C].add(v),u[L].add(v),u[F].add(v))}let w=this.groups;0===w.length&&(w=[{start:0,count:i.length}]);for(let C=0,L=w.length;C<L;++C){const F=w[C],B=F.start;for(let k=B,V=B+F.count;k<V;k+=3)y(i[k+0],i[k+1],i[k+2])}const x=new A,E=new A,S=new A,M=new A;function b(C){S.fromArray(s,3*C),M.copy(S);const L=l[C];x.copy(L),x.sub(S.multiplyScalar(S.dot(L))).normalize(),E.crossVectors(M,L);const B=E.dot(u[C])<0?-1:1;c[4*C]=x.x,c[4*C+1]=x.y,c[4*C+2]=x.z,c[4*C+3]=B}for(let C=0,L=w.length;C<L;++C){const F=w[C],B=F.start;for(let k=B,V=B+F.count;k<V;k+=3)b(i[k+0]),b(i[k+1]),b(i[k+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new jt(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new A,s=new A,o=new A,a=new A,c=new A,l=new A,u=new A,h=new A;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),_=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),o.fromBufferAttribute(t,_),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(i,p),c.fromBufferAttribute(i,m),l.fromBufferAttribute(i,_),a.add(u),c.add(u),l.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(m,c.x,c.y,c.z),i.setXYZ(_,l.x,l.y,l.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)ei.fromBufferAttribute(e,t),ei.normalize(),e.setXYZ(t,ei.x,ei.y,ei.z)}toNonIndexed(){function e(a,c){const l=a.array,u=a.itemSize,h=a.normalized,d=new l.constructor(c.length*u);let f=0,p=0;for(let m=0,_=c.length;m<_;m++){f=a.isInterleavedBufferAttribute?c[m]*a.data.stride+a.offset:c[m]*u;for(let g=0;g<u;g++)d[p++]=l[f++]}return new jt(d,u,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ot,i=this.index.array,r=this.attributes;for(const a in r){const l=e(r[a],i);t.setAttribute(a,l)}const s=this.morphAttributes;for(const a in s){const c=[],l=s[a];for(let u=0,h=l.length;u<h;u++){const f=e(l[u],i);c.push(f)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const c=this.parameters;for(const l in c)void 0!==c[l]&&(e[l]=c[l]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i)e.data.attributes[c]=i[c].toJSON(e.data);const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let h=0,d=l.length;h<d;h++)u.push(l[h].toJSON(e.data));u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const l in r)this.setAttribute(l,r[l].clone(t));const s=e.morphAttributes;for(const l in s){const u=[],h=s[l];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let l=0,u=o.length;l<u;l++){const h=o[l];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Gk=new Ge,Rc=new Ic,hv=new bi,Wk=new A,uh=new A,hh=new A,dh=new A,tM=new A,dv=new A,fv=new Y,pv=new Y,mv=new Y,jk=new A,$k=new A,qk=new A,gv=new A,_v=new A;class Ot extends gn{constructor(e=new ot,t=new di){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){dv.set(0,0,0);for(let c=0,l=s.length;c<l;c++){const u=a[c];0!==u&&(tM.fromBufferAttribute(s[c],e),dv.addScaledVector(o?tM:tM.sub(t),u))}t.add(dv)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),hv.copy(i.boundingSphere),hv.applyMatrix4(s),Rc.copy(e.ray).recast(e.near),(!1!==hv.containsPoint(Rc.origin)||!(null===Rc.intersectSphere(hv,Wk)||Rc.origin.distanceToSquared(Wk)>(e.far-e.near)**2))&&(Gk.copy(s).invert(),Rc.copy(e.ray).applyMatrix4(Gk),(null===i.boundingBox||!1!==Rc.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Rc)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(null!==a)if(Array.isArray(o))for(let p=0,m=d.length;p<m;p++){const _=d[p],g=o[_.materialIndex];for(let w=Math.max(_.start,f.start),x=Math.min(a.count,Math.min(_.start+_.count,f.start+f.count));w<x;w+=3)r=vv(this,g,e,i,l,u,h,a.getX(w),a.getX(w+1),a.getX(w+2)),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=_.materialIndex,t.push(r))}else for(let _=Math.max(0,f.start),g=Math.min(a.count,f.start+f.count);_<g;_+=3)r=vv(this,o,e,i,l,u,h,a.getX(_),a.getX(_+1),a.getX(_+2)),r&&(r.faceIndex=Math.floor(_/3),t.push(r));else if(void 0!==c)if(Array.isArray(o))for(let p=0,m=d.length;p<m;p++){const _=d[p],g=o[_.materialIndex];for(let w=Math.max(_.start,f.start),x=Math.min(c.count,Math.min(_.start+_.count,f.start+f.count));w<x;w+=3)r=vv(this,g,e,i,l,u,h,w,w+1,w+2),r&&(r.faceIndex=Math.floor(w/3),r.face.materialIndex=_.materialIndex,t.push(r))}else for(let _=Math.max(0,f.start),g=Math.min(c.count,f.start+f.count);_<g;_+=3)r=vv(this,o,e,i,l,u,h,_,_+1,_+2),r&&(r.faceIndex=Math.floor(_/3),t.push(r))}}function vv(n,e,t,i,r,s,o,a,c,l){n.getVertexPosition(a,uh),n.getVertexPosition(c,hh),n.getVertexPosition(l,dh);const u=function cne(n,e,t,i,r,s,o,a){let c;if(c=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===c)return null;_v.copy(a),_v.applyMatrix4(n.matrixWorld);const l=t.ray.origin.distanceTo(_v);return l<t.near||l>t.far?null:{distance:l,point:_v.clone(),object:n}}(n,e,t,i,uh,hh,dh,gv);if(u){r&&(fv.fromBufferAttribute(r,a),pv.fromBufferAttribute(r,c),mv.fromBufferAttribute(r,l),u.uv=Ir.getInterpolation(gv,uh,hh,dh,fv,pv,mv,new Y)),s&&(fv.fromBufferAttribute(s,a),pv.fromBufferAttribute(s,c),mv.fromBufferAttribute(s,l),u.uv1=Ir.getInterpolation(gv,uh,hh,dh,fv,pv,mv,new Y),u.uv2=u.uv1),o&&(jk.fromBufferAttribute(o,a),$k.fromBufferAttribute(o,c),qk.fromBufferAttribute(o,l),u.normal=Ir.getInterpolation(gv,uh,hh,dh,jk,$k,qk,new A),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:c,c:l,normal:new A,materialIndex:0};Ir.getNormal(uh,hh,dh,h.normal),u.face=h}return u}class Po extends ot{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],l=[],u=[],h=[];let d=0,f=0;function p(m,_,g,v,y,w,x,E,S,M,b){const C=w/S,L=x/M,F=w/2,B=x/2,R=E/2,k=S+1,V=M+1;let z=0,re=0;const q=new A;for(let ee=0;ee<V;ee++){const te=ee*L-B;for(let _e=0;_e<k;_e++)q[m]=(_e*C-F)*v,q[_]=te*y,q[g]=R,l.push(q.x,q.y,q.z),q[m]=0,q[_]=0,q[g]=E>0?1:-1,u.push(q.x,q.y,q.z),h.push(_e/S),h.push(1-ee/M),z+=1}for(let ee=0;ee<M;ee++)for(let te=0;te<S;te++){const G=d+te+k*(ee+1),K=d+(te+1)+k*(ee+1),ae=d+(te+1)+k*ee;c.push(d+te+k*ee,G,ae),c.push(G,K,ae),re+=6}a.addGroup(f,re,b),f+=re,d+=z}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Pe(l,3)),this.setAttribute("normal",new Pe(u,3)),this.setAttribute("uv",new Pe(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Po(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function fh(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function ji(n){const e={};for(let t=0;t<n.length;t++){const i=fh(n[t]);for(const r in i)e[r]=i[r]}return e}function Xk(n){return null===n.getRenderTarget()?n.outputColorSpace:Lt.workingColorSpace}const une={clone:fh,merge:ji};class Ys extends cr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=fh(e.uniforms),this.uniformsGroups=function lne(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class nM extends gn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ge,this.projectionMatrix=new Ge,this.projectionMatrixInverse=new Ge,this.coordinateSystem=Xs}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class ti extends nM{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Ku*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Mc*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Ku*Math.atan(Math.tan(.5*Mc*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Mc*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/l,r*=o.width/c,i*=o.height/l}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class fne extends gn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new ti(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new ti(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new ti(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new ti(-90,1,e,t);a.layers=this.layers,this.add(a);const c=new ti(-90,1,e,t);c.layers=this.layers,this.add(c);const l=new ti(-90,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,c]=t;for(const l of t)this.remove(l);if(e===Xs)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,c,l,u]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const m=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,c),e.setRenderTarget(i,4,r),e.render(t,l),i.texture.generateMipmaps=m,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(h,d,f),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class yv extends Qr{constructor(e,t,i,r,s,o,a,c,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:ya,i,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class pne extends Tc{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(Kf("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===bc?Wt:""),this.texture=new yv(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:an}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Po(5,5,5),s=new Ys({name:"CubemapFromEquirect",uniforms:fh(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Ot(r,s),a=t.minFilter;return t.minFilter===Mo&&(t.minFilter=an),new fne(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const iM=new A,mne=new A,gne=new pt;class No{constructor(e=new A(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=iM.subVectors(i,t).cross(mne.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(iM),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||gne.getNormalMatrix(e),r=this.coplanarPoint(iM).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Pc=new bi,wv=new A;class xv{constructor(e=new No,t=new No,i=new No,r=new No,s=new No,o=new No){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Xs){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],l=r[4],u=r[5],h=r[6],d=r[7],f=r[8],p=r[9],m=r[10],_=r[11],g=r[12],v=r[13],y=r[14],w=r[15];if(i[0].setComponents(c-s,d-l,_-f,w-g).normalize(),i[1].setComponents(c+s,d+l,_+f,w+g).normalize(),i[2].setComponents(c+o,d+u,_+p,w+v).normalize(),i[3].setComponents(c-o,d-u,_-p,w-v).normalize(),i[4].setComponents(c-a,d-h,_-m,w-y).normalize(),t===Xs)i[5].setComponents(c+a,d+h,_+m,w+y).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,h,m,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Pc.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Pc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Pc)}intersectsSprite(e){return Pc.center.set(0,0,0),Pc.radius=.7071067811865476,Pc.applyMatrix4(e.matrixWorld),this.intersectsSphere(Pc)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(wv.x=r.normal.x>0?e.max.x:e.min.x,wv.y=r.normal.y>0?e.max.y:e.min.y,wv.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(wv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Yk(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function _ne(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)},remove:function a(l){l.isInterleavedBufferAttribute&&(l=l.data);const u=i.get(l);u&&(n.deleteBuffer(u.buffer),i.delete(l))},update:function c(l,u){if(l.isGLBufferAttribute){const d=i.get(l);return void((!d||d.version<l.version)&&i.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}l.isInterleavedBufferAttribute&&(l=l.data);const h=i.get(l);if(void 0===h)i.set(l,function r(l,u){const h=l.array,d=l.usage,f=h.byteLength,p=n.createBuffer();let m;if(n.bindBuffer(u,p),n.bufferData(u,h,d),l.onUploadCallback(),h instanceof Float32Array)m=n.FLOAT;else if(h instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");m=n.HALF_FLOAT}else m=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)m=n.SHORT;else if(h instanceof Uint32Array)m=n.UNSIGNED_INT;else if(h instanceof Int32Array)m=n.INT;else if(h instanceof Int8Array)m=n.BYTE;else if(h instanceof Uint8Array)m=n.UNSIGNED_BYTE;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);m=n.UNSIGNED_BYTE}return{buffer:p,type:m,bytesPerElement:h.BYTES_PER_ELEMENT,version:l.version,size:f}}(l,u));else if(h.version<l.version){if(h.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function s(l,u,h){const d=u.array,f=u._updateRange,p=u.updateRanges;if(n.bindBuffer(h,l),-1===f.count&&0===p.length&&n.bufferSubData(h,0,d),0!==p.length){for(let m=0,_=p.length;m<_;m++){const g=p[m];t?n.bufferSubData(h,g.start*d.BYTES_PER_ELEMENT,d,g.start,g.count):n.bufferSubData(h,g.start*d.BYTES_PER_ELEMENT,d.subarray(g.start,g.start+g.count))}u.clearUpdateRanges()}-1!==f.count&&(t?n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()})(h.buffer,l,u),h.version=l.version}}}}class gh extends ot{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),l=a+1,u=c+1,h=e/a,d=t/c,f=[],p=[],m=[],_=[];for(let g=0;g<u;g++){const v=g*d-o;for(let y=0;y<l;y++)p.push(y*h-s,-v,0),m.push(0,0,1),_.push(y/a),_.push(1-g/c)}for(let g=0;g<c;g++)for(let v=0;v<a;v++){const w=v+l*(g+1),x=v+1+l*(g+1),E=v+1+l*g;f.push(v+l*g,w,E),f.push(w,x,E)}this.setIndex(f),this.setAttribute("position",new Pe(p,3)),this.setAttribute("normal",new Pe(m,3)),this.setAttribute("uv",new Pe(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gh(e.width,e.height,e.widthSegments,e.heightSegments)}}const dt={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},xe={common:{diffuse:{value:new Z(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new pt},alphaMap:{value:null},alphaMapTransform:{value:new pt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new pt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new pt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new pt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new pt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new pt},normalScale:{value:new Y(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new pt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new pt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new pt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new pt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Z(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Z(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new pt},alphaTest:{value:0},uvTransform:{value:new pt}},sprite:{diffuse:{value:new Z(16777215)},opacity:{value:1},center:{value:new Y(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new pt},alphaMap:{value:null},alphaMapTransform:{value:new pt},alphaTest:{value:0}}},Zs={basic:{uniforms:ji([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.fog]),vertexShader:dt.meshbasic_vert,fragmentShader:dt.meshbasic_frag},lambert:{uniforms:ji([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,xe.lights,{emissive:{value:new Z(0)}}]),vertexShader:dt.meshlambert_vert,fragmentShader:dt.meshlambert_frag},phong:{uniforms:ji([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,xe.lights,{emissive:{value:new Z(0)},specular:{value:new Z(1118481)},shininess:{value:30}}]),vertexShader:dt.meshphong_vert,fragmentShader:dt.meshphong_frag},standard:{uniforms:ji([xe.common,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.roughnessmap,xe.metalnessmap,xe.fog,xe.lights,{emissive:{value:new Z(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag},toon:{uniforms:ji([xe.common,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.gradientmap,xe.fog,xe.lights,{emissive:{value:new Z(0)}}]),vertexShader:dt.meshtoon_vert,fragmentShader:dt.meshtoon_frag},matcap:{uniforms:ji([xe.common,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,{matcap:{value:null}}]),vertexShader:dt.meshmatcap_vert,fragmentShader:dt.meshmatcap_frag},points:{uniforms:ji([xe.points,xe.fog]),vertexShader:dt.points_vert,fragmentShader:dt.points_frag},dashed:{uniforms:ji([xe.common,xe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:dt.linedashed_vert,fragmentShader:dt.linedashed_frag},depth:{uniforms:ji([xe.common,xe.displacementmap]),vertexShader:dt.depth_vert,fragmentShader:dt.depth_frag},normal:{uniforms:ji([xe.common,xe.bumpmap,xe.normalmap,xe.displacementmap,{opacity:{value:1}}]),vertexShader:dt.meshnormal_vert,fragmentShader:dt.meshnormal_frag},sprite:{uniforms:ji([xe.sprite,xe.fog]),vertexShader:dt.sprite_vert,fragmentShader:dt.sprite_frag},background:{uniforms:{uvTransform:{value:new pt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:dt.background_vert,fragmentShader:dt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:dt.backgroundCube_vert,fragmentShader:dt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:dt.cube_vert,fragmentShader:dt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:dt.equirect_vert,fragmentShader:dt.equirect_frag},distanceRGBA:{uniforms:ji([xe.common,xe.displacementmap,{referencePosition:{value:new A},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:dt.distanceRGBA_vert,fragmentShader:dt.distanceRGBA_frag},shadow:{uniforms:ji([xe.lights,xe.fog,{color:{value:new Z(0)},opacity:{value:1}}]),vertexShader:dt.shadow_vert,fragmentShader:dt.shadow_frag}};Zs.physical={uniforms:ji([Zs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new pt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new pt},clearcoatNormalScale:{value:new Y(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new pt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new pt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new pt},sheen:{value:0},sheenColor:{value:new Z(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new pt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new pt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new pt},transmissionSamplerSize:{value:new Y},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new pt},attenuationDistance:{value:0},attenuationColor:{value:new Z(0)},specularColor:{value:new Z(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new pt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new pt},anisotropyVector:{value:new Y},anisotropyMap:{value:null},anisotropyMapTransform:{value:new pt}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag};const bv={r:0,b:0,g:0};function _re(n,e,t,i,r,s,o){const a=new Z(0);let l,u,c=!0===s?0:1,h=null,d=0,f=null;function m(_,g){_.getRGB(bv,Xk(n)),i.buffers.color.setClear(bv.r,bv.g,bv.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(_,g=1){a.set(_),c=g,m(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(_){c=_,m(a,c)},render:function p(_,g){let v=!1,y=!0===g.isScene?g.background:null;y&&y.isTexture&&(y=(g.backgroundBlurriness>0?t:e).get(y)),null===y?m(a,c):y&&y.isColor&&(m(y,1),v=!0);const w=n.xr.getEnvironmentBlendMode();"additive"===w?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===w&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===Gf)?(void 0===u&&(u=new Ot(new Po(1,1,1),new Ys({name:"BackgroundCubeMaterial",uniforms:fh(Zs.backgroundCube.uniforms),vertexShader:Zs.backgroundCube.vertexShader,fragmentShader:Zs.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(x,E,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=Lt.getTransfer(y.colorSpace)!==tn,(h!==y||d!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(void 0===l&&(l=new Ot(new gh(2,2),new Ys({name:"BackgroundMaterial",uniforms:fh(Zs.background.uniforms),vertexShader:Zs.background.vertexShader,fragmentShader:Zs.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=y,l.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,l.material.toneMapped=Lt.getTransfer(y.colorSpace)!==tn,!0===y.matrixAutoUpdate&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),(h!==y||d!==y.version||f!==n.toneMapping)&&(l.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),l.layers.enableAll(),_.unshift(l,l.geometry,l.material,0,0,null))}}}function vre(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},c=_(null);let l=c,u=!1;function f(R){return i.isWebGL2?n.bindVertexArray(R):s.bindVertexArrayOES(R)}function p(R){return i.isWebGL2?n.deleteVertexArray(R):s.deleteVertexArrayOES(R)}function _(R){const k=[],V=[],z=[];for(let re=0;re<r;re++)k[re]=0,V[re]=0,z[re]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:k,enabledAttributes:V,attributeDivisors:z,object:R,attributes:{},index:null}}function y(){const R=l.newAttributes;for(let k=0,V=R.length;k<V;k++)R[k]=0}function w(R){x(R,0)}function x(R,k){const z=l.enabledAttributes,re=l.attributeDivisors;l.newAttributes[R]=1,0===z[R]&&(n.enableVertexAttribArray(R),z[R]=1),re[R]!==k&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](R,k),re[R]=k)}function E(){const R=l.newAttributes,k=l.enabledAttributes;for(let V=0,z=k.length;V<z;V++)k[V]!==R[V]&&(n.disableVertexAttribArray(V),k[V]=0)}function S(R,k,V,z,re,q,ee){!0===ee?n.vertexAttribIPointer(R,k,V,re,q):n.vertexAttribPointer(R,k,V,z,re,q)}function F(){B(),u=!0,l!==c&&(l=c,f(l.object))}function B(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function h(R,k,V,z,re){let q=!1;if(o){const ee=function m(R,k,V){const z=!0===V.wireframe;let re=a[R.id];void 0===re&&(re={},a[R.id]=re);let q=re[k.id];void 0===q&&(q={},re[k.id]=q);let ee=q[z];return void 0===ee&&(ee=_(function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),q[z]=ee),ee}(z,V,k);l!==ee&&(l=ee,f(l.object)),q=function g(R,k,V,z){const re=l.attributes,q=k.attributes;let ee=0;const te=V.getAttributes();for(const _e in te)if(te[_e].location>=0){const K=re[_e];let ae=q[_e];if(void 0===ae&&("instanceMatrix"===_e&&R.instanceMatrix&&(ae=R.instanceMatrix),"instanceColor"===_e&&R.instanceColor&&(ae=R.instanceColor)),void 0===K||K.attribute!==ae||ae&&K.data!==ae.data)return!0;ee++}return l.attributesNum!==ee||l.index!==z}(R,z,V,re),q&&function v(R,k,V,z){const re={},q=k.attributes;let ee=0;const te=V.getAttributes();for(const _e in te)if(te[_e].location>=0){let K=q[_e];void 0===K&&("instanceMatrix"===_e&&R.instanceMatrix&&(K=R.instanceMatrix),"instanceColor"===_e&&R.instanceColor&&(K=R.instanceColor));const ae={};ae.attribute=K,K&&K.data&&(ae.data=K.data),re[_e]=ae,ee++}l.attributes=re,l.attributesNum=ee,l.index=z}(R,z,V,re)}else{const ee=!0===k.wireframe;(l.geometry!==z.id||l.program!==V.id||l.wireframe!==ee)&&(l.geometry=z.id,l.program=V.id,l.wireframe=ee,q=!0)}null!==re&&t.update(re,n.ELEMENT_ARRAY_BUFFER),(q||u)&&(u=!1,function M(R,k,V,z){if(!1===i.isWebGL2&&(R.isInstancedMesh||z.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const re=z.attributes,q=V.getAttributes(),ee=k.defaultAttributeValues;for(const te in q){const _e=q[te];if(_e.location>=0){let G=re[te];if(void 0===G&&("instanceMatrix"===te&&R.instanceMatrix&&(G=R.instanceMatrix),"instanceColor"===te&&R.instanceColor&&(G=R.instanceColor)),void 0!==G){const K=G.normalized,ae=G.itemSize,ye=t.get(G);if(void 0===ye)continue;const Ce=ye.buffer,Be=ye.type,We=ye.bytesPerElement,Se=!0===i.isWebGL2&&(Be===n.INT||Be===n.UNSIGNED_INT||1013===G.gpuType);if(G.isInterleavedBufferAttribute){const Fe=G.data,P=Fe.stride,ge=G.offset;if(Fe.isInstancedInterleavedBuffer){for(let Q=0;Q<_e.locationSize;Q++)x(_e.location+Q,Fe.meshPerAttribute);!0!==R.isInstancedMesh&&void 0===z._maxInstanceCount&&(z._maxInstanceCount=Fe.meshPerAttribute*Fe.count)}else for(let Q=0;Q<_e.locationSize;Q++)w(_e.location+Q);n.bindBuffer(n.ARRAY_BUFFER,Ce);for(let Q=0;Q<_e.locationSize;Q++)S(_e.location+Q,ae/_e.locationSize,Be,K,P*We,(ge+ae/_e.locationSize*Q)*We,Se)}else{if(G.isInstancedBufferAttribute){for(let Fe=0;Fe<_e.locationSize;Fe++)x(_e.location+Fe,G.meshPerAttribute);!0!==R.isInstancedMesh&&void 0===z._maxInstanceCount&&(z._maxInstanceCount=G.meshPerAttribute*G.count)}else for(let Fe=0;Fe<_e.locationSize;Fe++)w(_e.location+Fe);n.bindBuffer(n.ARRAY_BUFFER,Ce);for(let Fe=0;Fe<_e.locationSize;Fe++)S(_e.location+Fe,ae/_e.locationSize,Be,K,ae*We,ae/_e.locationSize*Fe*We,Se)}}else if(void 0!==ee){const K=ee[te];if(void 0!==K)switch(K.length){case 2:n.vertexAttrib2fv(_e.location,K);break;case 3:n.vertexAttrib3fv(_e.location,K);break;case 4:n.vertexAttrib4fv(_e.location,K);break;default:n.vertexAttrib1fv(_e.location,K)}}}}E()}(R,k,V,z),null!==re&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(re).buffer))},reset:F,resetDefaultState:B,dispose:function b(){F();for(const R in a){const k=a[R];for(const V in k){const z=k[V];for(const re in z)p(z[re].object),delete z[re];delete k[V]}delete a[R]}},releaseStatesOfGeometry:function C(R){if(void 0===a[R.id])return;const k=a[R.id];for(const V in k){const z=k[V];for(const re in z)p(z[re].object),delete z[re];delete k[V]}delete a[R.id]},releaseStatesOfProgram:function L(R){for(const k in a){const V=a[k];if(void 0===V[R.id])continue;const z=V[R.id];for(const re in z)p(z[re].object),delete z[re];delete V[R.id]}},initAttributes:y,enableAttribute:w,disableUnusedAttributes:E}}function yre(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(u){s=u},this.render=function a(u,h){n.drawArrays(s,u,h),t.update(h,s,1)},this.renderInstances=function c(u,h,d){if(0===d)return;let f,p;if(r)f=n,p="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",null===f)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");f[p](s,u,h,d),t.update(h,s,d)},this.renderMultiDraw=function l(u,h,d){if(0===d)return;const f=e.get("WEBGL_multi_draw");if(null===f)for(let p=0;p<d;p++)this.render(u[p],h[p]);else{f.multiDrawArraysWEBGL(s,u,0,h,0,d);let p=0;for(let m=0;m<d;m++)p+=h[m];t.update(p,s,1)}}}function wre(n,e,t){let i;function s(S){if("highp"===S){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";S="mediump"}return"mediump"===S&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&"WebGL2RenderingContext"===n.constructor.name;let a=void 0!==t.precision?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const l=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),d=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),m=n.getParameter(n.MAX_VERTEX_ATTRIBS),_=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),g=n.getParameter(n.MAX_VARYING_VECTORS),v=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,w=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const S=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:_,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:w,floatVertexTextures:y&&w,maxSamples:o?n.getParameter(n.MAX_SAMPLES):0}}function xre(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new No,a=new pt,c={value:null,needsUpdate:!1};function u(h,d,f,p){const m=null!==h?h.length:0;let _=null;if(0!==m){if(_=c.value,!0!==p||null===_){const g=f+4*m,v=d.matrixWorldInverse;a.getNormalMatrix(v),(null===_||_.length<g)&&(_=new Float32Array(g));for(let y=0,w=f;y!==m;++y,w+=4)o.copy(h[y]).applyMatrix4(v,a),o.normal.toArray(_,w),_[w+3]=o.constant}c.value=_,c.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,_}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=0!==h.length||d||0!==i||r;return r=d,i=h.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=u(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,m=h.clipIntersection,_=h.clipShadows,g=n.get(h);if(!r||null===p||0===p.length||s&&!_)s?u(null):function l(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const v=s?0:i,y=4*v;let w=g.clippingState||null;c.value=w,w=u(p,d,y,f);for(let x=0;x!==y;++x)w[x]=t[x];g.clippingState=w,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=v}}}function bre(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=ya:304===a&&(o.mapping=yc),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);void 0!==c&&(e.delete(a),c.dispose())}return{get:function i(o){if(o&&o.isTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const c=o.image;if(c&&c.height>0){const l=new pne(c.height/2);return l.fromEquirectangularTexture(n,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Ev extends nM{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,c=r-t;if(null!==this.view&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Zk=[.125,.215,.35,.446,.526,.582],rM=new Ev,Kk=new Z;let sM=null,oM=0,aM=0;const Lc=(1+Math.sqrt(5))/2,vh=1/Lc,Jk=[new A(1,1,1),new A(-1,1,1),new A(1,1,-1),new A(-1,1,-1),new A(0,Lc,vh),new A(0,Lc,-vh),new A(vh,0,Lc),new A(-vh,0,Lc),new A(Lc,vh,0),new A(-Lc,vh,0)];class Qk{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){sM=this._renderer.getRenderTarget(),oM=this._renderer.getActiveCubeFace(),aM=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=nU(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=tU(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(sM,oM,aM),e.scissorTest=!1,Sv(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===ya||e.mapping===yc?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),sM=this._renderer.getRenderTarget(),oM=this._renderer.getActiveCubeFace(),aM=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:an,minFilter:an,generateMipmaps:!1,type:$f,format:Tr,colorSpace:Qn,depthBuffer:!1},r=eU(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=eU(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Ere(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+Zk.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>n-4?c=Zk[o-n+4-1]:0===o&&(c=0),i.push(c);const l=1/(a-2),u=-l,h=1+l,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,m=3,_=2,g=1,v=new Float32Array(m*p*f),y=new Float32Array(_*p*f),w=new Float32Array(g*p*f);for(let E=0;E<f;E++){const S=E%3*2/3-1,M=E>2?0:-1;v.set([S,M,0,S+2/3,M,0,S+2/3,M+1,0,S,M,0,S+2/3,M+1,0,S,M+1,0],m*p*E),y.set(d,_*p*E),w.set([E,E,E,E,E,E],g*p*E)}const x=new ot;x.setAttribute("position",new jt(v,m)),x.setAttribute("uv",new jt(y,_)),x.setAttribute("faceIndex",new jt(w,g)),e.push(x),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function Sre(n,e,t){const i=new Float32Array(20),r=new A(0,1,0);return new Ys({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Ot(this._lodPlanes[0],e);this._renderer.compile(t,rM)}_sceneToCubeUV(e,t,i,r){const a=new ti(90,1,t,i),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(Kk),u.toneMapping=So,u.autoClear=!1;const f=new di({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new Ot(new Po,f);let m=!1;const _=e.background;_?_.isColor&&(f.color.copy(_),e.background=null,m=!0):(f.color.copy(Kk),m=!0);for(let g=0;g<6;g++){const v=g%3;0===v?(a.up.set(0,c[g],0),a.lookAt(l[g],0,0)):1===v?(a.up.set(0,0,c[g]),a.lookAt(0,l[g],0)):(a.up.set(0,c[g],0),a.lookAt(0,0,l[g]));const y=this._cubeSize;Sv(r,v*y,g>2?y:0,y,y),u.setRenderTarget(r),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=_}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===ya||e.mapping===yc;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=nU()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=tU());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ot(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const c=this._cubeSize;Sv(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,rM)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,Jk[(r-1)%Jk.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const c=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new Ot(this._lodPlanes[r],l),d=l.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,m=s/p,_=isFinite(s)?1+Math.floor(3*m):20;_>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to 20`);const g=[];let v=0;for(let S=0;S<20;++S){const M=S/m,b=Math.exp(-M*M/2);g.push(b),0===S?v+=b:S<_&&(v+=2*b)}for(let S=0;S<g.length;S++)g[S]=g[S]/v;d.envMap.value=e.texture,d.samples.value=_,d.weights.value=g,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-i;const w=this._sizeLods[r];Sv(t,3*w*(r>y-4?r-y+4:0),4*(this._cubeSize-w),3*w,2*w),c.setRenderTarget(t),c.render(h,rM)}}function eU(n,e,t){const i=new Tc(n,e,t);return i.texture.mapping=Gf,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Sv(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function tU(){return new Ys({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function nU(){return new Ys({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Mre(n){let e=new WeakMap,t=null;function s(a){const c=a.target;c.removeEventListener("dispose",s);const l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function i(a){if(a&&a.isTexture){const c=a.mapping,l=303===c||304===c,u=c===ya||c===yc;if(l||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new Qk(n)),h=l?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(l&&h&&h.height>0||u&&h&&function r(a){let c=0;for(let u=0;u<6;u++)void 0!==a[u]&&c++;return 6===c}(h)){null===t&&(t=new Qk(n));const d=l?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Cre(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Tre(n,e,t,i){const r={},s=new WeakMap;function o(h){const d=h.target;null!==d.index&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);for(const p in d.morphAttributes){const m=d.morphAttributes[p];for(let _=0,g=m.length;_<g;_++)e.remove(m[_])}d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,t.memory.geometries--}function l(h){const d=[],f=h.index,p=h.attributes.position;let m=0;if(null!==f){const v=f.array;m=f.version;for(let y=0,w=v.length;y<w;y+=3){const x=v[y+0],E=v[y+1],S=v[y+2];d.push(x,E,E,S,S,x)}}else{if(void 0===p)return;m=p.version;for(let y=0,w=p.array.length/3-1;y<w;y+=3){const x=y+0,E=y+1,S=y+2;d.push(x,E,E,S,S,x)}}const _=new(Ck(d)?Hk:zk)(d,1);_.version=m;const g=s.get(h);g&&e.remove(g),s.set(h,_)}return{get:function a(h,d){return!0===r[d.id]||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d},update:function c(h){const d=h.attributes;for(const p in d)e.update(d[p],n.ARRAY_BUFFER);const f=h.morphAttributes;for(const p in f){const m=f[p];for(let _=0,g=m.length;_<g;_++)e.update(m[_],n.ARRAY_BUFFER)}},getWireframeAttribute:function u(h){const d=s.get(h);if(d){const f=h.index;null!==f&&d.version<f.version&&l(h)}else l(h);return s.get(h)}}}function Are(n,e,t,i){const r=i.isWebGL2;let s,a,c;this.setMode=function o(f){s=f},this.setIndex=function l(f){a=f.type,c=f.bytesPerElement},this.render=function u(f,p){n.drawElements(s,p,a,f*c),t.update(p,s,1)},this.renderInstances=function h(f,p,m){if(0===m)return;let _,g;if(r)_=n,g="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===_)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[g](s,p,a,f*c,m),t.update(p,s,m)},this.renderMultiDraw=function d(f,p,m){if(0===m)return;const _=e.get("WEBGL_multi_draw");if(null===_)for(let g=0;g<m;g++)this.render(f[g]/c,p[g]);else{_.multiDrawElementsWEBGL(s,p,0,a,f,0,m);let g=0;for(let v=0;v<m;v++)g+=p[v];t.update(g,s,1)}}}function Dre(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function Ire(n,e){return n[0]-e[0]}function Rre(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Pre(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Vt,a=[];for(let l=0;l<8;l++)a[l]=[l,0];return{update:function c(l,u,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==f?f.length:0;let m=s.get(u);if(void 0===m||m.count!==p){let R=function(){F.dispose(),s.delete(u),u.removeEventListener("dispose",R)};void 0!==m&&m.texture.dispose();const v=void 0!==u.morphAttributes.position,y=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,x=u.morphAttributes.position||[],E=u.morphAttributes.normal||[],S=u.morphAttributes.color||[];let M=0;!0===v&&(M=1),!0===y&&(M=2),!0===w&&(M=3);let b=u.attributes.position.count*M,C=1;b>e.maxTextureSize&&(C=Math.ceil(b/e.maxTextureSize),b=e.maxTextureSize);const L=new Float32Array(b*C*4*p),F=new zS(L,b,C,p);F.type=qs,F.needsUpdate=!0;const B=4*M;for(let k=0;k<p;k++){const V=x[k],z=E[k],re=S[k],q=b*C*4*k;for(let ee=0;ee<V.count;ee++){const te=ee*B;!0===v&&(o.fromBufferAttribute(V,ee),L[q+te+0]=o.x,L[q+te+1]=o.y,L[q+te+2]=o.z,L[q+te+3]=0),!0===y&&(o.fromBufferAttribute(z,ee),L[q+te+4]=o.x,L[q+te+5]=o.y,L[q+te+6]=o.z,L[q+te+7]=0),!0===w&&(o.fromBufferAttribute(re,ee),L[q+te+8]=o.x,L[q+te+9]=o.y,L[q+te+10]=o.z,L[q+te+11]=4===re.itemSize?o.w:1)}}m={count:p,texture:F,size:new Y(b,C)},s.set(u,m),u.addEventListener("dispose",R)}let _=0;for(let v=0;v<d.length;v++)_+=d[v];const g=u.morphTargetsRelative?1:1-_;h.getUniforms().setValue(n,"morphTargetBaseInfluence",g),h.getUniforms().setValue(n,"morphTargetInfluences",d),h.getUniforms().setValue(n,"morphTargetsTexture",m.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",m.size)}else{const f=void 0===d?0:d.length;let p=i[u.id];if(void 0===p||p.length!==f){p=[];for(let y=0;y<f;y++)p[y]=[y,0];i[u.id]=p}for(let y=0;y<f;y++){const w=p[y];w[0]=y,w[1]=d[y]}p.sort(Rre);for(let y=0;y<8;y++)y<f&&p[y][1]?(a[y][0]=p[y][0],a[y][1]=p[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(Ire);const m=u.morphAttributes.position,_=u.morphAttributes.normal;let g=0;for(let y=0;y<8;y++){const w=a[y],x=w[0],E=w[1];x!==Number.MAX_SAFE_INTEGER&&E?(m&&u.getAttribute("morphTarget"+y)!==m[x]&&u.setAttribute("morphTarget"+y,m[x]),_&&u.getAttribute("morphNormal"+y)!==_[x]&&u.setAttribute("morphNormal"+y,_[x]),r[y]=E,g+=E):(m&&!0===u.hasAttribute("morphTarget"+y)&&u.deleteAttribute("morphTarget"+y),_&&!0===u.hasAttribute("morphNormal"+y)&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const v=u.morphTargetsRelative?1:1-g;h.getUniforms().setValue(n,"morphTargetBaseInfluence",v),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function Nre(n,e,t,i){let r=new WeakMap;function a(c){const l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),null!==l.instanceColor&&t.remove(l.instanceColor)}return{update:function s(c){const l=i.render.frame,h=e.get(c,c.geometry);if(r.get(h)!==l&&(e.update(h),r.set(h,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",a)&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),null!==c.instanceColor&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){const d=c.skeleton;r.get(d)!==l&&(d.update(),r.set(d,l))}return h},dispose:function o(){r=new WeakMap}}}class iU extends Qr{constructor(e,t,i,r,s,o,a,c,l,u){if((u=void 0!==u?u:xc)!==xc&&u!==$u)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===xc&&(i=xa),void 0===i&&u===$u&&(i=wc),super(null,r,s,o,a,c,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Cn,this.minFilter=void 0!==c?c:Cn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const rU=new Qr,sU=new iU(1,1);sU.compareFunction=515;const oU=new zS,aU=new Rk,cU=new yv,lU=[],uU=[],hU=new Float32Array(16),dU=new Float32Array(9),fU=new Float32Array(4);function yh(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=lU[r];if(void 0===s&&(s=new Float32Array(r),lU[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function qn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Xn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function Mv(n,e){let t=uU[e];void 0===t&&(t=new Int32Array(e),uU[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Lre(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Ore(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(qn(t,e))return;n.uniform2fv(this.addr,e),Xn(t,e)}}function Fre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(qn(t,e))return;n.uniform3fv(this.addr,e),Xn(t,e)}}function kre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(qn(t,e))return;n.uniform4fv(this.addr,e),Xn(t,e)}}function Ure(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(qn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Xn(t,e)}else{if(qn(t,i))return;fU.set(i),n.uniformMatrix2fv(this.addr,!1,fU),Xn(t,i)}}function Bre(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(qn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Xn(t,e)}else{if(qn(t,i))return;dU.set(i),n.uniformMatrix3fv(this.addr,!1,dU),Xn(t,i)}}function Vre(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(qn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Xn(t,e)}else{if(qn(t,i))return;hU.set(i),n.uniformMatrix4fv(this.addr,!1,hU),Xn(t,i)}}function zre(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function Hre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(qn(t,e))return;n.uniform2iv(this.addr,e),Xn(t,e)}}function Gre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(qn(t,e))return;n.uniform3iv(this.addr,e),Xn(t,e)}}function Wre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(qn(t,e))return;n.uniform4iv(this.addr,e),Xn(t,e)}}function jre(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function $re(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(qn(t,e))return;n.uniform2uiv(this.addr,e),Xn(t,e)}}function qre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(qn(t,e))return;n.uniform3uiv(this.addr,e),Xn(t,e)}}function Xre(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(qn(t,e))return;n.uniform4uiv(this.addr,e),Xn(t,e)}}function Yre(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||(this.type===n.SAMPLER_2D_SHADOW?sU:rU),r)}function Zre(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||aU,r)}function Kre(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||cU,r)}function Jre(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||oU,r)}function ese(n,e){n.uniform1fv(this.addr,e)}function tse(n,e){const t=yh(e,this.size,2);n.uniform2fv(this.addr,t)}function nse(n,e){const t=yh(e,this.size,3);n.uniform3fv(this.addr,t)}function ise(n,e){const t=yh(e,this.size,4);n.uniform4fv(this.addr,t)}function rse(n,e){const t=yh(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function sse(n,e){const t=yh(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function ose(n,e){const t=yh(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function ase(n,e){n.uniform1iv(this.addr,e)}function cse(n,e){n.uniform2iv(this.addr,e)}function lse(n,e){n.uniform3iv(this.addr,e)}function use(n,e){n.uniform4iv(this.addr,e)}function hse(n,e){n.uniform1uiv(this.addr,e)}function dse(n,e){n.uniform2uiv(this.addr,e)}function fse(n,e){n.uniform3uiv(this.addr,e)}function pse(n,e){n.uniform4uiv(this.addr,e)}function mse(n,e,t){const i=this.cache,r=e.length,s=Mv(t,r);qn(i,s)||(n.uniform1iv(this.addr,s),Xn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||rU,s[o])}function gse(n,e,t){const i=this.cache,r=e.length,s=Mv(t,r);qn(i,s)||(n.uniform1iv(this.addr,s),Xn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||aU,s[o])}function _se(n,e,t){const i=this.cache,r=e.length,s=Mv(t,r);qn(i,s)||(n.uniform1iv(this.addr,s),Xn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||cU,s[o])}function vse(n,e,t){const i=this.cache,r=e.length,s=Mv(t,r);qn(i,s)||(n.uniform1iv(this.addr,s),Xn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||oU,s[o])}class wse{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function Qre(n){switch(n){case 5126:return Lre;case 35664:return Ore;case 35665:return Fre;case 35666:return kre;case 35674:return Ure;case 35675:return Bre;case 35676:return Vre;case 5124:case 35670:return zre;case 35667:case 35671:return Hre;case 35668:case 35672:return Gre;case 35669:case 35673:return Wre;case 5125:return jre;case 36294:return $re;case 36295:return qre;case 36296:return Xre;case 35678:case 36198:case 36298:case 36306:case 35682:return Yre;case 35679:case 36299:case 36307:return Zre;case 35680:case 36300:case 36308:case 36293:return Kre;case 36289:case 36303:case 36311:case 36292:return Jre}}(t.type)}}class xse{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function yse(n){switch(n){case 5126:return ese;case 35664:return tse;case 35665:return nse;case 35666:return ise;case 35674:return rse;case 35675:return sse;case 35676:return ose;case 5124:case 35670:return ase;case 35667:case 35671:return cse;case 35668:case 35672:return lse;case 35669:case 35673:return use;case 5125:return hse;case 36294:return dse;case 36295:return fse;case 36296:return pse;case 35678:case 36198:case 36298:case 36306:case 35682:return mse;case 35679:case 36299:case 36307:return gse;case 35680:case 36300:case 36308:case 36293:return _se;case 36289:case 36303:case 36311:case 36292:return vse}}(t.type)}}class bse{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const lM=/(\w+)(\])?(\[|\.)?/g;function pU(n,e){n.seq.push(e),n.map[e.id]=e}function Ese(n,e,t){const i=n.name,r=i.length;for(lM.lastIndex=0;;){const s=lM.exec(i);let a=s[1];const l=s[3];if("]"===s[2]&&(a|=0),void 0===l||"["===l&&lM.lastIndex+2===r){pU(t,void 0===l?new wse(a,n,e):new xse(a,n,e));break}{let h=t.map[a];void 0===h&&(h=new bse(a),pU(t,h)),t=h}}}class Cv{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);Ese(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=i[a.id];!1!==c.needsUpdate&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function mU(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const Sse=37297;let Mse=0;function gU(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Cse(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function Ase(n,e){const t=function Tse(n){const e=Lt.getPrimaries(Lt.workingColorSpace),t=Lt.getPrimaries(n);let i;switch(e===t?i="":e===K_&&t===Z_?i="LinearDisplayP3ToLinearSRGB":e===Z_&&t===K_&&(i="LinearSRGBToLinearDisplayP3"),n){case Qn:case X_:return[i,"LinearTransferOETF"];case Wt:case LS:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Dse(n,e){let t;switch(e){case F2:t="Linear";break;case k2:t="Reinhard";break;case U2:t="OptimizedCineon";break;case ES:t="ACESFilmic";break;case B2:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function ip(n){return""!==n}function _U(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function vU(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Nse=/^[ \t]*#include +<([\w\d./]+)>/gm;function uM(n){return n.replace(Nse,Ose)}const Lse=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Ose(n,e){let t=dt[e];if(void 0===t){const i=Lse.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=dt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return uM(t)}const Fse=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function yU(n){return n.replace(Fse,kse)}function kse(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function wU(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function Gse(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=function Use(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===I2?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===R2?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===bo&&(e="SHADOWMAP_TYPE_VSM"),e}(t),l=function Bse(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case ya:case yc:e="ENVMAP_TYPE_CUBE";break;case Gf:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function Vse(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===yc&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function zse(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case H_:e="ENVMAP_BLENDING_MULTIPLY";break;case ste:e="ENVMAP_BLENDING_MIX";break;case ote:e="ENVMAP_BLENDING_ADD"}return e}(t),d=function Hse(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function Ise(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ip).join("\n")}(t),p=function Rse(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),m=r.createProgram();let _,g,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(_=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(ip).join("\n"),_.length>0&&(_+="\n"),g=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(ip).join("\n"),g.length>0&&(g+="\n")):(_=[wU(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ip).join("\n"),g=[f,wU(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==So?"#define TONE_MAPPING":"",t.toneMapping!==So?dt.tonemapping_pars_fragment:"",t.toneMapping!==So?Dse("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",dt.colorspace_pars_fragment,Ase("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(ip).join("\n")),o=uM(o),o=_U(o,t),o=vU(o,t),a=uM(a),a=_U(a,t),a=vU(a,t),o=yU(o),a=yU(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",_=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+_,g=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===Sk?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Sk?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const w=v+g+a,x=mU(r,r.VERTEX_SHADER,v+_+o),E=mU(r,r.FRAGMENT_SHADER,w);function S(L){if(n.debug.checkShaderErrors){const F=r.getProgramInfoLog(m).trim(),B=r.getShaderInfoLog(x).trim(),R=r.getShaderInfoLog(E).trim();let k=!0,V=!0;if(!1===r.getProgramParameter(m,r.LINK_STATUS))if(k=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,m,x,E);else{const z=gU(r,x,"vertex"),re=gU(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+F+"\n"+z+"\n"+re)}else""!==F?console.warn("THREE.WebGLProgram: Program Info Log:",F):(""===B||""===R)&&(V=!1);V&&(L.diagnostics={runnable:k,programLog:F,vertexShader:{log:B,prefix:_},fragmentShader:{log:R,prefix:g}})}r.deleteShader(x),r.deleteShader(E),M=new Cv(r,m),b=function Pse(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,m)}let M,b;r.attachShader(m,x),r.attachShader(m,E),void 0!==t.index0AttributeName?r.bindAttribLocation(m,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),this.getUniforms=function(){return void 0===M&&S(this),M},this.getAttributes=function(){return void 0===b&&S(this),b};let C=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===C&&(C=r.getProgramParameter(m,Sse)),C},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Mse++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=x,this.fragmentShader=E,this}let Wse=0;class jse{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new $se(e),t.set(e,i)),i}}class $se{constructor(e){this.id=Wse++,this.code=e,this.usedTimes=0}}function qse(n,e,t,i,r,s,o){const a=new XS,c=new jse,l=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(b){return 0===b?"uv":`uv${b}`}return{getParameters:function _(b,C,L,F,B){const R=F.fog,k=B.geometry,z=(b.isMeshStandardMaterial?t:e).get(b.envMap||(b.isMeshStandardMaterial?F.environment:null)),re=z&&z.mapping===Gf?z.image.height:null,q=p[b.type];null!==b.precision&&(f=r.getMaxPrecision(b.precision),f!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",f,"instead."));const ee=k.morphAttributes.position||k.morphAttributes.normal||k.morphAttributes.color,te=void 0!==ee?ee.length:0;let G,K,ae,ye,_e=0;if(void 0!==k.morphAttributes.position&&(_e=1),void 0!==k.morphAttributes.normal&&(_e=2),void 0!==k.morphAttributes.color&&(_e=3),q){const Xi=Zs[q];G=Xi.vertexShader,K=Xi.fragmentShader}else G=b.vertexShader,K=b.fragmentShader,c.update(b),ae=c.getVertexShaderID(b),ye=c.getFragmentShaderID(b);const Ce=n.getRenderTarget(),Be=!0===B.isInstancedMesh,Se=!!b.map,P=!!z,ge=!!b.aoMap,Q=!!b.lightMap,fe=!!b.bumpMap,ie=!!b.normalMap,Ve=!!b.displacementMap,Te=!!b.emissiveMap,De=!!b.metalnessMap,Ye=!!b.roughnessMap,wt=b.anisotropy>0,nn=b.clearcoat>0,I=b.iridescence>0,T=b.sheen>0,H=b.transmission>0,ue=wt&&!!b.anisotropyMap,se=nn&&!!b.clearcoatMap,he=nn&&!!b.clearcoatNormalMap,ke=nn&&!!b.clearcoatRoughnessMap,pe=I&&!!b.iridescenceMap,Ee=I&&!!b.iridescenceThicknessMap,N=T&&!!b.sheenColorMap,me=T&&!!b.sheenRoughnessMap,ne=!!b.specularMap,Qe=!!b.specularColorMap,ze=!!b.specularIntensityMap,qe=H&&!!b.transmissionMap,Le=H&&!!b.thicknessMap,gt=!!b.alphaMap,oe=!!b.extensions,J=!!k.attributes.uv1,de=!!k.attributes.uv2,je=!!k.attributes.uv3;let _t=So;return b.toneMapped&&(null===Ce||!0===Ce.isXRRenderTarget)&&(_t=n.toneMapping),{isWebGL2:u,shaderID:q,shaderType:b.type,shaderName:b.name,vertexShader:G,fragmentShader:K,defines:b.defines,customVertexShaderID:ae,customFragmentShaderID:ye,isRawShaderMaterial:!0===b.isRawShaderMaterial,glslVersion:b.glslVersion,precision:f,batching:!0===B.isBatchedMesh,instancing:Be,instancingColor:Be&&null!==B.instanceColor,supportsVertexTextures:d,outputColorSpace:null===Ce?n.outputColorSpace:!0===Ce.isXRRenderTarget?Ce.texture.colorSpace:Qn,map:Se,matcap:!!b.matcap,envMap:P,envMapMode:P&&z.mapping,envMapCubeUVHeight:re,aoMap:ge,lightMap:Q,bumpMap:fe,normalMap:ie,displacementMap:d&&Ve,emissiveMap:Te,normalMapObjectSpace:ie&&1===b.normalMapType,normalMapTangentSpace:ie&&0===b.normalMapType,metalnessMap:De,roughnessMap:Ye,anisotropy:wt,anisotropyMap:ue,clearcoat:nn,clearcoatMap:se,clearcoatNormalMap:he,clearcoatRoughnessMap:ke,iridescence:I,iridescenceMap:pe,iridescenceThicknessMap:Ee,sheen:T,sheenColorMap:N,sheenRoughnessMap:me,specularMap:ne,specularColorMap:Qe,specularIntensityMap:ze,transmission:H,transmissionMap:qe,thicknessMap:Le,gradientMap:!!b.gradientMap,opaque:!1===b.transparent&&1===b.blending,alphaMap:gt,alphaTest:b.alphaTest>0,alphaHash:!!b.alphaHash,combine:b.combine,mapUv:Se&&m(b.map.channel),aoMapUv:ge&&m(b.aoMap.channel),lightMapUv:Q&&m(b.lightMap.channel),bumpMapUv:fe&&m(b.bumpMap.channel),normalMapUv:ie&&m(b.normalMap.channel),displacementMapUv:Ve&&m(b.displacementMap.channel),emissiveMapUv:Te&&m(b.emissiveMap.channel),metalnessMapUv:De&&m(b.metalnessMap.channel),roughnessMapUv:Ye&&m(b.roughnessMap.channel),anisotropyMapUv:ue&&m(b.anisotropyMap.channel),clearcoatMapUv:se&&m(b.clearcoatMap.channel),clearcoatNormalMapUv:he&&m(b.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ke&&m(b.clearcoatRoughnessMap.channel),iridescenceMapUv:pe&&m(b.iridescenceMap.channel),iridescenceThicknessMapUv:Ee&&m(b.iridescenceThicknessMap.channel),sheenColorMapUv:N&&m(b.sheenColorMap.channel),sheenRoughnessMapUv:me&&m(b.sheenRoughnessMap.channel),specularMapUv:ne&&m(b.specularMap.channel),specularColorMapUv:Qe&&m(b.specularColorMap.channel),specularIntensityMapUv:ze&&m(b.specularIntensityMap.channel),transmissionMapUv:qe&&m(b.transmissionMap.channel),thicknessMapUv:Le&&m(b.thicknessMap.channel),alphaMapUv:gt&&m(b.alphaMap.channel),vertexTangents:!!k.attributes.tangent&&(ie||wt),vertexColors:b.vertexColors,vertexAlphas:!0===b.vertexColors&&!!k.attributes.color&&4===k.attributes.color.itemSize,vertexUv1s:J,vertexUv2s:de,vertexUv3s:je,pointsUvs:!0===B.isPoints&&!!k.attributes.uv&&(Se||gt),fog:!!R,useFog:!0===b.fog,fogExp2:R&&R.isFogExp2,flatShading:!0===b.flatShading,sizeAttenuation:!0===b.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===B.isSkinnedMesh,morphTargets:void 0!==k.morphAttributes.position,morphNormals:void 0!==k.morphAttributes.normal,morphColors:void 0!==k.morphAttributes.color,morphTargetsCount:te,morphTextureStride:_e,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numLightProbes:C.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:b.dithering,shadowMapEnabled:n.shadowMap.enabled&&L.length>0,shadowMapType:n.shadowMap.type,toneMapping:_t,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Se&&!0===b.map.isVideoTexture&&Lt.getTransfer(b.map.colorSpace)===tn,premultipliedAlpha:b.premultipliedAlpha,doubleSided:2===b.side,flipSided:1===b.side,useDepthPacking:b.depthPacking>=0,depthPacking:b.depthPacking||0,index0AttributeName:b.index0AttributeName,extensionDerivatives:oe&&!0===b.extensions.derivatives,extensionFragDepth:oe&&!0===b.extensions.fragDepth,extensionDrawBuffers:oe&&!0===b.extensions.drawBuffers,extensionShaderTextureLOD:oe&&!0===b.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:b.customProgramCacheKey()}},getProgramCacheKey:function g(b){const C=[];if(b.shaderID?C.push(b.shaderID):(C.push(b.customVertexShaderID),C.push(b.customFragmentShaderID)),void 0!==b.defines)for(const L in b.defines)C.push(L),C.push(b.defines[L]);return!1===b.isRawShaderMaterial&&(function v(b,C){b.push(C.precision),b.push(C.outputColorSpace),b.push(C.envMapMode),b.push(C.envMapCubeUVHeight),b.push(C.mapUv),b.push(C.alphaMapUv),b.push(C.lightMapUv),b.push(C.aoMapUv),b.push(C.bumpMapUv),b.push(C.normalMapUv),b.push(C.displacementMapUv),b.push(C.emissiveMapUv),b.push(C.metalnessMapUv),b.push(C.roughnessMapUv),b.push(C.anisotropyMapUv),b.push(C.clearcoatMapUv),b.push(C.clearcoatNormalMapUv),b.push(C.clearcoatRoughnessMapUv),b.push(C.iridescenceMapUv),b.push(C.iridescenceThicknessMapUv),b.push(C.sheenColorMapUv),b.push(C.sheenRoughnessMapUv),b.push(C.specularMapUv),b.push(C.specularColorMapUv),b.push(C.specularIntensityMapUv),b.push(C.transmissionMapUv),b.push(C.thicknessMapUv),b.push(C.combine),b.push(C.fogExp2),b.push(C.sizeAttenuation),b.push(C.morphTargetsCount),b.push(C.morphAttributeCount),b.push(C.numDirLights),b.push(C.numPointLights),b.push(C.numSpotLights),b.push(C.numSpotLightMaps),b.push(C.numHemiLights),b.push(C.numRectAreaLights),b.push(C.numDirLightShadows),b.push(C.numPointLightShadows),b.push(C.numSpotLightShadows),b.push(C.numSpotLightShadowsWithMaps),b.push(C.numLightProbes),b.push(C.shadowMapType),b.push(C.toneMapping),b.push(C.numClippingPlanes),b.push(C.numClipIntersection),b.push(C.depthPacking)}(C,b),function y(b,C){a.disableAll(),C.isWebGL2&&a.enable(0),C.supportsVertexTextures&&a.enable(1),C.instancing&&a.enable(2),C.instancingColor&&a.enable(3),C.matcap&&a.enable(4),C.envMap&&a.enable(5),C.normalMapObjectSpace&&a.enable(6),C.normalMapTangentSpace&&a.enable(7),C.clearcoat&&a.enable(8),C.iridescence&&a.enable(9),C.alphaTest&&a.enable(10),C.vertexColors&&a.enable(11),C.vertexAlphas&&a.enable(12),C.vertexUv1s&&a.enable(13),C.vertexUv2s&&a.enable(14),C.vertexUv3s&&a.enable(15),C.vertexTangents&&a.enable(16),C.anisotropy&&a.enable(17),C.alphaHash&&a.enable(18),C.batching&&a.enable(19),b.push(a.mask),a.disableAll(),C.fog&&a.enable(0),C.useFog&&a.enable(1),C.flatShading&&a.enable(2),C.logarithmicDepthBuffer&&a.enable(3),C.skinning&&a.enable(4),C.morphTargets&&a.enable(5),C.morphNormals&&a.enable(6),C.morphColors&&a.enable(7),C.premultipliedAlpha&&a.enable(8),C.shadowMapEnabled&&a.enable(9),C.useLegacyLights&&a.enable(10),C.doubleSided&&a.enable(11),C.flipSided&&a.enable(12),C.useDepthPacking&&a.enable(13),C.dithering&&a.enable(14),C.transmission&&a.enable(15),C.sheen&&a.enable(16),C.opaque&&a.enable(17),C.pointsUvs&&a.enable(18),C.decodeVideoTexture&&a.enable(19),b.push(a.mask)}(C,b),C.push(n.outputColorSpace)),C.push(b.customProgramCacheKey),C.join()},getUniforms:function w(b){const C=p[b.type];let L;return L=C?une.clone(Zs[C].uniforms):b.uniforms,L},acquireProgram:function x(b,C){let L;for(let F=0,B=l.length;F<B;F++){const R=l[F];if(R.cacheKey===C){L=R,++L.usedTimes;break}}return void 0===L&&(L=new Gse(n,C,b,s),l.push(L)),L},releaseProgram:function E(b){if(0==--b.usedTimes){const C=l.indexOf(b);l[C]=l[l.length-1],l.pop(),b.destroy()}},releaseShaderCache:function S(b){c.remove(b)},programs:l,dispose:function M(){c.dispose()}}}function Xse(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function Yse(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function xU(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function bU(){const n=[];let e=0;const t=[],i=[],r=[];function o(h,d,f,p,m,_){let g=n[e];return void 0===g?(g={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:m,group:_},n[e]=g):(g.id=h.id,g.object=h,g.geometry=d,g.material=f,g.groupOrder=p,g.renderOrder=h.renderOrder,g.z=m,g.group=_),e++,g}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(h,d,f,p,m,_){const g=o(h,d,f,p,m,_);f.transmission>0?i.push(g):!0===f.transparent?r.push(g):t.push(g)},unshift:function c(h,d,f,p,m,_){const g=o(h,d,f,p,m,_);f.transmission>0?i.unshift(g):!0===f.transparent?r.unshift(g):t.unshift(g)},finish:function u(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function l(h,d){t.length>1&&t.sort(h||Yse),i.length>1&&i.sort(d||xU),r.length>1&&r.sort(d||xU)}}}function Zse(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new bU,n.set(i,[o])):r>=s.length?(o=new bU,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function Kse(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new A,color:new Z};break;case"SpotLight":t={position:new A,direction:new A,color:new Z,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new A,color:new Z,distance:0,decay:0};break;case"HemisphereLight":t={direction:new A,skyColor:new Z,groundColor:new Z};break;case"RectAreaLight":t={color:new Z,position:new A,halfWidth:new A,halfHeight:new A}}return n[e.id]=t,t}}}let Qse=0;function eoe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function toe(n,e){const t=new Kse,i=function Jse(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Y};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Y,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new A);const s=new A,o=new Ge,a=new Ge;return{setup:function c(u,h){let d=0,f=0,p=0;for(let F=0;F<9;F++)r.probe[F].set(0,0,0);let m=0,_=0,g=0,v=0,y=0,w=0,x=0,E=0,S=0,M=0,b=0;u.sort(eoe);const C=!0===h?Math.PI:1;for(let F=0,B=u.length;F<B;F++){const R=u[F],k=R.color,V=R.intensity,z=R.distance,re=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)d+=k.r*V*C,f+=k.g*V*C,p+=k.b*V*C;else if(R.isLightProbe){for(let q=0;q<9;q++)r.probe[q].addScaledVector(R.sh.coefficients[q],V);b++}else if(R.isDirectionalLight){const q=t.get(R);if(q.color.copy(R.color).multiplyScalar(R.intensity*C),R.castShadow){const ee=R.shadow,te=i.get(R);te.shadowBias=ee.bias,te.shadowNormalBias=ee.normalBias,te.shadowRadius=ee.radius,te.shadowMapSize=ee.mapSize,r.directionalShadow[m]=te,r.directionalShadowMap[m]=re,r.directionalShadowMatrix[m]=R.shadow.matrix,w++}r.directional[m]=q,m++}else if(R.isSpotLight){const q=t.get(R);q.position.setFromMatrixPosition(R.matrixWorld),q.color.copy(k).multiplyScalar(V*C),q.distance=z,q.coneCos=Math.cos(R.angle),q.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),q.decay=R.decay,r.spot[g]=q;const ee=R.shadow;if(R.map&&(r.spotLightMap[S]=R.map,S++,ee.updateMatrices(R),R.castShadow&&M++),r.spotLightMatrix[g]=ee.matrix,R.castShadow){const te=i.get(R);te.shadowBias=ee.bias,te.shadowNormalBias=ee.normalBias,te.shadowRadius=ee.radius,te.shadowMapSize=ee.mapSize,r.spotShadow[g]=te,r.spotShadowMap[g]=re,E++}g++}else if(R.isRectAreaLight){const q=t.get(R);q.color.copy(k).multiplyScalar(V),q.halfWidth.set(.5*R.width,0,0),q.halfHeight.set(0,.5*R.height,0),r.rectArea[v]=q,v++}else if(R.isPointLight){const q=t.get(R);if(q.color.copy(R.color).multiplyScalar(R.intensity*C),q.distance=R.distance,q.decay=R.decay,R.castShadow){const ee=R.shadow,te=i.get(R);te.shadowBias=ee.bias,te.shadowNormalBias=ee.normalBias,te.shadowRadius=ee.radius,te.shadowMapSize=ee.mapSize,te.shadowCameraNear=ee.camera.near,te.shadowCameraFar=ee.camera.far,r.pointShadow[_]=te,r.pointShadowMap[_]=re,r.pointShadowMatrix[_]=R.shadow.matrix,x++}r.point[_]=q,_++}else if(R.isHemisphereLight){const q=t.get(R);q.skyColor.copy(R.color).multiplyScalar(V*C),q.groundColor.copy(R.groundColor).multiplyScalar(V*C),r.hemi[y]=q,y++}}v>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=xe.LTC_FLOAT_1,r.rectAreaLTC2=xe.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=xe.LTC_HALF_1,r.rectAreaLTC2=xe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const L=r.hash;(L.directionalLength!==m||L.pointLength!==_||L.spotLength!==g||L.rectAreaLength!==v||L.hemiLength!==y||L.numDirectionalShadows!==w||L.numPointShadows!==x||L.numSpotShadows!==E||L.numSpotMaps!==S||L.numLightProbes!==b)&&(r.directional.length=m,r.spot.length=g,r.rectArea.length=v,r.point.length=_,r.hemi.length=y,r.directionalShadow.length=w,r.directionalShadowMap.length=w,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=E,r.spotShadowMap.length=E,r.directionalShadowMatrix.length=w,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=E+S-M,r.spotLightMap.length=S,r.numSpotLightShadowsWithMaps=M,r.numLightProbes=b,L.directionalLength=m,L.pointLength=_,L.spotLength=g,L.rectAreaLength=v,L.hemiLength=y,L.numDirectionalShadows=w,L.numPointShadows=x,L.numSpotShadows=E,L.numSpotMaps=S,L.numLightProbes=b,r.version=Qse++)},setupView:function l(u,h){let d=0,f=0,p=0,m=0,_=0;const g=h.matrixWorldInverse;for(let v=0,y=u.length;v<y;v++){const w=u[v];if(w.isDirectionalLight){const x=r.directional[d];x.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(g),d++}else if(w.isSpotLight){const x=r.spot[p];x.position.setFromMatrixPosition(w.matrixWorld),x.position.applyMatrix4(g),x.direction.setFromMatrixPosition(w.matrixWorld),s.setFromMatrixPosition(w.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(g),p++}else if(w.isRectAreaLight){const x=r.rectArea[m];x.position.setFromMatrixPosition(w.matrixWorld),x.position.applyMatrix4(g),a.identity(),o.copy(w.matrixWorld),o.premultiply(g),a.extractRotation(o),x.halfWidth.set(.5*w.width,0,0),x.halfHeight.set(0,.5*w.height,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),m++}else if(w.isPointLight){const x=r.point[f];x.position.setFromMatrixPosition(w.matrixWorld),x.position.applyMatrix4(g),f++}else if(w.isHemisphereLight){const x=r.hemi[_];x.direction.setFromMatrixPosition(w.matrixWorld),x.direction.transformDirection(g),_++}}},state:r}}function EU(n,e){const t=new toe(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function c(h){t.setup(i,h)},setupLightsView:function l(h){t.setupView(i,h)},pushLight:function o(h){i.push(h)},pushShadow:function a(h){r.push(h)}}}function noe(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let c;return void 0===a?(c=new EU(n,e),t.set(s,[c])):o>=a.length?(c=new EU(n,e),a.push(c)):c=a[o],c},dispose:function r(){t=new WeakMap}}}class SU extends cr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class MU extends cr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function soe(n,e,t){let i=new xv;const r=new Y,s=new Y,o=new Vt,a=new SU({depthPacking:3201}),c=new MU,l={},u=t.maxTextureSize,h={0:1,1:0,2:2},d=new Ys({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Y},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new ot;p.setAttribute("position",new jt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Ot(p,d),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=I2;let g=this.type;function v(x,E){const S=e.update(m);d.defines.VSM_SAMPLES!==x.blurSamples&&(d.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new Tc(r.x,r.y)),d.uniforms.shadow_pass.value=x.map.texture,d.uniforms.resolution.value=x.mapSize,d.uniforms.radius.value=x.radius,n.setRenderTarget(x.mapPass),n.clear(),n.renderBufferDirect(E,null,S,d,m,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,n.setRenderTarget(x.map),n.clear(),n.renderBufferDirect(E,null,S,f,m,null)}function y(x,E,S,M){let b=null;const C=!0===S.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(void 0!==C)b=C;else if(b=!0===S.isPointLight?c:a,n.localClippingEnabled&&!0===E.clipShadows&&Array.isArray(E.clippingPlanes)&&0!==E.clippingPlanes.length||E.displacementMap&&0!==E.displacementScale||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0){const L=b.uuid,F=E.uuid;let B=l[L];void 0===B&&(B={},l[L]=B);let R=B[F];void 0===R&&(R=b.clone(),B[F]=R),b=R}return b.visible=E.visible,b.wireframe=E.wireframe,b.side=M===bo?null!==E.shadowSide?E.shadowSide:E.side:null!==E.shadowSide?E.shadowSide:h[E.side],b.alphaMap=E.alphaMap,b.alphaTest=E.alphaTest,b.map=E.map,b.clipShadows=E.clipShadows,b.clippingPlanes=E.clippingPlanes,b.clipIntersection=E.clipIntersection,b.displacementMap=E.displacementMap,b.displacementScale=E.displacementScale,b.displacementBias=E.displacementBias,b.wireframeLinewidth=E.wireframeLinewidth,b.linewidth=E.linewidth,!0===S.isPointLight&&!0===b.isMeshDistanceMaterial&&(n.properties.get(b).light=S),b}function w(x,E,S,M,b){if(!1===x.visible)return;if(x.layers.test(E.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&b===bo)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,x.matrixWorld);const F=e.update(x),B=x.material;if(Array.isArray(B)){const R=F.groups;for(let k=0,V=R.length;k<V;k++){const z=R[k],re=B[z.materialIndex];if(re&&re.visible){const q=y(x,re,M,b);x.onBeforeShadow(n,x,E,S,F,q,z),n.renderBufferDirect(S,null,F,q,x,z),x.onAfterShadow(n,x,E,S,F,q,z)}}}else if(B.visible){const R=y(x,B,M,b);x.onBeforeShadow(n,x,E,S,F,R,null),n.renderBufferDirect(S,null,F,R,x,null),x.onAfterShadow(n,x,E,S,F,R,null)}}const L=x.children;for(let F=0,B=L.length;F<B;F++)w(L[F],E,S,M,b)}this.render=function(x,E,S){if(!1===_.enabled||!1===_.autoUpdate&&!1===_.needsUpdate||0===x.length)return;const M=n.getRenderTarget(),b=n.getActiveCubeFace(),C=n.getActiveMipmapLevel(),L=n.state;L.setBlending(0),L.buffers.color.setClear(1,1,1,1),L.buffers.depth.setTest(!0),L.setScissorTest(!1);const F=g!==bo&&this.type===bo,B=g===bo&&this.type!==bo;for(let R=0,k=x.length;R<k;R++){const V=x[R],z=V.shadow;if(void 0===z){console.warn("THREE.WebGLShadowMap:",V,"has no shadow.");continue}if(!1===z.autoUpdate&&!1===z.needsUpdate)continue;r.copy(z.mapSize);const re=z.getFrameExtents();if(r.multiply(re),s.copy(z.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/re.x),r.x=s.x*re.x,z.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/re.y),r.y=s.y*re.y,z.mapSize.y=s.y)),null===z.map||!0===F||!0===B){const ee=this.type!==bo?{minFilter:Cn,magFilter:Cn}:{};null!==z.map&&z.map.dispose(),z.map=new Tc(r.x,r.y,ee),z.map.texture.name=V.name+".shadowMap",z.camera.updateProjectionMatrix()}n.setRenderTarget(z.map),n.clear();const q=z.getViewportCount();for(let ee=0;ee<q;ee++){const te=z.getViewport(ee);o.set(s.x*te.x,s.y*te.y,s.x*te.z,s.y*te.w),L.viewport(o),z.updateMatrices(V,ee),i=z.getFrustum(),w(E,S,z.camera,V,this.type)}!0!==z.isPointLightShadow&&this.type===bo&&v(z,S),z.needsUpdate=!1}g=this.type,_.needsUpdate=!1,n.setRenderTarget(M,b,C)}}function ooe(n,e,t){const i=t.isWebGL2,a=new function r(){let O=!1;const be=new Vt;let oe=null;const J=new Vt(0,0,0,0);return{setMask:function(de){oe!==de&&!O&&(n.colorMask(de,de,de,de),oe=de)},setLocked:function(de){O=de},setClear:function(de,je,_t,oi,Xi){!0===Xi&&(de*=oi,je*=oi,_t*=oi),be.set(de,je,_t,oi),!1===J.equals(be)&&(n.clearColor(de,je,_t,oi),J.copy(be))},reset:function(){O=!1,oe=null,J.set(-1,0,0,0)}}},c=new function s(){let O=!1,be=null,oe=null,J=null;return{setTest:function(de){de?We(n.DEPTH_TEST):Se(n.DEPTH_TEST)},setMask:function(de){be!==de&&!O&&(n.depthMask(de),be=de)},setFunc:function(de){if(oe!==de){switch(de){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}oe=de}},setLocked:function(de){O=de},setClear:function(de){J!==de&&(n.clearDepth(de),J=de)},reset:function(){O=!1,be=null,oe=null,J=null}}},l=new function o(){let O=!1,be=null,oe=null,J=null,de=null,je=null,_t=null,oi=null,Xi=null;return{setTest:function(Qt){O||(Qt?We(n.STENCIL_TEST):Se(n.STENCIL_TEST))},setMask:function(Qt){be!==Qt&&!O&&(n.stencilMask(Qt),be=Qt)},setFunc:function(Qt,Yi,so){(oe!==Qt||J!==Yi||de!==so)&&(n.stencilFunc(Qt,Yi,so),oe=Qt,J=Yi,de=so)},setOp:function(Qt,Yi,so){(je!==Qt||_t!==Yi||oi!==so)&&(n.stencilOp(Qt,Yi,so),je=Qt,_t=Yi,oi=so)},setLocked:function(Qt){O=Qt},setClear:function(Qt){Xi!==Qt&&(n.clearStencil(Qt),Xi=Qt)},reset:function(){O=!1,be=null,oe=null,J=null,de=null,je=null,_t=null,oi=null,Xi=null}}},u=new WeakMap,h=new WeakMap;let d={},f={},p=new WeakMap,m=[],_=null,g=!1,v=null,y=null,w=null,x=null,E=null,S=null,M=null,b=new Z(0,0,0),C=0,L=!1,F=null,B=null,R=null,k=null,V=null;const z=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let re=!1,q=0;const ee=n.getParameter(n.VERSION);-1!==ee.indexOf("WebGL")?(q=parseFloat(/^WebGL (\d)/.exec(ee)[1]),re=q>=1):-1!==ee.indexOf("OpenGL ES")&&(q=parseFloat(/^OpenGL ES (\d)/.exec(ee)[1]),re=q>=2);let te=null,_e={};const G=n.getParameter(n.SCISSOR_BOX),K=n.getParameter(n.VIEWPORT),ae=(new Vt).fromArray(G),ye=(new Vt).fromArray(K);function Ce(O,be,oe,J){const de=new Uint8Array(4),je=n.createTexture();n.bindTexture(O,je),n.texParameteri(O,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(O,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let _t=0;_t<oe;_t++)!i||O!==n.TEXTURE_3D&&O!==n.TEXTURE_2D_ARRAY?n.texImage2D(be+_t,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,de):n.texImage3D(be,0,n.RGBA,1,1,J,0,n.RGBA,n.UNSIGNED_BYTE,de);return je}const Be={};function We(O){!0!==d[O]&&(n.enable(O),d[O]=!0)}function Se(O){!1!==d[O]&&(n.disable(O),d[O]=!1)}Be[n.TEXTURE_2D]=Ce(n.TEXTURE_2D,n.TEXTURE_2D,1),Be[n.TEXTURE_CUBE_MAP]=Ce(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Be[n.TEXTURE_2D_ARRAY]=Ce(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Be[n.TEXTURE_3D]=Ce(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),c.setClear(1),l.setClear(0),We(n.DEPTH_TEST),c.setFunc(3),Te(!1),De(1),We(n.CULL_FACE),ie(0);const Q={100:n.FUNC_ADD,101:n.FUNC_SUBTRACT,102:n.FUNC_REVERSE_SUBTRACT};if(i)Q[103]=n.MIN,Q[104]=n.MAX;else{const O=e.get("EXT_blend_minmax");null!==O&&(Q[103]=O.MIN_EXT,Q[104]=O.MAX_EXT)}const fe={200:n.ZERO,201:n.ONE,202:n.SRC_COLOR,204:n.SRC_ALPHA,210:n.SRC_ALPHA_SATURATE,208:n.DST_COLOR,206:n.DST_ALPHA,203:n.ONE_MINUS_SRC_COLOR,205:n.ONE_MINUS_SRC_ALPHA,209:n.ONE_MINUS_DST_COLOR,207:n.ONE_MINUS_DST_ALPHA,211:n.CONSTANT_COLOR,212:n.ONE_MINUS_CONSTANT_COLOR,213:n.CONSTANT_ALPHA,214:n.ONE_MINUS_CONSTANT_ALPHA};function ie(O,be,oe,J,de,je,_t,oi,Xi,Qt){if(0!==O){if(!1===g&&(We(n.BLEND),g=!0),5===O)de=de||be,je=je||oe,_t=_t||J,(be!==y||de!==E)&&(n.blendEquationSeparate(Q[be],Q[de]),y=be,E=de),(oe!==w||J!==x||je!==S||_t!==M)&&(n.blendFuncSeparate(fe[oe],fe[J],fe[je],fe[_t]),w=oe,x=J,S=je,M=_t),(!1===oi.equals(b)||Xi!==C)&&(n.blendColor(oi.r,oi.g,oi.b,Xi),b.copy(oi),C=Xi),v=O,L=!1;else if(O!==v||Qt!==L){if((100!==y||100!==E)&&(n.blendEquation(n.FUNC_ADD),y=100,E=100),Qt)switch(O){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}else switch(O){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}w=null,x=null,S=null,M=null,b.set(0,0,0),C=0,v=O,L=Qt}}else!0===g&&(Se(n.BLEND),g=!1)}function Te(O){F!==O&&(n.frontFace(O?n.CW:n.CCW),F=O)}function De(O){0!==O?(We(n.CULL_FACE),O!==B&&n.cullFace(1===O?n.BACK:2===O?n.FRONT:n.FRONT_AND_BACK)):Se(n.CULL_FACE),B=O}function wt(O,be,oe){O?(We(n.POLYGON_OFFSET_FILL),(k!==be||V!==oe)&&(n.polygonOffset(be,oe),k=be,V=oe)):Se(n.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:c,stencil:l},enable:We,disable:Se,bindFramebuffer:function Fe(O,be){return f[O]!==be&&(n.bindFramebuffer(O,be),f[O]=be,i&&(O===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=be),O===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=be)),!0)},drawBuffers:function P(O,be){let oe=m,J=!1;if(O)if(oe=p.get(be),void 0===oe&&(oe=[],p.set(be,oe)),O.isWebGLMultipleRenderTargets){const de=O.texture;if(oe.length!==de.length||oe[0]!==n.COLOR_ATTACHMENT0){for(let je=0,_t=de.length;je<_t;je++)oe[je]=n.COLOR_ATTACHMENT0+je;oe.length=de.length,J=!0}}else oe[0]!==n.COLOR_ATTACHMENT0&&(oe[0]=n.COLOR_ATTACHMENT0,J=!0);else oe[0]!==n.BACK&&(oe[0]=n.BACK,J=!0);J&&(t.isWebGL2?n.drawBuffers(oe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(oe))},useProgram:function ge(O){return _!==O&&(n.useProgram(O),_=O,!0)},setBlending:ie,setMaterial:function Ve(O,be){2===O.side?Se(n.CULL_FACE):We(n.CULL_FACE);let oe=1===O.side;be&&(oe=!oe),Te(oe),1===O.blending&&!1===O.transparent?ie(0):ie(O.blending,O.blendEquation,O.blendSrc,O.blendDst,O.blendEquationAlpha,O.blendSrcAlpha,O.blendDstAlpha,O.blendColor,O.blendAlpha,O.premultipliedAlpha),c.setFunc(O.depthFunc),c.setTest(O.depthTest),c.setMask(O.depthWrite),a.setMask(O.colorWrite);const J=O.stencilWrite;l.setTest(J),J&&(l.setMask(O.stencilWriteMask),l.setFunc(O.stencilFunc,O.stencilRef,O.stencilFuncMask),l.setOp(O.stencilFail,O.stencilZFail,O.stencilZPass)),wt(O.polygonOffset,O.polygonOffsetFactor,O.polygonOffsetUnits),!0===O.alphaToCoverage?We(n.SAMPLE_ALPHA_TO_COVERAGE):Se(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Te,setCullFace:De,setLineWidth:function Ye(O){O!==R&&(re&&n.lineWidth(O),R=O)},setPolygonOffset:wt,setScissorTest:function nn(O){O?We(n.SCISSOR_TEST):Se(n.SCISSOR_TEST)},activeTexture:function I(O){void 0===O&&(O=n.TEXTURE0+z-1),te!==O&&(n.activeTexture(O),te=O)},bindTexture:function T(O,be,oe){void 0===oe&&(oe=null===te?n.TEXTURE0+z-1:te);let J=_e[oe];void 0===J&&(J={type:void 0,texture:void 0},_e[oe]=J),(J.type!==O||J.texture!==be)&&(te!==oe&&(n.activeTexture(oe),te=oe),n.bindTexture(O,be||Be[O]),J.type=O,J.texture=be)},unbindTexture:function H(){const O=_e[te];void 0!==O&&void 0!==O.type&&(n.bindTexture(O.type,null),O.type=void 0,O.texture=void 0)},compressedTexImage2D:function ue(){try{n.compressedTexImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexImage3D:function se(){try{n.compressedTexImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage2D:function ne(){try{n.texImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage3D:function Qe(){try{n.texImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},updateUBOMapping:function Le(O,be){let oe=h.get(be);void 0===oe&&(oe=new WeakMap,h.set(be,oe));let J=oe.get(O);void 0===J&&(J=n.getUniformBlockIndex(be,O.name),oe.set(O,J))},uniformBlockBinding:function Re(O,be){const J=h.get(be).get(O);u.get(be)!==J&&(n.uniformBlockBinding(be,J,O.__bindingPointIndex),u.set(be,J))},texStorage2D:function N(){try{n.texStorage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texStorage3D:function me(){try{n.texStorage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage2D:function he(){try{n.texSubImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage3D:function ke(){try{n.texSubImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage2D:function pe(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage3D:function Ee(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},scissor:function ze(O){!1===ae.equals(O)&&(n.scissor(O.x,O.y,O.z,O.w),ae.copy(O))},viewport:function qe(O){!1===ye.equals(O)&&(n.viewport(O.x,O.y,O.z,O.w),ye.copy(O))},reset:function gt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),!0===i&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},te=null,_e={},f={},p=new WeakMap,m=[],_=null,g=!1,v=null,y=null,w=null,x=null,E=null,S=null,M=null,b=new Z(0,0,0),C=0,L=!1,F=null,B=null,R=null,k=null,V=null,ae.set(0,0,n.canvas.width,n.canvas.height),ye.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),l.reset()}}}function aoe(n,e,t,i,r,s,o){const a=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const _=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(I,T){return g?new OffscreenCanvas(I,T):Zf("canvas")}function y(I,T,H,ue){let se=1;if((I.width>ue||I.height>ue)&&(se=ue/Math.max(I.width,I.height)),se<1||!0===T){if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap){const he=T?Q_:Math.floor,ke=he(se*I.width),pe=he(se*I.height);void 0===m&&(m=v(ke,pe));const Ee=H?v(ke,pe):m;return Ee.width=ke,Ee.height=pe,Ee.getContext("2d").drawImage(I,0,0,ke,pe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+I.width+"x"+I.height+") to ("+ke+"x"+pe+")."),Ee}return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+I.width+"x"+I.height+")."),I}return I}function w(I){return kS(I.width)&&kS(I.height)}function E(I,T){return I.generateMipmaps&&T&&I.minFilter!==Cn&&I.minFilter!==an}function S(I){n.generateMipmap(I)}function M(I,T,H,ue,se=!1){if(!1===a)return T;if(null!==I){if(void 0!==n[I])return n[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let he=T;if(T===n.RED&&(H===n.FLOAT&&(he=n.R32F),H===n.HALF_FLOAT&&(he=n.R16F),H===n.UNSIGNED_BYTE&&(he=n.R8)),T===n.RED_INTEGER&&(H===n.UNSIGNED_BYTE&&(he=n.R8UI),H===n.UNSIGNED_SHORT&&(he=n.R16UI),H===n.UNSIGNED_INT&&(he=n.R32UI),H===n.BYTE&&(he=n.R8I),H===n.SHORT&&(he=n.R16I),H===n.INT&&(he=n.R32I)),T===n.RG&&(H===n.FLOAT&&(he=n.RG32F),H===n.HALF_FLOAT&&(he=n.RG16F),H===n.UNSIGNED_BYTE&&(he=n.RG8)),T===n.RGBA){const ke=se?Y_:Lt.getTransfer(ue);H===n.FLOAT&&(he=n.RGBA32F),H===n.HALF_FLOAT&&(he=n.RGBA16F),H===n.UNSIGNED_BYTE&&(he=ke===tn?n.SRGB8_ALPHA8:n.RGBA8),H===n.UNSIGNED_SHORT_4_4_4_4&&(he=n.RGBA4),H===n.UNSIGNED_SHORT_5_5_5_1&&(he=n.RGB5_A1)}return(he===n.R16F||he===n.R32F||he===n.RG16F||he===n.RG32F||he===n.RGBA16F||he===n.RGBA32F)&&e.get("EXT_color_buffer_float"),he}function b(I,T,H){return!0===E(I,H)||I.isFramebufferTexture&&I.minFilter!==Cn&&I.minFilter!==an?Math.log2(Math.max(T.width,T.height))+1:void 0!==I.mipmaps&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?T.mipmaps.length:1}function C(I){return I===Cn||1004===I||1005===I?n.NEAREST:n.LINEAR}function L(I){const T=I.target;T.removeEventListener("dispose",L),function B(I){const T=i.get(I);if(void 0===T.__webglInit)return;const H=I.source,ue=_.get(H);if(ue){const se=ue[T.__cacheKey];se.usedTimes--,0===se.usedTimes&&R(I),0===Object.keys(ue).length&&_.delete(H)}i.remove(I)}(T),T.isVideoTexture&&p.delete(T)}function F(I){const T=I.target;T.removeEventListener("dispose",F),function k(I){const T=I.texture,H=i.get(I),ue=i.get(T);if(void 0!==ue.__webglTexture&&(n.deleteTexture(ue.__webglTexture),o.memory.textures--),I.depthTexture&&I.depthTexture.dispose(),I.isWebGLCubeRenderTarget)for(let se=0;se<6;se++){if(Array.isArray(H.__webglFramebuffer[se]))for(let he=0;he<H.__webglFramebuffer[se].length;he++)n.deleteFramebuffer(H.__webglFramebuffer[se][he]);else n.deleteFramebuffer(H.__webglFramebuffer[se]);H.__webglDepthbuffer&&n.deleteRenderbuffer(H.__webglDepthbuffer[se])}else{if(Array.isArray(H.__webglFramebuffer))for(let se=0;se<H.__webglFramebuffer.length;se++)n.deleteFramebuffer(H.__webglFramebuffer[se]);else n.deleteFramebuffer(H.__webglFramebuffer);if(H.__webglDepthbuffer&&n.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&n.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let se=0;se<H.__webglColorRenderbuffer.length;se++)H.__webglColorRenderbuffer[se]&&n.deleteRenderbuffer(H.__webglColorRenderbuffer[se]);H.__webglDepthRenderbuffer&&n.deleteRenderbuffer(H.__webglDepthRenderbuffer)}if(I.isWebGLMultipleRenderTargets)for(let se=0,he=T.length;se<he;se++){const ke=i.get(T[se]);ke.__webglTexture&&(n.deleteTexture(ke.__webglTexture),o.memory.textures--),i.remove(T[se])}i.remove(T),i.remove(I)}(T)}function R(I){const T=i.get(I);n.deleteTexture(T.__webglTexture),delete _.get(I.source)[T.__cacheKey],o.memory.textures--}let V=0;function ee(I,T){const H=i.get(I);if(I.isVideoTexture&&function wt(I){const T=o.render.frame;p.get(I)!==T&&(p.set(I,T),I.update())}(I),!1===I.isRenderTargetTexture&&I.version>0&&H.__version!==I.version){const ue=I.image;if(null===ue)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ue.complete)return void We(H,I,T);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,H.__webglTexture,n.TEXTURE0+T)}const K={[Cr]:n.REPEAT,[wi]:n.CLAMP_TO_EDGE,1002:n.MIRRORED_REPEAT},ae={[Cn]:n.NEAREST,1004:n.NEAREST_MIPMAP_NEAREST,1005:n.NEAREST_MIPMAP_LINEAR,[an]:n.LINEAR,1007:n.LINEAR_MIPMAP_NEAREST,[Mo]:n.LINEAR_MIPMAP_LINEAR},ye={512:n.NEVER,519:n.ALWAYS,513:n.LESS,515:n.LEQUAL,514:n.EQUAL,518:n.GEQUAL,516:n.GREATER,517:n.NOTEQUAL};function Ce(I,T,H){if(H?(n.texParameteri(I,n.TEXTURE_WRAP_S,K[T.wrapS]),n.texParameteri(I,n.TEXTURE_WRAP_T,K[T.wrapT]),(I===n.TEXTURE_3D||I===n.TEXTURE_2D_ARRAY)&&n.texParameteri(I,n.TEXTURE_WRAP_R,K[T.wrapR]),n.texParameteri(I,n.TEXTURE_MAG_FILTER,ae[T.magFilter]),n.texParameteri(I,n.TEXTURE_MIN_FILTER,ae[T.minFilter])):(n.texParameteri(I,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(I,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(I===n.TEXTURE_3D||I===n.TEXTURE_2D_ARRAY)&&n.texParameteri(I,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(T.wrapS!==wi||T.wrapT!==wi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(I,n.TEXTURE_MAG_FILTER,C(T.magFilter)),n.texParameteri(I,n.TEXTURE_MIN_FILTER,C(T.minFilter)),T.minFilter!==Cn&&T.minFilter!==an&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),T.compareFunction&&(n.texParameteri(I,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(I,n.TEXTURE_COMPARE_FUNC,ye[T.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const ue=e.get("EXT_texture_filter_anisotropic");if(T.magFilter===Cn||1005!==T.minFilter&&T.minFilter!==Mo||T.type===qs&&!1===e.has("OES_texture_float_linear")||!1===a&&T.type===$f&&!1===e.has("OES_texture_half_float_linear"))return;(T.anisotropy>1||i.get(T).__currentAnisotropy)&&(n.texParameterf(I,ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(T.anisotropy,r.getMaxAnisotropy())),i.get(T).__currentAnisotropy=T.anisotropy)}}function Be(I,T){let H=!1;void 0===I.__webglInit&&(I.__webglInit=!0,T.addEventListener("dispose",L));const ue=T.source;let se=_.get(ue);void 0===se&&(se={},_.set(ue,se));const he=function q(I){const T=[];return T.push(I.wrapS),T.push(I.wrapT),T.push(I.wrapR||0),T.push(I.magFilter),T.push(I.minFilter),T.push(I.anisotropy),T.push(I.internalFormat),T.push(I.format),T.push(I.type),T.push(I.generateMipmaps),T.push(I.premultiplyAlpha),T.push(I.flipY),T.push(I.unpackAlignment),T.push(I.colorSpace),T.join()}(T);if(he!==I.__cacheKey){void 0===se[he]&&(se[he]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,H=!0),se[he].usedTimes++;const ke=se[I.__cacheKey];void 0!==ke&&(se[I.__cacheKey].usedTimes--,0===ke.usedTimes&&R(T)),I.__cacheKey=he,I.__webglTexture=se[he].texture}return H}function We(I,T,H){let ue=n.TEXTURE_2D;(T.isDataArrayTexture||T.isCompressedArrayTexture)&&(ue=n.TEXTURE_2D_ARRAY),T.isData3DTexture&&(ue=n.TEXTURE_3D);const se=Be(I,T),he=T.source;t.bindTexture(ue,I.__webglTexture,n.TEXTURE0+H);const ke=i.get(he);if(he.version!==ke.__version||!0===se){t.activeTexture(n.TEXTURE0+H);const pe=Lt.getPrimaries(Lt.workingColorSpace),Ee=""===T.colorSpace?null:Lt.getPrimaries(T.colorSpace),N=""===T.colorSpace||pe===Ee?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,T.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,T.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,T.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,N);const me=function x(I){return!a&&(I.wrapS!==wi||I.wrapT!==wi||I.minFilter!==Cn&&I.minFilter!==an)}(T)&&!1===w(T.image);let ne=y(T.image,me,!1,u);ne=nn(T,ne);const Qe=w(ne)||a,ze=s.convert(T.format,T.colorSpace);let Re,qe=s.convert(T.type),Le=M(T.internalFormat,ze,qe,T.colorSpace,T.isVideoTexture);Ce(ue,T,Qe);const gt=T.mipmaps,O=a&&!0!==T.isVideoTexture&&36196!==Le,be=void 0===ke.__version||!0===se,oe=b(T,ne,Qe);if(T.isDepthTexture)Le=n.DEPTH_COMPONENT,a?Le=T.type===qs?n.DEPTH_COMPONENT32F:T.type===xa?n.DEPTH_COMPONENT24:T.type===wc?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:T.type===qs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),T.format===xc&&Le===n.DEPTH_COMPONENT&&1012!==T.type&&T.type!==xa&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),T.type=xa,qe=s.convert(T.type)),T.format===$u&&Le===n.DEPTH_COMPONENT&&(Le=n.DEPTH_STENCIL,T.type!==wc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),T.type=wc,qe=s.convert(T.type))),be&&(O?t.texStorage2D(n.TEXTURE_2D,1,Le,ne.width,ne.height):t.texImage2D(n.TEXTURE_2D,0,Le,ne.width,ne.height,0,ze,qe,null));else if(T.isDataTexture)if(gt.length>0&&Qe){O&&be&&t.texStorage2D(n.TEXTURE_2D,oe,Le,gt[0].width,gt[0].height);for(let J=0,de=gt.length;J<de;J++)Re=gt[J],O?t.texSubImage2D(n.TEXTURE_2D,J,0,0,Re.width,Re.height,ze,qe,Re.data):t.texImage2D(n.TEXTURE_2D,J,Le,Re.width,Re.height,0,ze,qe,Re.data);T.generateMipmaps=!1}else O?(be&&t.texStorage2D(n.TEXTURE_2D,oe,Le,ne.width,ne.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ne.width,ne.height,ze,qe,ne.data)):t.texImage2D(n.TEXTURE_2D,0,Le,ne.width,ne.height,0,ze,qe,ne.data);else if(T.isCompressedTexture)if(T.isCompressedArrayTexture){O&&be&&t.texStorage3D(n.TEXTURE_2D_ARRAY,oe,Le,gt[0].width,gt[0].height,ne.depth);for(let J=0,de=gt.length;J<de;J++)Re=gt[J],T.format!==Tr?null!==ze?O?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,J,0,0,0,Re.width,Re.height,ne.depth,ze,Re.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,J,Le,Re.width,Re.height,ne.depth,0,Re.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):O?t.texSubImage3D(n.TEXTURE_2D_ARRAY,J,0,0,0,Re.width,Re.height,ne.depth,ze,qe,Re.data):t.texImage3D(n.TEXTURE_2D_ARRAY,J,Le,Re.width,Re.height,ne.depth,0,ze,qe,Re.data)}else{O&&be&&t.texStorage2D(n.TEXTURE_2D,oe,Le,gt[0].width,gt[0].height);for(let J=0,de=gt.length;J<de;J++)Re=gt[J],T.format!==Tr?null!==ze?O?t.compressedTexSubImage2D(n.TEXTURE_2D,J,0,0,Re.width,Re.height,ze,Re.data):t.compressedTexImage2D(n.TEXTURE_2D,J,Le,Re.width,Re.height,0,Re.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):O?t.texSubImage2D(n.TEXTURE_2D,J,0,0,Re.width,Re.height,ze,qe,Re.data):t.texImage2D(n.TEXTURE_2D,J,Le,Re.width,Re.height,0,ze,qe,Re.data)}else if(T.isDataArrayTexture)O?(be&&t.texStorage3D(n.TEXTURE_2D_ARRAY,oe,Le,ne.width,ne.height,ne.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ne.width,ne.height,ne.depth,ze,qe,ne.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Le,ne.width,ne.height,ne.depth,0,ze,qe,ne.data);else if(T.isData3DTexture)O?(be&&t.texStorage3D(n.TEXTURE_3D,oe,Le,ne.width,ne.height,ne.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ne.width,ne.height,ne.depth,ze,qe,ne.data)):t.texImage3D(n.TEXTURE_3D,0,Le,ne.width,ne.height,ne.depth,0,ze,qe,ne.data);else if(T.isFramebufferTexture){if(be)if(O)t.texStorage2D(n.TEXTURE_2D,oe,Le,ne.width,ne.height);else{let J=ne.width,de=ne.height;for(let je=0;je<oe;je++)t.texImage2D(n.TEXTURE_2D,je,Le,J,de,0,ze,qe,null),J>>=1,de>>=1}}else if(gt.length>0&&Qe){O&&be&&t.texStorage2D(n.TEXTURE_2D,oe,Le,gt[0].width,gt[0].height);for(let J=0,de=gt.length;J<de;J++)Re=gt[J],O?t.texSubImage2D(n.TEXTURE_2D,J,0,0,ze,qe,Re):t.texImage2D(n.TEXTURE_2D,J,Le,ze,qe,Re);T.generateMipmaps=!1}else O?(be&&t.texStorage2D(n.TEXTURE_2D,oe,Le,ne.width,ne.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ze,qe,ne)):t.texImage2D(n.TEXTURE_2D,0,Le,ze,qe,ne);E(T,Qe)&&S(ue),ke.__version=he.version,T.onUpdate&&T.onUpdate(T)}I.__version=T.version}function Fe(I,T,H,ue,se,he){const ke=s.convert(H.format,H.colorSpace),pe=s.convert(H.type),Ee=M(H.internalFormat,ke,pe,H.colorSpace);if(!i.get(T).__hasExternalTextures){const me=Math.max(1,T.width>>he),ne=Math.max(1,T.height>>he);se===n.TEXTURE_3D||se===n.TEXTURE_2D_ARRAY?t.texImage3D(se,he,Ee,me,ne,T.depth,0,ke,pe,null):t.texImage2D(se,he,Ee,me,ne,0,ke,pe,null)}t.bindFramebuffer(n.FRAMEBUFFER,I),Ye(T)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ue,se,i.get(H).__webglTexture,0,De(T)):(se===n.TEXTURE_2D||se>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&se<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ue,se,i.get(H).__webglTexture,he),t.bindFramebuffer(n.FRAMEBUFFER,null)}function P(I,T,H){if(n.bindRenderbuffer(n.RENDERBUFFER,I),T.depthBuffer&&!T.stencilBuffer){let ue=!0===a?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(H||Ye(T)){const se=T.depthTexture;se&&se.isDepthTexture&&(se.type===qs?ue=n.DEPTH_COMPONENT32F:se.type===xa&&(ue=n.DEPTH_COMPONENT24));const he=De(T);Ye(T)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,he,ue,T.width,T.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,he,ue,T.width,T.height)}else n.renderbufferStorage(n.RENDERBUFFER,ue,T.width,T.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,I)}else if(T.depthBuffer&&T.stencilBuffer){const ue=De(T);H&&!1===Ye(T)?n.renderbufferStorageMultisample(n.RENDERBUFFER,ue,n.DEPTH24_STENCIL8,T.width,T.height):Ye(T)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ue,n.DEPTH24_STENCIL8,T.width,T.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,T.width,T.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,I)}else{const ue=!0===T.isWebGLMultipleRenderTargets?T.texture:[T.texture];for(let se=0;se<ue.length;se++){const he=ue[se],ke=s.convert(he.format,he.colorSpace),pe=s.convert(he.type),Ee=M(he.internalFormat,ke,pe,he.colorSpace),N=De(T);H&&!1===Ye(T)?n.renderbufferStorageMultisample(n.RENDERBUFFER,N,Ee,T.width,T.height):Ye(T)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,N,Ee,T.width,T.height):n.renderbufferStorage(n.RENDERBUFFER,Ee,T.width,T.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Q(I){const T=i.get(I),H=!0===I.isWebGLCubeRenderTarget;if(I.depthTexture&&!T.__autoAllocateDepthBuffer){if(H)throw new Error("target.depthTexture not supported in Cube render targets");!function ge(I,T){if(T&&T.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,I),!T.depthTexture||!T.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(T.depthTexture).__webglTexture||T.depthTexture.image.width!==T.width||T.depthTexture.image.height!==T.height)&&(T.depthTexture.image.width=T.width,T.depthTexture.image.height=T.height,T.depthTexture.needsUpdate=!0),ee(T.depthTexture,0);const ue=i.get(T.depthTexture).__webglTexture,se=De(T);if(T.depthTexture.format===xc)Ye(T)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ue,0,se):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ue,0);else{if(T.depthTexture.format!==$u)throw new Error("Unknown depthTexture format");Ye(T)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ue,0,se):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ue,0)}}(T.__webglFramebuffer,I)}else if(H){T.__webglDepthbuffer=[];for(let ue=0;ue<6;ue++)t.bindFramebuffer(n.FRAMEBUFFER,T.__webglFramebuffer[ue]),T.__webglDepthbuffer[ue]=n.createRenderbuffer(),P(T.__webglDepthbuffer[ue],I,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,T.__webglFramebuffer),T.__webglDepthbuffer=n.createRenderbuffer(),P(T.__webglDepthbuffer,I,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function De(I){return Math.min(h,I.samples)}function Ye(I){const T=i.get(I);return a&&I.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==T.__useRenderToTexture}function nn(I,T){const H=I.colorSpace,ue=I.format,se=I.type;return!0===I.isCompressedTexture||!0===I.isVideoTexture||1035===I.format||H!==Qn&&""!==H&&(Lt.getTransfer(H)===tn?!1===a?!0===e.has("EXT_sRGB")&&ue===Tr?(I.format=1035,I.minFilter=an,I.generateMipmaps=!1):T=Ik.sRGBToLinear(T):(ue!==Tr||se!==wa)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",H)),T}this.allocateTextureUnit=function re(){const I=V;return I>=c&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+c),V+=1,I},this.resetTextureUnits=function z(){V=0},this.setTexture2D=ee,this.setTexture2DArray=function te(I,T){const H=i.get(I);I.version>0&&H.__version!==I.version?We(H,I,T):t.bindTexture(n.TEXTURE_2D_ARRAY,H.__webglTexture,n.TEXTURE0+T)},this.setTexture3D=function _e(I,T){const H=i.get(I);I.version>0&&H.__version!==I.version?We(H,I,T):t.bindTexture(n.TEXTURE_3D,H.__webglTexture,n.TEXTURE0+T)},this.setTextureCube=function G(I,T){const H=i.get(I);I.version>0&&H.__version!==I.version?function Se(I,T,H){if(6!==T.image.length)return;const ue=Be(I,T),se=T.source;t.bindTexture(n.TEXTURE_CUBE_MAP,I.__webglTexture,n.TEXTURE0+H);const he=i.get(se);if(se.version!==he.__version||!0===ue){t.activeTexture(n.TEXTURE0+H);const ke=Lt.getPrimaries(Lt.workingColorSpace),pe=""===T.colorSpace?null:Lt.getPrimaries(T.colorSpace),Ee=""===T.colorSpace||ke===pe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,T.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,T.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,T.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ee);const N=T.isCompressedTexture||T.image[0].isCompressedTexture,me=T.image[0]&&T.image[0].isDataTexture,ne=[];for(let J=0;J<6;J++)ne[J]=N||me?me?T.image[J].image:T.image[J]:y(T.image[J],!1,!0,l),ne[J]=nn(T,ne[J]);const Qe=ne[0],ze=w(Qe)||a,qe=s.convert(T.format,T.colorSpace),Le=s.convert(T.type),Re=M(T.internalFormat,qe,Le,T.colorSpace),gt=a&&!0!==T.isVideoTexture,O=void 0===he.__version||!0===ue;let oe,be=b(T,Qe,ze);if(Ce(n.TEXTURE_CUBE_MAP,T,ze),N){gt&&O&&t.texStorage2D(n.TEXTURE_CUBE_MAP,be,Re,Qe.width,Qe.height);for(let J=0;J<6;J++){oe=ne[J].mipmaps;for(let de=0;de<oe.length;de++){const je=oe[de];T.format!==Tr?null!==qe?gt?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,de,0,0,je.width,je.height,qe,je.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,de,Re,je.width,je.height,0,je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,de,0,0,je.width,je.height,qe,Le,je.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,de,Re,je.width,je.height,0,qe,Le,je.data)}}}else{oe=T.mipmaps,gt&&O&&(oe.length>0&&be++,t.texStorage2D(n.TEXTURE_CUBE_MAP,be,Re,ne[0].width,ne[0].height));for(let J=0;J<6;J++)if(me){gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,0,0,ne[J].width,ne[J].height,qe,Le,ne[J].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,Re,ne[J].width,ne[J].height,0,qe,Le,ne[J].data);for(let de=0;de<oe.length;de++){const _t=oe[de].image[J].image;gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,de+1,0,0,_t.width,_t.height,qe,Le,_t.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,de+1,Re,_t.width,_t.height,0,qe,Le,_t.data)}}else{gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,0,0,qe,Le,ne[J]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,Re,qe,Le,ne[J]);for(let de=0;de<oe.length;de++){const je=oe[de];gt?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,de+1,0,0,qe,Le,je.image[J]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+J,de+1,Re,qe,Le,je.image[J])}}}E(T,ze)&&S(n.TEXTURE_CUBE_MAP),he.__version=se.version,T.onUpdate&&T.onUpdate(T)}I.__version=T.version}(H,I,T):t.bindTexture(n.TEXTURE_CUBE_MAP,H.__webglTexture,n.TEXTURE0+T)},this.rebindTextures=function fe(I,T,H){const ue=i.get(I);void 0!==T&&Fe(ue.__webglFramebuffer,I,I.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==H&&Q(I)},this.setupRenderTarget=function ie(I){const T=I.texture,H=i.get(I),ue=i.get(T);I.addEventListener("dispose",F),!0!==I.isWebGLMultipleRenderTargets&&(void 0===ue.__webglTexture&&(ue.__webglTexture=n.createTexture()),ue.__version=T.version,o.memory.textures++);const se=!0===I.isWebGLCubeRenderTarget,he=!0===I.isWebGLMultipleRenderTargets,ke=w(I)||a;if(se){H.__webglFramebuffer=[];for(let pe=0;pe<6;pe++)if(a&&T.mipmaps&&T.mipmaps.length>0){H.__webglFramebuffer[pe]=[];for(let Ee=0;Ee<T.mipmaps.length;Ee++)H.__webglFramebuffer[pe][Ee]=n.createFramebuffer()}else H.__webglFramebuffer[pe]=n.createFramebuffer()}else{if(a&&T.mipmaps&&T.mipmaps.length>0){H.__webglFramebuffer=[];for(let pe=0;pe<T.mipmaps.length;pe++)H.__webglFramebuffer[pe]=n.createFramebuffer()}else H.__webglFramebuffer=n.createFramebuffer();if(he)if(r.drawBuffers){const pe=I.texture;for(let Ee=0,N=pe.length;Ee<N;Ee++){const me=i.get(pe[Ee]);void 0===me.__webglTexture&&(me.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&I.samples>0&&!1===Ye(I)){const pe=he?T:[T];H.__webglMultisampledFramebuffer=n.createFramebuffer(),H.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,H.__webglMultisampledFramebuffer);for(let Ee=0;Ee<pe.length;Ee++){const N=pe[Ee];H.__webglColorRenderbuffer[Ee]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,H.__webglColorRenderbuffer[Ee]);const me=s.convert(N.format,N.colorSpace),ne=s.convert(N.type),Qe=M(N.internalFormat,me,ne,N.colorSpace,!0===I.isXRRenderTarget),ze=De(I);n.renderbufferStorageMultisample(n.RENDERBUFFER,ze,Qe,I.width,I.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ee,n.RENDERBUFFER,H.__webglColorRenderbuffer[Ee])}n.bindRenderbuffer(n.RENDERBUFFER,null),I.depthBuffer&&(H.__webglDepthRenderbuffer=n.createRenderbuffer(),P(H.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(se){t.bindTexture(n.TEXTURE_CUBE_MAP,ue.__webglTexture),Ce(n.TEXTURE_CUBE_MAP,T,ke);for(let pe=0;pe<6;pe++)if(a&&T.mipmaps&&T.mipmaps.length>0)for(let Ee=0;Ee<T.mipmaps.length;Ee++)Fe(H.__webglFramebuffer[pe][Ee],I,T,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+pe,Ee);else Fe(H.__webglFramebuffer[pe],I,T,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0);E(T,ke)&&S(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(he){const pe=I.texture;for(let Ee=0,N=pe.length;Ee<N;Ee++){const me=pe[Ee],ne=i.get(me);t.bindTexture(n.TEXTURE_2D,ne.__webglTexture),Ce(n.TEXTURE_2D,me,ke),Fe(H.__webglFramebuffer,I,me,n.COLOR_ATTACHMENT0+Ee,n.TEXTURE_2D,0),E(me,ke)&&S(n.TEXTURE_2D)}t.unbindTexture()}else{let pe=n.TEXTURE_2D;if((I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(a?pe=I.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(pe,ue.__webglTexture),Ce(pe,T,ke),a&&T.mipmaps&&T.mipmaps.length>0)for(let Ee=0;Ee<T.mipmaps.length;Ee++)Fe(H.__webglFramebuffer[Ee],I,T,n.COLOR_ATTACHMENT0,pe,Ee);else Fe(H.__webglFramebuffer,I,T,n.COLOR_ATTACHMENT0,pe,0);E(T,ke)&&S(pe),t.unbindTexture()}I.depthBuffer&&Q(I)},this.updateRenderTargetMipmap=function Ve(I){const T=w(I)||a,H=!0===I.isWebGLMultipleRenderTargets?I.texture:[I.texture];for(let ue=0,se=H.length;ue<se;ue++){const he=H[ue];if(E(he,T)){const ke=I.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,pe=i.get(he).__webglTexture;t.bindTexture(ke,pe),S(ke),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Te(I){if(a&&I.samples>0&&!1===Ye(I)){const T=I.isWebGLMultipleRenderTargets?I.texture:[I.texture],H=I.width,ue=I.height;let se=n.COLOR_BUFFER_BIT;const he=[],ke=I.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,pe=i.get(I),Ee=!0===I.isWebGLMultipleRenderTargets;if(Ee)for(let N=0;N<T.length;N++)t.bindFramebuffer(n.FRAMEBUFFER,pe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+N,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,pe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+N,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,pe.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,pe.__webglFramebuffer);for(let N=0;N<T.length;N++){he.push(n.COLOR_ATTACHMENT0+N),I.depthBuffer&&he.push(ke);const me=void 0!==pe.__ignoreDepthValues&&pe.__ignoreDepthValues;if(!1===me&&(I.depthBuffer&&(se|=n.DEPTH_BUFFER_BIT),I.stencilBuffer&&(se|=n.STENCIL_BUFFER_BIT)),Ee&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,pe.__webglColorRenderbuffer[N]),!0===me&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[ke]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[ke])),Ee){const ne=i.get(T[N]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ne,0)}n.blitFramebuffer(0,0,H,ue,0,0,H,ue,se,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,he)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ee)for(let N=0;N<T.length;N++){t.bindFramebuffer(n.FRAMEBUFFER,pe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+N,n.RENDERBUFFER,pe.__webglColorRenderbuffer[N]);const me=i.get(T[N]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,pe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+N,n.TEXTURE_2D,me,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,pe.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=Q,this.setupFrameBufferTexture=Fe,this.useMultisampledRTT=Ye}function coe(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=""){let a;const c=Lt.getTransfer(o);if(s===wa)return n.UNSIGNED_BYTE;if(1017===s)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===s)return n.UNSIGNED_SHORT_5_5_5_1;if(1010===s)return n.BYTE;if(1011===s)return n.SHORT;if(1012===s)return n.UNSIGNED_SHORT;if(1013===s)return n.INT;if(s===xa)return n.UNSIGNED_INT;if(s===qs)return n.FLOAT;if(s===$f)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return n.ALPHA;if(s===Tr)return n.RGBA;if(1024===s)return n.LUMINANCE;if(1025===s)return n.LUMINANCE_ALPHA;if(s===xc)return n.DEPTH_COMPONENT;if(s===$u)return n.DEPTH_STENCIL;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1028===s)return n.RED;if(1029===s)return n.RED_INTEGER;if(1030===s)return n.RG;if(1031===s)return n.RG_INTEGER;if(1033===s)return n.RGBA_INTEGER;if(33776===s||33777===s||33778===s||33779===s)if(c===tn){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return c===tn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s||36494===s||36495===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return c===tn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===s)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===s)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===s||36284===s||36285===s||36286===s){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(36492===s)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===s)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===s)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===s)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===wc?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class loe extends ti{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Ss extends gn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const uoe={type:"move"};class hM{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Ss,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Ss,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new A,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new A),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Ss,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new A,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new A),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){o=!0;for(const m of e.hand.values()){const _=t.getJointPose(m,i),g=this._getHandJoint(l,m);null!==_&&(g.matrix.fromArray(_.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=_.radius),g.visible=null!==_}const d=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),f=.02,p=.005;l.inputState.pinching&&d>f+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=f-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(uoe)))}return null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==s),null!==l&&(l.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Ss;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class hoe extends Sc{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",c=1,l=null,u=null,h=null,d=null,f=null,p=null;const m=t.getContextAttributes();let _=null,g=null;const v=[],y=[],w=new Y;let x=null;const E=new ti;E.layers.enable(1),E.viewport=new Vt;const S=new ti;S.layers.enable(2),S.viewport=new Vt;const M=[E,S],b=new loe;b.layers.enable(1),b.layers.enable(2);let C=null,L=null;function F(G){const K=y.indexOf(G.inputSource);if(-1===K)return;const ae=v[K];void 0!==ae&&(ae.update(G.inputSource,G.frame,l||o),ae.dispatchEvent({type:G.type,data:G.inputSource}))}function B(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",B),r.removeEventListener("inputsourceschange",R);for(let G=0;G<v.length;G++){const K=y[G];null!==K&&(y[G]=null,v[G].disconnect(K))}C=null,L=null,e.setRenderTarget(_),f=null,d=null,h=null,r=null,g=null,_e.stop(),i.isPresenting=!1,e.setPixelRatio(x),e.setSize(w.width,w.height,!1),i.dispatchEvent({type:"sessionend"})}function R(G){for(let K=0;K<G.removed.length;K++){const ae=G.removed[K],ye=y.indexOf(ae);ye>=0&&(y[ye]=null,v[ye].disconnect(ae))}for(let K=0;K<G.added.length;K++){const ae=G.added[K];let ye=y.indexOf(ae);if(-1===ye){for(let Be=0;Be<v.length;Be++){if(Be>=y.length){y.push(ae),ye=Be;break}if(null===y[Be]){y[Be]=ae,ye=Be;break}}if(-1===ye)break}const Ce=v[ye];Ce&&Ce.connect(ae)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(G){let K=v[G];return void 0===K&&(K=new hM,v[G]=K),K.getTargetRaySpace()},this.getControllerGrip=function(G){let K=v[G];return void 0===K&&(K=new hM,v[G]=K),K.getGripSpace()},this.getHand=function(G){let K=v[G];return void 0===K&&(K=new hM,v[G]=K),K.getHandSpace()},this.setFramebufferScaleFactor=function(G){s=G,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(G){a=G,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(G){l=G},this.getBaseLayer=function(){return null!==d?d:f},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var G=Fn(function*(K){if(r=K,null!==r){if(_=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",B),r.addEventListener("inputsourceschange",R),!0!==m.xrCompatible&&(yield t.makeXRCompatible()),x=e.getPixelRatio(),e.getSize(w),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||m.antialias,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),g=new Tc(f.framebufferWidth,f.framebufferHeight,{format:Tr,type:wa,colorSpace:e.outputColorSpace,stencilBuffer:m.stencil});else{let ae=null,ye=null,Ce=null;m.depth&&(Ce=m.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ae=m.stencil?$u:xc,ye=m.stencil?wc:xa);const Be={colorFormat:t.RGBA8,depthFormat:Ce,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(Be),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),g=new Tc(d.textureWidth,d.textureHeight,{format:Tr,type:wa,depthTexture:new iU(d.textureWidth,d.textureHeight,ye,void 0,void 0,void 0,void 0,void 0,void 0,ae),stencilBuffer:m.stencil,colorSpace:e.outputColorSpace,samples:m.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=d.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(c),l=null,o=yield r.requestReferenceSpace(a),_e.setContext(r),_e.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(K){return G.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const k=new A,V=new A;function re(G,K){null===K?G.matrixWorld.copy(G.matrix):G.matrixWorld.multiplyMatrices(K.matrixWorld,G.matrix),G.matrixWorldInverse.copy(G.matrixWorld).invert()}this.updateCamera=function(G){if(null===r)return;b.near=S.near=E.near=G.near,b.far=S.far=E.far=G.far,(C!==b.near||L!==b.far)&&(r.updateRenderState({depthNear:b.near,depthFar:b.far}),C=b.near,L=b.far);const K=G.parent,ae=b.cameras;re(b,K);for(let ye=0;ye<ae.length;ye++)re(ae[ye],K);2===ae.length?function z(G,K,ae){k.setFromMatrixPosition(K.matrixWorld),V.setFromMatrixPosition(ae.matrixWorld);const ye=k.distanceTo(V),Ce=K.projectionMatrix.elements,Be=ae.projectionMatrix.elements,We=Ce[14]/(Ce[10]-1),Se=Ce[14]/(Ce[10]+1),Fe=(Ce[9]+1)/Ce[5],P=(Ce[9]-1)/Ce[5],ge=(Ce[8]-1)/Ce[0],Q=(Be[8]+1)/Be[0],fe=We*ge,ie=We*Q,Ve=ye/(-ge+Q),Te=Ve*-ge;K.matrixWorld.decompose(G.position,G.quaternion,G.scale),G.translateX(Te),G.translateZ(Ve),G.matrixWorld.compose(G.position,G.quaternion,G.scale),G.matrixWorldInverse.copy(G.matrixWorld).invert();const De=We+Ve,Ye=Se+Ve;G.projectionMatrix.makePerspective(fe-Te,ie+(ye-Te),Fe*Se/Ye*De,P*Se/Ye*De,De,Ye),G.projectionMatrixInverse.copy(G.projectionMatrix).invert()}(b,E,S):b.projectionMatrix.copy(E.projectionMatrix),function q(G,K,ae){null===ae?G.matrix.copy(K.matrixWorld):(G.matrix.copy(ae.matrixWorld),G.matrix.invert(),G.matrix.multiply(K.matrixWorld)),G.matrix.decompose(G.position,G.quaternion,G.scale),G.updateMatrixWorld(!0),G.projectionMatrix.copy(K.projectionMatrix),G.projectionMatrixInverse.copy(K.projectionMatrixInverse),G.isPerspectiveCamera&&(G.fov=2*Ku*Math.atan(1/G.projectionMatrix.elements[5]),G.zoom=1)}(G,b,K)},this.getCamera=function(){return b},this.getFoveation=function(){if(null!==d||null!==f)return c},this.setFoveation=function(G){c=G,null!==d&&(d.fixedFoveation=G),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=G)};let ee=null;const _e=new Yk;_e.setAnimationLoop(function te(G,K){if(u=K.getViewerPose(l||o),p=K,null!==u){const ae=u.views;null!==f&&(e.setRenderTargetFramebuffer(g,f.framebuffer),e.setRenderTarget(g));let ye=!1;ae.length!==b.cameras.length&&(b.cameras.length=0,ye=!0);for(let Ce=0;Ce<ae.length;Ce++){const Be=ae[Ce];let We=null;if(null!==f)We=f.getViewport(Be);else{const Fe=h.getViewSubImage(d,Be);We=Fe.viewport,0===Ce&&(e.setRenderTargetTextures(g,Fe.colorTexture,d.ignoreDepthValues?void 0:Fe.depthStencilTexture),e.setRenderTarget(g))}let Se=M[Ce];void 0===Se&&(Se=new ti,Se.layers.enable(Ce),Se.viewport=new Vt,M[Ce]=Se),Se.matrix.fromArray(Be.transform.matrix),Se.matrix.decompose(Se.position,Se.quaternion,Se.scale),Se.projectionMatrix.fromArray(Be.projectionMatrix),Se.projectionMatrixInverse.copy(Se.projectionMatrix).invert(),Se.viewport.set(We.x,We.y,We.width,We.height),0===Ce&&(b.matrix.copy(Se.matrix),b.matrix.decompose(b.position,b.quaternion,b.scale)),!0===ye&&b.cameras.push(Se)}}for(let ae=0;ae<v.length;ae++){const ye=y[ae],Ce=v[ae];null!==ye&&void 0!==Ce&&Ce.update(ye,K,l||o)}ee&&ee(G,K),K.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:K}),p=null}),this.setAnimationLoop=function(G){ee=G},this.dispose=function(){}}}function doe(n,e){function t(_,g){!0===_.matrixAutoUpdate&&_.updateMatrix(),g.value.copy(_.matrix)}function s(_,g){_.opacity.value=g.opacity,g.color&&_.diffuse.value.copy(g.color),g.emissive&&_.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(_.map.value=g.map,t(g.map,_.mapTransform)),g.alphaMap&&(_.alphaMap.value=g.alphaMap,t(g.alphaMap,_.alphaMapTransform)),g.bumpMap&&(_.bumpMap.value=g.bumpMap,t(g.bumpMap,_.bumpMapTransform),_.bumpScale.value=g.bumpScale,1===g.side&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,t(g.normalMap,_.normalMapTransform),_.normalScale.value.copy(g.normalScale),1===g.side&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,t(g.displacementMap,_.displacementMapTransform),_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,_.emissiveMapTransform)),g.specularMap&&(_.specularMap.value=g.specularMap,t(g.specularMap,_.specularMapTransform)),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);const v=e.get(g).envMap;if(v&&(_.envMap.value=v,_.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,_.reflectivity.value=g.reflectivity,_.ior.value=g.ior,_.refractionRatio.value=g.refractionRatio),g.lightMap){_.lightMap.value=g.lightMap;const y=!0===n._useLegacyLights?Math.PI:1;_.lightMapIntensity.value=g.lightMapIntensity*y,t(g.lightMap,_.lightMapTransform)}g.aoMap&&(_.aoMap.value=g.aoMap,_.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,_.aoMapTransform))}return{refreshFogUniforms:function i(_,g){g.color.getRGB(_.fogColor.value,Xk(n)),g.isFog?(_.fogNear.value=g.near,_.fogFar.value=g.far):g.isFogExp2&&(_.fogDensity.value=g.density)},refreshMaterialUniforms:function r(_,g,v,y,w){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(_,g):g.isMeshToonMaterial?(s(_,g),function h(_,g){g.gradientMap&&(_.gradientMap.value=g.gradientMap)}(_,g)):g.isMeshPhongMaterial?(s(_,g),function u(_,g){_.specular.value.copy(g.specular),_.shininess.value=Math.max(g.shininess,1e-4)}(_,g)):g.isMeshStandardMaterial?(s(_,g),function d(_,g){_.metalness.value=g.metalness,g.metalnessMap&&(_.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,_.metalnessMapTransform)),_.roughness.value=g.roughness,g.roughnessMap&&(_.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,_.roughnessMapTransform)),e.get(g).envMap&&(_.envMapIntensity.value=g.envMapIntensity)}(_,g),g.isMeshPhysicalMaterial&&function f(_,g,v){_.ior.value=g.ior,g.sheen>0&&(_.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),_.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(_.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,_.sheenColorMapTransform)),g.sheenRoughnessMap&&(_.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,_.sheenRoughnessMapTransform))),g.clearcoat>0&&(_.clearcoat.value=g.clearcoat,_.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(_.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,_.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,_.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(_.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,_.clearcoatNormalMapTransform),_.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),1===g.side&&_.clearcoatNormalScale.value.negate())),g.iridescence>0&&(_.iridescence.value=g.iridescence,_.iridescenceIOR.value=g.iridescenceIOR,_.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(_.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,_.iridescenceMapTransform)),g.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,_.iridescenceThicknessMapTransform))),g.transmission>0&&(_.transmission.value=g.transmission,_.transmissionSamplerMap.value=v.texture,_.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(_.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,_.transmissionMapTransform)),_.thickness.value=g.thickness,g.thicknessMap&&(_.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,_.thicknessMapTransform)),_.attenuationDistance.value=g.attenuationDistance,_.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(_.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(_.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,_.anisotropyMapTransform))),_.specularIntensity.value=g.specularIntensity,_.specularColor.value.copy(g.specularColor),g.specularColorMap&&(_.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,_.specularColorMapTransform)),g.specularIntensityMap&&(_.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,_.specularIntensityMapTransform))}(_,g,w)):g.isMeshMatcapMaterial?(s(_,g),function p(_,g){g.matcap&&(_.matcap.value=g.matcap)}(_,g)):g.isMeshDepthMaterial?s(_,g):g.isMeshDistanceMaterial?(s(_,g),function m(_,g){const v=e.get(g).light;_.referencePosition.value.setFromMatrixPosition(v.matrixWorld),_.nearDistance.value=v.shadow.camera.near,_.farDistance.value=v.shadow.camera.far}(_,g)):g.isMeshNormalMaterial?s(_,g):g.isLineBasicMaterial?(function o(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,g.map&&(_.map.value=g.map,t(g.map,_.mapTransform))}(_,g),g.isLineDashedMaterial&&function a(_,g){_.dashSize.value=g.dashSize,_.totalSize.value=g.dashSize+g.gapSize,_.scale.value=g.scale}(_,g)):g.isPointsMaterial?function c(_,g,v,y){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.size.value=g.size*v,_.scale.value=.5*y,g.map&&(_.map.value=g.map,t(g.map,_.uvTransform)),g.alphaMap&&(_.alphaMap.value=g.alphaMap,t(g.alphaMap,_.alphaMapTransform)),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest)}(_,g,v,y):g.isSpriteMaterial?function l(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.rotation.value=g.rotation,g.map&&(_.map.value=g.map,t(g.map,_.mapTransform)),g.alphaMap&&(_.alphaMap.value=g.alphaMap,t(g.alphaMap,_.alphaMapTransform)),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest)}(_,g):g.isShadowMaterial?(_.color.value.copy(g.color),_.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function foe(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function f(v,y,w){const x=v.value;if(void 0===w[y]){if("number"==typeof x)w[y]=x;else{const E=Array.isArray(x)?x:[x],S=[];for(let M=0;M<E.length;M++)S.push(E[M].clone());w[y]=S}return!0}if("number"==typeof x){if(w[y]!==x)return w[y]=x,!0}else{const E=Array.isArray(w[y])?w[y]:[w[y]],S=Array.isArray(x)?x:[x];for(let M=0;M<E.length;M++){const b=E[M];if(!1===b.equals(S[M]))return b.copy(S[M]),!0}}return!1}function m(v){const y={boundary:0,storage:0};return"number"==typeof v?(y.boundary=4,y.storage=4):v.isVector2?(y.boundary=8,y.storage=8):v.isVector3||v.isColor?(y.boundary=16,y.storage=12):v.isVector4?(y.boundary=16,y.storage=16):v.isMatrix3?(y.boundary=48,y.storage=48):v.isMatrix4?(y.boundary=64,y.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),y}function _(v){const y=v.target;y.removeEventListener("dispose",_);const w=o.indexOf(y.__bindingPointIndex);o.splice(w,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}return{bind:function c(v,y){i.uniformBlockBinding(v,y.program)},update:function l(v,y){let w=r[v.id];void 0===w&&(function p(v){const y=v.uniforms;let w=0;let E=0;for(let S=0,M=y.length;S<M;S++){const b=y[S],C={boundary:0,storage:0},L=Array.isArray(b.value)?b.value:[b.value];for(let F=0,B=L.length;F<B;F++){const k=m(L[F]);C.boundary+=k.boundary,C.storage+=k.storage}b.__data=new Float32Array(C.storage/Float32Array.BYTES_PER_ELEMENT),b.__offset=w,S>0&&(E=w%16,0!==E&&16-E-C.boundary<0&&(w+=16-E,b.__offset=w)),w+=C.storage}E=w%16,E>0&&(w+=16-E),v.__size=w,v.__cache={}}(v),w=function u(v){const y=function h(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=y;const w=n.createBuffer(),x=v.__size,E=v.usage;return n.bindBuffer(n.UNIFORM_BUFFER,w),n.bufferData(n.UNIFORM_BUFFER,x,E),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,y,w),w}(v),r[v.id]=w,v.addEventListener("dispose",_)),i.updateUBOMapping(v,y.program);const E=e.render.frame;s[v.id]!==E&&(function d(v){const w=v.uniforms,x=v.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[v.id]);for(let E=0,S=w.length;E<S;E++){const M=w[E];if(!0===f(M,E,x)){const b=M.__offset,C=Array.isArray(M.value)?M.value:[M.value];let L=0;for(let F=0;F<C.length;F++){const B=C[F],R=m(B);"number"==typeof B?(M.__data[0]=B,n.bufferSubData(n.UNIFORM_BUFFER,b+L,M.__data)):B.isMatrix3?(M.__data[0]=B.elements[0],M.__data[1]=B.elements[1],M.__data[2]=B.elements[2],M.__data[3]=B.elements[0],M.__data[4]=B.elements[3],M.__data[5]=B.elements[4],M.__data[6]=B.elements[5],M.__data[7]=B.elements[0],M.__data[8]=B.elements[6],M.__data[9]=B.elements[7],M.__data[10]=B.elements[8],M.__data[11]=B.elements[0]):(B.toArray(M.__data,L),L+=R.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,b,M.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(v),s[v.id]=E)},dispose:function g(){for(const v in r)n.deleteBuffer(r[v]);o=[],r={},s={}}}}class CU{constructor(e={}){const{canvas:t=jte(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=e;let d;this.isWebGLRenderer=!0,d=null!==i?i.getContextAttributes().alpha:o;const f=new Uint32Array(4),p=new Int32Array(4);let m=null,_=null;const g=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Wt,this._useLegacyLights=!1,this.toneMapping=So,this.toneMappingExposure=1;const y=this;let w=!1,x=0,E=0,S=null,M=-1,b=null;const C=new Vt,L=new Vt;let F=null;const B=new Z(0);let R=0,k=t.width,V=t.height,z=1,re=null,q=null;const ee=new Vt(0,0,k,V),te=new Vt(0,0,k,V);let _e=!1;const G=new xv;let K=!1,ae=!1,ye=null;const Ce=new Ge,Be=new Y,We=new A,Se={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Fe(){return null===S?z:1}let Q,fe,ie,Ve,Te,De,Ye,wt,nn,I,T,H,ue,se,he,ke,pe,Ee,N,me,ne,Qe,ze,qe,P=i;function ge(D,U){for(let j=0;j<D.length;j++){const W=t.getContext(D[j],U);if(null!==W)return W}return null}try{const D={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r159"),t.addEventListener("webglcontextlost",gt,!1),t.addEventListener("webglcontextrestored",O,!1),t.addEventListener("webglcontextcreationerror",be,!1),null===P){const U=["webgl2","webgl","experimental-webgl"];if(!0===y.isWebGL1Renderer&&U.shift(),P=ge(U,D),null===P)throw ge(U)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&P instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===P.getShaderPrecisionFormat&&(P.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(D){throw console.error("THREE.WebGLRenderer: "+D.message),D}function Le(){Q=new Cre(P),fe=new wre(P,Q,e),Q.init(fe),Qe=new coe(P,Q,fe),ie=new ooe(P,Q,fe),Ve=new Dre(P),Te=new Xse,De=new aoe(P,Q,ie,Te,fe,Qe,Ve),Ye=new bre(y),wt=new Mre(y),nn=new _ne(P,fe),ze=new vre(P,Q,nn,fe),I=new Tre(P,nn,Ve,ze),T=new Nre(P,I,nn,Ve),N=new Pre(P,fe,De),ke=new xre(Te),H=new qse(y,Ye,wt,Q,fe,ze,ke),ue=new doe(y,Te),se=new Zse,he=new noe(Q,fe),Ee=new _re(y,Ye,wt,ie,T,d,c),pe=new soe(y,T,fe),qe=new foe(P,Ve,fe,ie),me=new yre(P,Q,Ve,fe),ne=new Are(P,Q,Ve,fe),Ve.programs=H.programs,y.capabilities=fe,y.extensions=Q,y.properties=Te,y.renderLists=se,y.shadowMap=pe,y.state=ie,y.info=Ve}Le();const Re=new hoe(y,P);function gt(D){D.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),w=!0}function O(){console.log("THREE.WebGLRenderer: Context Restored."),w=!1;const D=Ve.autoReset,U=pe.enabled,j=pe.autoUpdate,$=pe.needsUpdate,W=pe.type;Le(),Ve.autoReset=D,pe.enabled=U,pe.autoUpdate=j,pe.needsUpdate=$,pe.type=W}function be(D){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function oe(D){const U=D.target;U.removeEventListener("dispose",oe),function J(D){(function de(D){const U=Te.get(D).programs;void 0!==U&&(U.forEach(function(j){H.releaseProgram(j)}),D.isShaderMaterial&&H.releaseShaderCache(D))})(D),Te.remove(D)}(U)}function je(D,U,j){!0===D.transparent&&2===D.side&&!1===D.forceSinglePass?(D.side=1,D.needsUpdate=!0,T0(D,U,j),D.side=0,D.needsUpdate=!0,T0(D,U,j),D.side=2):T0(D,U,j)}this.xr=Re,this.getContext=function(){return P},this.getContextAttributes=function(){return P.getContextAttributes()},this.forceContextLoss=function(){const D=Q.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){const D=Q.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(D){void 0!==D&&(z=D,this.setSize(k,V,!1))},this.getSize=function(D){return D.set(k,V)},this.setSize=function(D,U,j=!0){Re.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(k=D,V=U,t.width=Math.floor(D*z),t.height=Math.floor(U*z),!0===j&&(t.style.width=D+"px",t.style.height=U+"px"),this.setViewport(0,0,D,U))},this.getDrawingBufferSize=function(D){return D.set(k*z,V*z).floor()},this.setDrawingBufferSize=function(D,U,j){k=D,V=U,z=j,t.width=Math.floor(D*j),t.height=Math.floor(U*j),this.setViewport(0,0,D,U)},this.getCurrentViewport=function(D){return D.copy(C)},this.getViewport=function(D){return D.copy(ee)},this.setViewport=function(D,U,j,$){D.isVector4?ee.set(D.x,D.y,D.z,D.w):ee.set(D,U,j,$),ie.viewport(C.copy(ee).multiplyScalar(z).floor())},this.getScissor=function(D){return D.copy(te)},this.setScissor=function(D,U,j,$){D.isVector4?te.set(D.x,D.y,D.z,D.w):te.set(D,U,j,$),ie.scissor(L.copy(te).multiplyScalar(z).floor())},this.getScissorTest=function(){return _e},this.setScissorTest=function(D){ie.setScissorTest(_e=D)},this.setOpaqueSort=function(D){re=D},this.setTransparentSort=function(D){q=D},this.getClearColor=function(D){return D.copy(Ee.getClearColor())},this.setClearColor=function(){Ee.setClearColor.apply(Ee,arguments)},this.getClearAlpha=function(){return Ee.getClearAlpha()},this.setClearAlpha=function(){Ee.setClearAlpha.apply(Ee,arguments)},this.clear=function(D=!0,U=!0,j=!0){let $=0;if(D){let W=!1;if(null!==S){const Ie=S.texture.format;W=1033===Ie||1031===Ie||1029===Ie}if(W){const Ie=S.texture.type,He=Ie===wa||Ie===xa||1012===Ie||Ie===wc||1017===Ie||1018===Ie,et=Ee.getClearColor(),rt=Ee.getClearAlpha(),mt=et.r,at=et.g,ht=et.b;He?(f[0]=mt,f[1]=at,f[2]=ht,f[3]=rt,P.clearBufferuiv(P.COLOR,0,f)):(p[0]=mt,p[1]=at,p[2]=ht,p[3]=rt,P.clearBufferiv(P.COLOR,0,p))}else $|=P.COLOR_BUFFER_BIT}U&&($|=P.DEPTH_BUFFER_BIT),j&&($|=P.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),P.clear($)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",gt,!1),t.removeEventListener("webglcontextrestored",O,!1),t.removeEventListener("webglcontextcreationerror",be,!1),se.dispose(),he.dispose(),Te.dispose(),Ye.dispose(),wt.dispose(),T.dispose(),ze.dispose(),qe.dispose(),H.dispose(),Re.dispose(),Re.removeEventListener("sessionstart",Xi),Re.removeEventListener("sessionend",Qt),ye&&(ye.dispose(),ye=null),Yi.stop()},this.renderBufferDirect=function(D,U,j,$,W,Ie){null===U&&(U=Se);const He=W.isMesh&&W.matrixWorld.determinant()<0,et=function _me(D,U,j,$,W){!0!==U.isScene&&(U=Se),De.resetTextureUnits();const Ie=U.fog,et=null===S?y.outputColorSpace:!0===S.isXRRenderTarget?S.texture.colorSpace:Qn,rt=($.isMeshStandardMaterial?wt:Ye).get($.envMap||($.isMeshStandardMaterial?U.environment:null)),mt=!0===$.vertexColors&&!!j.attributes.color&&4===j.attributes.color.itemSize,at=!!j.attributes.tangent&&(!!$.normalMap||$.anisotropy>0),ht=!!j.morphAttributes.position,In=!!j.morphAttributes.normal,Gr=!!j.morphAttributes.color;let ai=So;$.toneMapped&&(null===S||!0===S.isXRRenderTarget)&&(ai=y.toneMapping);const qo=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,hn=void 0!==qo?qo.length:0,vt=Te.get($),MA=_.state.lights;!0!==K||!0!==ae&&D===b||ke.setState($,D,D===b&&$.id===M);let xn=!1;$.version===vt.__version?(vt.needsLights&&vt.lightsStateVersion!==MA.state.version||vt.outputColorSpace!==et||W.isBatchedMesh&&!1===vt.batching||!W.isBatchedMesh&&!0===vt.batching||W.isInstancedMesh&&!1===vt.instancing||!W.isInstancedMesh&&!0===vt.instancing||W.isSkinnedMesh&&!1===vt.skinning||!W.isSkinnedMesh&&!0===vt.skinning||W.isInstancedMesh&&!0===vt.instancingColor&&null===W.instanceColor||W.isInstancedMesh&&!1===vt.instancingColor&&null!==W.instanceColor||vt.envMap!==rt||!0===$.fog&&vt.fog!==Ie||void 0!==vt.numClippingPlanes&&(vt.numClippingPlanes!==ke.numPlanes||vt.numIntersection!==ke.numIntersection)||vt.vertexAlphas!==mt||vt.vertexTangents!==at||vt.morphTargets!==ht||vt.morphNormals!==In||vt.morphColors!==Gr||vt.toneMapping!==ai||!0===fe.isWebGL2&&vt.morphTargetsCount!==hn)&&(xn=!0):(xn=!0,vt.__version=$.version);let Sl=vt.currentProgram;!0===xn&&(Sl=T0($,U,W));let rG=!1,cm=!1,CA=!1;const Ri=Sl.getUniforms(),Ml=vt.uniforms;if(ie.useProgram(Sl.program)&&(rG=!0,cm=!0,CA=!0),$.id!==M&&(M=$.id,cm=!0),rG||b!==D){Ri.setValue(P,"projectionMatrix",D.projectionMatrix),Ri.setValue(P,"viewMatrix",D.matrixWorldInverse);const ls=Ri.map.cameraPosition;void 0!==ls&&ls.setValue(P,We.setFromMatrixPosition(D.matrixWorld)),fe.logarithmicDepthBuffer&&Ri.setValue(P,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),($.isMeshPhongMaterial||$.isMeshToonMaterial||$.isMeshLambertMaterial||$.isMeshBasicMaterial||$.isMeshStandardMaterial||$.isShaderMaterial)&&Ri.setValue(P,"isOrthographic",!0===D.isOrthographicCamera),b!==D&&(b=D,cm=!0,CA=!0)}if(W.isSkinnedMesh){Ri.setOptional(P,W,"bindMatrix"),Ri.setOptional(P,W,"bindMatrixInverse");const ls=W.skeleton;ls&&(fe.floatVertexTextures?(null===ls.boneTexture&&ls.computeBoneTexture(),Ri.setValue(P,"boneTexture",ls.boneTexture,De)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}W.isBatchedMesh&&(Ri.setOptional(P,W,"batchingTexture"),Ri.setValue(P,"batchingTexture",W._matricesTexture,De));const TA=j.morphAttributes;if((void 0!==TA.position||void 0!==TA.normal||void 0!==TA.color&&!0===fe.isWebGL2)&&N.update(W,j,Sl),(cm||vt.receiveShadow!==W.receiveShadow)&&(vt.receiveShadow=W.receiveShadow,Ri.setValue(P,"receiveShadow",W.receiveShadow)),$.isMeshGouraudMaterial&&null!==$.envMap&&(Ml.envMap.value=rt,Ml.flipEnvMap.value=rt.isCubeTexture&&!1===rt.isRenderTargetTexture?-1:1),cm&&(Ri.setValue(P,"toneMappingExposure",y.toneMappingExposure),vt.needsLights&&function vme(D,U){D.ambientLightColor.needsUpdate=U,D.lightProbe.needsUpdate=U,D.directionalLights.needsUpdate=U,D.directionalLightShadows.needsUpdate=U,D.pointLights.needsUpdate=U,D.pointLightShadows.needsUpdate=U,D.spotLights.needsUpdate=U,D.spotLightShadows.needsUpdate=U,D.rectAreaLights.needsUpdate=U,D.hemisphereLights.needsUpdate=U}(Ml,CA),Ie&&!0===$.fog&&ue.refreshFogUniforms(Ml,Ie),ue.refreshMaterialUniforms(Ml,$,z,V,ye),Cv.upload(P,nG(vt),Ml,De)),$.isShaderMaterial&&!0===$.uniformsNeedUpdate&&(Cv.upload(P,nG(vt),Ml,De),$.uniformsNeedUpdate=!1),$.isSpriteMaterial&&Ri.setValue(P,"center",W.center),Ri.setValue(P,"modelViewMatrix",W.modelViewMatrix),Ri.setValue(P,"normalMatrix",W.normalMatrix),Ri.setValue(P,"modelMatrix",W.matrixWorld),$.isShaderMaterial||$.isRawShaderMaterial){const ls=$.uniformsGroups;for(let AA=0,wme=ls.length;AA<wme;AA++)if(fe.isWebGL2){const sG=ls[AA];qe.update(sG,Sl),qe.bind(sG,Sl)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Sl}(D,U,j,$,W);ie.setMaterial($,He);let rt=j.index,mt=1;if(!0===$.wireframe){if(rt=I.getWireframeAttribute(j),void 0===rt)return;mt=2}const at=j.drawRange,ht=j.attributes.position;let In=at.start*mt,Gr=(at.start+at.count)*mt;null!==Ie&&(In=Math.max(In,Ie.start*mt),Gr=Math.min(Gr,(Ie.start+Ie.count)*mt)),null!==rt?(In=Math.max(In,0),Gr=Math.min(Gr,rt.count)):null!=ht&&(In=Math.max(In,0),Gr=Math.min(Gr,ht.count));const ai=Gr-In;if(ai<0||ai===1/0)return;ze.setup(W,$,et,j,rt);let qo,hn=me;if(null!==rt&&(qo=nn.get(rt),hn=ne,hn.setIndex(qo)),W.isMesh)!0===$.wireframe?(ie.setLineWidth($.wireframeLinewidth*Fe()),hn.setMode(P.LINES)):hn.setMode(P.TRIANGLES);else if(W.isLine){let vt=$.linewidth;void 0===vt&&(vt=1),ie.setLineWidth(vt*Fe()),hn.setMode(W.isLineSegments?P.LINES:W.isLineLoop?P.LINE_LOOP:P.LINE_STRIP)}else W.isPoints?hn.setMode(P.POINTS):W.isSprite&&hn.setMode(P.TRIANGLES);if(W.isBatchedMesh)hn.renderMultiDraw(W._multiDrawStarts,W._multiDrawCounts,W._multiDrawCount);else if(W.isInstancedMesh)hn.renderInstances(In,ai,W.count);else if(j.isInstancedBufferGeometry){const MA=Math.min(j.instanceCount,void 0!==j._maxInstanceCount?j._maxInstanceCount:1/0);hn.renderInstances(In,ai,MA)}else hn.render(In,ai)},this.compile=function(D,U,j=null){null===j&&(j=D),_=he.get(j),_.init(),v.push(_),j.traverseVisible(function(W){W.isLight&&W.layers.test(U.layers)&&(_.pushLight(W),W.castShadow&&_.pushShadow(W))}),D!==j&&D.traverseVisible(function(W){W.isLight&&W.layers.test(U.layers)&&(_.pushLight(W),W.castShadow&&_.pushShadow(W))}),_.setupLights(y._useLegacyLights);const $=new Set;return D.traverse(function(W){const Ie=W.material;if(Ie)if(Array.isArray(Ie))for(let He=0;He<Ie.length;He++){const et=Ie[He];je(et,j,W),$.add(et)}else je(Ie,j,W),$.add(Ie)}),v.pop(),_=null,$},this.compileAsync=function(D,U,j=null){const $=this.compile(D,U,j);return new Promise(W=>{function Ie(){$.forEach(function(He){Te.get(He).currentProgram.isReady()&&$.delete(He)}),0!==$.size?setTimeout(Ie,10):W(D)}null!==Q.get("KHR_parallel_shader_compile")?Ie():setTimeout(Ie,10)})};let _t=null;function Xi(){Yi.stop()}function Qt(){Yi.start()}const Yi=new Yk;function so(D,U,j,$){if(!1===D.visible)return;if(D.layers.test(U.layers))if(D.isGroup)j=D.renderOrder;else if(D.isLOD)!0===D.autoUpdate&&D.update(U);else if(D.isLight)_.pushLight(D),D.castShadow&&_.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||G.intersectsSprite(D)){$&&We.setFromMatrixPosition(D.matrixWorld).applyMatrix4(Ce);const He=T.update(D),et=D.material;et.visible&&m.push(D,He,et,j,We.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(!D.frustumCulled||G.intersectsObject(D))){const He=T.update(D),et=D.material;if($&&(void 0!==D.boundingSphere?(null===D.boundingSphere&&D.computeBoundingSphere(),We.copy(D.boundingSphere.center)):(null===He.boundingSphere&&He.computeBoundingSphere(),We.copy(He.boundingSphere.center)),We.applyMatrix4(D.matrixWorld).applyMatrix4(Ce)),Array.isArray(et)){const rt=He.groups;for(let mt=0,at=rt.length;mt<at;mt++){const ht=rt[mt],In=et[ht.materialIndex];In&&In.visible&&m.push(D,He,In,j,We.z,ht)}}else et.visible&&m.push(D,He,et,j,We.z,null)}const Ie=D.children;for(let He=0,et=Ie.length;He<et;He++)so(Ie[He],U,j,$)}function eG(D,U,j,$){const W=D.opaque,Ie=D.transmissive,He=D.transparent;_.setupLightsView(j),!0===K&&ke.setGlobalState(y.clippingPlanes,j),Ie.length>0&&function gme(D,U,j,$){if(null!==(!0===j.isScene?j.overrideMaterial:null))return;const Ie=fe.isWebGL2;null===ye&&(ye=new Tc(1,1,{generateMipmaps:!0,type:Q.has("EXT_color_buffer_half_float")?$f:wa,minFilter:Mo,samples:Ie?4:0})),y.getDrawingBufferSize(Be),Ie?ye.setSize(Be.x,Be.y):ye.setSize(Q_(Be.x),Q_(Be.y));const He=y.getRenderTarget();y.setRenderTarget(ye),y.getClearColor(B),R=y.getClearAlpha(),R<1&&y.setClearColor(16777215,.5),y.clear();const et=y.toneMapping;y.toneMapping=So,C0(D,j,$),De.updateMultisampleRenderTarget(ye),De.updateRenderTargetMipmap(ye);let rt=!1;for(let mt=0,at=U.length;mt<at;mt++){const ht=U[mt],In=ht.object,Gr=ht.geometry,ai=ht.material,qo=ht.group;if(2===ai.side&&In.layers.test($.layers)){const hn=ai.side;ai.side=1,ai.needsUpdate=!0,tG(In,j,$,Gr,ai,qo),ai.side=hn,ai.needsUpdate=!0,rt=!0}}!0===rt&&(De.updateMultisampleRenderTarget(ye),De.updateRenderTargetMipmap(ye)),y.setRenderTarget(He),y.setClearColor(B,R),y.toneMapping=et}(W,Ie,U,j),$&&ie.viewport(C.copy($)),W.length>0&&C0(W,U,j),Ie.length>0&&C0(Ie,U,j),He.length>0&&C0(He,U,j),ie.buffers.depth.setTest(!0),ie.buffers.depth.setMask(!0),ie.buffers.color.setMask(!0),ie.setPolygonOffset(!1)}function C0(D,U,j){const $=!0===U.isScene?U.overrideMaterial:null;for(let W=0,Ie=D.length;W<Ie;W++){const He=D[W],et=He.object,rt=He.geometry,mt=null===$?He.material:$,at=He.group;et.layers.test(j.layers)&&tG(et,U,j,rt,mt,at)}}function tG(D,U,j,$,W,Ie){D.onBeforeRender(y,U,j,$,W,Ie),D.modelViewMatrix.multiplyMatrices(j.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),W.onBeforeRender(y,U,j,$,D,Ie),!0===W.transparent&&2===W.side&&!1===W.forceSinglePass?(W.side=1,W.needsUpdate=!0,y.renderBufferDirect(j,U,$,W,D,Ie),W.side=0,W.needsUpdate=!0,y.renderBufferDirect(j,U,$,W,D,Ie),W.side=2):y.renderBufferDirect(j,U,$,W,D,Ie),D.onAfterRender(y,U,j,$,W,Ie)}function T0(D,U,j){!0!==U.isScene&&(U=Se);const $=Te.get(D),W=_.state.lights,He=W.state.version,et=H.getParameters(D,W.state,_.state.shadowsArray,U,j),rt=H.getProgramCacheKey(et);let mt=$.programs;$.environment=D.isMeshStandardMaterial?U.environment:null,$.fog=U.fog,$.envMap=(D.isMeshStandardMaterial?wt:Ye).get(D.envMap||$.environment),void 0===mt&&(D.addEventListener("dispose",oe),mt=new Map,$.programs=mt);let at=mt.get(rt);if(void 0!==at){if($.currentProgram===at&&$.lightsStateVersion===He)return iG(D,et),at}else et.uniforms=H.getUniforms(D),D.onBuild(j,et,y),D.onBeforeCompile(et,y),at=H.acquireProgram(et,rt),mt.set(rt,at),$.uniforms=et.uniforms;const ht=$.uniforms;return(!D.isShaderMaterial&&!D.isRawShaderMaterial||!0===D.clipping)&&(ht.clippingPlanes=ke.uniform),iG(D,et),$.needsLights=function yme(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&!0===D.lights}(D),$.lightsStateVersion=He,$.needsLights&&(ht.ambientLightColor.value=W.state.ambient,ht.lightProbe.value=W.state.probe,ht.directionalLights.value=W.state.directional,ht.directionalLightShadows.value=W.state.directionalShadow,ht.spotLights.value=W.state.spot,ht.spotLightShadows.value=W.state.spotShadow,ht.rectAreaLights.value=W.state.rectArea,ht.ltc_1.value=W.state.rectAreaLTC1,ht.ltc_2.value=W.state.rectAreaLTC2,ht.pointLights.value=W.state.point,ht.pointLightShadows.value=W.state.pointShadow,ht.hemisphereLights.value=W.state.hemi,ht.directionalShadowMap.value=W.state.directionalShadowMap,ht.directionalShadowMatrix.value=W.state.directionalShadowMatrix,ht.spotShadowMap.value=W.state.spotShadowMap,ht.spotLightMatrix.value=W.state.spotLightMatrix,ht.spotLightMap.value=W.state.spotLightMap,ht.pointShadowMap.value=W.state.pointShadowMap,ht.pointShadowMatrix.value=W.state.pointShadowMatrix),$.currentProgram=at,$.uniformsList=null,at}function nG(D){if(null===D.uniformsList){const U=D.currentProgram.getUniforms();D.uniformsList=Cv.seqWithValue(U.seq,D.uniforms)}return D.uniformsList}function iG(D,U){const j=Te.get(D);j.outputColorSpace=U.outputColorSpace,j.batching=U.batching,j.instancing=U.instancing,j.instancingColor=U.instancingColor,j.skinning=U.skinning,j.morphTargets=U.morphTargets,j.morphNormals=U.morphNormals,j.morphColors=U.morphColors,j.morphTargetsCount=U.morphTargetsCount,j.numClippingPlanes=U.numClippingPlanes,j.numIntersection=U.numClipIntersection,j.vertexAlphas=U.vertexAlphas,j.vertexTangents=U.vertexTangents,j.toneMapping=U.toneMapping}Yi.setAnimationLoop(function oi(D){_t&&_t(D)}),typeof self<"u"&&Yi.setContext(self),this.setAnimationLoop=function(D){_t=D,Re.setAnimationLoop(D),null===D?Yi.stop():Yi.start()},Re.addEventListener("sessionstart",Xi),Re.addEventListener("sessionend",Qt),this.render=function(D,U){if(void 0===U||!0===U.isCamera){if(!0!==w){if(!0===D.matrixWorldAutoUpdate&&D.updateMatrixWorld(),null===U.parent&&!0===U.matrixWorldAutoUpdate&&U.updateMatrixWorld(),!0===Re.enabled&&!0===Re.isPresenting&&(!0===Re.cameraAutoUpdate&&Re.updateCamera(U),U=Re.getCamera()),!0===D.isScene&&D.onBeforeRender(y,D,U,S),_=he.get(D,v.length),_.init(),v.push(_),Ce.multiplyMatrices(U.projectionMatrix,U.matrixWorldInverse),G.setFromProjectionMatrix(Ce),ae=this.localClippingEnabled,K=ke.init(this.clippingPlanes,ae),m=se.get(D,g.length),m.init(),g.push(m),so(D,U,0,y.sortObjects),m.finish(),!0===y.sortObjects&&m.sort(re,q),this.info.render.frame++,!0===K&&ke.beginShadows(),pe.render(_.state.shadowsArray,D,U),!0===K&&ke.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ee.render(m,D),_.setupLights(y._useLegacyLights),U.isArrayCamera){const $=U.cameras;for(let W=0,Ie=$.length;W<Ie;W++){const He=$[W];eG(m,D,He,He.viewport)}}else eG(m,D,U);null!==S&&(De.updateMultisampleRenderTarget(S),De.updateRenderTargetMipmap(S)),!0===D.isScene&&D.onAfterRender(y,D,U),ze.resetDefaultState(),M=-1,b=null,v.pop(),_=v.length>0?v[v.length-1]:null,g.pop(),m=g.length>0?g[g.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(D,U,j){Te.get(D.texture).__webglTexture=U,Te.get(D.depthTexture).__webglTexture=j;const $=Te.get(D);$.__hasExternalTextures=!0,$.__hasExternalTextures&&($.__autoAllocateDepthBuffer=void 0===j,$.__autoAllocateDepthBuffer||!0===Q.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(D,U){const j=Te.get(D);j.__webglFramebuffer=U,j.__useDefaultFramebuffer=void 0===U},this.setRenderTarget=function(D,U=0,j=0){S=D,x=U,E=j;let $=!0,W=null,Ie=!1,He=!1;if(D){const rt=Te.get(D);void 0!==rt.__useDefaultFramebuffer?(ie.bindFramebuffer(P.FRAMEBUFFER,null),$=!1):void 0===rt.__webglFramebuffer?De.setupRenderTarget(D):rt.__hasExternalTextures&&De.rebindTextures(D,Te.get(D.texture).__webglTexture,Te.get(D.depthTexture).__webglTexture);const mt=D.texture;(mt.isData3DTexture||mt.isDataArrayTexture||mt.isCompressedArrayTexture)&&(He=!0);const at=Te.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(W=Array.isArray(at[U])?at[U][j]:at[U],Ie=!0):W=fe.isWebGL2&&D.samples>0&&!1===De.useMultisampledRTT(D)?Te.get(D).__webglMultisampledFramebuffer:Array.isArray(at)?at[j]:at,C.copy(D.viewport),L.copy(D.scissor),F=D.scissorTest}else C.copy(ee).multiplyScalar(z).floor(),L.copy(te).multiplyScalar(z).floor(),F=_e;if(ie.bindFramebuffer(P.FRAMEBUFFER,W)&&fe.drawBuffers&&$&&ie.drawBuffers(D,W),ie.viewport(C),ie.scissor(L),ie.setScissorTest(F),Ie){const rt=Te.get(D.texture);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+U,rt.__webglTexture,j)}else if(He){const rt=Te.get(D.texture);P.framebufferTextureLayer(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,rt.__webglTexture,j||0,U||0)}M=-1},this.readRenderTargetPixels=function(D,U,j,$,W,Ie,He){if(!D||!D.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let et=Te.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&void 0!==He&&(et=et[He]),et){ie.bindFramebuffer(P.FRAMEBUFFER,et);try{const rt=D.texture,mt=rt.format,at=rt.type;if(mt!==Tr&&Qe.convert(mt)!==P.getParameter(P.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ht=at===$f&&(Q.has("EXT_color_buffer_half_float")||fe.isWebGL2&&Q.has("EXT_color_buffer_float"));if(!(at===wa||Qe.convert(at)===P.getParameter(P.IMPLEMENTATION_COLOR_READ_TYPE)||at===qs&&(fe.isWebGL2||Q.has("OES_texture_float")||Q.has("WEBGL_color_buffer_float"))||ht))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");U>=0&&U<=D.width-$&&j>=0&&j<=D.height-W&&P.readPixels(U,j,$,W,Qe.convert(mt),Qe.convert(at),Ie)}finally{const rt=null!==S?Te.get(S).__webglFramebuffer:null;ie.bindFramebuffer(P.FRAMEBUFFER,rt)}}},this.copyFramebufferToTexture=function(D,U,j=0){const $=Math.pow(2,-j),W=Math.floor(U.image.width*$),Ie=Math.floor(U.image.height*$);De.setTexture2D(U,0),P.copyTexSubImage2D(P.TEXTURE_2D,j,0,0,D.x,D.y,W,Ie),ie.unbindTexture()},this.copyTextureToTexture=function(D,U,j,$=0){const W=U.image.width,Ie=U.image.height,He=Qe.convert(j.format),et=Qe.convert(j.type);De.setTexture2D(j,0),P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,j.flipY),P.pixelStorei(P.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),P.pixelStorei(P.UNPACK_ALIGNMENT,j.unpackAlignment),U.isDataTexture?P.texSubImage2D(P.TEXTURE_2D,$,D.x,D.y,W,Ie,He,et,U.image.data):U.isCompressedTexture?P.compressedTexSubImage2D(P.TEXTURE_2D,$,D.x,D.y,U.mipmaps[0].width,U.mipmaps[0].height,He,U.mipmaps[0].data):P.texSubImage2D(P.TEXTURE_2D,$,D.x,D.y,He,et,U.image),0===$&&j.generateMipmaps&&P.generateMipmap(P.TEXTURE_2D),ie.unbindTexture()},this.copyTextureToTexture3D=function(D,U,j,$,W=0){if(y.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ie=D.max.x-D.min.x+1,He=D.max.y-D.min.y+1,et=D.max.z-D.min.z+1,rt=Qe.convert($.format),mt=Qe.convert($.type);let at;if($.isData3DTexture)De.setTexture3D($,0),at=P.TEXTURE_3D;else{if(!$.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");De.setTexture2DArray($,0),at=P.TEXTURE_2D_ARRAY}P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,$.flipY),P.pixelStorei(P.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$.premultiplyAlpha),P.pixelStorei(P.UNPACK_ALIGNMENT,$.unpackAlignment);const ht=P.getParameter(P.UNPACK_ROW_LENGTH),In=P.getParameter(P.UNPACK_IMAGE_HEIGHT),Gr=P.getParameter(P.UNPACK_SKIP_PIXELS),ai=P.getParameter(P.UNPACK_SKIP_ROWS),qo=P.getParameter(P.UNPACK_SKIP_IMAGES),hn=j.isCompressedTexture?j.mipmaps[0]:j.image;P.pixelStorei(P.UNPACK_ROW_LENGTH,hn.width),P.pixelStorei(P.UNPACK_IMAGE_HEIGHT,hn.height),P.pixelStorei(P.UNPACK_SKIP_PIXELS,D.min.x),P.pixelStorei(P.UNPACK_SKIP_ROWS,D.min.y),P.pixelStorei(P.UNPACK_SKIP_IMAGES,D.min.z),j.isDataTexture||j.isData3DTexture?P.texSubImage3D(at,W,U.x,U.y,U.z,Ie,He,et,rt,mt,hn.data):j.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),P.compressedTexSubImage3D(at,W,U.x,U.y,U.z,Ie,He,et,rt,hn.data)):P.texSubImage3D(at,W,U.x,U.y,U.z,Ie,He,et,rt,mt,hn),P.pixelStorei(P.UNPACK_ROW_LENGTH,ht),P.pixelStorei(P.UNPACK_IMAGE_HEIGHT,In),P.pixelStorei(P.UNPACK_SKIP_PIXELS,Gr),P.pixelStorei(P.UNPACK_SKIP_ROWS,ai),P.pixelStorei(P.UNPACK_SKIP_IMAGES,qo),0===W&&$.generateMipmaps&&P.generateMipmap(at),ie.unbindTexture()},this.initTexture=function(D){D.isCubeTexture?De.setTextureCube(D,0):D.isData3DTexture?De.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?De.setTexture2DArray(D,0):De.setTexture2D(D,0),ie.unbindTexture()},this.resetState=function(){x=0,E=0,S=null,ie.reset(),ze.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Xs}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===LS?"display-p3":"srgb",t.unpackColorSpace=Lt.workingColorSpace===X_?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Wt?bc:3e3}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===bc?Wt:Qn}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}(class poe extends CU{}).prototype.isWebGL1Renderer=!0;class Tv{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Z(e),this.near=t,this.far=i}clone(){return new Tv(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class TU extends gn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class fM{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Ar()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return console.warn('THREE.InterleavedBuffer: "updateRange" is deprecated and removed in r169. Use "addUpdateRange()" instead.'),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ar()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ar()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const $i=new A;class Oc{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.applyMatrix4(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.applyNormalMatrix(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)$i.fromBufferAttribute(this,t),$i.transformDirection(e),this.setXYZ(t,$i.x,$i.y,$i.z);return this}setX(e,t){return this.normalized&&(t=lt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=lt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=lt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=lt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ar(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ar(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ar(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ar(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=lt(t,this.array),i=lt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=lt(t,this.array),i=lt(i,this.array),r=lt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=lt(t,this.array),i=lt(i,this.array),r=lt(r,this.array),s=lt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new jt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Oc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const NU=new A,LU=new Vt,OU=new Vt,_oe=new A,FU=new Ge,Pv=new A,mM=new bi,kU=new Ge,gM=new Ic;class UU extends Ot{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=V2,this.bindMatrix=new Ge,this.bindMatrixInverse=new Ge,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Wi),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Pv),this.boundingBox.expandByPoint(Pv)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new bi),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Pv),this.boundingSphere.expandByPoint(Pv)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.matrixWorld;void 0!==this.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),mM.copy(this.boundingSphere),mM.applyMatrix4(r),!1!==e.ray.intersectsSphere(mM)&&(kU.copy(r).invert(),gM.copy(e.ray).applyMatrix4(kU),(null===this.boundingBox||!1!==gM.intersectsBox(this.boundingBox))&&this._computeIntersections(e,t,gM)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Vt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===V2?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;LU.fromBufferAttribute(r.attributes.skinIndex,e),OU.fromBufferAttribute(r.attributes.skinWeight,e),NU.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=OU.getComponent(s);if(0!==o){const a=LU.getComponent(s);FU.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(_oe.copy(NU).applyMatrix4(FU),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class _M extends gn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Sh extends Qr{constructor(e=null,t=1,i=1,r,s,o,a,c,l=Cn,u=Cn,h,d){super(null,o,a,c,l,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const BU=new Ge,voe=new Ge;class Nv{constructor(e=[],t=[]){this.uuid=Ar(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Ge)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Ge;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)BU.multiplyMatrices(e[s]?e[s].matrixWorld:voe,t[s]),BU.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new Nv(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Sh(t,e,e,Tr,qs);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new _M),this.bones.push(o),this.boneInverses.push((new Ge).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class Mh extends jt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Ch=new Ge,VU=new Ge,Lv=[],zU=new Wi,yoe=new Ge,ap=new Ot,cp=new bi;class Ov extends Ot{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Mh(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,yoe)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Wi),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Ch),zU.copy(e.boundingBox).applyMatrix4(Ch),this.boundingBox.union(zU)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new bi),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Ch),cp.copy(e.boundingSphere).applyMatrix4(Ch),this.boundingSphere.union(cp)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(ap.geometry=this.geometry,ap.material=this.material,void 0!==ap.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),cp.copy(this.boundingSphere),cp.applyMatrix4(i),!1!==e.ray.intersectsSphere(cp)))for(let s=0;s<r;s++){this.getMatrixAt(s,Ch),VU.multiplyMatrices(i,Ch),ap.matrixWorld=VU,ap.raycast(e,Lv);for(let o=0,a=Lv.length;o<a;o++){const c=Lv[o];c.instanceId=s,c.object=this,t.push(c)}Lv.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Mh(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Mi extends cr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Z(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const WU=new A,jU=new A,$U=new Ge,wM=new Ic,Uv=new bi;class Lo extends gn{constructor(e=new ot,t=new Mi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)WU.fromBufferAttribute(t,r-1),jU.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=WU.distanceTo(jU);e.setAttribute("lineDistance",new Pe(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Uv.copy(i.boundingSphere),Uv.applyMatrix4(r),Uv.radius+=s,!1===e.ray.intersectsSphere(Uv))return;$U.copy(r).invert(),wM.copy(e.ray).applyMatrix4($U);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=new A,u=new A,h=new A,d=new A,f=this.isLineSegments?2:1,p=i.index,_=i.attributes.position;if(null!==p)for(let y=Math.max(0,o.start),w=Math.min(p.count,o.start+o.count)-1;y<w;y+=f){const x=p.getX(y),E=p.getX(y+1);if(l.fromBufferAttribute(_,x),u.fromBufferAttribute(_,E),wM.distanceSqToSegment(l,u,d,h)>c)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||t.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),w=Math.min(_.count,o.start+o.count)-1;y<w;y+=f){if(l.fromBufferAttribute(_,y),u.fromBufferAttribute(_,y+1),wM.distanceSqToSegment(l,u,d,h)>c)continue;d.applyMatrix4(this.matrixWorld);const E=e.ray.origin.distanceTo(d);E<e.near||E>e.far||t.push({distance:E,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const qU=new A,XU=new A;class Bv extends Lo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)qU.fromBufferAttribute(t,r),XU.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+qU.distanceTo(XU);e.setAttribute("lineDistance",new Pe(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class YU extends Lo{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class xM extends cr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Z(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const ZU=new Ge,bM=new Ic,Vv=new bi,zv=new A;class KU extends gn{constructor(e=new ot,t=new xM){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Vv.copy(i.boundingSphere),Vv.applyMatrix4(r),Vv.radius+=s,!1===e.ray.intersectsSphere(Vv))return;ZU.copy(r).invert(),bM.copy(e.ray).applyMatrix4(ZU);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=i.index,h=i.attributes.position;if(null!==l)for(let p=Math.max(0,o.start),m=Math.min(l.count,o.start+o.count);p<m;p++){const _=l.getX(p);zv.fromBufferAttribute(h,_),JU(zv,_,c,r,e,t,this)}else for(let p=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);p<m;p++)zv.fromBufferAttribute(h,p),JU(zv,p,c,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function JU(n,e,t,i,r,s,o){const a=bM.distanceSqToPoint(n);if(a<t){const c=new A;bM.closestPointToPoint(n,c),c.applyMatrix4(i);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}class Toe extends Qr{constructor(e,t,i,r,s,o,a,c,l){super(e,t,i,r,s,o,a,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ks{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let l,a=0,c=s-1;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),l=i[r]-o,l<0)a=r+1;else{if(!(l>0)){c=r;break}c=r-1}if(r=c,i[r]===o)return r/(s-1);const u=i[r];return(r+(o-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new Y:new A);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new A,r=[],s=[],o=[],a=new A,c=new Ge;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new A);s[0]=new A,o[0]=new A;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),d<=l&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(mn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(c.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(mn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(c.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class EM extends Ks{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t){const i=t||new Y,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=c-this.aX,f=l-this.aY;c=d*u-f*h+this.aX,l=d*h+f*u+this.aY}return i.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function SM(){let n=0,e=0,t=0,i=0;function r(s,o,a,c){n=s,e=a,t=-3*s+3*o-2*a-c,i=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,l){r(o,a,l*(a-s),l*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,l,u,h){let d=(o-s)/l-(a-s)/(l+u)+(a-o)/u,f=(a-o)/u-(c-o)/(u+h)+(c-a)/h;d*=u,f*=u,r(o,a,d,f)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}const Hv=new A,MM=new SM,CM=new SM,TM=new SM;function QU(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function up(n,e,t,i){return function Ioe(n,e){const t=1-n;return t*t*e}(n,e)+function Roe(n,e){return 2*(1-n)*n*e}(n,t)+function Poe(n,e){return n*n*e}(n,i)}function hp(n,e,t,i,r){return function Noe(n,e){const t=1-n;return t*t*t*e}(n,e)+function Loe(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function Ooe(n,e){return 3*(1-n)*n*n*e}(n,i)+function Foe(n,e){return n*n*n*e}(n,r)}class eB extends Ks{constructor(e=new Y,t=new Y,i=new Y,r=new Y){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Y){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(hp(e,r.x,s.x,o.x,a.x),hp(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class tB extends Ks{constructor(e=new Y,t=new Y){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Y){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Y){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class nB extends Ks{constructor(e=new Y,t=new Y,i=new Y){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Y){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(up(e,r.x,s.x,o.x),up(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class rB extends Ks{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Y){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,c=r[0===o?o:o-1],l=r[o],u=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return i.set(QU(a,c.x,l.x,u.x,h.x),QU(a,c.y,l.y,u.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new Y).fromArray(r))}return this}}var Gv=Object.freeze({__proto__:null,ArcCurve:class Aoe extends EM{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class Doe extends Ks{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new A){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let l,u,a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===c&&a===s-1&&(a=s-2,c=1),this.closed||a>0?l=r[(a-1)%s]:(Hv.subVectors(r[0],r[1]).add(r[0]),l=Hv);const h=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(Hv.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=Hv),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let p=Math.pow(l.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(d),f),_=Math.pow(d.distanceToSquared(u),f);m<1e-4&&(m=1),p<1e-4&&(p=m),_<1e-4&&(_=m),MM.initNonuniformCatmullRom(l.x,h.x,d.x,u.x,p,m,_),CM.initNonuniformCatmullRom(l.y,h.y,d.y,u.y,p,m,_),TM.initNonuniformCatmullRom(l.z,h.z,d.z,u.z,p,m,_)}else"catmullrom"===this.curveType&&(MM.initCatmullRom(l.x,h.x,d.x,u.x,this.tension),CM.initCatmullRom(l.y,h.y,d.y,u.y,this.tension),TM.initCatmullRom(l.z,h.z,d.z,u.z,this.tension));return i.set(MM.calc(c),CM.calc(c),TM.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new A).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:eB,CubicBezierCurve3:class koe extends Ks{constructor(e=new A,t=new A,i=new A,r=new A){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new A){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(hp(e,r.x,s.x,o.x,a.x),hp(e,r.y,s.y,o.y,a.y),hp(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},EllipseCurve:EM,LineCurve:tB,LineCurve3:class Uoe extends Ks{constructor(e=new A,t=new A){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new A){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new A){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:nB,QuadraticBezierCurve3:class iB extends Ks{constructor(e=new A,t=new A,i=new A){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new A){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(up(e,r.x,s.x,o.x),up(e,r.y,s.y,o.y),up(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:rB});class Boe extends Ks{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);return e.equals(t)||this.curves.push(new Gv[!0===e.isVector2?"LineCurve":"LineCurve3"](t,e)),this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],c=a.getLength();return a.getPointAt(0===c?0:1-o/c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],c=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let l=0;l<c.length;l++){const u=c[l];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new Gv[r.type]).fromJSON(r))}return this}}class Wv extends Boe{constructor(e){super(),this.type="Path",this.currentPoint=new Y,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new tB(this.currentPoint.clone(),new Y(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new nB(this.currentPoint.clone(),new Y(e,t),new Y(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new eB(this.currentPoint.clone(),new Y(e,t),new Y(i,r),new Y(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new rB(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,c){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,c),this}absellipse(e,t,i,r,s,o,a,c){const l=new EM(e,t,i,r,s,o,a,c);if(this.curves.length>0){const h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class kc extends ot{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,c=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const l=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],d=[],f=[];let p=0;const m=[],_=i/2;let g=0;function y(w){const x=p,E=new Y,S=new A;let M=0;const b=!0===w?e:t,C=!0===w?1:-1;for(let F=1;F<=r;F++)h.push(0,_*C,0),d.push(0,C,0),f.push(.5,.5),p++;const L=p;for(let F=0;F<=r;F++){const R=F/r*c+a,k=Math.cos(R),V=Math.sin(R);S.x=b*V,S.y=_*C,S.z=b*k,h.push(S.x,S.y,S.z),d.push(0,C,0),E.x=.5*k+.5,E.y=.5*V*C+.5,f.push(E.x,E.y),p++}for(let F=0;F<r;F++){const B=x+F,R=L+F;!0===w?u.push(R,R+1,B):u.push(R+1,R,B),M+=3}l.addGroup(g,M,!0===w?1:2),g+=M}(function v(){const w=new A,x=new A;let E=0;const S=(t-e)/i;for(let M=0;M<=s;M++){const b=[],C=M/s,L=C*(t-e)+e;for(let F=0;F<=r;F++){const B=F/r,R=B*c+a,k=Math.sin(R),V=Math.cos(R);x.x=L*k,x.y=-C*i+_,x.z=L*V,h.push(x.x,x.y,x.z),w.set(k,S,V).normalize(),d.push(w.x,w.y,w.z),f.push(B,1-C),b.push(p++)}m.push(b)}for(let M=0;M<r;M++)for(let b=0;b<s;b++){const L=m[b+1][M],F=m[b+1][M+1],B=m[b][M+1];u.push(m[b][M],L,B),u.push(L,F,B),E+=6}l.addGroup(g,E,0),g+=E})(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(u),this.setAttribute("position",new Pe(h,3)),this.setAttribute("normal",new Pe(d,3)),this.setAttribute("uv",new Pe(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kc(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Uc extends ot{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function c(v,y,w,x){const E=x+1,S=[];for(let M=0;M<=E;M++){S[M]=[];const b=v.clone().lerp(w,M/E),C=y.clone().lerp(w,M/E),L=E-M;for(let F=0;F<=L;F++)S[M][F]=0===F&&M===E?b:b.clone().lerp(C,F/L)}for(let M=0;M<E;M++)for(let b=0;b<2*(E-M)-1;b++){const C=Math.floor(b/2);b%2==0?(d(S[M][C+1]),d(S[M+1][C]),d(S[M][C])):(d(S[M][C+1]),d(S[M+1][C+1]),d(S[M+1][C]))}}function d(v){s.push(v.x,v.y,v.z)}function f(v,y){const w=3*v;y.x=e[w+0],y.y=e[w+1],y.z=e[w+2]}function m(v,y,w,x){x<0&&1===v.x&&(o[y]=v.x-1),0===w.x&&0===w.z&&(o[y]=x/2/Math.PI+.5)}function _(v){return Math.atan2(v.z,-v.x)}function g(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}(function a(v){const y=new A,w=new A,x=new A;for(let E=0;E<t.length;E+=3)f(t[E+0],y),f(t[E+1],w),f(t[E+2],x),c(y,w,x,v)})(r),function l(v){const y=new A;for(let w=0;w<s.length;w+=3)y.x=s[w+0],y.y=s[w+1],y.z=s[w+2],y.normalize().multiplyScalar(v),s[w+0]=y.x,s[w+1]=y.y,s[w+2]=y.z}(i),function u(){const v=new A;for(let y=0;y<s.length;y+=3){v.x=s[y+0],v.y=s[y+1],v.z=s[y+2];const w=_(v)/2/Math.PI+.5,x=g(v)/Math.PI+.5;o.push(w,1-x)}(function p(){const v=new A,y=new A,w=new A,x=new A,E=new Y,S=new Y,M=new Y;for(let b=0,C=0;b<s.length;b+=9,C+=6){v.set(s[b+0],s[b+1],s[b+2]),y.set(s[b+3],s[b+4],s[b+5]),w.set(s[b+6],s[b+7],s[b+8]),E.set(o[C+0],o[C+1]),S.set(o[C+2],o[C+3]),M.set(o[C+4],o[C+5]),x.copy(v).add(y).add(w).divideScalar(3);const L=_(x);m(E,C+0,v,L),m(S,C+2,y,L),m(M,C+4,w,L)}})(),function h(){for(let v=0;v<o.length;v+=6){const y=o[v+0],w=o[v+2],x=o[v+4],E=Math.max(y,w,x),S=Math.min(y,w,x);E>.9&&S<.1&&(y<.2&&(o[v+0]+=1),w<.2&&(o[v+2]+=1),x<.2&&(o[v+4]+=1))}}()}(),this.setAttribute("position",new Pe(s,3)),this.setAttribute("normal",new Pe(s.slice(),3)),this.setAttribute("uv",new Pe(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Uc(e.vertices,e.indices,e.radius,e.details)}}const $v=new A,qv=new A,PM=new A,Xv=new Ir;class sB extends ot{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(Mc*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,l=[0,0,0],u=["a","b","c"],h=new Array(3),d={},f=[];for(let p=0;p<c;p+=3){o?(l[0]=o.getX(p),l[1]=o.getX(p+1),l[2]=o.getX(p+2)):(l[0]=p,l[1]=p+1,l[2]=p+2);const{a:m,b:_,c:g}=Xv;if(m.fromBufferAttribute(a,l[0]),_.fromBufferAttribute(a,l[1]),g.fromBufferAttribute(a,l[2]),Xv.getNormal(PM),h[0]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,h[1]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,h[2]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(let v=0;v<3;v++){const y=(v+1)%3,w=h[v],x=h[y],E=Xv[u[v]],S=Xv[u[y]],M=`${w}_${x}`,b=`${x}_${w}`;b in d&&d[b]?(PM.dot(d[b].normal)<=s&&(f.push(E.x,E.y,E.z),f.push(S.x,S.y,S.z)),d[b]=null):M in d||(d[M]={index0:l[v],index1:l[y],normal:PM.clone()})}}for(const p in d)if(d[p]){const{index0:m,index1:_}=d[p];$v.fromBufferAttribute(a,m),qv.fromBufferAttribute(a,_),f.push($v.x,$v.y,$v.z),f.push(qv.x,qv.y,qv.z)}this.setAttribute("position",new Pe(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Aa extends Wv{constructor(e){super(e),this.uuid=Ar(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new Wv).fromJSON(r))}return this}}function oB(n,e,t,i,r){let s,o;if(r===function nae(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=lB(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=lB(s,n[s],n[s+1],o);return o&&Yv(o,o.next)&&(pp(o),o=o.next),o}function Bc(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!Yv(t,t.next)&&0!==cn(t.prev,t,t.next))t=t.next;else{if(pp(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function dp(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function Zoe(n,e,t,i){let r=n;do{0===r.z&&(r.z=NM(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function Koe(n){let e,t,i,r,s,o,a,c,l=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<l&&(a++,i=i.nextZ,i);e++);for(c=l;a>0||c>0&&i;)0!==a&&(0===c||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,c--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,l*=2}while(o>1)}(r)}(n,i,r,s);let c,l,a=n;for(;n.prev!==n.next;)if(c=n.prev,l=n.next,s?Hoe(n,i,r,s):zoe(n))e.push(c.i/t|0),e.push(n.i/t|0),e.push(l.i/t|0),pp(n),n=l.next,a=l.next;else if((n=l)===a){o?1===o?dp(n=Goe(Bc(n),e,t),e,t,i,r,s,2):2===o&&Woe(n,e,t,i,r,s):dp(Bc(n),e,t,i,r,s,1);break}}function zoe(n){const e=n.prev,t=n,i=n.next;if(cn(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,c=t.y,l=i.y,u=r<s?r<o?r:o:s<o?s:o,h=a<c?a<l?a:l:c<l?c:l,d=r>s?r>o?r:o:s>o?s:o,f=a>c?a>l?a:l:c>l?c:l;let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&Ah(r,a,s,c,o,l,p.x,p.y)&&cn(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Hoe(n,e,t,i){const r=n.prev,s=n,o=n.next;if(cn(r,s,o)>=0)return!1;const a=r.x,c=s.x,l=o.x,u=r.y,h=s.y,d=o.y,f=a<c?a<l?a:l:c<l?c:l,p=u<h?u<d?u:d:h<d?h:d,m=a>c?a>l?a:l:c>l?c:l,_=u>h?u>d?u:d:h>d?h:d,g=NM(f,p,e,t,i),v=NM(m,_,e,t,i);let y=n.prevZ,w=n.nextZ;for(;y&&y.z>=g&&w&&w.z<=v;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=_&&y!==r&&y!==o&&Ah(a,u,c,h,l,d,y.x,y.y)&&cn(y.prev,y,y.next)>=0||(y=y.prevZ,w.x>=f&&w.x<=m&&w.y>=p&&w.y<=_&&w!==r&&w!==o&&Ah(a,u,c,h,l,d,w.x,w.y)&&cn(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;y&&y.z>=g;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=_&&y!==r&&y!==o&&Ah(a,u,c,h,l,d,y.x,y.y)&&cn(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;w&&w.z<=v;){if(w.x>=f&&w.x<=m&&w.y>=p&&w.y<=_&&w!==r&&w!==o&&Ah(a,u,c,h,l,d,w.x,w.y)&&cn(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function Goe(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!Yv(r,s)&&aB(r,i,i.next,s)&&fp(r,s)&&fp(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),pp(i),pp(i.next),i=n=s),i=i.next}while(i!==n);return Bc(i)}function Woe(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Qoe(o,a)){let c=cB(o,a);return o=Bc(o,o.next),c=Bc(c,c.next),dp(o,e,t,i,r,s,0),void dp(c,e,t,i,r,s,0)}a=a.next}o=o.next}while(o!==n)}function $oe(n,e){return n.x-e.x}function qoe(n,e){const t=function Xoe(n,e){let r,t=e,i=-1/0;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=s&&d>i&&(i=d,r=t.x<t.next.x?t:t.next,d===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,c=r.x,l=r.y;let h,u=1/0;t=r;do{s>=t.x&&t.x>=c&&s!==t.x&&Ah(o<l?s:i,o,c,l,o<l?i:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),fp(t,n)&&(h<u||h===u&&(t.x>r.x||t.x===r.x&&Yoe(r,t)))&&(r=t,u=h)),t=t.next}while(t!==a);return r}(n,e);if(!t)return e;const i=cB(t,n);return Bc(i,i.next),Bc(t,t.next)}function Yoe(n,e){return cn(n.prev,n,e.prev)<0&&cn(e.next,n,n.next)<0}function NM(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Joe(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function Ah(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function Qoe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function eae(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&aB(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(fp(n,e)&&fp(e,n)&&function tae(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(cn(n.prev,n,e.prev)||cn(n,e.prev,e))||Yv(n,e)&&cn(n.prev,n,n.next)>0&&cn(e.prev,e,e.next)>0)}function cn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Yv(n,e){return n.x===e.x&&n.y===e.y}function aB(n,e,t,i){const r=Kv(cn(n,e,t)),s=Kv(cn(n,e,i)),o=Kv(cn(t,i,n)),a=Kv(cn(t,i,e));return!!(r!==s&&o!==a||0===r&&Zv(n,t,e)||0===s&&Zv(n,i,e)||0===o&&Zv(t,n,i)||0===a&&Zv(t,e,i))}function Zv(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Kv(n){return n>0?1:n<0?-1:0}function fp(n,e){return cn(n.prev,n,n.next)<0?cn(n,e,n.next)>=0&&cn(n,n.prev,e)>=0:cn(n,e,n.prev)<0||cn(n,n.next,e)<0}function cB(n,e){const t=new LM(n.i,n.x,n.y),i=new LM(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function lB(n,e,t,i){const r=new LM(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function pp(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function LM(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Oo{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return Oo.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];uB(e),hB(i,e);let o=e.length;t.forEach(uB);for(let c=0;c<t.length;c++)r.push(o),o+=t[c].length,hB(i,t[c]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=oB(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,l,u,h,d,f;if(i&&(s=function joe(n,e,t,i){const r=[];let s,o,a,c,l;for(s=0,o=e.length;s<o;s++)a=e[s]*i,c=s<o-1?e[s+1]*i:n.length,l=oB(n,a,c,i,!1),l===l.next&&(l.steiner=!0),r.push(Joe(l));for(r.sort($oe),s=0;s<r.length;s++)t=qoe(r[s],t);return t}(n,e,s,t)),n.length>80*t){a=l=n[0],c=u=n[1];for(let p=t;p<r;p+=t)h=n[p],d=n[p+1],h<a&&(a=h),d<c&&(c=d),h>l&&(l=h),d>u&&(u=d);f=Math.max(l-a,u-c),f=0!==f?32767/f:0}return dp(s,o,t,a,c,f,0),o}(i,r);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}}function uB(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function hB(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Jv extends ot{constructor(e=new Aa([new Y(.5,.5),new Y(-.5,.5),new Y(-.5,-.5),new Y(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,c=e.length;a<c;a++)o(e[a]);function o(a){const c=[],l=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1,h=void 0!==t.depth?t.depth:1;let d=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,p=void 0!==t.bevelSize?t.bevelSize:f-.1,m=void 0!==t.bevelOffset?t.bevelOffset:0,_=void 0!==t.bevelSegments?t.bevelSegments:3;const g=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:iae;let y,x,E,S,M,w=!1;g&&(y=g.getSpacedPoints(u),w=!0,d=!1,x=g.computeFrenetFrames(u,!1),E=new A,S=new A,M=new A),d||(_=0,f=0,p=0,m=0);const b=a.extractPoints(l);let C=b.shape;const L=b.holes;if(!Oo.isClockWise(C)){C=C.reverse();for(let P=0,ge=L.length;P<ge;P++){const Q=L[P];Oo.isClockWise(Q)&&(L[P]=Q.reverse())}}const B=Oo.triangulateShape(C,L),R=C;for(let P=0,ge=L.length;P<ge;P++)C=C.concat(L[P]);function k(P,ge,Q){return ge||console.error("THREE.ExtrudeGeometry: vec does not exist"),P.clone().addScaledVector(ge,Q)}const V=C.length,z=B.length;function re(P,ge,Q){let fe,ie,Ve;const Te=P.x-ge.x,De=P.y-ge.y,Ye=Q.x-P.x,wt=Q.y-P.y,nn=Te*Te+De*De;if(Math.abs(Te*wt-De*Ye)>Number.EPSILON){const T=Math.sqrt(nn),H=Math.sqrt(Ye*Ye+wt*wt),ue=ge.x-De/T,se=ge.y+Te/T,pe=((Q.x-wt/H-ue)*wt-(Q.y+Ye/H-se)*Ye)/(Te*wt-De*Ye);fe=ue+Te*pe-P.x,ie=se+De*pe-P.y;const Ee=fe*fe+ie*ie;if(Ee<=2)return new Y(fe,ie);Ve=Math.sqrt(Ee/2)}else{let T=!1;Te>Number.EPSILON?Ye>Number.EPSILON&&(T=!0):Te<-Number.EPSILON?Ye<-Number.EPSILON&&(T=!0):Math.sign(De)===Math.sign(wt)&&(T=!0),T?(fe=-De,ie=Te,Ve=Math.sqrt(nn)):(fe=Te,ie=De,Ve=Math.sqrt(nn/2))}return new Y(fe/Ve,ie/Ve)}const q=[];for(let P=0,ge=R.length,Q=ge-1,fe=P+1;P<ge;P++,Q++,fe++)Q===ge&&(Q=0),fe===ge&&(fe=0),q[P]=re(R[P],R[Q],R[fe]);const ee=[];let te,_e=q.concat();for(let P=0,ge=L.length;P<ge;P++){const Q=L[P];te=[];for(let fe=0,ie=Q.length,Ve=ie-1,Te=fe+1;fe<ie;fe++,Ve++,Te++)Ve===ie&&(Ve=0),Te===ie&&(Te=0),te[fe]=re(Q[fe],Q[Ve],Q[Te]);ee.push(te),_e=_e.concat(te)}for(let P=0;P<_;P++){const ge=P/_,Q=f*Math.cos(ge*Math.PI/2),fe=p*Math.sin(ge*Math.PI/2)+m;for(let ie=0,Ve=R.length;ie<Ve;ie++){const Te=k(R[ie],q[ie],fe);Ce(Te.x,Te.y,-Q)}for(let ie=0,Ve=L.length;ie<Ve;ie++){const Te=L[ie];te=ee[ie];for(let De=0,Ye=Te.length;De<Ye;De++){const wt=k(Te[De],te[De],fe);Ce(wt.x,wt.y,-Q)}}}const G=p+m;for(let P=0;P<V;P++){const ge=d?k(C[P],_e[P],G):C[P];w?(S.copy(x.normals[0]).multiplyScalar(ge.x),E.copy(x.binormals[0]).multiplyScalar(ge.y),M.copy(y[0]).add(S).add(E),Ce(M.x,M.y,M.z)):Ce(ge.x,ge.y,0)}for(let P=1;P<=u;P++)for(let ge=0;ge<V;ge++){const Q=d?k(C[ge],_e[ge],G):C[ge];w?(S.copy(x.normals[P]).multiplyScalar(Q.x),E.copy(x.binormals[P]).multiplyScalar(Q.y),M.copy(y[P]).add(S).add(E),Ce(M.x,M.y,M.z)):Ce(Q.x,Q.y,h/u*P)}for(let P=_-1;P>=0;P--){const ge=P/_,Q=f*Math.cos(ge*Math.PI/2),fe=p*Math.sin(ge*Math.PI/2)+m;for(let ie=0,Ve=R.length;ie<Ve;ie++){const Te=k(R[ie],q[ie],fe);Ce(Te.x,Te.y,h+Q)}for(let ie=0,Ve=L.length;ie<Ve;ie++){const Te=L[ie];te=ee[ie];for(let De=0,Ye=Te.length;De<Ye;De++){const wt=k(Te[De],te[De],fe);w?Ce(wt.x,wt.y+y[u-1].y,y[u-1].x+Q):Ce(wt.x,wt.y,h+Q)}}}function ye(P,ge){let Q=P.length;for(;--Q>=0;){const fe=Q;let ie=Q-1;ie<0&&(ie=P.length-1);for(let Ve=0,Te=u+2*_;Ve<Te;Ve++){const De=V*Ve,Ye=V*(Ve+1);We(ge+fe+De,ge+ie+De,ge+ie+Ye,ge+fe+Ye)}}}function Ce(P,ge,Q){c.push(P),c.push(ge),c.push(Q)}function Be(P,ge,Q){Se(P),Se(ge),Se(Q);const fe=r.length/3,ie=v.generateTopUV(i,r,fe-3,fe-2,fe-1);Fe(ie[0]),Fe(ie[1]),Fe(ie[2])}function We(P,ge,Q,fe){Se(P),Se(ge),Se(fe),Se(ge),Se(Q),Se(fe);const ie=r.length/3,Ve=v.generateSideWallUV(i,r,ie-6,ie-3,ie-2,ie-1);Fe(Ve[0]),Fe(Ve[1]),Fe(Ve[3]),Fe(Ve[1]),Fe(Ve[2]),Fe(Ve[3])}function Se(P){r.push(c[3*P+0]),r.push(c[3*P+1]),r.push(c[3*P+2])}function Fe(P){s.push(P.x),s.push(P.y)}(function K(){const P=r.length/3;if(d){let ge=0,Q=V*ge;for(let fe=0;fe<z;fe++){const ie=B[fe];Be(ie[2]+Q,ie[1]+Q,ie[0]+Q)}ge=u+2*_,Q=V*ge;for(let fe=0;fe<z;fe++){const ie=B[fe];Be(ie[0]+Q,ie[1]+Q,ie[2]+Q)}}else{for(let ge=0;ge<z;ge++){const Q=B[ge];Be(Q[2],Q[1],Q[0])}for(let ge=0;ge<z;ge++){const Q=B[ge];Be(Q[0]+V*u,Q[1]+V*u,Q[2]+V*u)}}i.addGroup(P,r.length/3-P,0)})(),function ae(){const P=r.length/3;let ge=0;ye(R,ge),ge+=R.length;for(let Q=0,fe=L.length;Q<fe;Q++){const ie=L[Q];ye(ie,ge),ge+=ie.length}i.addGroup(P,r.length/3-P,1)}()}this.setAttribute("position",new Pe(r,3)),this.setAttribute("uv",new Pe(s,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function rae(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new Gv[r.type]).fromJSON(r)),new Jv(i,e.options)}}const iae={generateTopUV:function(n,e,t,i,r){const a=e[3*i],c=e[3*i+1],l=e[3*r],u=e[3*r+1];return[new Y(e[3*t],e[3*t+1]),new Y(a,c),new Y(l,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],c=e[3*t+2],l=e[3*i],u=e[3*i+1],h=e[3*i+2],d=e[3*r],f=e[3*r+1],p=e[3*r+2],m=e[3*s],_=e[3*s+1],g=e[3*s+2];return Math.abs(a-u)<Math.abs(o-l)?[new Y(o,1-c),new Y(l,1-h),new Y(d,1-p),new Y(m,1-g)]:[new Y(a,1-c),new Y(u,1-h),new Y(f,1-p),new Y(_,1-g)]}};class Qv extends Uc{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Qv(e.radius,e.detail)}}class Dh extends ot{constructor(e=.5,t=1,i=32,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i);const a=[],c=[],l=[],u=[];let h=e;const d=(t-e)/(r=Math.max(1,r)),f=new A,p=new Y;for(let m=0;m<=r;m++){for(let _=0;_<=i;_++){const g=s+_/i*o;f.x=h*Math.cos(g),f.y=h*Math.sin(g),c.push(f.x,f.y,f.z),l.push(0,0,1),p.x=(f.x/t+1)/2,p.y=(f.y/t+1)/2,u.push(p.x,p.y)}h+=d}for(let m=0;m<r;m++){const _=m*(i+1);for(let g=0;g<i;g++){const v=g+_,w=v+i+1,x=v+i+2,E=v+1;a.push(v,w,E),a.push(w,x,E)}}this.setIndex(a),this.setAttribute("position",new Pe(c,3)),this.setAttribute("normal",new Pe(l,3)),this.setAttribute("uv",new Pe(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Dh(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Vc extends ot{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const c=Math.min(o+a,Math.PI);let l=0;const u=[],h=new A,d=new A,f=[],p=[],m=[],_=[];for(let g=0;g<=i;g++){const v=[],y=g/i;let w=0;0===g&&0===o?w=.5/t:g===i&&c===Math.PI&&(w=-.5/t);for(let x=0;x<=t;x++){const E=x/t;h.x=-e*Math.cos(r+E*s)*Math.sin(o+y*a),h.y=e*Math.cos(o+y*a),h.z=e*Math.sin(r+E*s)*Math.sin(o+y*a),p.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),_.push(E+w,1-y),v.push(l++)}u.push(v)}for(let g=0;g<i;g++)for(let v=0;v<t;v++){const w=u[g][v],x=u[g+1][v],E=u[g+1][v+1];(0!==g||o>0)&&f.push(u[g][v+1],w,E),(g!==i-1||c<Math.PI)&&f.push(w,x,E)}this.setIndex(f),this.setAttribute("position",new Pe(p,3)),this.setAttribute("normal",new Pe(m,3)),this.setAttribute("uv",new Pe(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Da extends cr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Z(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Z(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Y(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ts extends Da{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Y(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return mn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Z(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Z(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Z(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Fo extends cr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Z(16777215),this.specular=new Z(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Z(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Y(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=H_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class pB extends cr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Y(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class ty extends cr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Z(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Z(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Y(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=H_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function zc(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function gB(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function VM(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=n[a+c]}return r}function zM(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class mp{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class pae extends mp{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===c)switch(this.getSettings_().endingEnd){case 2401:o=e,c=2*i-t;break;case 2402:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}const l=.5*(i-t),u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),m=p*p,_=m*p,g=-d*_+2*d*m-d*p,v=(1+d)*_+(-1.5-2*d)*m+(-.5+d)*p+1,y=(-1-f)*_+(1.5+f)*m+.5*p,w=f*_-f*m;for(let x=0;x!==a;++x)s[x]=g*o[u+x]+v*o[l+x]+y*o[c+x]+w*o[h+x];return s}}class _B extends mp{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(i-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[l+d]*h+o[c+d]*u;return s}}class mae extends mp{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Js{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=zc(t,this.TimeBufferType),this.values=zc(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:zc(e.times,Array),values:zc(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new mae(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new _B(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new pae(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case qf:t=this.InterpolantFactoryMethodDiscrete;break;case qu:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return qf;case this.InterpolantFactoryMethodLinear:return qu;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=i[a];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(null!==o&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(void 0!==r&&function mB(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,c=r.length;a!==c;++a){const l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const l=e[a];if(l!==e[a+1]&&(1!==a||l!==e[0]))if(r)c=!0;else{const h=a*i,d=h-i,f=h+i;for(let p=0;p!==i;++p){const m=t[h+p];if(m!==t[d+p]||m!==t[f+p]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const h=a*i,d=o*i;for(let f=0;f!==i;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,l=0;l!==i;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Js.prototype.TimeBufferType=Float32Array,Js.prototype.ValueBufferType=Float32Array,Js.prototype.DefaultInterpolation=qu;class Ih extends Js{}Ih.prototype.ValueTypeName="bool",Ih.prototype.ValueBufferType=Array,Ih.prototype.DefaultInterpolation=qf,Ih.prototype.InterpolantFactoryMethodLinear=void 0,Ih.prototype.InterpolantFactoryMethodSmooth=void 0;class vB extends Js{}vB.prototype.ValueTypeName="color";class Rh extends Js{}Rh.prototype.ValueTypeName="number";class gae extends mp{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let l=e*a;for(let u=l+a;l!==u;l+=4)hi.slerpFlat(s,0,o,l-a,o,l,c);return s}}class Hc extends Js{InterpolantFactoryMethodLinear(e){return new gae(this.times,this.values,this.getValueSize(),e)}}Hc.prototype.ValueTypeName="quaternion",Hc.prototype.DefaultInterpolation=qu,Hc.prototype.InterpolantFactoryMethodSmooth=void 0;class Ph extends Js{}Ph.prototype.ValueTypeName="string",Ph.prototype.ValueBufferType=Array,Ph.prototype.DefaultInterpolation=qf,Ph.prototype.InterpolantFactoryMethodLinear=void 0,Ph.prototype.InterpolantFactoryMethodSmooth=void 0;class Nh extends Js{}Nh.prototype.ValueTypeName="vector";class gp{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Ar(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(vae(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Js.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],l=[];c.push((a+s-1)%s,a,(a+1)%s),l.push(0,1,0);const u=gB(c);c=VM(c,1,u),l=VM(l,1,u),!r&&0===c[0]&&(c.push(s),l.push(l[0])),o.push(new Rh(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const l=e[a],u=l.name.match(s);if(u&&u.length>1){const h=u[1];let d=r[h];d||(r[h]=d=[]),d.push(l)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,d,f,p,m){if(0!==f.length){const _=[],g=[];zM(f,_,g,p),0!==_.length&&m.push(new h(d,_,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let h=0;h<l.length;h++){const d=l[h].keys;if(d&&0!==d.length)if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let m=0;m<d[p].morphTargets.length;m++)f[d[p].morphTargets[m]]=-1;for(const m in f){const _=[],g=[];for(let v=0;v!==d[p].morphTargets.length;++v){const y=d[p];_.push(y.time),g.push(y.morphTarget===m?1:0)}r.push(new Rh(".morphTargetInfluence["+m+"]",_,g))}c=f.length*o}else{const f=".bones["+t[h].name+"]";i(Nh,f+".position",d,"pos",r),i(Hc,f+".quaternion",d,"rot",r),i(Nh,f+".scale",d,"scl",r)}}return 0===r.length?null:new this(s,c,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function vae(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function _ae(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Rh;case"vector":case"vector2":case"vector3":case"vector4":return Nh;case"color":return vB;case"quaternion":return Hc;case"bool":case"boolean":return Ih;case"string":return Ph}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];zM(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Lh={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class HM{constructor(e,t,i){const r=this;let c,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,h){return l.push(u,h),this},this.removeHandler=function(u){const h=l.indexOf(u);return-1!==h&&l.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=l.length;h<d;h+=2){const f=l[h],p=l[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const yae=new HM;let Oh=(()=>{class n{constructor(t){this.manager=void 0!==t?t:yae,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const r=this;return new Promise(function(s,o){r.load(t,s,i,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();const ko={};class wae extends Error{constructor(e,t){super(e),this.response=t}}class Pr extends Oh{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Lh.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==ko[e])return void ko[e].push({onLoad:t,onProgress:i,onError:r});ko[e]=[],ko[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(l=>{if(200===l.status||0===l.status){if(0===l.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===l.body||void 0===l.body.getReader)return l;const u=ko[e],h=l.body.getReader(),d=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),f=d?parseInt(d):0,p=0!==f;let m=0;const _=new ReadableStream({start(g){!function v(){h.read().then(({done:y,value:w})=>{if(y)g.close();else{m+=w.byteLength;const x=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:f});for(let E=0,S=u.length;E<S;E++){const M=u[E];M.onProgress&&M.onProgress(x)}g.enqueue(w),v()}})}()}});return new Response(_)}throw new wae(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return l.json();default:if(void 0===a)return l.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return l.arrayBuffer().then(p=>f.decode(p))}}}).then(l=>{Lh.add(e,l);const u=ko[e];delete ko[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onLoad&&f.onLoad(l)}}).catch(l=>{const u=ko[e];if(void 0===u)throw this.manager.itemError(e),l;delete ko[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class ny extends Oh{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Lh.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Zf("img");function c(){u(),Lh.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class GM extends Oh{constructor(e){super(e)}load(e,t,i,r){const s=new Qr,o=new ny(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class iy extends gn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Z(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class WM extends iy{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(gn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Z(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const jM=new Ge,yB=new A,wB=new A;class $M{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Y(512,512),this.map=null,this.mapPass=null,this.matrix=new Ge,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new xv,this._frameExtents=new Y(1,1),this._viewportCount=1,this._viewports=[new Vt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;yB.setFromMatrixPosition(e.matrixWorld),t.position.copy(yB),wB.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(wB),t.updateMatrixWorld(),jM.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jM),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(jM)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class xae extends $M{constructor(){super(new ti(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*Ku*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class qM extends iy{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(gn.DEFAULT_UP),this.updateMatrix(),this.target=new gn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new xae}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const xB=new Ge,_p=new A,XM=new A;class bae extends $M{constructor(){super(new ti(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Y(4,2),this._viewportCount=6,this._viewports=[new Vt(2,1,1,1),new Vt(0,1,1,1),new Vt(3,1,1,1),new Vt(1,1,1,1),new Vt(3,0,1,1),new Vt(1,0,1,1)],this._cubeDirections=[new A(1,0,0),new A(-1,0,0),new A(0,0,1),new A(0,0,-1),new A(0,1,0),new A(0,-1,0)],this._cubeUps=[new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,0,1),new A(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),_p.setFromMatrixPosition(e.matrixWorld),i.position.copy(_p),XM.copy(i.position),XM.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(XM),i.updateMatrixWorld(),r.makeTranslation(-_p.x,-_p.y,-_p.z),xB.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(xB)}}class YM extends iy{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new bae}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Eae extends $M{constructor(){super(new Ev(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class ry extends iy{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(gn.DEFAULT_UP),this.updateMatrix(),this.target=new gn,this.shadow=new Eae}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Gc{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Rae extends Oh{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Lh.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){Lh.add(e,c),t&&t(c),s.manager.itemEnd(e)}).catch(function(c){r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}class TB{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=AB(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=AB();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function AB(){return(typeof performance>"u"?Date:performance).now()}const KM="\\[\\]\\.:\\/",Oae=new RegExp("["+KM+"]","g"),JM="[^"+KM+"]",Fae="[^"+KM.replace("\\.","")+"]",zae=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",JM)+/(WCOD+)?/.source.replace("WCOD",Fae)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",JM)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",JM)+"$"),Hae=["material","materials","bones","map"];class Gae{constructor(e,t,i){const r=i||Jt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Jt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Oae,"")}static parseTrackName(t){const i=zae.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Hae.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const c=o[a];if(c.name===i||c.uuid===i)return c;const l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===u){u=h;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=Gae,n})();Jt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Jt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Jt.prototype.GetterByBindingType=[Jt.prototype._getValue_direct,Jt.prototype._getValue_array,Jt.prototype._getValue_arrayElement,Jt.prototype._getValue_toArray],Jt.prototype.SetterByBindingTypeAndVersioning=[[Jt.prototype._setValue_direct,Jt.prototype._setValue_direct_setNeedsUpdate,Jt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Jt.prototype._setValue_array,Jt.prototype._setValue_array_setNeedsUpdate,Jt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Jt.prototype._setValue_arrayElement,Jt.prototype._setValue_arrayElement_setNeedsUpdate,Jt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Jt.prototype._setValue_fromArray,Jt.prototype._setValue_fromArray_setNeedsUpdate,Jt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class QM{constructor(e,t,i=0,r=1/0){this.ray=new Ic(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new XS,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return eC(e,this,i,t),i.sort(PB),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)eC(e[r],this,i,t);return i.sort(PB),i}}function PB(n,e){return n.distance-e.distance}function eC(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)eC(r[s],e,t,!0)}}class NB{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(mn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"159"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="159"),new Z(7837819),new Z(8280859),new Z(4612974),new Z(8295294),new Z(9547681),new Z(3233839),new Z(3568944),new Z(16442160),new Z(8832927),new Z(1131367),new Z(6382612),new Z(12295171),new Z(9061405),new Z(10199343),new Z(14799969);const Ra={white:new Z(16777215),black:new Z(0),grey:new Z(8421504),background:new Z(0),bg:new Z(10526880),gray:new Z(7829367),darkGreen:new Z(25600),midGreen:new Z(941139),lightGreen:new Z(557426),red:new Z(12063238),buttonBackground:new Z(7829367),buttonFontColor:new Z(2236962),hoveredBackground:new Z(10066329),hoveredFontColor:new Z(16777215)},GB=(new Z(16711680),new Z(16759552),new Z(16776960),new Z(65280),new Z(255),new Z(9699517),new Z(13107435),{camera:{name:"Default Camera",type:"Perspective",near:.1,far:200,fov:40,width:window.innerWidth||500,height:window.innerHeight||700,position:{x:0,y:1.6,z:0},rotation:{x:0,y:0,z:0}},width:window.innerWidth||400,height:window.innerHeight||700,lights:{name:"Default Light",type:"directional",x:2,y:10,z:-2,color:16777215,intensity:2,width:10,near:.1,far:30,castShadow:!0,useHelpers:!1,helper:!0},xrMode:"inline",controls:{type:"orbit"},background:Ra.background,fog:{color:0,near:1500,far:4e3}});class Kae{static createButton(e,t={}){const i=document.createElement("button");function r(l){let u=null;function h(p){return d.apply(this,arguments)}function d(){return(d=Fn(function*(p){p.addEventListener("end",f),yield e.xr.setSession(p),i.textContent="STOP XR",u=p})).apply(this,arguments)}function f(){u.removeEventListener("end",f),i.textContent="START XR",u=null}i.style.display="",i.style.cursor="pointer",i.style.left="calc(50% - 50px)",i.style.width="100px",i.textContent="START XR",i.onmouseenter=function(){i.style.opacity="1.0"},i.onmouseleave=function(){i.style.opacity="0.5"},i.onclick=function(){if(null===u){const p={...t,optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers",...t.optionalFeatures||[]]};navigator.xr.requestSession(l,p).then(h)}else u.end()}}function s(){i.style.display="",i.style.cursor="auto",i.style.left="calc(50% - 75px)",i.style.width="150px",i.onmouseenter=null,i.onmouseleave=null,i.onclick=null}function a(l){s(),console.warn("Exception when trying to call xr.isSessionSupported",l),i.textContent="XR NOT ALLOWED"}function c(l){l.style.position="absolute",l.style.bottom="20px",l.style.padding="12px 6px",l.style.border="1px solid #fff",l.style.borderRadius="4px",l.style.background="rgba(0,0,0,0.1)",l.style.color="#fff",l.style.font="normal 13px sans-serif",l.style.textAlign="center",l.style.opacity="0.5",l.style.outline="none",l.style.zIndex="999"}if("xr"in navigator)return i.id="XRButton",i.style.display="none",c(i),navigator.xr.isSessionSupported("immersive-ar").then(function(l){l?r("immersive-ar"):navigator.xr.isSessionSupported("immersive-vr").then(function(u){u?r("immersive-vr"):function o(){s(),i.textContent="XR NOT SUPPORTED"}()}).catch(a)}).catch(a),i;{const l=document.createElement("a");return!1===window.isSecureContext?(l.href=document.location.href.replace(/^http:/,"https:"),l.innerHTML="WEBXR NEEDS HTTPS"):(l.href="https://immersiveweb.dev/",l.innerHTML="WEBXR NOT AVAILABLE"),l.style.left="calc(50% - 90px)",l.style.width="180px",l.style.textDecoration="none",c(l),l}}}function WB(n,e){if(0===e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(2===e||1===e){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let c=0;c<a.count;c++)o.push(c);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class jB extends Oh{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new ice(t)}),this.register(function(t){return new dce(t)}),this.register(function(t){return new fce(t)}),this.register(function(t){return new pce(t)}),this.register(function(t){return new sce(t)}),this.register(function(t){return new oce(t)}),this.register(function(t){return new ace(t)}),this.register(function(t){return new cce(t)}),this.register(function(t){return new nce(t)}),this.register(function(t){return new lce(t)}),this.register(function(t){return new rce(t)}),this.register(function(t){return new hce(t)}),this.register(function(t){return new uce(t)}),this.register(function(t){return new ece(t)}),this.register(function(t){return new mce(t)}),this.register(function(t){return new gce(t)})}load(e,t,i,r){const s=this;let o;if(""!==this.resourcePath)o=this.resourcePath;else if(""!==this.path){const l=Gc.extractUrlBase(e);o=Gc.resolveURL(l,this.path)}else o=Gc.extractUrlBase(e);this.manager.itemStart(e);const a=function(l){r?r(l):console.error(l),s.manager.itemError(e),s.manager.itemEnd(e)},c=new Pr(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{s.parse(l,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},c=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===$B){try{o[xt.KHR_BINARY_GLTF]=new _ce(e)}catch(h){return void(r&&r(h))}s=JSON.parse(o[xt.KHR_BINARY_GLTF].content)}else s=JSON.parse(c.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new Ice(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const h=this.pluginCallbacks[u](l);h.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[h.name]=h,o[h.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const h=s.extensionsUsed[u],d=s.extensionsRequired||[];switch(h){case xt.KHR_MATERIALS_UNLIT:o[h]=new tce;break;case xt.KHR_DRACO_MESH_COMPRESSION:o[h]=new vce(s,this.dracoLoader);break;case xt.KHR_TEXTURE_TRANSFORM:o[h]=new yce;break;case xt.KHR_MESH_QUANTIZATION:o[h]=new wce;break;default:d.indexOf(h)>=0&&void 0===a[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function Qae(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const xt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ece{constructor(e){this.parser=e,this.name=xt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let l;const u=new Z(16777215);void 0!==c.color&&u.setRGB(c.color[0],c.color[1],c.color[2],Qn);const h=void 0!==c.range?c.range:0;switch(c.type){case"directional":l=new ry(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new YM(u),l.distance=h;break;case"spot":l=new qM(u),l.distance=h,c.spot=c.spot||{},c.spot.innerConeAngle=void 0!==c.spot.innerConeAngle?c.spot.innerConeAngle:0,c.spot.outerConeAngle=void 0!==c.spot.outerConeAngle?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),l.decay=2,Na(l,c),void 0!==c.intensity&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(l),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(c){return i._getNodeRef(t.cache,a,c)})}}class tce{constructor(){this.name=xt.KHR_MATERIALS_UNLIT}getMaterialType(){return di}extendParams(e,t,i){const r=[];e.color=new Z(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Qn),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,Wt))}return Promise.all(r)}}class nce{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class ice{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Y(a,a)}return Promise.all(s)}}class rce{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class sce{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Z(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];if(void 0!==o.sheenColorFactor){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Qn)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Wt)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class oce{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class ace{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=(new Z).setRGB(a[0],a[1],a[2],Qn),Promise.all(s)}}class cce{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class lce{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=(new Z).setRGB(a[0],a[1],a[2],Qn),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,Wt)),Promise.all(s)}}class uce{constructor(e){this.parser=e,this.name=xt.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return t.bumpScale=void 0!==o.bumpFactor?o.bumpFactor:1,void 0!==o.bumpTexture&&s.push(i.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class hce{constructor(e){this.parser=e,this.name=xt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?ts:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class dce{constructor(e){this.parser=e,this.name=xt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class fce{constructor(e){this.parser=e,this.name=xt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=i.textureLoader;if(a.uri){const l=i.options.manager.getHandler(a.uri);null!==l&&(c=l)}return this.detectSupport().then(function(l){if(l)return i.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class pce{constructor(e){this.parser=e,this.name=xt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let c=i.textureLoader;if(a.uri){const l=i.options.manager.getHandler(a.uri);null!==l&&(c=l)}return this.detectSupport().then(function(l){if(l)return i.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class mce{constructor(e){this.name=xt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const u=r.count,h=r.byteStride,d=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,h,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(u*h);return o.decodeGltfBuffer(new Uint8Array(f),u,h,d,r.mode,r.filter),f})})}return null}}class gce{constructor(e){this.name=xt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const l of r.primitives)if(l.mode!==ns.TRIANGLES&&l.mode!==ns.TRIANGLE_STRIP&&l.mode!==ns.TRIANGLE_FAN&&void 0!==l.mode)return null;const o=i.extensions[this.name].attributes,a=[],c={};for(const l in o)a.push(this.parser.getDependency("accessor",o[l]).then(u=>(c[l]=u,c[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(l=>{const u=l.pop(),h=u.isGroup?u.children:[u],d=l[0].count,f=[];for(const p of h){const m=new Ge,_=new A,g=new hi,v=new A(1,1,1),y=new Ov(p.geometry,p.material,d);for(let w=0;w<d;w++)c.TRANSLATION&&_.fromBufferAttribute(c.TRANSLATION,w),c.ROTATION&&g.fromBufferAttribute(c.ROTATION,w),c.SCALE&&v.fromBufferAttribute(c.SCALE,w),y.setMatrixAt(w,m.compose(_,g,v));for(const w in c)if("_COLOR_0"===w){const x=c[w];y.instanceColor=new Mh(x.array,x.itemSize,x.normalized)}else"TRANSLATION"!==w&&"ROTATION"!==w&&"SCALE"!==w&&p.geometry.setAttribute(w,c[w]);gn.prototype.copy.call(y,p),this.parser.assignFinalMaterial(y),f.push(y)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}}const $B="glTF";class _ce{constructor(e){this.name=xt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==$B)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const c=s.getUint32(o,!0);if(o+=4,1313821514===c){const l=new Uint8Array(e,12+o,a);this.content=i.decode(l)}else if(5130562===c){const l=12+o;this.body=e.slice(l,l+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class vce{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=xt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},c={},l={};for(const u in o){const h=oC[u]||u.toLowerCase();a[h]=o[u]}for(const u in e.attributes){const h=oC[u]||u.toLowerCase();if(void 0!==o[u]){const d=i.accessors[e.attributes[u]];l[h]=Fh[d.componentType].name,c[h]=!0===d.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(h){r.decodeDracoFile(u,function(d){for(const f in d.attributes){const m=c[f];void 0!==m&&(d.attributes[f].normalized=m)}h(d)},a,l)})})}}class yce{constructor(){this.name=xt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class wce{constructor(){this.name=xt.KHR_MESH_QUANTIZATION}}class XB extends mp{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=2*a,l=3*a,u=r-t,h=(i-t)/u,d=h*h,f=d*h,p=e*l,m=p-l,_=-2*f+3*d,g=f-d,v=1-_,y=g-d+h;for(let w=0;w!==a;w++)s[w]=v*o[m+w+a]+y*(o[m+w+c]*u)+_*o[p+w+a]+g*(o[p+w]*u);return s}}const xce=new hi;class bce extends XB{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return xce.fromArray(s).normalize().toArray(s),s}}const ns={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Fh={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},YB={9728:Cn,9729:an,9984:1004,9985:1007,9986:1005,9987:Mo},ZB={33071:wi,33648:1002,10497:Cr},sC={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},oC={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Pa={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Ece={CUBICSPLINE:void 0,LINEAR:qu,STEP:qf};function Yc(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Na(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Cce(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Tce(n){let e;const t=n.extensions&&n.extensions[xt.KHR_DRACO_MESH_COMPRESSION];if(e=t?"draco:"+t.bufferView+":"+t.indices+":"+cC(t.attributes):n.indices+":"+cC(n.attributes)+":"+n.mode,void 0!==n.targets)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+cC(n.targets[i]);return e}function cC(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function lC(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Dce=new Ge;class Ice{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Qae,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new GM(this.options.manager):new Rae(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Pr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};return Yc(s,a,r),Na(a,r),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,c=o.length;a<c;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const c=this.associations.get(o);null!=c&&this.associations.set(a,c);for(const[l,u]of o.children.entries())s(u,a.children[l])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[xt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Gc.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=sC[r.type],c=!0===r.normalized,l=new(0,Fh[r.componentType])(r.count*o);return Promise.resolve(new jt(l,o,c))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],c=sC[r.type],l=Fh[r.componentType],u=l.BYTES_PER_ELEMENT,d=r.byteOffset||0,f=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let m,_;if(f&&f!==u*c){const g=Math.floor(d/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let y=t.cache.get(v);y||(m=new l(a,g*f,r.count*f/u),y=new fM(m,f/u),t.cache.add(v,y)),_=new Oc(y,c,d%f/u,p)}else m=null===a?new l(r.count*c):new l(a,d,r.count*c),_=new jt(m,c,p);if(void 0!==r.sparse){const w=r.sparse.values.byteOffset||0,x=new(0,Fh[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*sC.SCALAR),E=new l(o[2],w,r.sparse.count*c);null!==a&&(_=new jt(_.array.slice(),_.itemSize,_.normalized));for(let S=0,M=x.length;S<M;S++){const b=x[S];if(_.setX(b,E[S*c]),c>=2&&_.setY(b,E[S*c+1]),c>=3&&_.setZ(b,E[S*c+2]),c>=4&&_.setW(b,E[S*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return _})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const c=this.options.manager.getHandler(o.uri);null!==c&&(a=c)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],c=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];const l=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",""===u.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(u.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=YB[d.magFilter]||an,u.minFilter=YB[d.minFilter]||Mo,u.wrapS=ZB[d.wrapS]||Cr,u.wrapT=ZB[d.wrapT]||Cr,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[c]=l,l}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let c=o.uri||"",l=!1;if(void 0!==o.bufferView)c=this.getDependency("bufferView",o.bufferView).then(function(h){l=!0;const d=new Blob([h],{type:o.mimeType});return c=a.createObjectURL(d),c});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(c).then(function(h){return new Promise(function(d,f){let p=d;!0===t.isImageBitmapLoader&&(p=function(m){const _=new Qr(m);_.needsUpdate=!0,d(_)}),t.load(Gc.resolveURL(h,s.path),p,void 0,f)})}).then(function(h){return!0===l&&a.revokeObjectURL(c),h.userData.mimeType=o.mimeType||function Ace(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),h});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&i.texCoord>0&&((o=o.clone()).channel=i.texCoord),s.extensions[xt.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[xt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=s.associations.get(o);o=s.extensions[xt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,c)}}return void 0!==r&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new xM,cr.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(a,c)),i=c}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let c=this.cache.get(a);c||(c=new Mi,cr.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,this.cache.add(a,c)),i=c}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=i.clone(),s&&(c.vertexColors=!0),o&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(i))),i=c}e.material=i}getMaterialType(){return Da}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=[];if((s.extensions||{})[xt.KHR_MATERIALS_UNLIT]){const h=r[xt.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),l.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new Z(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],Qn),a.opacity=d[3]}void 0!==h.baseColorTexture&&l.push(t.assignTexture(a,"map",h.baseColorTexture,Wt)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(l.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==di&&(l.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Y(1,1),void 0!==s.normalTexture.scale)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}if(void 0!==s.occlusionTexture&&o!==di&&(l.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==di){const h=s.emissiveFactor;a.emissive=(new Z).setRGB(h[0],h[1],h[2],Qn)}return void 0!==s.emissiveTexture&&o!==di&&l.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Wt)),Promise.all(l).then(function(){const h=new o(a);return s.name&&(h.name=s.name),Na(h,s),t.associations.set(h,{materials:e}),s.extensions&&Yc(r,h,s),h})}createUniqueName(e){const t=Jt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[xt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return KB(c,a,t)})}const o=[];for(let a=0,c=e.length;a<c;a++){const l=e[a],u=Tce(l),h=r[u];if(h)o.push(h.promise);else{let d;d=l.extensions&&l.extensions[xt.KHR_DRACO_MESH_COMPRESSION]?s(l):KB(new ot,l,t),r[u]={primitive:l,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let c=0,l=o.length;c<l;c++){const u=void 0===o[c].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new Da({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),n.DefaultMaterial):this.getDependency("material",o[c].material);a.push(u)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(c){const l=c.slice(0,c.length-1),u=c[c.length-1],h=[];for(let f=0,p=u.length;f<p;f++){const m=u[f],_=o[f];let g;const v=l[f];if(_.mode===ns.TRIANGLES||_.mode===ns.TRIANGLE_STRIP||_.mode===ns.TRIANGLE_FAN||void 0===_.mode)g=!0===s.isSkinnedMesh?new UU(m,v):new Ot(m,v),!0===g.isSkinnedMesh&&g.normalizeSkinWeights(),_.mode===ns.TRIANGLE_STRIP?g.geometry=WB(g.geometry,1):_.mode===ns.TRIANGLE_FAN&&(g.geometry=WB(g.geometry,2));else if(_.mode===ns.LINES)g=new Bv(m,v);else if(_.mode===ns.LINE_STRIP)g=new Lo(m,v);else if(_.mode===ns.LINE_LOOP)g=new YU(m,v);else{if(_.mode!==ns.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_.mode);g=new KU(m,v)}Object.keys(g.geometry.morphAttributes).length>0&&Cce(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),Na(g,s),_.extensions&&Yc(r,g,_),t.assignFinalMaterial(g),h.push(g)}for(let f=0,p=h.length;f<p;f++)t.associations.set(h[f],{meshes:e,primitives:f});if(1===h.length)return s.extensions&&Yc(r,h[0],s),h[0];const d=new Ss;s.extensions&&Yc(r,d,s),t.associations.set(d,{meshes:e});for(let f=0,p=h.length;f<p;f++)d.add(h[f]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new ti(Cc_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new Ev(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Na(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],c=[];for(let l=0,u=o.length;l<u;l++){const h=o[l];if(h){a.push(h);const d=new Ge;null!==s&&d.fromArray(s.array,16*l),c.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new Nv(a,c)})}loadAnimation(e){const i=this,r=this.json.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],c=[],l=[],u=[];for(let h=0,d=r.channels.length;h<d;h++){const f=r.channels[h],p=r.samplers[f.sampler],m=f.target,g=void 0!==r.parameters?r.parameters[p.input]:p.input,v=void 0!==r.parameters?r.parameters[p.output]:p.output;void 0!==m.node&&(o.push(this.getDependency("node",m.node)),a.push(this.getDependency("accessor",g)),c.push(this.getDependency("accessor",v)),l.push(p),u.push(m))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c),Promise.all(l),Promise.all(u)]).then(function(h){const d=h[0],f=h[1],p=h[2],m=h[3],_=h[4],g=[];for(let v=0,y=d.length;v<y;v++){const w=d[v],x=f[v],E=p[v],S=m[v],M=_[v];if(void 0===w)continue;w.updateMatrix&&w.updateMatrix();const b=i._createAnimationTracks(w,x,E,S,M);if(b)for(let C=0;C<b.length;C++)g.push(b[C])}return new gp(s,void 0,g)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let c=0,l=r.weights.length;c<l;c++)a.morphTargetInfluences[c]=r.weights[c]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let l=0,u=a.length;l<u;l++)o.push(i.getDependency("node",a[l]));const c=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),c]).then(function(l){const u=l[0],h=l[1],d=l[2];null!==d&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(d,Dce)});for(let f=0,p=h.length;f<p;f++)u.add(h[f]);return u})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],c=r._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return c&&a.push(c),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(l){return r._getNodeRef(r.cameraCache,s.camera,l)})),r._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),this.nodeCache[e]=Promise.all(a).then(function(l){let u;if(u=!0===s.isBone?new _M:l.length>1?new Ss:1===l.length?l[0]:new gn,u!==l[0])for(let h=0,d=l.length;h<d;h++)u.add(l[h]);if(s.name&&(u.userData.name=s.name,u.name=o),Na(u,s),s.extensions&&Yc(i,u,s),void 0!==s.matrix){const h=new Ge;h.fromArray(s.matrix),u.applyMatrix4(h)}else void 0!==s.translation&&u.position.fromArray(s.translation),void 0!==s.rotation&&u.quaternion.fromArray(s.rotation),void 0!==s.scale&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Ss;i.name&&(s.name=r.createUniqueName(i.name)),Na(s,i),i.extensions&&Yc(t,s,i);const o=i.nodes||[],a=[];for(let c=0,l=o.length;c<l;c++)a.push(r.getDependency("node",o[c]));return Promise.all(a).then(function(c){for(let u=0,h=c.length;u<h;u++)s.add(c[u]);return r.associations=(u=>{const h=new Map;for(const[d,f]of r.associations)(d instanceof cr||d instanceof Qr)&&h.set(d,f);return u.traverse(d=>{const f=r.associations.get(d);null!=f&&h.set(d,f)}),h})(s),s})}_createAnimationTracks(e,t,i,r,s){const o=[],a=e.name?e.name:e.uuid,c=[];let l;switch(Pa[s.path]===Pa.weights?e.traverse(function(d){d.morphTargetInfluences&&c.push(d.name?d.name:d.uuid)}):c.push(a),Pa[s.path]){case Pa.weights:l=Rh;break;case Pa.rotation:l=Hc;break;case Pa.position:case Pa.scale:l=Nh;break;default:l=1===i.itemSize?Rh:Nh}const u=void 0!==r.interpolation?Ece[r.interpolation]:qu,h=this._getArrayFromAccessor(i);for(let d=0,f=c.length;d<f;d++){const p=new l(c[d]+"."+Pa[s.path],t.array,h,u);"CUBICSPLINE"===r.interpolation&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=lC(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){return new(this instanceof Hc?bce:XB)(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function KB(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(c){n.setAttribute(a,c)})}for(const o in i){const a=oC[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Lt.workingColorSpace!==Qn&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Lt.workingColorSpace}" not supported.`),Na(n,e),function Rce(n,e,t){const i=e.attributes,r=new Wi;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],c=a.min,l=a.max;if(void 0===c||void 0===l)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new A(c[0],c[1],c[2]),new A(l[0],l[1],l[2])),a.normalized){const u=lC(Fh[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new A,c=new A;for(let l=0,u=s.length;l<u;l++){const h=s[l];if(void 0!==h.POSITION){const d=t.json.accessors[h.POSITION],f=d.min,p=d.max;if(void 0!==f&&void 0!==p){if(c.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),c.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),c.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const m=lC(Fh[d.componentType]);c.multiplyScalar(m)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new bi;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function Mce(n,e,t){let i=!1,r=!1,s=!1;for(let l=0,u=e.length;l<u;l++){const h=e[l];if(void 0!==h.POSITION&&(i=!0),void 0!==h.NORMAL&&(r=!0),void 0!==h.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],c=[];for(let l=0,u=e.length;l<u;l++){const h=e[l];if(i){const d=void 0!==h.POSITION?t.getDependency("accessor",h.POSITION):n.attributes.position;o.push(d)}if(r){const d=void 0!==h.NORMAL?t.getDependency("accessor",h.NORMAL):n.attributes.normal;a.push(d)}if(s){const d=void 0!==h.COLOR_0?t.getDependency("accessor",h.COLOR_0):n.attributes.color;c.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(l){const h=l[1],d=l[2];return i&&(n.morphAttributes.position=l[0]),r&&(n.morphAttributes.normal=h),s&&(n.morphAttributes.color=d),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const vn={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};function JB(n){return uC.apply(this,arguments)}function uC(){return(uC=Fn(function*(n){const e=yield fetch(n);if(e.ok)return e.json();throw new Error(e.statusText)})).apply(this,arguments)}function hC(){return(hC=Fn(function*(n){if(!n)throw new Error("No basePath supplied");return yield JB(`${n}/profilesList.json`)})).apply(this,arguments)}function dC(){return dC=Fn(function*(n,e,t=null,i=!0){if(!n)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=yield function Pce(n){return hC.apply(this,arguments)}(e);let s;if(n.profiles.some(c=>{const l=r[c];return l&&(s={profileId:c,profilePath:`${e}/${l.path}`,deprecated:!!l.deprecated}),!!s}),!s){if(!t)throw new Error("No matching profile name found");const c=r[t];if(!c)throw new Error(`No matching profile name found and default profile "${t}" missing.`);s={profileId:t,profilePath:`${e}/${c.path}`,deprecated:!!c.deprecated}}const o=yield JB(s.profilePath);let a;if(i){let c;if(c="any"===n.handedness?o.layouts[Object.keys(o.layouts)[0]]:o.layouts[n.handedness],!c)throw new Error(`No matching handedness, ${n.handedness}, in profile ${s.profileId}`);c.assetPath&&(a=s.profilePath.replace("profile.json",c.assetPath))}return{profile:o,assetPath:a}}),dC.apply(this,arguments)}const Lce={xAxis:0,yAxis:0,button:0,state:vn.ComponentState.DEFAULT};class Fce{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===vn.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(Lce)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:r}){const{normalizedXAxis:s,normalizedYAxis:o}=function Oce(n=0,e=0){let t=n,i=e;if(Math.sqrt(n*n+e*e)>1){const o=Math.atan2(e,n);t=Math.cos(o),i=Math.sin(o)}return{normalizedXAxis:.5*t+.5,normalizedYAxis:.5*i+.5}}(e,t);switch(this.componentProperty){case vn.ComponentProperty.X_AXIS:this.value=this.states.includes(r)?s:.5;break;case vn.ComponentProperty.Y_AXIS:this.value=this.states.includes(r)?o:.5;break;case vn.ComponentProperty.BUTTON:this.value=this.states.includes(r)?i:0;break;case vn.ComponentProperty.STATE:this.value=this.valueNodeProperty===vn.VisualResponseProperty.VISIBILITY?this.states.includes(r):this.states.includes(r)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class kce{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach(i=>{const r=new Fce(t.visualResponses[i]);this.visualResponses[i]=r}),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:vn.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=vn.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=vn.ComponentState.PRESSED:(t.touched||this.values.button>vn.ButtonTouchThreshold)&&(this.values.state=vn.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===vn.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>vn.AxisTouchThreshold&&(this.values.state=vn.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===vn.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>vn.AxisTouchThreshold&&(this.values.state=vn.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach(t=>{t.updateFromComponent(this.values)})}}class Uce{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach(r=>{this.components[r]=new kce(r,this.layoutDescription.components[r])}),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach(t=>{e.push(t.data)}),e}updateFromGamepad(){Object.values(this.components).forEach(e=>{e.updateFromGamepad(this.xrInputSource.gamepad)})}}class zce extends gn{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse(t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)})),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach(t=>{Object.values(t.visualResponses).forEach(i=>{const{valueNode:r,minNode:s,maxNode:o,value:a,valueNodeProperty:c}=i;r&&(c===vn.VisualResponseProperty.VISIBILITY?r.visible=a:c===vn.VisualResponseProperty.TRANSFORM&&(r.quaternion.slerpQuaternions(s.quaternion,o.quaternion,a),r.position.lerpVectors(s.position,o.position,a)))})}))}}function QB(n,e){(function Hce(n,e){Object.values(n.components).forEach(t=>{const{type:i,touchPointNodeName:r,visualResponses:s}=t;if(i===vn.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(r),t.touchPointNode){const o=new Vc(.001),a=new di({color:255}),c=new Ot(o,a);t.touchPointNode.add(c)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(s).forEach(o=>{const{valueNodeName:a,minNodeName:c,maxNodeName:l,valueNodeProperty:u}=o;if(u===vn.VisualResponseProperty.TRANSFORM){if(o.minNode=e.getObjectByName(c),o.maxNode=e.getObjectByName(l),!o.minNode)return void console.warn(`Could not find ${c} in the model`);if(!o.maxNode)return void console.warn(`Could not find ${l} in the model`)}o.valueNode=e.getObjectByName(a),o.valueNode||console.warn(`Could not find ${a} in the model`)})})})(n.motionController,e),n.envMap&&e.traverse(t=>{t.isMesh&&(t.material.envMap=n.envMap,t.material.needsUpdate=!0)}),n.add(e)}class e3{constructor(e=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new jB)}createControllerModel(e){const t=new zce;let i=null;return e.addEventListener("connected",r=>{const s=r.data;"tracked-pointer"!==s.targetRayMode||!s.gamepad||function Nce(n,e){return dC.apply(this,arguments)}(s,this.path,"generic-trigger").then(({profile:o,assetPath:a})=>{t.motionController=new Uce(s,o,a);const c=this._assetCache[t.motionController.assetUrl];if(c)i=c.scene.clone(),QB(t,i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,l=>{this._assetCache[t.motionController.assetUrl]=l,i=l.scene.clone(),QB(t,i)},null,()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)})}}).catch(o=>{console.warn(o)})}),e.addEventListener("disconnected",()=>{t.motionController=null,t.remove(i),i=null}),t}}var yp=function(){var n=0,e=document.createElement("div");function t(u){return e.appendChild(u.dom),u}function i(u){for(var h=0;h<e.children.length;h++)e.children[h].style.display=h===u?"block":"none";n=u}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(u){u.preventDefault(),i(++n%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,a=t(new yp.Panel("FPS","#0ff","#002")),c=t(new yp.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=t(new yp.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:e,addPanel:t,showPanel:i,begin:function(){r=(performance||Date).now()},end:function(){o++;var u=(performance||Date).now();if(c.update(u-r,200),u>=s+1e3&&(a.update(1e3*o/(u-s),100),s=u,o=0,l)){var h=performance.memory;l.update(h.usedJSHeapSize/1048576,h.jsHeapSizeLimit/1048576)}return u},update:function(){r=this.end()},domElement:e,setMode:i}};yp.Panel=function(n,e,t){var i=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,c=48*o,l=3*o,u=2*o,h=3*o,d=15*o,f=74*o,p=30*o,m=document.createElement("canvas");m.width=a,m.height=c,m.style.cssText="width:80px;height:48px";var _=m.getContext("2d");return _.font="bold "+9*o+"px Helvetica,Arial,sans-serif",_.textBaseline="top",_.fillStyle=t,_.fillRect(0,0,a,c),_.fillStyle=e,_.fillText(n,l,u),_.fillRect(h,d,f,p),_.fillStyle=t,_.globalAlpha=.9,_.fillRect(h,d,f,p),{dom:m,update:function(g,v){i=Math.min(i,g),r=Math.max(r,g),_.fillStyle=t,_.globalAlpha=1,_.fillRect(0,0,a,d),_.fillStyle=e,_.fillText(s(g)+" "+n+" ("+s(i)+"-"+s(r)+")",l,u),_.drawImage(m,h+o,d,f-o,p,h,d,f-o,p),_.fillRect(h+f-o,d,o,p),_.fillStyle=t,_.globalAlpha=.9,_.fillRect(h+f-o,d,o,s((1-g/v)*p))}}};const t3=yp;class Gce extends t3.Panel{constructor(e,t="GPU MS"){super(t,"#f90","#210");let i=!0,r=e.getExtension("EXT_disjoint_timer_query_webgl2");null===r&&(i=!1,r=e.getExtension("EXT_disjoint_timer_query"),null===r&&console.warn("GPUStatsPanel: disjoint_time_query extension not available.")),this.context=e,this.extension=r,this.maxTime=30,this.activeQueries=0,this.startQuery=function(){const s=this.context,o=this.extension;if(null===o)return;let a;i?(a=s.createQuery(),s.beginQuery(o.TIME_ELAPSED_EXT,a)):(a=o.createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,a)),this.activeQueries++;const c=()=>{let l,u,h;i?(l=s.getQueryParameter(a,s.QUERY_RESULT_AVAILABLE),u=s.getParameter(o.GPU_DISJOINT_EXT),h=s.getQueryParameter(a,s.QUERY_RESULT)):(l=o.getQueryObjectEXT(a,o.QUERY_RESULT_AVAILABLE_EXT),u=s.getParameter(o.GPU_DISJOINT_EXT),h=o.getQueryObjectEXT(a,o.QUERY_RESULT_EXT)),l?(u||this.update(1e-6*h,this.maxTime),this.activeQueries--):!1===s.isContextLost()&&requestAnimationFrame(c)};requestAnimationFrame(c)},this.endQuery=function(){const s=this.extension;null!==s&&(i?this.context.endQuery(s.TIME_ELAPSED_EXT):s.endQueryEXT(s.TIME_ELAPSED_EXT))}}}function Uo(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function n3(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}var fC,Ci,yn,ln,rs,yC,wC,c3,h3,Hh,Ap,c,l,u,h,d,f,n,e,t,i,r,s,o,a,p,Nr={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},kh={duration:.5,overwrite:!1,delay:0},is=1e8,$t=1e-8,pC=2*Math.PI,Wce=pC/4,jce=0,i3=Math.sqrt,$ce=Math.cos,qce=Math.sin,ni=function(e){return"string"==typeof e},wn=function(e){return"function"==typeof e},Bo=function(e){return"number"==typeof e},mC=function(e){return typeof e>"u"},Qs=function(e){return"object"==typeof e},ur=function(e){return!1!==e},gC=function(){return typeof window<"u"},dy=function(e){return wn(e)||ni(e)},r3="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Ti=Array.isArray,_C=/(?:-?\.?\d|\.)+/gi,s3=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Uh=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,vC=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,o3=/[+-]=-?[.\d]+/,a3=/[^,'"\[\]\s]+/gi,Xce=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Lr={},fy={},l3=function(e){return(fy=Kc(e,Lr))&&fr},xC=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},wp=function(e,t){return!t&&console.warn(e)},u3=function(e,t){return e&&(Lr[e]=t)&&fy&&(fy[e]=t)||Lr},xp=function(){return 0},Yce={suppressEvents:!0,isStart:!0,kill:!1},py={suppressEvents:!0,kill:!1},Zce={suppressEvents:!0},bC={},La=[],EC={},Or={},SC={},d3=30,my=[],MC="",CC=function(e){var i,r,t=e[0];if(Qs(t)||wn(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(r=my.length;r--&&!my[r].targetTest(t););i=my[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new z3(e[r],i)))||e.splice(r,1);return e},Zc=function(e){return e._gsap||CC(as(e))[0]._gsap},f3=function(e,t,i){return(i=e[t])&&wn(i)?e[t]():mC(i)&&e.getAttribute&&e.getAttribute(t)||i},hr=function(e,t){return(e=e.split(",")).forEach(t)||e},An=function(e){return Math.round(1e5*e)/1e5||0},ii=function(e){return Math.round(1e7*e)/1e7||0},Bh=function(e,t){var i=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),"+"===i?e+r:"-"===i?e-r:"*"===i?e*r:e/r},Kce=function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i},gy=function(){var i,r,e=La.length,t=La.slice(0);for(EC={},La.length=0,i=0;i<e;i++)(r=t[i])&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},p3=function(e,t,i,r){La.length&&!Ci&&gy(),e.render(t,i,r||Ci&&t<0&&(e._initted||e._startAt)),La.length&&!Ci&&gy()},m3=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(a3).length<2?t:ni(e)?e.trim():e},g3=function(e){return e},ss=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Kc=function(e,t){for(var i in t)e[i]=t[i];return e},_3=function n(e,t){for(var i in t)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=Qs(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},_y=function(e,t){var r,i={};for(r in e)r in t||(i[r]=e[r]);return i},bp=function(e){var t=e.parent||ln,i=e.keyframes?function(e){return function(t,i){for(var r in i)r in t||"duration"===r&&e||"ease"===r||(t[r]=i[r])}}(Ti(e.keyframes)):ss;if(ur(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},v3=function(e,t,i,r,s){void 0===i&&(i="_first"),void 0===r&&(r="_last");var a,o=e[r];if(s)for(a=t[s];o&&o[s]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},vy=function(e,t,i,r){void 0===i&&(i="_first"),void 0===r&&(r="_last");var s=t._prev,o=t._next;s?s._next=o:e[i]===t&&(e[i]=o),o?o._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},Oa=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Jc=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},TC=function(e,t,i,r){return e._startAt&&(Ci?e._startAt.revert(py):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},tle=function n(e){return!e||e._ts&&n(e.parent)},y3=function(e){return e._repeat?Vh(e._tTime,e=e.duration()+e._rDelay)*e:0},Vh=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},yy=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},wy=function(e){return e._end=ii(e._start+(e._tDur/Math.abs(e._ts||e._rts||$t)||0))},xy=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=ii(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),wy(e),i._dirty||Jc(i,e)),e},w3=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=yy(e.rawTime(),t),(!t._dur||Sp(0,t.totalDuration(),i)-t._tTime>$t)&&t.render(i,!0)),Jc(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-$t}},eo=function(e,t,i,r){return t.parent&&Oa(t),t._start=ii((Bo(i)?i:i||e!==ln?os(e,i,t):e._time)+t._delay),t._end=ii(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),v3(e,t,"_first","_last",e._sort?"_start":0),AC(t)||(e._recent=t),r||w3(e,t),e._ts<0&&xy(e,e._tTime),e},x3=function(e,t){return(Lr.ScrollTrigger||xC("scrollTrigger",t))&&Lr.ScrollTrigger.create(t,e)},b3=function(e,t,i,r,s){return kC(e,t,s),e._initted?!i&&e._pt&&!Ci&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&h3!==kr.frame?(La.push(e),e._lazy=[s,r],1):void 0:1},nle=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},AC=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},zh=function(e,t,i,r){var s=e._repeat,o=ii(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=s?s<0?1e10:ii(o*(s+1)+e._rDelay*s):o,a>0&&!r&&xy(e,e._tTime=e._tDur*a),e.parent&&wy(e),i||Jc(e.parent,e),e},E3=function(e){return e instanceof qi?Jc(e):zh(e,e._dur)},sle={_start:0,endTime:xp,totalDuration:xp},os=function n(e,t,i){var a,c,l,r=e.labels,s=e._recent||sle,o=e.duration()>=is?s.endTime(!1):e._dur;return ni(t)&&(isNaN(t)||t in r)?(c=t.charAt(0),l="%"===t.substr(-1),a=t.indexOf("="),"<"===c||">"===c?(a>=0&&(t=t.replace(/=/,"")),("<"===c?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(l?(a<0?s:i).totalDuration()/100:1)):a<0?(t in r||(r[t]=o),r[t]):(c=parseFloat(t.charAt(a-1)+t.substr(a+1)),l&&i&&(c=c/100*(Ti(i)?i[0]:i).totalDuration()),a>1?n(e,t.substr(0,a-1),i)+c:o+c)):null==t?o:+t},Ep=function(e,t,i){var a,c,r=Bo(t[1]),s=(r?2:1)+(e<2?0:1),o=t[s];if(r&&(o.duration=t[1]),o.parent=i,e){for(a=o,c=i;c&&!("immediateRender"in a);)a=c.vars.defaults||{},c=ur(c.vars.inherit)&&c.parent;o.immediateRender=ur(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[s-1]}return new Un(t[0],o,t[s+1])},Fa=function(e,t){return e||0===e?t(e):t},Sp=function(e,t,i){return i<e?e:i>t?t:i},Ai=function(e,t){return ni(e)&&(t=Xce.exec(e))?t[1]:""},DC=[].slice,S3=function(e,t){return e&&Qs(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Qs(e[0]))&&!e.nodeType&&e!==rs},as=function(e,t,i){return yn&&!t&&yn.selector?yn.selector(e):!ni(e)||i||!yC&&Gh()?Ti(e)?function(e,t,i){return void 0===i&&(i=[]),e.forEach(function(r){var s;return ni(r)&&!t||S3(r,1)?(s=i).push.apply(s,as(r)):i.push(r)})||i}(e,i):S3(e)?DC.call(e,0):e?[e]:[]:DC.call((t||wC).querySelectorAll(e),0)},IC=function(e){return e=as(e)[0]||wp("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return as(t,i.querySelectorAll?i:i===e?wp("Invalid scope")||wC.createElement("div"):e)}},M3=function(e){return e.sort(function(){return.5-Math.random()})},C3=function(e){if(wn(e))return e;var t=Qs(e)?e:{each:e},i=Qc(t.ease),r=t.from||0,s=parseFloat(t.base)||0,o={},a=r>0&&r<1,c=isNaN(r)||a,l=t.axis,u=r,h=r;return ni(r)?u=h={center:.5,edges:.5,end:1}[r]||0:!a&&c&&(u=r[0],h=r[1]),function(d,f,p){var g,v,y,w,x,E,S,M,b,m=(p||t).length,_=o[m];if(!_){if(!(b="auto"===t.grid?0:(t.grid||[1,is])[1])){for(S=-is;S<(S=p[b++].getBoundingClientRect().left)&&b<m;);b<m&&b--}for(_=o[m]=[],g=c?Math.min(b,m)*u-.5:r%b,v=b===is?0:c?m*h/b-.5:r/b|0,S=0,M=is,E=0;E<m;E++)y=E%b-g,w=v-(E/b|0),_[E]=x=l?Math.abs("y"===l?w:y):i3(y*y+w*w),x>S&&(S=x),x<M&&(M=x);"random"===r&&M3(_),_.max=S-M,_.min=M,_.v=m=(parseFloat(t.amount)||parseFloat(t.each)*(b>m?m-1:l?"y"===l?m/b:b:Math.max(b,m/b))||0)*("edges"===r?-1:1),_.b=m<0?s-m:s,_.u=Ai(t.amount||t.each)||0,i=i&&m<0?U3(i):i}return m=(_[d]-_.min)/_.max||0,ii(_.b+(i?i(m):m)*_.v)+_.u}},RC=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var r=ii(Math.round(parseFloat(i)/e)*e*t);return(r-r%1)/t+(Bo(i)?0:Ai(i))}},T3=function(e,t){var r,s,i=Ti(e);return!i&&Qs(e)&&(r=i=e.radius||is,e.values?(e=as(e.values),(s=!Bo(e[0]))&&(r*=r)):e=RC(e.increment)),Fa(t,i?wn(e)?function(o){return s=e(o),Math.abs(s-o)<=r?s:o}:function(o){for(var d,f,a=parseFloat(s?o.x:o),c=parseFloat(s?o.y:0),l=is,u=0,h=e.length;h--;)(d=s?(d=e[h].x-a)*d+(f=e[h].y-c)*f:Math.abs(e[h]-a))<l&&(l=d,u=h);return u=!r||l<=r?e[u]:o,s||u===o||Bo(o)?u:u+Ai(o)}:RC(e))},A3=function(e,t,i,r){return Fa(Ti(e)?!t:!0===i?!!(i=0):!r,function(){return Ti(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+.99*i))/i)*i*r)/r})},D3=function(e,t,i){return Fa(i,function(r){return e[~~t(r)]})},Mp=function(e){for(var r,s,o,a,t=0,i="";~(r=e.indexOf("random(",t));)o=e.indexOf(")",r),a="["===e.charAt(r+7),s=e.substr(r+7,o-r-7).match(a?a3:_C),i+=e.substr(t,r-t)+A3(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=o+1;return i+e.substr(t,e.length-t)},I3=function(e,t,i,r,s){var o=t-e,a=r-i;return Fa(s,function(c){return i+((c-e)/o*a||0)})},R3=function(e,t,i){var o,a,c,r=e.labels,s=is;for(o in r)(a=r[o]-t)<0==!!i&&a&&s>(a=Math.abs(a))&&(c=o,s=a);return c},Fr=function(e,t,i){var c,l,u,r=e.vars,s=r[t],o=yn,a=e._ctx;if(s)return c=r[t+"Params"],l=r.callbackScope||e,i&&La.length&&gy(),a&&(yn=a),u=c?s.apply(l,c):s.call(l),yn=o,u},Cp=function(e){return Oa(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Ci),e.progress()<1&&Fr(e,"onInterrupt"),e},P3=[],N3=function(e){if(gC()&&e){var t=(e=!e.name&&e.default||e).name,i=wn(e),r=t&&!i&&e.init?function(){this._props=[]}:e,s={init:xp,render:VC,add:OC,kill:Dle,modifier:Ale,rawVars:0},o={targetTest:0,get:0,getSetter:BC,aliases:{},register:0};if(Gh(),e!==r){if(Or[t])return;ss(r,ss(_y(e,s),o)),Kc(r.prototype,Kc(s,_y(e,o))),Or[r.prop=t]=r,e.targetTest&&(my.push(r),bC[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}u3(t,r),e.register&&e.register(fr,r,dr)}else e&&P3.push(e)},qt=255,Tp={aqua:[0,qt,qt],lime:[0,qt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,qt],navy:[0,0,128],white:[qt,qt,qt],olive:[128,128,0],yellow:[qt,qt,0],orange:[qt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[qt,0,0],pink:[qt,192,203],cyan:[0,qt,qt],transparent:[qt,qt,qt,0]},PC=function(e,t,i){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(i-t)*e*6:e<.5?i:3*e<2?t+(i-t)*(2/3-e)*6:t)*qt+.5|0},L3=function(e,t,i){var s,o,a,c,l,u,h,d,f,p,r=e?Bo(e)?[e>>16,e>>8&qt,e&qt]:0:Tp.black;if(!r){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),Tp[e])r=Tp[e];else if("#"===e.charAt(0)){if(e.length<6&&(s=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+s+s+o+o+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(r=parseInt(e.substr(1,6),16))>>16,r>>8&qt,r&qt,parseInt(e.substr(7),16)/255];r=[(e=parseInt(e.substr(1),16))>>16,e>>8&qt,e&qt]}else if("hsl"===e.substr(0,3))if(r=p=e.match(_C),t){if(~e.indexOf("="))return r=e.match(s3),i&&r.length<4&&(r[3]=1),r}else c=+r[0]%360/360,l=+r[1]/100,s=2*(u=+r[2]/100)-(o=u<=.5?u*(l+1):u+l-u*l),r.length>3&&(r[3]*=1),r[0]=PC(c+1/3,s,o),r[1]=PC(c,s,o),r[2]=PC(c-1/3,s,o);else r=e.match(_C)||Tp.transparent;r=r.map(Number)}return t&&!p&&(s=r[0]/qt,o=r[1]/qt,a=r[2]/qt,u=((h=Math.max(s,o,a))+(d=Math.min(s,o,a)))/2,h===d?c=l=0:(f=h-d,l=u>.5?f/(2-h-d):f/(h+d),c=h===s?(o-a)/f+(o<a?6:0):h===o?(a-s)/f+2:(s-o)/f+4,c*=60),r[0]=~~(c+.5),r[1]=~~(100*l+.5),r[2]=~~(100*u+.5)),i&&r.length<4&&(r[3]=1),r},O3=function(e){var t=[],i=[],r=-1;return e.split(ka).forEach(function(s){var o=s.match(Uh)||[];t.push.apply(t,o),i.push(r+=o.length+1)}),t.c=i,t},F3=function(e,t,i){var c,l,u,h,r="",s=(e+r).match(ka),o=t?"hsla(":"rgba(",a=0;if(!s)return e;if(s=s.map(function(d){return(d=L3(d,t,1))&&o+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(u=O3(e),(c=i.c).join(r)!==u.c.join(r)))for(h=(l=e.replace(ka,"1").split(Uh)).length-1;a<h;a++)r+=l[a]+(~c.indexOf(a)?s.shift()||o+"0,0,0,0)":(u.length?u:s.length?s:i).shift());if(!l)for(h=(l=e.split(ka)).length-1;a<h;a++)r+=l[a]+s[a];return r+l[h]},ka=function(){var e,n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in Tp)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),ple=/hsl[a]?\(/,k3=function(e){var i,t=e.join(" ");if(ka.lastIndex=0,ka.test(t))return i=ple.test(t),e[1]=F3(e[1],i),e[0]=F3(e[0],i,O3(e[1])),!0},kr=(n=Date.now,e=500,t=33,i=n(),r=i,o=s=1e3/240,p=function m(_){var y,w,x,E,g=n()-r,v=!0===_;if(g>e&&(i+=g-t),((y=(x=(r+=g)-i)-o)>0||v)&&(E=++h.frame,d=x-1e3*h.time,h.time=x/=1e3,o+=y+(y>=s?4:s-y),w=1),v||(c=l(m)),w)for(f=0;f<a.length;f++)a[f](x,d,E,_)},h={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(_){return d/(1e3/(_||60))},wake:function(){c3&&(!yC&&gC()&&(rs=yC=window,wC=rs.document||{},Lr.gsap=fr,(rs.gsapVersions||(rs.gsapVersions=[])).push(fr.version),l3(fy||rs.GreenSockGlobals||!rs.gsap&&rs||{}),u=rs.requestAnimationFrame,P3.forEach(N3)),c&&h.sleep(),l=u||function(_){return setTimeout(_,o-1e3*h.time+1|0)},Ap=1,p(2))},sleep:function(){(u?rs.cancelAnimationFrame:clearTimeout)(c),Ap=0,l=xp},lagSmoothing:function(_,g){e=_||1/0,t=Math.min(g||33,e)},fps:function(_){o=1e3*h.time+(s=1e3/(_||240))},add:function(_,g,v){var y=g?function(w,x,E,S){_(w,x,E,S),h.remove(y)}:_;return h.remove(_),a[v?"unshift":"push"](y),Gh(),y},remove:function(_,g){~(g=a.indexOf(_))&&a.splice(g,1)&&f>=g&&f--},_listeners:a=[]}),Gh=function(){return!Ap&&kr.wake()},Mt={},mle=/^[\d.\-M][\d.\-,\s]/,gle=/["']/g,_le=function(e){for(var a,c,l,t={},i=e.substr(1,e.length-3).split(":"),r=i[0],s=1,o=i.length;s<o;s++)c=i[s],a=s!==o-1?c.lastIndexOf(","):c.length,l=c.substr(0,a),t[r]=isNaN(l)?l.replace(gle,"").trim():+l,r=c.substr(a+1).trim();return t},U3=function(e){return function(t){return 1-e(1-t)}},B3=function n(e,t){for(var r,i=e._first;i;)i instanceof qi?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},Qc=function(e,t){return e&&(wn(e)?e:Mt[e]||function(e){var t=(e+"").split("("),i=Mt[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[_le(t[1])]:function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<i?e.indexOf(")",i+1):i)}(e).split(",").map(m3)):Mt._CE&&mle.test(e)?Mt._CE("",e):i}(e))||t},el=function(e,t,i,r){void 0===i&&(i=function(c){return 1-t(1-c)}),void 0===r&&(r=function(c){return c<.5?t(2*c)/2:1-t(2*(1-c))/2});var o,s={easeIn:t,easeOut:i,easeInOut:r};return hr(e,function(a){for(var c in Mt[a]=Lr[a]=s,Mt[o=a.toLowerCase()]=i,s)Mt[o+("easeIn"===c?".in":"easeOut"===c?".out":".inOut")]=Mt[a+"."+c]=s[c]}),s},V3=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},NC=function n(e,t,i){var r=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),o=s/pC*(Math.asin(1/r)||0),a=function(u){return 1===u?1:r*Math.pow(2,-10*u)*qce((u-o)*s)+1},c="out"===e?a:"in"===e?function(l){return 1-a(1-l)}:V3(a);return s=pC/s,c.config=function(l,u){return n(e,l,u)},c},LC=function n(e,t){void 0===t&&(t=1.70158);var i=function(o){return o?--o*o*((t+1)*o+t)+1:0},r="out"===e?i:"in"===e?function(s){return 1-i(1-s)}:V3(i);return r.config=function(s){return n(e,s)},r};hr("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;el(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(2*i,t)/2:1-Math.pow(2*(1-i),t)/2})}),Mt.Linear.easeNone=Mt.none=Mt.Linear.easeIn,el("Elastic",NC("in"),NC("out"),NC()),function(n,e){var s=function(a){return a<.36363636363636365?n*a*a:a<.7272727272727273?n*Math.pow(a-1.5/e,2)+.75:a<.9090909090909092?n*(a-=2.25/e)*a+.9375:n*Math.pow(a-2.625/e,2)+.984375};el("Bounce",function(o){return 1-s(1-o)},s)}(7.5625,2.75),el("Expo",function(n){return n?Math.pow(2,10*(n-1)):0}),el("Circ",function(n){return-(i3(1-n*n)-1)}),el("Sine",function(n){return 1===n?1:1-$ce(n*Wce)}),el("Back",LC("in"),LC("out"),LC()),Mt.SteppedEase=Mt.steps=Lr.SteppedEase={config:function(e,t){void 0===e&&(e=1);var i=1/e,r=e+(t?0:1),s=t?1:0;return function(a){return((r*Sp(0,.99999999,a)|0)+s)*i}}},kh.ease=Mt["quad.out"],hr("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return MC+=n+","+n+"Params,"});var z3=function(e,t){this.id=jce++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:f3,this.set=t?t.getSetter:BC},Dp=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,zh(this,+t.duration,1,1),this.data=t.data,yn&&(this._ctx=yn,yn.data.push(this)),Ap||kr.wake()}var e=n.prototype;return e.delay=function(i){return i||0===i?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,zh(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,r){if(Gh(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(xy(this,i),!s._dp||s.parent||w3(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&eo(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===$t||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),p3(this,i,r)),this},e.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+y3(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},e.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?i:1-i)+y3(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(i,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,r):this._repeat?Vh(this._tTime,s)+1:1},e.timeScale=function(i,r){if(!arguments.length)return this._rts===-$t?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?yy(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-$t?0:this._rts,this.totalTime(Sp(-Math.abs(this._delay),this._tDur,s),!1!==r),wy(this),function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Gh(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==$t&&(this._tTime-=$t)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&eo(r,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(ur(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?yy(r.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){void 0===i&&(i=Zce);var r=Ci;return Ci=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),"nested"!==this.data&&!1!==i.kill&&this.kill(),Ci=r,this},e.globalTime=function(i){for(var r=this,s=arguments.length?i:r.rawTime();r;)s=r._start+s/(Math.abs(r._ts)||1),r=r._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,E3(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,E3(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,r){return this.totalTime(os(this,i),ur(r))},e.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,ur(r))},e.play=function(i,r){return null!=i&&this.seek(i,r),this.reversed(!1).paused(!1)},e.reverse=function(i,r){return null!=i&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(i,r){return null!=i&&this.seek(i,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-$t:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-$t,this},e.isActive=function(){var s,i=this.parent||this._dp,r=this._start;return!(i&&!(this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=r&&s<this.endTime(!0)-$t))},e.eventCallback=function(i,r,s){var o=this.vars;return arguments.length>1?(r?(o[i]=r,s&&(o[i+"Params"]=s),"onUpdate"===i&&(this._onUpdate=r)):delete o[i],this):o[i]},e.then=function(i){var r=this;return new Promise(function(s){var o=wn(i)?i:g3,a=function(){var l=r.then;r.then=null,wn(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=l),s(o),r.then=l};r._initted&&1===r.totalProgress()&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},e.kill=function(){Cp(this)},n}();ss(Dp.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-$t,_prom:0,_ps:!1,_rts:1});var qi=function(n){function e(i,r){var s;return void 0===i&&(i={}),(s=n.call(this,i)||this).labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=ur(i.sortChildren),ln&&eo(i.parent||ln,Uo(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&x3(Uo(s),i.scrollTrigger),s}n3(e,n);var t=e.prototype;return t.to=function(r,s,o){return Ep(0,arguments,this),this},t.from=function(r,s,o){return Ep(1,arguments,this),this},t.fromTo=function(r,s,o,a){return Ep(2,arguments,this),this},t.set=function(r,s,o){return s.duration=0,s.parent=this,bp(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Un(r,s,os(this,o),1),this},t.call=function(r,s,o){return eo(this,Un.delayedCall(0,r,s),o)},t.staggerTo=function(r,s,o,a,c,l,u){return o.duration=s,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=u,o.parent=this,new Un(r,o,os(this,c)),this},t.staggerFrom=function(r,s,o,a,c,l,u){return o.runBackwards=1,bp(o).immediateRender=ur(o.immediateRender),this.staggerTo(r,s,o,a,c,l,u)},t.staggerFromTo=function(r,s,o,a,c,l,u,h){return a.startAt=o,bp(a).immediateRender=ur(a.immediateRender),this.staggerTo(r,s,a,c,l,u,h)},t.render=function(r,s,o){var d,f,p,m,_,g,v,y,w,x,E,S,a=this._time,c=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=r<=0?0:ii(r),h=this._zTime<0!=r<0&&(this._initted||!l);if(this!==ln&&u>c&&r>=0&&(u=c),u!==this._tTime||o||h){if(a!==this._time&&l&&(u+=this._time-a,r+=this._time-a),d=u,w=this._start,g=!(y=this._ts),h&&(l||(a=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(E=this._yoyo,_=l+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(100*_+r,s,o);if(d=ii(u%_),u===c?(m=this._repeat,d=l):((m=~~(u/_))&&m===u/_&&(d=l,m--),d>l&&(d=l)),x=Vh(this._tTime,_),!a&&this._tTime&&x!==m&&this._tTime-x*_-this._dur<=0&&(x=m),E&&1&m&&(d=l-d,S=1),m!==x&&!this._lock){var M=E&&1&x,b=M===(E&&1&m);if(m<x&&(M=!M),a=M?0:u%l?l:u,this._lock=1,this.render(a||(S?0:ii(m*_)),s,!l)._lock=0,this._tTime=u,!s&&this.parent&&Fr(this,"onRepeat"),this.vars.repeatRefresh&&!S&&(this.invalidate()._lock=1),a&&a!==this._time||g!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,c=this._tDur,b&&(this._lock=2,this.render(a=M?l:-1e-4,!0),this.vars.repeatRefresh&&!S&&this.invalidate()),this._lock=0,!this._ts&&!g)return this;B3(this,S)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=function(e,t,i){var r;if(i>t)for(r=e._first;r&&r._start<=i;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,ii(a),ii(d)),v&&(u-=d-(d=v._start))),this._tTime=u,this._time=d,this._act=!y,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!s&&!m&&(Fr(this,"onStart"),this._tTime!==u))return this;if(d>=a&&r>=0)for(f=this._first;f;){if(p=f._next,(f._act||d>=f._start)&&f._ts&&v!==f){if(f.parent!==this)return this.render(r,s,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,s,o),d!==this._time||!this._ts&&!g){v=0,p&&(u+=this._zTime=-$t);break}}f=p}else{f=this._last;for(var C=r<0?r:d;f;){if(p=f._prev,(f._act||C<=f._end)&&f._ts&&v!==f){if(f.parent!==this)return this.render(r,s,o);if(f.render(f._ts>0?(C-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(C-f._start)*f._ts,s,o||Ci&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!g){v=0,p&&(u+=this._zTime=C?-$t:$t);break}}f=p}}if(v&&!s&&(this.pause(),v.render(d>=a?0:-$t)._zTime=d>=a?1:-1,this._ts))return this._start=w,wy(this),this.render(r,s,o);this._onUpdate&&!s&&Fr(this,"onUpdate",!0),(u===c&&this._tTime>=this.totalDuration()||!u&&a)&&(w===this._start||Math.abs(y)!==Math.abs(this._ts))&&(this._lock||((r||!l)&&(u===c&&this._ts>0||!u&&this._ts<0)&&Oa(this,1),!s&&(!(r<0)||a)&&(u||a||!c)&&(Fr(this,u===c&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var o=this;if(Bo(s)||(s=os(this,s,r)),!(r instanceof Dp)){if(Ti(r))return r.forEach(function(a){return o.add(a,s)}),this;if(ni(r))return this.addLabel(r,s);if(!wn(r))return this;r=Un.delayedCall(0,r)}return this!==r?eo(this,r,s):this},t.getChildren=function(r,s,o,a){void 0===r&&(r=!0),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=-is);for(var c=[],l=this._first;l;)l._start>=a&&(l instanceof Un?s&&c.push(l):(o&&c.push(l),r&&c.push.apply(c,l.getChildren(!0,s,o)))),l=l._next;return c},t.getById=function(r){for(var s=this.getChildren(1,1,1),o=s.length;o--;)if(s[o].vars.id===r)return s[o]},t.remove=function(r){return ni(r)?this.removeLabel(r):wn(r)?this.killTweensOf(r):(vy(this,r),r===this._recent&&(this._recent=this._last),Jc(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ii(kr.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=os(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,o){var a=Un.delayedCall(0,s||xp,o);return a.data="isPause",this._hasPause=1,eo(this,a,os(this,r))},t.removePause=function(r){var s=this._first;for(r=os(this,r);s;)s._start===r&&"isPause"===s.data&&Oa(s),s=s._next},t.killTweensOf=function(r,s,o){for(var a=this.getTweensOf(r,o),c=a.length;c--;)Ua!==a[c]&&a[c].kill(r,s);return this},t.getTweensOf=function(r,s){for(var u,o=[],a=as(r),c=this._first,l=Bo(s);c;)c instanceof Un?Kce(c._targets,a)&&(l?(!Ua||c._initted&&c._ts)&&c.globalTime(0)<=s&&c.globalTime(c.totalDuration())>s:!s||c.isActive())&&o.push(c):(u=c.getTweensOf(a,s)).length&&o.push.apply(o,u),c=c._next;return o},t.tweenTo=function(r,s){s=s||{};var f,o=this,a=os(o,r),l=s.startAt,u=s.onStart,h=s.onStartParams,d=s.immediateRender,p=Un.to(o,ss({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||$t,onStart:function(){if(o.pause(),!f){var _=s.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());p._dur!==_&&zh(p,_,0,1).render(p._time,!0,!0),f=1}u&&u.apply(p,h||[])}},s));return d?p.render(0):p},t.tweenFromTo=function(r,s,o){return this.tweenTo(s,ss({startAt:{time:os(this,r)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(r){return void 0===r&&(r=this._time),R3(this,os(this,r))},t.previousLabel=function(r){return void 0===r&&(r=this._time),R3(this,os(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+$t)},t.shiftChildren=function(r,s,o){void 0===o&&(o=0);for(var l,a=this._first,c=this.labels;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(s)for(l in c)c[l]>=o&&(c[l]+=r);return Jc(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return n.prototype.invalidate.call(this,r)},t.clear=function(r){void 0===r&&(r=!0);for(var o,s=this._first;s;)o=s._next,this.remove(s),s=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Jc(this)},t.totalDuration=function(r){var l,u,h,s=0,o=this,a=o._last,c=is;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(h=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),(u=a._start)>c&&o._sort&&a._ts&&!o._lock?(o._lock=1,eo(o,a,u-a._delay,1)._lock=0):c=u,u<0&&a._ts&&(s-=u,(!h&&!o._dp||h&&h.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),c=0),a._end>s&&a._ts&&(s=a._end),a=l;zh(o,o===ln&&o._time>s?o._time:s,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(r){if(ln._ts&&(p3(ln,yy(r,ln)),h3=kr.frame),kr.frame>=d3){d3+=Nr.autoSleep||120;var s=ln._first;if((!s||!s._ts)&&Nr.autoSleep&&kr._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||kr.sleep()}}},e}(Dp);ss(qi.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ua,FC,wle=function(e,t,i,r,s,o,a){var h,d,f,p,m,_,g,v,c=new dr(this._pt,e,t,0,1,q3,null,s),l=0,u=0;for(c.b=i,c.e=r,i+="",(g=~(r+="").indexOf("random("))&&(r=Mp(r)),o&&(o(v=[i,r],e,t),i=v[0],r=v[1]),d=i.match(vC)||[];h=vC.exec(r);)p=h[0],m=r.substring(l,h.index),f?f=(f+1)%5:"rgba("===m.substr(-5)&&(f=1),p!==d[u++]&&(_=parseFloat(d[u-1])||0,c._pt={_next:c._pt,p:m||1===u?m:",",s:_,c:"="===p.charAt(1)?Bh(_,p)-_:parseFloat(p)-_,m:f&&f<4?Math.round:0},l=vC.lastIndex);return c.c=l<r.length?r.substring(l,r.length):"",c.fp=a,(o3.test(r)||g)&&(c.e=0),this._pt=c,c},OC=function(e,t,i,r,s,o,a,c,l,u){wn(r)&&(r=r(s||0,e,o));var p,h=e[t],d="get"!==i?i:wn(h)?l?e[t.indexOf("set")||!wn(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():h,f=wn(h)?l?Mle:j3:UC;if(ni(r)&&(~r.indexOf("random(")&&(r=Mp(r)),"="===r.charAt(1)&&((p=Bh(d,r)+(Ai(d)||0))||0===p)&&(r=p)),!u||d!==r||FC)return isNaN(d*r)||""===r?(!h&&!(t in e)&&xC(t,r),wle.call(this,e,t,d,r,f,c||Nr.stringFilter,l)):(p=new dr(this._pt,e,t,+d||0,r-(d||0),"boolean"==typeof h?Tle:$3,0,f),l&&(p.fp=l),a&&p.modifier(a,this,e),this._pt=p)},H3=function(e,t,i,r,s,o){var a,c,l,u;if(Or[e]&&!1!==(a=new Or[e]).init(s,a.rawVars?t[e]:function(e,t,i,r,s){if(wn(e)&&(e=Ip(e,s,t,i,r)),!Qs(e)||e.style&&e.nodeType||Ti(e)||r3(e))return ni(e)?Ip(e,s,t,i,r):e;var a,o={};for(a in e)o[a]=Ip(e[a],s,t,i,r);return o}(t[e],r,s,o,i),i,r,o)&&(i._pt=c=new dr(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==Hh))for(l=i._ptLookup[i._targets.indexOf(s)],u=a._props.length;u--;)l[a._props[u]]=c;return a},kC=function n(e,t,i){var x,E,S,M,b,C,L,F,B,R,k,V,z,r=e.vars,s=r.ease,o=r.startAt,a=r.immediateRender,c=r.lazy,l=r.onUpdate,u=r.runBackwards,h=r.yoyoEase,d=r.keyframes,f=r.autoRevert,p=e._dur,m=e._startAt,_=e._targets,g=e.parent,v=g&&"nested"===g.data?g.vars.targets:_,y="auto"===e._overwrite&&!fC,w=e.timeline;if(w&&(!d||!s)&&(s="none"),e._ease=Qc(s,kh.ease),e._yEase=h?U3(Qc(!0===h?s:h,kh.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!w&&!!r.runBackwards,!w||d&&!r.stagger){if(V=(F=_[0]?Zc(_[0]).harness:0)&&r[F.prop],x=_y(r,bC),m&&(m._zTime<0&&m.progress(1),t<0&&u&&a&&!f?m.render(-1,!0):m.revert(u&&p?py:Yce),m._lazy=0),o){if(Oa(e._startAt=Un.set(_,ss({data:"isStart",overwrite:!1,parent:g,immediateRender:!0,lazy:!m&&ur(c),startAt:null,delay:0,onUpdate:l&&function(){return Fr(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Ci||!a&&!f)&&e._startAt.revert(py),a&&p&&t<=0&&i<=0)return void(t&&(e._zTime=t))}else if(u&&p&&!m)if(t&&(a=!1),S=ss({overwrite:!1,data:"isFromStart",lazy:a&&!m&&ur(c),immediateRender:a,stagger:0,parent:g},x),V&&(S[F.prop]=V),Oa(e._startAt=Un.set(_,S)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Ci?e._startAt.revert(py):e._startAt.render(-1,!0)),e._zTime=t,a){if(!t)return}else n(e._startAt,$t,$t);for(e._pt=e._ptCache=0,c=p&&ur(c)||c&&!p,E=0;E<_.length;E++){if(L=(b=_[E])._gsap||CC(_)[E]._gsap,e._ptLookup[E]=R={},EC[L.id]&&La.length&&gy(),k=v===_?E:v.indexOf(b),F&&!1!==(B=new F).init(b,V||x,e,k,v)&&(e._pt=M=new dr(e._pt,b,B.name,0,1,B.render,B,0,B.priority),B._props.forEach(function(re){R[re]=M}),B.priority&&(C=1)),!F||V)for(S in x)Or[S]&&(B=H3(S,x,e,k,b,v))?B.priority&&(C=1):R[S]=M=OC.call(e,b,S,"get",x[S],k,v,0,r.stringFilter);e._op&&e._op[E]&&e.kill(b,e._op[E]),y&&e._pt&&(Ua=e,ln.killTweensOf(b,R,e.globalTime(t)),z=!e.parent,Ua=0),e._pt&&c&&(EC[L.id]=1)}C&&X3(e),e._onInit&&e._onInit(e)}e._onUpdate=l,e._initted=(!e._op||e._pt)&&!z,d&&t<=0&&w.render(is,!0,!0)},Sle=function(e,t,i,r){var o,a,s=t.ease||r||"power1.inOut";if(Ti(t))a=i[e]||(i[e]=[]),t.forEach(function(c,l){return a.push({t:l/(t.length-1)*100,v:c,e:s})});else for(o in t)a=i[o]||(i[o]=[]),"ease"===o||a.push({t:parseFloat(e),v:t[o],e:s})},Ip=function(e,t,i,r,s){return wn(e)?e.call(t,i,r,s):ni(e)&&~e.indexOf("random(")?Mp(e):e},G3=MC+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",W3={};hr(G3+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return W3[n]=1});var Un=function(n){function e(i,r,s,o){var a;"number"==typeof r&&(s.duration=r,r=s,s=null);var w,x,E,S,M,b,C,L,c=(a=n.call(this,o?r:bp(r))||this).vars,l=c.duration,u=c.delay,h=c.immediateRender,d=c.stagger,f=c.overwrite,p=c.keyframes,m=c.defaults,_=c.scrollTrigger,g=c.yoyoEase,v=r.parent||ln,y=(Ti(i)||r3(i)?Bo(i[0]):"length"in r)?[i]:as(i);if(a._targets=y.length?CC(y):wp("GSAP target "+i+" not found. https://gsap.com",!Nr.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,p||d||dy(l)||dy(u)){if(r=a.vars,(w=a.timeline=new qi({data:"nested",defaults:m||{},targets:v&&"nested"===v.data?v.vars.targets:y})).kill(),w.parent=w._dp=Uo(a),w._start=0,d||dy(l)||dy(u)){if(S=y.length,C=d&&C3(d),Qs(d))for(M in d)~G3.indexOf(M)&&(L||(L={}),L[M]=d[M]);for(x=0;x<S;x++)(E=_y(r,W3)).stagger=0,g&&(E.yoyoEase=g),L&&Kc(E,L),b=y[x],E.duration=+Ip(l,Uo(a),x,b,y),E.delay=(+Ip(u,Uo(a),x,b,y)||0)-a._delay,!d&&1===S&&E.delay&&(a._delay=u=E.delay,a._start+=u,E.delay=0),w.to(b,E,C?C(x,b,y):0),w._ease=Mt.none;w.duration()?l=u=0:a.timeline=0}else if(p){bp(ss(w.vars.defaults,{ease:"none"})),w._ease=Qc(p.ease||r.ease||"none");var B,R,k,F=0;if(Ti(p))p.forEach(function(V){return w.to(y,V,">")}),w.duration();else{for(M in E={},p)"ease"===M||"easeEach"===M||Sle(M,p[M],E,p.easeEach);for(M in E)for(B=E[M].sort(function(V,z){return V.t-z.t}),F=0,x=0;x<B.length;x++)(k={ease:(R=B[x]).e,duration:(R.t-(x?B[x-1].t:0))/100*l})[M]=R.v,w.to(y,k,F),F+=k.duration;w.duration()<l&&w.to({},{duration:l-w.duration()})}}l||a.duration(l=w.duration())}else a.timeline=0;return!0===f&&!fC&&(Ua=Uo(a),ln.killTweensOf(y),Ua=0),eo(v,Uo(a),s),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(h||!l&&!p&&a._start===ii(v._time)&&ur(h)&&tle(Uo(a))&&"nested"!==v.data)&&(a._tTime=-$t,a.render(Math.max(0,-u)||0)),_&&x3(Uo(a),_),a}n3(e,n);var t=e.prototype;return t.render=function(r,s,o){var d,f,p,m,_,g,v,y,w,a=this._time,c=this._tDur,l=this._dur,u=r<0,h=r>c-$t&&!u?c:r<$t?0:r;if(l){if(h!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=h,y=this.timeline,this._repeat){if(m=l+this._rDelay,this._repeat<-1&&u)return this.totalTime(100*m+r,s,o);if(d=ii(h%m),h===c?(p=this._repeat,d=l):((p=~~(h/m))&&p===ii(h/m)&&(d=l,p--),d>l&&(d=l)),(g=this._yoyo&&1&p)&&(w=this._yEase,d=l-d),_=Vh(this._tTime,m),d===a&&!o&&this._initted&&p===_)return this._tTime=h,this;p!==_&&(y&&this._yEase&&B3(y,g),this.vars.repeatRefresh&&!g&&!this._lock&&this._time!==l&&this._initted&&(this._lock=o=1,this.render(ii(m*p),!0).invalidate()._lock=0))}if(!this._initted){if(b3(this,u?r:d,o,s,h))return this._tTime=0,this;if(!(a===this._time||o&&this.vars.repeatRefresh&&p!==_))return this;if(l!==this._dur)return this.render(r,s,o)}if(this._tTime=h,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(w||this._ease)(d/l),this._from&&(this.ratio=v=1-v),d&&!a&&!s&&!p&&(Fr(this,"onStart"),this._tTime!==h))return this;for(f=this._pt;f;)f.r(v,f.d),f=f._next;y&&y.render(r<0?r:!d&&g?-$t:y._dur*y._ease(d/this._dur),s,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&TC(this,r,0,o),Fr(this,"onUpdate")),this._repeat&&p!==_&&this.vars.onRepeat&&!s&&this.parent&&Fr(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(u&&!this._onUpdate&&TC(this,r,0,!0),(r||!l)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&Oa(this,1),!s&&(!u||a)&&(h||a||g)&&(Fr(this,h===c?"onComplete":"onReverseComplete",!0),this._prom&&!(h<c&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,i,r){var l,u,h,s=e.ratio,o=t<0||!t&&(!e._start&&nle(e)&&(e._initted||!AC(e))||(e._ts<0||e._dp._ts<0)&&!AC(e))?0:1,a=e._rDelay,c=0;if(a&&e._repeat&&(c=Sp(0,e._tDur,t),u=Vh(c,a),e._yoyo&&1&u&&(o=1-o),u!==Vh(e._tTime,a)&&(s=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==s||Ci||r||e._zTime===$t||!t&&e._zTime){if(!e._initted&&b3(e,t,r,i,c))return;for(h=e._zTime,e._zTime=t||(i?$t:0),i||(i=t&&!h),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=c,l=e._pt;l;)l.r(o,l.d),l=l._next;t<0&&TC(e,t,0,!0),e._onUpdate&&!i&&Fr(e,"onUpdate"),c&&e._repeat&&!i&&e.parent&&Fr(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&Oa(e,1),!i&&!Ci&&(Fr(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,r,s,o);return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,o,a,c){Ap||kr.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||kC(this,l),function(e,t,i,r,s,o,a,c){var u,h,d,f,l=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!l)for(l=e._ptCache[t]=[],d=e._ptLookup,f=e._targets.length;f--;){if((u=d[f][t])&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return FC=1,e.vars[t]="+=0",kC(e,a),FC=0,c?wp(t+" not eligible for reset"):1;l.push(u)}for(f=l.length;f--;)(u=(h=l[f])._pt||h).s=!r&&0!==r||s?u.s+(r||0)+o*u.c:r,u.c=i-u.s,h.e&&(h.e=An(i)+Ai(h.e)),h.b&&(h.b=u.s+Ai(h.b))}(this,r,s,o,a,this._ease(l/this._dur),l,c)?this.resetTo(r,s,o,a,1):(xy(this,0),this.parent||v3(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(void 0===s&&(s="all"),!(r||s&&"all"!==s))return this._lazy=this._pt=0,this.parent?Cp(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,Ua&&!0!==Ua.vars.overwrite)._first||Cp(this),this.parent&&o!==this.timeline.totalDuration()&&zh(this,this._dur*this.timeline._tDur/o,0,1),this}var h,d,f,p,m,_,g,a=this._targets,c=r?as(r):a,l=this._ptLookup,u=this._pt;if((!s||"all"===s)&&function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0}(a,c))return"all"===s&&(this._pt=0),Cp(this);for(h=this._op=this._op||[],"all"!==s&&(ni(s)&&(m={},hr(s,function(v){return m[v]=1}),s=m),s=function(e,t){var s,o,a,c,i=e[0]?Zc(e[0]).harness:0,r=i&&i.aliases;if(!r)return t;for(o in s=Kc({},t),r)if(o in s)for(a=(c=r[o].split(",")).length;a--;)s[c[a]]=s[o];return s}(a,s)),g=a.length;g--;)if(~c.indexOf(a[g]))for(m in d=l[g],"all"===s?(h[g]=s,p=d,f={}):(f=h[g]=h[g]||{},p=s),p)(_=d&&d[m])&&((!("kill"in _.d)||!0===_.d.kill(m))&&vy(this,_,"_pt"),delete d[m]),"all"!==f&&(f[m]=1);return this._initted&&!this._pt&&u&&Cp(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return Ep(1,arguments)},e.delayedCall=function(r,s,o,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(r,s,o){return Ep(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,o){return ln.killTweensOf(r,s,o)},e}(Dp);ss(Un.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),hr("staggerTo,staggerFrom,staggerFromTo",function(n){Un[n]=function(){var e=new qi,t=DC.call(arguments,0);return t.splice("staggerFromTo"===n?5:4,0,0),e[n].apply(e,t)}});var UC=function(e,t,i){return e[t]=i},j3=function(e,t,i){return e[t](i)},Mle=function(e,t,i,r){return e[t](r.fp,i)},Cle=function(e,t,i){return e.setAttribute(t,i)},BC=function(e,t){return wn(e[t])?j3:mC(e[t])&&e.setAttribute?Cle:UC},$3=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},Tle=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},q3=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round(1e4*(i.s+i.c*e))/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},VC=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},Ale=function(e,t,i,r){for(var o,s=this._pt;s;)o=s._next,s.p===r&&s.modifier(e,t,i),s=o},Dle=function(e){for(var i,r,t=this._pt;t;)r=t._next,t.p===e&&!t.op||t.op===e?vy(this,t,"_pt"):t.dep||(i=1),t=r;return!i},Ile=function(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)},X3=function(e){for(var i,r,s,o,t=e._pt;t;){for(i=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:o)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:o=t,t=i}e._pt=s},dr=function(){function n(t,i,r,s,o,a,c,l,u){this.t=i,this.s=s,this.c=o,this.p=r,this.r=a||$3,this.d=c||this,this.set=l||UC,this.pr=u||0,this._next=t,t&&(t._prev=this)}return n.prototype.modifier=function(i,r,s){this.mSet=this.mSet||this.set,this.set=Ile,this.m=i,this.mt=s,this.tween=r},n}();hr(MC+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return bC[n]=1}),Lr.TweenMax=Lr.TweenLite=Un,Lr.TimelineLite=Lr.TimelineMax=qi,ln=new qi({sortChildren:!1,defaults:kh,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Nr.stringFilter=k3;var tl=[],by={},Rle=[],Y3=0,Ple=0,zC=function(e){return(by[e]||Rle).map(function(t){return t()})},HC=function(){var e=Date.now(),t=[];e-Y3>2&&(zC("matchMediaInit"),tl.forEach(function(i){var o,a,c,l,r=i.queries,s=i.conditions;for(a in r)(o=rs.matchMedia(r[a]).matches)&&(c=1),o!==s[a]&&(s[a]=o,l=1);l&&(i.revert(),c&&t.push(i))}),zC("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(r){return i.add(null,r)})}),Y3=e,zC("matchMedia"))},Z3=function(){function n(t,i){this.selector=i&&IC(i),this.data=[],this._r=[],this.isReverted=!1,this.id=Ple++,t&&this.add(t)}var e=n.prototype;return e.add=function(i,r,s){wn(i)&&(s=r,r=i,i=wn);var o=this,a=function(){var h,l=yn,u=o.selector;return l&&l!==o&&l.data.push(o),s&&(o.selector=IC(s)),yn=o,h=r.apply(o,arguments),wn(h)&&o._r.push(h),yn=l,o.selector=u,o.isReverted=!1,h};return o.last=a,i===wn?a(o,function(c){return o.add(null,c)}):i?o[i]=a:a},e.ignore=function(i){var r=yn;yn=null,i(this),yn=r},e.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof n?i.push.apply(i,r.getTweens()):r instanceof Un&&!(r.parent&&"nested"===r.parent.data)&&i.push(r)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,r){var s=this;if(i?function(){for(var l,a=s.getTweens(),c=s.data.length;c--;)"isFlip"===(l=s.data[c]).data&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,h){return h.g-u.g||-1/0}).forEach(function(u){return u.t.revert(i)}),c=s.data.length;c--;)(l=s.data[c])instanceof qi?"nested"!==l.data&&(l.scrollTrigger&&l.scrollTrigger.revert(),l.kill()):!(l instanceof Un)&&l.revert&&l.revert(i);s._r.forEach(function(u){return u(i,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),r)for(var o=tl.length;o--;)tl[o].id===this.id&&tl.splice(o,1)},e.revert=function(i){this.kill(i||{})},n}(),Nle=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(i,r,s){Qs(i)||(i={matches:i});var c,l,u,o=new Z3(0,s||this.scope),a=o.conditions={};for(l in yn&&!o.selector&&(o.selector=yn.selector),this.contexts.push(o),r=o.add("onMatch",r),o.queries=i,i)"all"===l?u=1:(c=rs.matchMedia(i[l]))&&(tl.indexOf(o)<0&&tl.push(o),(a[l]=c.matches)&&(u=1),c.addListener?c.addListener(HC):c.addEventListener("change",HC));return u&&r(o,function(h){return o.add(null,h)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},n}(),Ey={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(r){return N3(r)})},timeline:function(e){return new qi(e)},getTweensOf:function(e,t){return ln.getTweensOf(e,t)},getProperty:function(e,t,i,r){ni(e)&&(e=as(e)[0]);var s=Zc(e||{}).get,o=i?g3:m3;return"native"===i&&(i=""),e&&(t?o((Or[t]&&Or[t].get||s)(e,t,i,r)):function(a,c,l){return o((Or[a]&&Or[a].get||s)(e,a,c,l))})},quickSetter:function(e,t,i){if((e=as(e)).length>1){var r=e.map(function(u){return fr.quickSetter(u,t,i)}),s=r.length;return function(u){for(var h=s;h--;)r[h](u)}}var o=Or[t],a=Zc(e=e[0]||{}),c=a.harness&&(a.harness.aliases||{})[t]||t,l=o?function(u){var h=new o;Hh._pt=0,h.init(e,i?u+i:u,Hh,0,[e]),h.render(1,h),Hh._pt&&VC(1,Hh)}:a.set(e,c);return o?l:function(u){return l(e,c,i?u+i:u,a,1)}},quickTo:function(e,t,i){var r,s=fr.to(e,Kc(((r={})[t]="+=0.1",r.paused=!0,r),i||{})),o=function(c,l,u){return s.resetTo(t,c,l,u)};return o.tween=s,o},isTweening:function(e){return ln.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Qc(e.ease,kh.ease)),_3(kh,e||{})},config:function(e){return _3(Nr,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,s=e.defaults,o=e.extendTimeline;(e.plugins||"").split(",").forEach(function(a){return a&&!Or[a]&&!Lr[a]&&wp(t+" effect requires "+a+" plugin.")}),SC[t]=function(a,c,l){return i(as(a),ss(c||{},s),l)},o&&(qi.prototype[t]=function(a,c,l){return this.add(SC[t](a,Qs(c)?c:(l=c)&&{},this),l)})},registerEase:function(e,t){Mt[e]=Qc(t)},parseEase:function(e,t){return arguments.length?Qc(e,t):Mt},getById:function(e){return ln.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var r,s,i=new qi(e);for(i.smoothChildTiming=ur(e.smoothChildTiming),ln.remove(i),i._dp=0,i._time=i._tTime=ln._time,r=ln._first;r;)s=r._next,(t||!(!r._dur&&r instanceof Un&&r.vars.onComplete===r._targets[0]))&&eo(i,r,r._start-r._delay),r=s;return eo(ln,i,0),i},context:function(e,t){return e?new Z3(e,t):yn},matchMedia:function(e){return new Nle(e)},matchMediaRefresh:function(){return tl.forEach(function(e){var i,r,t=e.conditions;for(r in t)t[r]&&(t[r]=!1,i=1);i&&e.revert()})||HC()},addEventListener:function(e,t){var i=by[e]||(by[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=by[e],r=i&&i.indexOf(t);r>=0&&i.splice(r,1)},utils:{wrap:function n(e,t,i){var r=t-e;return Ti(e)?D3(e,n(0,e.length),t):Fa(i,function(s){return(r+(s-e)%r)%r+e})},wrapYoyo:function n(e,t,i){var r=t-e,s=2*r;return Ti(e)?D3(e,n(0,e.length-1),t):Fa(i,function(o){return e+((o=(s+(o-e)%s)%s||0)>r?s-o:o)})},distribute:C3,random:A3,snap:T3,normalize:function(e,t,i){return I3(e,t,0,1,i)},getUnit:Ai,clamp:function(e,t,i){return Fa(i,function(r){return Sp(e,t,r)})},splitColor:L3,toArray:as,selector:IC,mapRange:I3,pipe:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduce(function(s,o){return o(s)},r)}},unitize:function(e,t){return function(i){return e(parseFloat(i))+(t||Ai(i))}},interpolate:function n(e,t,i,r){var s=isNaN(e+t)?0:function(f){return(1-f)*e+f*t};if(!s){var c,l,u,h,d,o=ni(e),a={};if(!0===i&&(r=1)&&(i=null),o)e={p:e},t={p:t};else if(Ti(e)&&!Ti(t)){for(u=[],d=(h=e.length)-2,l=1;l<h;l++)u.push(n(e[l-1],e[l]));h--,s=function(p){p*=h;var m=Math.min(d,~~p);return u[m](p-m)},i=t}else r||(e=Kc(Ti(e)?[]:{},e));if(!u){for(c in t)OC.call(a,e,c,"get",t[c]);s=function(p){return VC(p,a)||(o?e.p:e)}}}return Fa(i,s)},shuffle:M3},install:l3,effects:SC,ticker:kr,updateRoot:qi.updateRoot,plugins:Or,globalTimeline:ln,core:{PropTween:dr,globals:u3,Tween:Un,Timeline:qi,Animation:Dp,getCache:Zc,_removeLinkedListItem:vy,reverting:function(){return Ci},context:function(e){return e&&yn&&(yn.data.push(e),e._ctx=yn),yn},suppressOverwrites:function(e){return fC=e}}};hr("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return Ey[n]=Un[n]}),kr.add(qi.updateRoot),Hh=Ey.to({},{duration:0});var Lle=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},GC=function(e,t){return{name:e,rawVars:1,init:function(r,s,o){o._onInit=function(a){var c,l;if(ni(s)&&(c={},hr(s,function(u){return c[u]=1}),s=c),t){for(l in c={},s)c[l]=t(s[l]);s=c}!function(e,t){var r,s,o,i=e._targets;for(r in t)for(s=i.length;s--;)(o=e._ptLookup[s][r])&&(o=o.d)&&(o._pt&&(o=Lle(o,r)),o&&o.modifier&&o.modifier(t[r],e,i[s],r))}(a,s)}}}},fr=Ey.registerPlugin({name:"attr",init:function(e,t,i,r,s){var o,a,c;for(o in this.tween=i,t)c=e.getAttribute(o)||"",(a=this.add(e,"setAttribute",(c||0)+"",t[o],r,s,0,0,o)).op=o,a.b=c,this._props.push(o)},render:function(e,t){for(var i=t._pt;i;)Ci?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},GC("roundProps",RC),GC("modifiers"),GC("snap",T3))||Ey;Un.version=qi.version=fr.version="3.12.3",c3=1,gC()&&Gh();var K3,Ba,Wh,WC,nl,J3,jC,rV,Vo={},il=180/Math.PI,jh=Math.PI/180,$h=Math.atan2,Q3=1e8,$C=/([A-Z])/g,Ule=/(left|right|width|margin|padding|x)/i,Ble=/[\s,\(]\S/,to={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},qC=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Vle=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},zle=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},Hle=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},eV=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},tV=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},Gle=function(e,t,i){return e.style[t]=i},Wle=function(e,t,i){return e.style.setProperty(t,i)},jle=function(e,t,i){return e._gsap[t]=i},$le=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},qle=function(e,t,i,r,s){var o=e._gsap;o.scaleX=o.scaleY=i,o.renderTransform(s,o)},Xle=function(e,t,i,r,s){var o=e._gsap;o[t]=i,o.renderTransform(s,o)},un="transform",pr=un+"Origin",Yle=function n(e,t){var i=this,r=this.target,s=r.style,o=r._gsap;if(e in Vo&&s){if(this.tfm=this.tfm||{},"transform"===e)return to.transform.split(",").forEach(function(a){return n.call(i,a,t)});if(~(e=to[e]||e).indexOf(",")?e.split(",").forEach(function(a){return i.tfm[a]=zo(r,a)}):this.tfm[e]=o.x?o[e]:zo(r,e),e===pr&&(this.tfm.zOrigin=o.zOrigin),this.props.indexOf(un)>=0)return;o.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(pr,t,"")),e=un}(s||t)&&this.props.push(e,t,s[e])},nV=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Zle=function(){var s,o,e=this.props,t=this.target,i=t.style,r=t._gsap;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty("--"===e[s].substr(0,2)?e[s]:e[s].replace($C,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),(!(s=jC())||!s.isStart)&&!i[un]&&(nV(i),r.zOrigin&&i[pr]&&(i[pr]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},iV=function(e,t){var i={target:e,props:[],revert:Zle,save:Yle};return e._gsap||fr.core.getCache(e),t&&t.split(",").forEach(function(r){return i.save(r)}),i},XC=function(e,t){var i=Ba.createElementNS?Ba.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Ba.createElement(e);return i&&i.style?i:Ba.createElement(e)},no=function n(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace($C,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&n(e,qh(t)||t,1)||""},sV="O,Moz,ms,Ms,Webkit".split(","),qh=function(e,t,i){var s=(t||nl).style,o=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(sV[o]+e in s););return o<0?null:(3===o?"ms":o>=0?sV[o]:"")+e},YC=function(){typeof window<"u"&&window.document&&(K3=window,Wh=(Ba=K3.document).documentElement,nl=XC("div")||{style:{}},XC("div"),un=qh(un),pr=un+"Origin",nl.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",rV=!!qh("perspective"),jC=fr.core.reverting,WC=1)},ZC=function n(e){var o,t=XC("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,s=this.style.cssText;if(Wh.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),Wh.removeChild(t),this.style.cssText=s,o},oV=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},aV=function(e){var t;try{t=e.getBBox()}catch{t=ZC.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===ZC||(t=ZC.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+oV(e,["x","cx","x1"])||0,y:+oV(e,["y","cy","y1"])||0,width:0,height:0}},cV=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!aV(e))},rl=function(e,t){if(t){var r,i=e.style;t in Vo&&t!==pr&&(t=un),i.removeProperty?(("ms"===(r=t.substr(0,2))||"webkit"===t.substr(0,6))&&(t="-"+t),i.removeProperty("--"===r?t:t.replace($C,"-$1").toLowerCase())):i.removeAttribute(t)}},Va=function(e,t,i,r,s,o){var a=new dr(e._pt,t,i,0,1,o?tV:eV);return e._pt=a,a.b=r,a.e=s,e._props.push(i),a},lV={deg:1,rad:1,turn:1},Kle={grid:1,flex:1},za=function n(e,t,i,r){var p,m,_,g,s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",a=nl.style,c=Ule.test(t),l="svg"===e.tagName.toLowerCase(),u=(l?"client":"offset")+(c?"Width":"Height"),h=100,d="px"===r,f="%"===r;if(r===o||!s||lV[r]||lV[o])return s;if("px"!==o&&!d&&(s=n(e,t,i,"px")),g=e.getCTM&&cV(e),(f||"%"===o)&&(Vo[t]||~t.indexOf("adius")))return p=g?e.getBBox()[c?"width":"height"]:e[u],An(f?s/p*h:s/100*p);if(a[c?"width":"height"]=h+(d?o:r),m=~t.indexOf("adius")||"em"===r&&e.appendChild&&!l?e:e.parentNode,g&&(m=(e.ownerSVGElement||{}).parentNode),(!m||m===Ba||!m.appendChild)&&(m=Ba.body),(_=m._gsap)&&f&&_.width&&c&&_.time===kr.time&&!_.uncache)return An(s/_.width*h);if(!f||"height"!==t&&"width"!==t)(f||"%"===o)&&!Kle[no(m,"display")]&&(a.position=no(e,"position")),m===e&&(a.position="static"),m.appendChild(nl),p=nl[u],m.removeChild(nl),a.position="absolute";else{var v=e.style[t];e.style[t]=h+r,p=e[u],v?e.style[t]=v:rl(e,t)}return c&&f&&((_=Zc(m)).time=kr.time,_.width=m[u]),An(d?p*s/h:p&&s?h/p*s:0)},zo=function(e,t,i,r){var s;return WC||YC(),t in to&&"transform"!==t&&~(t=to[t]).indexOf(",")&&(t=t.split(",")[0]),Vo[t]&&"transform"!==t?(s=Pp(e,r),s="transformOrigin"!==t?s[t]:s.svg?s.origin:My(no(e,pr))+" "+s.zOrigin+"px"):(!(s=e.style[t])||"auto"===s||r||~(s+"").indexOf("calc("))&&(s=Sy[t]&&Sy[t](e,t,i)||no(e,t)||f3(e,t)||("opacity"===t?1:0)),i&&!~(s+"").trim().indexOf(" ")?za(e,t,s,i)+i:s},Jle=function(e,t,i,r){if(!i||"none"===i){var s=qh(t,e,1),o=s&&no(e,s,1);o&&o!==i?(t=s,i=o):"borderColor"===t&&(i=no(e,"borderTopColor"))}var u,h,d,f,p,m,_,g,v,y,w,a=new dr(this._pt,e.style,t,0,1,q3),c=0,l=0;if(a.b=i,a.e=r,i+="","auto"==(r+="")&&(m=e.style[t],e.style[t]=r,r=no(e,t)||r,m?e.style[t]=m:rl(e,t)),k3(u=[i,r]),r=u[1],d=(i=u[0]).match(Uh)||[],(r.match(Uh)||[]).length){for(;h=Uh.exec(r);)_=h[0],v=r.substring(c,h.index),p?p=(p+1)%5:("rgba("===v.substr(-5)||"hsla("===v.substr(-5))&&(p=1),_!==(m=d[l++]||"")&&(f=parseFloat(m)||0,w=m.substr((f+"").length),"="===_.charAt(1)&&(_=Bh(f,_)+w),g=parseFloat(_),y=_.substr((g+"").length),c=Uh.lastIndex-y.length,y||(y=y||Nr.units[t]||w,c===r.length&&(r+=y,a.e+=y)),w!==y&&(f=za(e,t,m,y)||0),a._pt={_next:a._pt,p:v||1===l?v:",",s:f,c:g-f,m:p&&p<4||"zIndex"===t?Math.round:0});a.c=c<r.length?r.substring(c,r.length):""}else a.r="display"===t&&"none"===r?tV:eV;return o3.test(r)&&(a.e=0),this._pt=a,a},uV={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Qle=function(e){var t=e.split(" "),i=t[0],r=t[1]||"50%";return("top"===i||"bottom"===i||"left"===r||"right"===r)&&(e=i,i=r,r=e),t[0]=uV[i]||i,t[1]=uV[r]||r,t.join(" ")},eue=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var a,c,l,i=t.t,r=i.style,s=t.u,o=i._gsap;if("all"===s||!0===s)r.cssText="",c=1;else for(l=(s=s.split(",")).length;--l>-1;)Vo[a=s[l]]&&(c=1,a="transformOrigin"===a?pr:un),rl(i,a);c&&(rl(i,un),o&&(o.svg&&i.removeAttribute("transform"),Pp(i,1),o.uncache=1,nV(r)))}},Sy={clearProps:function(e,t,i,r,s){if("isFromStart"!==s.data){var o=e._pt=new dr(e._pt,t,i,0,0,eue);return o.u=r,o.pr=-10,o.tween=s,e._props.push(i),1}}},Rp=[1,0,0,1,0,0],hV={},dV=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},fV=function(e){var t=no(e,un);return dV(t)?Rp:t.substr(7).match(s3).map(An)},KC=function(e,t){var o,a,c,l,i=e._gsap||Zc(e),r=e.style,s=fV(e);return i.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(s=[(c=e.transform.baseVal.consolidate().matrix).a,c.b,c.c,c.d,c.e,c.f]).join(",")?Rp:s:(s===Rp&&!e.offsetParent&&e!==Wh&&!i.svg&&(c=r.display,r.display="block",(!(o=e.parentNode)||!e.offsetParent)&&(l=1,a=e.nextElementSibling,Wh.appendChild(e)),s=fV(e),c?r.display=c:rl(e,"display"),l&&(a?o.insertBefore(e,a):o?o.appendChild(e):Wh.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},JC=function(e,t,i,r,s,o){var E,S,b,a=e._gsap,c=s||KC(e,!0),l=a.xOrigin||0,u=a.yOrigin||0,h=a.xOffset||0,d=a.yOffset||0,f=c[0],p=c[1],m=c[2],_=c[3],g=c[4],v=c[5],y=t.split(" "),w=parseFloat(y[0])||0,x=parseFloat(y[1])||0;i?c!==Rp&&(S=f*_-p*m)&&(b=w*(-p/S)+x*(f/S)-(f*v-p*g)/S,w=w*(_/S)+x*(-m/S)+(m*v-_*g)/S,x=b):(w=(E=aV(e)).x+(~y[0].indexOf("%")?w/100*E.width:w),x=E.y+(~(y[1]||y[0]).indexOf("%")?x/100*E.height:x),!("xOrigin"in a)&&(w||x)&&(w-=E.x,x-=E.y)),r||!1!==r&&a.smooth?(a.xOffset=h+((g=w-l)*f+(v=x-u)*m)-g,a.yOffset=d+(g*p+v*_)-v):a.xOffset=a.yOffset=0,a.xOrigin=w,a.yOrigin=x,a.smooth=!!r,a.origin=t,a.originIsAbsolute=!!i,e.style[pr]="0px 0px",o&&(Va(o,a,"xOrigin",l,w),Va(o,a,"yOrigin",u,x),Va(o,a,"xOffset",h,a.xOffset),Va(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",w+" "+x)},Pp=function(e,t){var i=e._gsap||new z3(e);if("x"in i&&!t&&!i.uncache)return i;var u,h,d,f,p,m,_,g,v,y,w,x,E,S,M,b,C,L,F,B,R,k,V,z,re,q,ee,te,_e,G,K,ae,r=e.style,s=i.scaleX<0,o="px",a="deg",c=getComputedStyle(e),l=no(e,pr)||"0";return u=h=d=m=_=g=v=y=w=0,f=p=1,i.svg=!(!e.getCTM||!cV(e)),c.translate&&(("none"!==c.translate||"none"!==c.scale||"none"!==c.rotate)&&(r[un]=("none"!==c.translate?"translate3d("+(c.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==c.rotate?"rotate("+c.rotate+") ":"")+("none"!==c.scale?"scale("+c.scale.split(" ").join(",")+") ":"")+("none"!==c[un]?c[un]:"")),r.scale=r.rotate=r.translate="none"),S=KC(e,i.svg),i.svg&&(i.uncache?(re=e.getBBox(),l=i.xOrigin-re.x+"px "+(i.yOrigin-re.y)+"px",z=""):z=!t&&e.getAttribute("data-svg-origin"),JC(e,z||l,!!z||i.originIsAbsolute,!1!==i.smooth,S)),x=i.xOrigin||0,E=i.yOrigin||0,S!==Rp&&(L=S[0],F=S[1],B=S[2],R=S[3],u=k=S[4],h=V=S[5],6===S.length?(f=Math.sqrt(L*L+F*F),p=Math.sqrt(R*R+B*B),m=L||F?$h(F,L)*il:0,(v=B||R?$h(B,R)*il+m:0)&&(p*=Math.abs(Math.cos(v*jh))),i.svg&&(u-=x-(x*L+E*B),h-=E-(x*F+E*R))):(G=S[7],ee=S[8],te=S[9],K=S[11],u=S[12],h=S[13],d=S[14],_=(M=$h(ae=S[6],_e=S[10]))*il,M&&(z=k*(b=Math.cos(-M))+ee*(C=Math.sin(-M)),re=V*b+te*C,q=ae*b+_e*C,ee=k*-C+ee*b,te=V*-C+te*b,_e=ae*-C+_e*b,K=G*-C+K*b,k=z,V=re,ae=q),g=(M=$h(-B,_e))*il,M&&(b=Math.cos(-M),K=R*(C=Math.sin(-M))+K*b,L=z=L*b-ee*C,F=re=F*b-te*C,B=q=B*b-_e*C),m=(M=$h(F,L))*il,M&&(z=L*(b=Math.cos(M))+F*(C=Math.sin(M)),re=k*b+V*C,F=F*b-L*C,V=V*b-k*C,L=z,k=re),_&&Math.abs(_)+Math.abs(m)>359.9&&(_=m=0,g=180-g),f=An(Math.sqrt(L*L+F*F+B*B)),p=An(Math.sqrt(V*V+ae*ae)),M=$h(k,V),v=Math.abs(M)>2e-4?M*il:0,w=K?1/(K<0?-K:K):0),i.svg&&(z=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!dV(no(e,un)),z&&e.setAttribute("transform",z))),Math.abs(v)>90&&Math.abs(v)<270&&(s?(f*=-1,v+=m<=0?180:-180,m+=m<=0?180:-180):(p*=-1,v+=v<=0?180:-180)),t=t||i.uncache,i.x=u-((i.xPercent=u&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+o,i.y=h-((i.yPercent=h&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+o,i.z=d+o,i.scaleX=An(f),i.scaleY=An(p),i.rotation=An(m)+a,i.rotationX=An(_)+a,i.rotationY=An(g)+a,i.skewX=v+a,i.skewY=y+a,i.transformPerspective=w+o,(i.zOrigin=parseFloat(l.split(" ")[2])||!t&&i.zOrigin||0)&&(r[pr]=My(l)),i.svg||(i.xOffset=i.yOffset=0),i.force3D=Nr.force3D,i.renderTransform=i.svg?nue:rV?pV:tue,i.uncache=0,i},My=function(e){return(e=e.split(" "))[0]+" "+e[1]},QC=function(e,t,i){var r=Ai(t);return An(parseFloat(t)+parseFloat(za(e,"x",i+"px",r)))+r},tue=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,pV(e,t)},sl="0deg",Np="0px",ol=") ",pV=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,c=i.z,l=i.rotation,u=i.rotationY,h=i.rotationX,d=i.skewX,f=i.skewY,p=i.scaleX,m=i.scaleY,_=i.transformPerspective,g=i.force3D,v=i.target,y=i.zOrigin,w="",x="auto"===g&&e&&1!==e||!0===g;if(y&&(h!==sl||u!==sl)){var b,E=parseFloat(u)*jh,S=Math.sin(E),M=Math.cos(E);E=parseFloat(h)*jh,b=Math.cos(E),o=QC(v,o,S*b*-y),a=QC(v,a,-Math.sin(E)*-y),c=QC(v,c,M*b*-y+y)}_!==Np&&(w+="perspective("+_+ol),(r||s)&&(w+="translate("+r+"%, "+s+"%) "),(x||o!==Np||a!==Np||c!==Np)&&(w+=c!==Np||x?"translate3d("+o+", "+a+", "+c+") ":"translate("+o+", "+a+ol),l!==sl&&(w+="rotate("+l+ol),u!==sl&&(w+="rotateY("+u+ol),h!==sl&&(w+="rotateX("+h+ol),(d!==sl||f!==sl)&&(w+="skew("+d+", "+f+ol),(1!==p||1!==m)&&(w+="scale("+p+", "+m+ol),v.style[un]=w||"translate(0, 0)"},nue=function(e,t){var x,E,S,M,b,i=t||this,r=i.xPercent,s=i.yPercent,o=i.x,a=i.y,c=i.rotation,l=i.skewX,u=i.skewY,h=i.scaleX,d=i.scaleY,f=i.target,p=i.xOrigin,m=i.yOrigin,_=i.xOffset,g=i.yOffset,v=i.forceCSS,y=parseFloat(o),w=parseFloat(a);c=parseFloat(c),l=parseFloat(l),(u=parseFloat(u))&&(l+=u=parseFloat(u),c+=u),c||l?(c*=jh,l*=jh,x=Math.cos(c)*h,E=Math.sin(c)*h,S=Math.sin(c-l)*-d,M=Math.cos(c-l)*d,l&&(u*=jh,b=Math.tan(l-u),S*=b=Math.sqrt(1+b*b),M*=b,u&&(b=Math.tan(u),x*=b=Math.sqrt(1+b*b),E*=b)),x=An(x),E=An(E),S=An(S),M=An(M)):(x=h,M=d,E=S=0),(y&&!~(o+"").indexOf("px")||w&&!~(a+"").indexOf("px"))&&(y=za(f,"x",o,"px"),w=za(f,"y",a,"px")),(p||m||_||g)&&(y=An(y+p-(p*x+m*S)+_),w=An(w+m-(p*E+m*M)+g)),(r||s)&&(b=f.getBBox(),y=An(y+r/100*b.width),w=An(w+s/100*b.height)),f.setAttribute("transform",b="matrix("+x+","+E+","+S+","+M+","+y+","+w+")"),v&&(f.style[un]=b)},iue=function(e,t,i,r,s){var h,d,o=360,a=ni(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?il:1)-r,u=r+l+"deg";return a&&("short"===(h=s.split("_")[1])&&(l%=o)!=l%180&&(l+=l<0?o:-o),"cw"===h&&l<0?l=(l+o*Q3)%o-~~(l/o)*o:"ccw"===h&&l>0&&(l=(l-o*Q3)%o-~~(l/o)*o)),e._pt=d=new dr(e._pt,t,i,r,l,Vle),d.e=u,d.u="deg",e._props.push(i),d},mV=function(e,t){for(var i in t)e[i]=t[i];return e},rue=function(e,t,i){var a,c,l,u,h,d,p,r=mV({},i._gsap),o=i.style;for(c in r.svg?(l=i.getAttribute("transform"),i.setAttribute("transform",""),o[un]=t,a=Pp(i,1),rl(i,un),i.setAttribute("transform",l)):(l=getComputedStyle(i)[un],o[un]=t,a=Pp(i,1),o[un]=l),Vo)(l=r[c])!==(u=a[c])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(c)<0&&(h=Ai(l)!==(p=Ai(u))?za(i,c,l,p):parseFloat(l),d=parseFloat(u),e._pt=new dr(e._pt,a,c,h,d-h,qC),e._pt.u=p||0,e._props.push(c));mV(a,r)};hr("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",r="Bottom",s="Left",o=(e<3?[t,i,r,s]:[t+s,t+i,r+i,r+s]).map(function(a){return e<2?n+a:"border"+a+n});Sy[e>1?"border"+n:n]=function(a,c,l,u,h){var d,f;if(arguments.length<4)return d=o.map(function(p){return zo(a,p,l)}),5===(f=d.join(" ")).split(d[0]).length?d[0]:f;d=(u+"").split(" "),f={},o.forEach(function(p,m){return f[p]=d[m]=d[m]||d[(m-1)/2|0]}),a.init(c,f,h)}});var gV={name:"css",register:YC,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,s){var l,u,h,d,f,p,m,_,g,v,y,w,x,E,S,M,o=this._props,a=e.style,c=i.vars.startAt;for(m in WC||YC(),this.styles=this.styles||iV(e),M=this.styles.props,this.tween=i,t)if("autoRound"!==m&&(u=t[m],!Or[m]||!H3(m,t,i,r,e,s)))if(p=Sy[m],"function"==(f=typeof u)&&(f=typeof(u=u.call(i,r,e,s))),"string"===f&&~u.indexOf("random(")&&(u=Mp(u)),p)p(this,e,m,u,i)&&(S=1);else if("--"===m.substr(0,2))l=(getComputedStyle(e).getPropertyValue(m)+"").trim(),u+="",ka.lastIndex=0,ka.test(l)||(_=Ai(l),g=Ai(u)),g?_!==g&&(l=za(e,m,l,g)+g):_&&(u+=_),this.add(a,"setProperty",l,u,r,s,0,0,m),o.push(m),M.push(m,0,a[m]);else if("undefined"!==f){if(c&&m in c?(l="function"==typeof c[m]?c[m].call(i,r,e,s):c[m],ni(l)&&~l.indexOf("random(")&&(l=Mp(l)),Ai(l+"")||"auto"===l||(l+=Nr.units[m]||Ai(zo(e,m))||""),"="===(l+"").charAt(1)&&(l=zo(e,m))):l=zo(e,m),d=parseFloat(l),(v="string"===f&&"="===u.charAt(1)&&u.substr(0,2))&&(u=u.substr(2)),h=parseFloat(u),m in to&&("autoAlpha"===m&&(1===d&&"hidden"===zo(e,"visibility")&&h&&(d=0),M.push("visibility",0,a.visibility),Va(this,a,"visibility",d?"inherit":"hidden",h?"inherit":"hidden",!h)),"scale"!==m&&"transform"!==m&&~(m=to[m]).indexOf(",")&&(m=m.split(",")[0])),y=m in Vo)if(this.styles.save(m),w||((x=e._gsap).renderTransform&&!t.parseTransform||Pp(e,t.parseTransform),E=!1!==t.smoothOrigin&&x.smooth,(w=this._pt=new dr(this._pt,a,un,0,1,x.renderTransform,x,0,-1)).dep=1),"scale"===m)this._pt=new dr(this._pt,x,"scaleY",x.scaleY,(v?Bh(x.scaleY,v+h):h)-x.scaleY||0,qC),this._pt.u=0,o.push("scaleY",m),m+="X";else{if("transformOrigin"===m){M.push(pr,0,a[pr]),u=Qle(u),x.svg?JC(e,u,0,E,0,this):((g=parseFloat(u.split(" ")[2])||0)!==x.zOrigin&&Va(this,x,"zOrigin",x.zOrigin,g),Va(this,a,m,My(l),My(u)));continue}if("svgOrigin"===m){JC(e,u,1,E,0,this);continue}if(m in hV){iue(this,x,m,d,v?Bh(d,v+u):u);continue}if("smoothOrigin"===m){Va(this,x,"smooth",x.smooth,u);continue}if("force3D"===m){x[m]=u;continue}if("transform"===m){rue(this,u,e);continue}}else m in a||(m=qh(m)||m);if(y||(h||0===h)&&(d||0===d)&&!Ble.test(u)&&m in a)h||(h=0),(_=(l+"").substr((d+"").length))!==(g=Ai(u)||(m in Nr.units?Nr.units[m]:_))&&(d=za(e,m,l,g)),this._pt=new dr(this._pt,y?x:a,m,d,(v?Bh(d,v+h):h)-d,y||"px"!==g&&"zIndex"!==m||!1===t.autoRound?qC:Hle),this._pt.u=g||0,_!==g&&"%"!==g&&(this._pt.b=l,this._pt.r=zle);else if(m in a)Jle.call(this,e,m,l,v?v+u:u);else if(m in e)this.add(e,m,l||e[m],v?v+u:u,r,s);else if("parseTransform"!==m){xC(m,u);continue}y||(m in a?M.push(m,0,a[m]):M.push(m,1,l||e[m])),o.push(m)}S&&X3(this)},render:function(e,t){if(t.tween._time||!jC())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:zo,aliases:to,getSetter:function(e,t,i){var r=to[t];return r&&r.indexOf(",")<0&&(t=r),t in Vo&&t!==pr&&(e._gsap.x||zo(e,"x"))?i&&J3===i?"scale"===t?$le:jle:(J3=i||{})&&("scale"===t?qle:Xle):e.style&&!mC(e.style[t])?Gle:~t.indexOf("-")?Wle:BC(e,t)},core:{_removeProperty:rl,_getMatrix:KC}};fr.utils.checkPrefix=qh,fr.core.getStyleSaver=iV,function(n,e,t,i){var r=hr(n+","+e+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(s){Vo[s]=1});hr(e,function(s){Nr.units[s]="deg",hV[s]=1}),to[r[13]]=n+","+e,hr("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(s){var o=s.split(":");to[o[1]]=r[o[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),hr("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Nr.units[n]="px"}),fr.registerPlugin(gV);var Lp=fr.registerPlugin(gV)||fr;let _V=(()=>{var n;class e{constructor(){this.dummyCamera=new gn,this.dolly=new gn,this.theta=0,this.radius=5}createCamera(i){return this.camera=new ti(i.fov,i.width/i.height,i.near,i.far),this.camera.position.set(i.position.x,i.position.y,24),this.camera.rotation.set(0,0,0),this.camera.name=i.name,this.camera}addDolly(){return this.dolly.add(this.camera),this.camera?.add(this.dummyCamera),this.dolly}moveDolly(i,r,s){}moveCamera(i,r,s,o){Lp.to(this.camera.position,{x:i,y:r,z:s,duration:o})}rotateCamera(i,r,s){Lp.to(this.camera.rotation,{x:i,y:r,z:s,duration:3.2})}animateCamera(i){this.theta+=.1*i.delta,i.camera.position.x=this.radius*Math.sin(Cc_degToRad(this.theta)),i.camera.position.y=this.radius*Math.sin(Cc_degToRad(this.theta)),i.camera.position.z=this.radius*Math.cos(Cc_degToRad(this.theta)),i.camera.lookAt(i.look)}updateCamera(i){i.camera.updateMatrixWorld()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})();const vV={type:"change"},eT={type:"start"},yV={type:"end"},Cy=new Ic,wV=new No,sue=Math.cos(70*Cc_DEG2RAD);class oue extends Sc{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new A,this.cursor=new A,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(N){N.addEventListener("keydown",T),this._domElementKeyEvents=N},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",T),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(vV),i.update(),s=r.NONE},this.update=function(){const N=new A,me=(new hi).setFromUnitVectors(e.up,new A(0,1,0)),ne=me.clone().invert(),Qe=new A,ze=new hi,qe=new A,Le=2*Math.PI;return function(gt=null){const O=i.object.position;N.copy(O).sub(i.target),N.applyQuaternion(me),a.setFromVector3(N),i.autoRotate&&s===r.NONE&&L(function b(N){return null!==N?2*Math.PI/60*i.autoRotateSpeed*N:2*Math.PI/60/60*i.autoRotateSpeed}(gt)),i.enableDamping?(a.theta+=c.theta*i.dampingFactor,a.phi+=c.phi*i.dampingFactor):(a.theta+=c.theta,a.phi+=c.phi);let be=i.minAzimuthAngle,oe=i.maxAzimuthAngle;isFinite(be)&&isFinite(oe)&&(be<-Math.PI?be+=Le:be>Math.PI&&(be-=Le),oe<-Math.PI?oe+=Le:oe>Math.PI&&(oe-=Le),a.theta=be<=oe?Math.max(be,Math.min(oe,a.theta)):a.theta>(be+oe)/2?Math.max(be,a.theta):Math.min(oe,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor),a.radius=q(i.zoomToCursor&&E||i.object.isOrthographicCamera?a.radius:a.radius*l),N.setFromSpherical(a),N.applyQuaternion(ne),O.copy(i.target).add(N),i.object.lookAt(i.target),!0===i.enableDamping?(c.theta*=1-i.dampingFactor,c.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(c.set(0,0,0),u.set(0,0,0));let J=!1;if(i.zoomToCursor&&E){let de=null;if(i.object.isPerspectiveCamera){const je=N.length();de=q(je*l),i.object.position.addScaledVector(w,je-de),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const je=new A(x.x,x.y,0);je.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/l)),i.object.updateProjectionMatrix(),J=!0;const _t=new A(x.x,x.y,0);_t.unproject(i.object),i.object.position.sub(_t).add(je),i.object.updateMatrixWorld(),de=N.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;null!==de&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(de).add(i.object.position):(Cy.origin.copy(i.object.position),Cy.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(Cy.direction))<sue?e.lookAt(i.target):(wV.setFromNormalAndCoplanarPoint(i.object.up,i.target),Cy.intersectPlane(wV,i.target))))}else i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/l)),i.object.updateProjectionMatrix(),J=!0);return l=1,E=!1,!!(J||Qe.distanceToSquared(i.object.position)>o||8*(1-ze.dot(i.object.quaternion))>o||qe.distanceToSquared(i.target)>0)&&(i.dispatchEvent(vV),Qe.copy(i.object.position),ze.copy(i.object.quaternion),qe.copy(i.target),!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",se),i.domElement.removeEventListener("pointerdown",Te),i.domElement.removeEventListener("pointercancel",Ye),i.domElement.removeEventListener("wheel",I),i.domElement.removeEventListener("pointermove",De),i.domElement.removeEventListener("pointerup",Ye),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",T),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new NB,c=new NB;let l=1;const u=new A,h=new Y,d=new Y,f=new Y,p=new Y,m=new Y,_=new Y,g=new Y,v=new Y,y=new Y,w=new A,x=new Y;let E=!1;const S=[],M={};function C(){return Math.pow(.95,i.zoomSpeed)}function L(N){c.theta-=N}function F(N){c.phi-=N}const B=function(){const N=new A;return function(ne,Qe){N.setFromMatrixColumn(Qe,0),N.multiplyScalar(-ne),u.add(N)}}(),R=function(){const N=new A;return function(ne,Qe){!0===i.screenSpacePanning?N.setFromMatrixColumn(Qe,1):(N.setFromMatrixColumn(Qe,0),N.crossVectors(i.object.up,N)),N.multiplyScalar(ne),u.add(N)}}(),k=function(){const N=new A;return function(ne,Qe){const ze=i.domElement;if(i.object.isPerspectiveCamera){N.copy(i.object.position).sub(i.target);let Le=N.length();Le*=Math.tan(i.object.fov/2*Math.PI/180),B(2*ne*Le/ze.clientHeight,i.object.matrix),R(2*Qe*Le/ze.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(B(ne*(i.object.right-i.object.left)/i.object.zoom/ze.clientWidth,i.object.matrix),R(Qe*(i.object.top-i.object.bottom)/i.object.zoom/ze.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function V(N){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?l/=N:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function z(N){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?l*=N:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function re(N){if(!i.zoomToCursor)return;E=!0;const me=i.domElement.getBoundingClientRect(),Qe=N.clientY-me.top,qe=me.height;x.x=(N.clientX-me.left)/me.width*2-1,x.y=-Qe/qe*2+1,w.set(x.x,x.y,1).unproject(i.object).sub(i.object.position).normalize()}function q(N){return Math.max(i.minDistance,Math.min(i.maxDistance,N))}function ee(N){h.set(N.clientX,N.clientY)}function _e(N){p.set(N.clientX,N.clientY)}function Be(){1===S.length?h.set(S[0].pageX,S[0].pageY):h.set(.5*(S[0].pageX+S[1].pageX),.5*(S[0].pageY+S[1].pageY))}function We(){1===S.length?p.set(S[0].pageX,S[0].pageY):p.set(.5*(S[0].pageX+S[1].pageX),.5*(S[0].pageY+S[1].pageY))}function Se(){const N=S[0].pageX-S[1].pageX,me=S[0].pageY-S[1].pageY,ne=Math.sqrt(N*N+me*me);g.set(0,ne)}function ge(N){if(1==S.length)d.set(N.pageX,N.pageY);else{const ne=Ee(N);d.set(.5*(N.pageX+ne.x),.5*(N.pageY+ne.y))}f.subVectors(d,h).multiplyScalar(i.rotateSpeed);const me=i.domElement;L(2*Math.PI*f.x/me.clientHeight),F(2*Math.PI*f.y/me.clientHeight),h.copy(d)}function Q(N){if(1===S.length)m.set(N.pageX,N.pageY);else{const me=Ee(N);m.set(.5*(N.pageX+me.x),.5*(N.pageY+me.y))}_.subVectors(m,p).multiplyScalar(i.panSpeed),k(_.x,_.y),p.copy(m)}function fe(N){const me=Ee(N),ne=N.pageX-me.x,Qe=N.pageY-me.y,ze=Math.sqrt(ne*ne+Qe*Qe);v.set(0,ze),y.set(0,Math.pow(v.y/g.y,i.zoomSpeed)),V(y.y),g.copy(v)}function Te(N){!1!==i.enabled&&(0===S.length&&(i.domElement.setPointerCapture(N.pointerId),i.domElement.addEventListener("pointermove",De),i.domElement.addEventListener("pointerup",Ye)),function he(N){S.push(N)}(N),"touch"===N.pointerType?function H(N){switch(pe(N),S.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Be(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;We(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Fe(){i.enableZoom&&Se(),i.enablePan&&We()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function P(){i.enableZoom&&Se(),i.enableRotate&&Be()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(eT)}(N):function wt(N){let me;switch(N.button){case 0:me=i.mouseButtons.LEFT;break;case 1:me=i.mouseButtons.MIDDLE;break;case 2:me=i.mouseButtons.RIGHT;break;default:me=-1}switch(me){case 1:if(!1===i.enableZoom)return;(function te(N){re(N),g.set(N.clientX,N.clientY)})(N),s=r.DOLLY;break;case 0:if(N.ctrlKey||N.metaKey||N.shiftKey){if(!1===i.enablePan)return;_e(N),s=r.PAN}else{if(!1===i.enableRotate)return;ee(N),s=r.ROTATE}break;case 2:if(N.ctrlKey||N.metaKey||N.shiftKey){if(!1===i.enableRotate)return;ee(N),s=r.ROTATE}else{if(!1===i.enablePan)return;_e(N),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(eT)}(N))}function De(N){!1!==i.enabled&&("touch"===N.pointerType?function ue(N){switch(pe(N),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;ge(N),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;Q(N),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function ie(N){i.enableZoom&&fe(N),i.enablePan&&Q(N)})(N),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function Ve(N){i.enableZoom&&fe(N),i.enableRotate&&ge(N)})(N),i.update();break;default:s=r.NONE}}(N):function nn(N){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function G(N){d.set(N.clientX,N.clientY),f.subVectors(d,h).multiplyScalar(i.rotateSpeed);const me=i.domElement;L(2*Math.PI*f.x/me.clientHeight),F(2*Math.PI*f.y/me.clientHeight),h.copy(d),i.update()}(N);break;case r.DOLLY:if(!1===i.enableZoom)return;!function K(N){v.set(N.clientX,N.clientY),y.subVectors(v,g),y.y>0?V(C()):y.y<0&&z(C()),g.copy(v),i.update()}(N);break;case r.PAN:if(!1===i.enablePan)return;!function ae(N){m.set(N.clientX,N.clientY),_.subVectors(m,p).multiplyScalar(i.panSpeed),k(_.x,_.y),p.copy(m),i.update()}(N)}}(N))}function Ye(N){(function ke(N){delete M[N.pointerId];for(let me=0;me<S.length;me++)if(S[me].pointerId==N.pointerId)return void S.splice(me,1)})(N),0===S.length&&(i.domElement.releasePointerCapture(N.pointerId),i.domElement.removeEventListener("pointermove",De),i.domElement.removeEventListener("pointerup",Ye)),i.dispatchEvent(yV),s=r.NONE}function I(N){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(N.preventDefault(),i.dispatchEvent(eT),function ye(N){re(N),N.deltaY<0?z(C()):N.deltaY>0&&V(C()),i.update()}(N),i.dispatchEvent(yV))}function T(N){!1===i.enabled||!1===i.enablePan||function Ce(N){let me=!1;switch(N.code){case i.keys.UP:N.ctrlKey||N.metaKey||N.shiftKey?F(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):k(0,i.keyPanSpeed),me=!0;break;case i.keys.BOTTOM:N.ctrlKey||N.metaKey||N.shiftKey?F(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):k(0,-i.keyPanSpeed),me=!0;break;case i.keys.LEFT:N.ctrlKey||N.metaKey||N.shiftKey?L(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):k(i.keyPanSpeed,0),me=!0;break;case i.keys.RIGHT:N.ctrlKey||N.metaKey||N.shiftKey?L(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):k(-i.keyPanSpeed,0),me=!0}me&&(N.preventDefault(),i.update())}(N)}function se(N){!1!==i.enabled&&N.preventDefault()}function pe(N){let me=M[N.pointerId];void 0===me&&(me=new Y,M[N.pointerId]=me),me.set(N.pageX,N.pageY)}function Ee(N){return M[(N.pointerId===S[0].pointerId?S[1]:S[0]).pointerId]}i.domElement.addEventListener("contextmenu",se),i.domElement.addEventListener("pointerdown",Te),i.domElement.addEventListener("pointercancel",Ye),i.domElement.addEventListener("wheel",I,{passive:!1}),this.update()}}class io{constructor(e,t,i,r,s="div"){this.parent=e,this.object=t,this.property=i,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement(s),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),io.nextNameID=io.nextNameID||0,this.$name.id="lil-gui-name-"+ ++io.nextNameID,this.$widget=document.createElement("div"),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",o=>o.stopPropagation()),this.domElement.addEventListener("keyup",o=>o.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(e){return this._name=e,this.$name.innerHTML=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),void 0!==this._onChange&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),void 0!==this._onFinishChange&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled||(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e)),this}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,void 0!==this._listenCallbackID&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.object[this.property]=e,this._callOnChange(),this.updateDisplay(),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class aue extends io{constructor(e,t,i){super(e,t,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function tT(n){let e,t;return(e=n.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=n.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=n.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),!!t&&"#"+t}const cue={isPrimitive:!0,match:n=>"string"==typeof n,fromHexString:tT,toHexString:tT},Op={isPrimitive:!0,match:n=>"number"==typeof n,fromHexString:n=>parseInt(n.substring(1),16),toHexString:n=>"#"+n.toString(16).padStart(6,0)},lue=[cue,Op,{isPrimitive:!1,match:n=>Array.isArray(n),fromHexString(n,e,t=1){const i=Op.fromHexString(n);e[0]=(i>>16&255)/255*t,e[1]=(i>>8&255)/255*t,e[2]=(255&i)/255*t},toHexString:([n,e,t],i=1)=>Op.toHexString(n*(i=255/i)<<16^e*i<<8^t*i<<0)},{isPrimitive:!1,match:n=>Object(n)===n,fromHexString(n,e,t=1){const i=Op.fromHexString(n);e.r=(i>>16&255)/255*t,e.g=(i>>8&255)/255*t,e.b=(255&i)/255*t},toHexString:({r:n,g:e,b:t},i=1)=>Op.toHexString(n*(i=255/i)<<16^e*i<<8^t*i<<0)}];class hue extends io{constructor(e,t,i,r){super(e,t,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=function uue(n){return lue.find(e=>e.match(n))}(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=tT(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class nT extends io{constructor(e,t,i){super(e,t,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class due extends io{constructor(e,t,i,r,s,o){super(e,t,i,"number"),this._initInput(),this.min(r),this.max(s);const a=void 0!==o;this.step(a?o:this._getImplicitStep(),a),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=100*t+"%"}return this._inputFocused||(this.$input.value=void 0===this._decimals?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const i=v=>{const y=parseFloat(this.$input.value);isNaN(y)||(this._snapClampSetValue(y+v),this.$input.value=this.getValue())};let a,c,l,u,h,o=!1;const p=v=>{if(o){const y=v.clientX-a;Math.abs(v.clientY-c)>5?(v.preventDefault(),this.$input.blur(),o=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(y)>5&&m()}o||(h-=(v.clientY-l)*this._step*this._arrowKeyMultiplier(v),u+h>this._max?h=this._max-u:u+h<this._min&&(h=this._min-u),this._snapClampSetValue(u+h)),l=v.clientY},m=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",m)};this.$input.addEventListener("input",()=>{let v=parseFloat(this.$input.value);isNaN(v)||(this._stepExplicit&&(v=this._snap(v)),this.setValue(this._clamp(v)))}),this.$input.addEventListener("keydown",v=>{"Enter"===v.key&&this.$input.blur(),"ArrowUp"===v.code&&(v.preventDefault(),i(this._step*this._arrowKeyMultiplier(v))),"ArrowDown"===v.code&&(v.preventDefault(),i(this._step*this._arrowKeyMultiplier(v)*-1))}),this.$input.addEventListener("wheel",v=>{this._inputFocused&&(v.preventDefault(),i(this._step*this._normalizeMouseWheel(v)))},{passive:!1}),this.$input.addEventListener("mousedown",v=>{a=v.clientX,c=l=v.clientY,o=!0,u=this.getValue(),h=0,window.addEventListener("mousemove",p),window.addEventListener("mouseup",m)}),this.$input.addEventListener("focus",()=>{this._inputFocused=!0}),this.$input.addEventListener("blur",()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()})}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const t=g=>{const v=this.$slider.getBoundingClientRect();let y=((g,v,y,w,x)=>(g-v)/(y-v)*(this._max-w)+w)(g,v.left,v.right,this._min);this._snapClampSetValue(y)},r=g=>{t(g.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)};let a,c,o=!1;const l=g=>{g.preventDefault(),this._setDraggingStyle(!0),t(g.touches[0].clientX),o=!1},h=g=>{if(o){const y=g.touches[0].clientY-c;Math.abs(g.touches[0].clientX-a)>Math.abs(y)?l(g):(window.removeEventListener("touchmove",h),window.removeEventListener("touchend",d))}else g.preventDefault(),t(g.touches[0].clientX)},d=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",h),window.removeEventListener("touchend",d)},f=this._callOnFinishChange.bind(this);let m;this.$slider.addEventListener("mousedown",g=>{this._setDraggingStyle(!0),t(g.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)}),this.$slider.addEventListener("touchstart",g=>{g.touches.length>1||(this._hasScrollBar?(a=g.touches[0].clientX,c=g.touches[0].clientY,o=!0):l(g),window.addEventListener("touchmove",h,{passive:!1}),window.addEventListener("touchend",d))},{passive:!1}),this.$slider.addEventListener("wheel",g=>{if(Math.abs(g.deltaX)<Math.abs(g.deltaY)&&this._hasScrollBar)return;g.preventDefault();const y=this._normalizeMouseWheel(g)*this._step;this._snapClampSetValue(this.getValue()+y),this.$input.value=this.getValue(),clearTimeout(m),m=setTimeout(f,400)},{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:i}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,i=-e.wheelDelta/120,i*=this._stepExplicit?1:10),t+-i}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return void 0!==this._min}get _hasMax(){return void 0!==this._max}}class fue extends io{constructor(e,t,i,r){super(e,t,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.options(r)}options(e){return this._values=Array.isArray(e)?e:Object.values(e),this._names=Array.isArray(e)?e:Object.keys(e),this.$select.replaceChildren(),this._names.forEach(t=>{const i=document.createElement("option");i.innerHTML=t,this.$select.appendChild(i)}),this.updateDisplay(),this}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.innerHTML=-1===t?e:this._names[t],this}}class pue extends io{constructor(e,t,i){super(e,t,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{"Enter"===r.code&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}let xV=!1;class iT{constructor({parent:e,autoPlace:t=void 0===e,container:i,width:r,title:s="Controls",closeFolders:o=!1,injectStyles:a=!0,touchStyles:c=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",l=>{("Enter"===l.code||"Space"===l.code)&&(l.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),this.parent)return this.parent.children.push(this),this.parent.folders.push(this),void this.parent.$children.appendChild(this.domElement);this.domElement.classList.add("root"),c&&this.domElement.classList.add("allow-touch-styles"),!xV&&a&&(function gue(n){const e=document.createElement("style");e.innerHTML=n;const t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}('.lil-gui {\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  line-height: 1;\n  font-weight: normal;\n  font-style: normal;\n  text-align: left;\n  color: var(--text-color);\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  --background-color: #1f1f1f;\n  --text-color: #ebebeb;\n  --title-background-color: #111111;\n  --title-text-color: #ebebeb;\n  --widget-color: #424242;\n  --hover-color: #4f4f4f;\n  --focus-color: #595959;\n  --number-color: #2cc9ff;\n  --string-color: #a2db3c;\n  --font-size: 11px;\n  --input-font-size: 11px;\n  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;\n  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;\n  --padding: 4px;\n  --spacing: 4px;\n  --widget-height: 20px;\n  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);\n  --name-width: 45%;\n  --slider-knob-width: 2px;\n  --slider-input-width: 27%;\n  --color-input-width: 27%;\n  --slider-input-min-width: 45px;\n  --color-input-min-width: 45px;\n  --folder-indent: 7px;\n  --widget-padding: 0 0 0 3px;\n  --widget-border-radius: 2px;\n  --checkbox-size: calc(0.75 * var(--widget-height));\n  --scrollbar-width: 5px;\n}\n.lil-gui, .lil-gui * {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n.lil-gui.root {\n  width: var(--width, 245px);\n  display: flex;\n  flex-direction: column;\n  background: var(--background-color);\n}\n.lil-gui.root > .title {\n  background: var(--title-background-color);\n  color: var(--title-text-color);\n}\n.lil-gui.root > .children {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.lil-gui.root > .children::-webkit-scrollbar {\n  width: var(--scrollbar-width);\n  height: var(--scrollbar-width);\n  background: var(--background-color);\n}\n.lil-gui.root > .children::-webkit-scrollbar-thumb {\n  border-radius: var(--scrollbar-width);\n  background: var(--focus-color);\n}\n@media (pointer: coarse) {\n  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {\n    --widget-height: 28px;\n    --padding: 6px;\n    --spacing: 6px;\n    --font-size: 13px;\n    --input-font-size: 16px;\n    --folder-indent: 10px;\n    --scrollbar-width: 7px;\n    --slider-input-min-width: 50px;\n    --color-input-min-width: 65px;\n  }\n}\n.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {\n  --widget-height: 28px;\n  --padding: 6px;\n  --spacing: 6px;\n  --font-size: 13px;\n  --input-font-size: 16px;\n  --folder-indent: 10px;\n  --scrollbar-width: 7px;\n  --slider-input-min-width: 50px;\n  --color-input-min-width: 65px;\n}\n.lil-gui.autoPlace {\n  max-height: 100%;\n  position: fixed;\n  top: 0;\n  right: 15px;\n  z-index: 1001;\n}\n\n.lil-gui .controller {\n  display: flex;\n  align-items: center;\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n}\n.lil-gui .controller.disabled {\n  opacity: 0.5;\n}\n.lil-gui .controller.disabled, .lil-gui .controller.disabled * {\n  pointer-events: none !important;\n}\n.lil-gui .controller > .name {\n  min-width: var(--name-width);\n  flex-shrink: 0;\n  white-space: pre;\n  padding-right: var(--spacing);\n  line-height: var(--widget-height);\n}\n.lil-gui .controller .widget {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  min-height: var(--widget-height);\n}\n.lil-gui .controller.string input {\n  color: var(--string-color);\n}\n.lil-gui .controller.boolean {\n  cursor: pointer;\n}\n.lil-gui .controller.color .display {\n  width: 100%;\n  height: var(--widget-height);\n  border-radius: var(--widget-border-radius);\n  position: relative;\n}\n@media (hover: hover) {\n  .lil-gui .controller.color .display:hover:before {\n    content: " ";\n    display: block;\n    position: absolute;\n    border-radius: var(--widget-border-radius);\n    border: 1px solid #fff9;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n}\n.lil-gui .controller.color input[type=color] {\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.lil-gui .controller.color input[type=text] {\n  margin-left: var(--spacing);\n  font-family: var(--font-family-mono);\n  min-width: var(--color-input-min-width);\n  width: var(--color-input-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.option select {\n  opacity: 0;\n  position: absolute;\n  width: 100%;\n  max-width: 100%;\n}\n.lil-gui .controller.option .display {\n  position: relative;\n  pointer-events: none;\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  line-height: var(--widget-height);\n  max-width: 100%;\n  overflow: hidden;\n  word-break: break-all;\n  padding-left: 0.55em;\n  padding-right: 1.75em;\n  background: var(--widget-color);\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .display.focus {\n    background: var(--focus-color);\n  }\n}\n.lil-gui .controller.option .display.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.option .display:after {\n  font-family: "lil-gui";\n  content: "\u2195";\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  padding-right: 0.375em;\n}\n.lil-gui .controller.option .widget,\n.lil-gui .controller.option select {\n  cursor: pointer;\n}\n@media (hover: hover) {\n  .lil-gui .controller.option .widget:hover .display {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number input {\n  color: var(--number-color);\n}\n.lil-gui .controller.number.hasSlider input {\n  margin-left: var(--spacing);\n  width: var(--slider-input-width);\n  min-width: var(--slider-input-min-width);\n  flex-shrink: 0;\n}\n.lil-gui .controller.number .slider {\n  width: 100%;\n  height: var(--widget-height);\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  padding-right: var(--slider-knob-width);\n  overflow: hidden;\n  cursor: ew-resize;\n  touch-action: pan-y;\n}\n@media (hover: hover) {\n  .lil-gui .controller.number .slider:hover {\n    background: var(--hover-color);\n  }\n}\n.lil-gui .controller.number .slider.active {\n  background: var(--focus-color);\n}\n.lil-gui .controller.number .slider.active .fill {\n  opacity: 0.95;\n}\n.lil-gui .controller.number .fill {\n  height: 100%;\n  border-right: var(--slider-knob-width) solid var(--number-color);\n  box-sizing: content-box;\n}\n\n.lil-gui-dragging .lil-gui {\n  --hover-color: var(--widget-color);\n}\n.lil-gui-dragging * {\n  cursor: ew-resize !important;\n}\n\n.lil-gui-dragging.lil-gui-vertical * {\n  cursor: ns-resize !important;\n}\n\n.lil-gui .title {\n  height: var(--title-height);\n  line-height: calc(var(--title-height) - 4px);\n  font-weight: 600;\n  padding: 0 var(--padding);\n  -webkit-tap-highlight-color: transparent;\n  cursor: pointer;\n  outline: none;\n  text-decoration-skip: objects;\n}\n.lil-gui .title:before {\n  font-family: "lil-gui";\n  content: "\u25be";\n  padding-right: 2px;\n  display: inline-block;\n}\n.lil-gui .title:active {\n  background: var(--title-background-color);\n  opacity: 0.75;\n}\n@media (hover: hover) {\n  body:not(.lil-gui-dragging) .lil-gui .title:hover {\n    background: var(--title-background-color);\n    opacity: 0.85;\n  }\n  .lil-gui .title:focus {\n    text-decoration: underline var(--focus-color);\n  }\n}\n.lil-gui.root > .title:focus {\n  text-decoration: none !important;\n}\n.lil-gui.closed > .title:before {\n  content: "\u25b8";\n}\n.lil-gui.closed > .children {\n  transform: translateY(-7px);\n  opacity: 0;\n}\n.lil-gui.closed:not(.transition) > .children {\n  display: none;\n}\n.lil-gui.transition > .children {\n  transition-duration: 300ms;\n  transition-property: height, opacity, transform;\n  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);\n  overflow: hidden;\n  pointer-events: none;\n}\n.lil-gui .children:empty:before {\n  content: "Empty";\n  padding: 0 var(--padding);\n  margin: var(--spacing) 0;\n  display: block;\n  height: var(--widget-height);\n  font-style: italic;\n  line-height: var(--widget-height);\n  opacity: 0.5;\n}\n.lil-gui.root > .children > .lil-gui > .title {\n  border: 0 solid var(--widget-color);\n  border-width: 1px 0;\n  transition: border-color 300ms;\n}\n.lil-gui.root > .children > .lil-gui.closed > .title {\n  border-bottom-color: transparent;\n}\n.lil-gui + .controller {\n  border-top: 1px solid var(--widget-color);\n  margin-top: 0;\n  padding-top: var(--spacing);\n}\n.lil-gui .lil-gui .lil-gui > .title {\n  border: none;\n}\n.lil-gui .lil-gui .lil-gui > .children {\n  border: none;\n  margin-left: var(--folder-indent);\n  border-left: 2px solid var(--widget-color);\n}\n.lil-gui .lil-gui .controller {\n  border: none;\n}\n\n.lil-gui label, .lil-gui input, .lil-gui button {\n  -webkit-tap-highlight-color: transparent;\n}\n.lil-gui input {\n  border: 0;\n  outline: none;\n  font-family: var(--font-family);\n  font-size: var(--input-font-size);\n  border-radius: var(--widget-border-radius);\n  height: var(--widget-height);\n  background: var(--widget-color);\n  color: var(--text-color);\n  width: 100%;\n}\n@media (hover: hover) {\n  .lil-gui input:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui input:active {\n    background: var(--focus-color);\n  }\n}\n.lil-gui input:disabled {\n  opacity: 1;\n}\n.lil-gui input[type=text],\n.lil-gui input[type=number] {\n  padding: var(--widget-padding);\n  -moz-appearance: textfield;\n}\n.lil-gui input[type=text]:focus,\n.lil-gui input[type=number]:focus {\n  background: var(--focus-color);\n}\n.lil-gui input[type=checkbox] {\n  appearance: none;\n  width: var(--checkbox-size);\n  height: var(--checkbox-size);\n  border-radius: var(--widget-border-radius);\n  text-align: center;\n  cursor: pointer;\n}\n.lil-gui input[type=checkbox]:checked:before {\n  font-family: "lil-gui";\n  content: "\u2713";\n  font-size: var(--checkbox-size);\n  line-height: var(--checkbox-size);\n}\n@media (hover: hover) {\n  .lil-gui input[type=checkbox]:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button {\n  outline: none;\n  cursor: pointer;\n  font-family: var(--font-family);\n  font-size: var(--font-size);\n  color: var(--text-color);\n  width: 100%;\n  height: var(--widget-height);\n  text-transform: none;\n  background: var(--widget-color);\n  border-radius: var(--widget-border-radius);\n  border: none;\n}\n@media (hover: hover) {\n  .lil-gui button:hover {\n    background: var(--hover-color);\n  }\n  .lil-gui button:focus {\n    box-shadow: inset 0 0 0 1px var(--focus-color);\n  }\n}\n.lil-gui button:active {\n  background: var(--focus-color);\n}\n\n@font-face {\n  font-family: "lil-gui";\n  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");\n}'),xV=!0),i?i.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this._closeFolders=o}add(e,t,i,r,s){if(Object(i)===i)return new fue(this,e,t,i);const o=e[t];switch(typeof o){case"number":return new due(this,e,t,i,r,s);case"boolean":return new aue(this,e,t);case"string":return new pue(this,e,t);case"function":return new nT(this,e,t)}console.error("gui.add failed\n\tproperty:",t,"\n\tobject:",e,"\n\tvalue:",o)}addColor(e,t,i=1){return new hue(this,e,t,i)}addFolder(e){const t=new iT({parent:this,title:e});return this.root._closeFolders&&t.close(),t}load(e,t=!0){return e.controllers&&this.controllers.forEach(i=>{i instanceof nT||i._name in e.controllers&&i.load(e.controllers[i._name])}),t&&e.folders&&this.folders.forEach(i=>{i._title in e.folders&&i.load(e.folders[i._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof nT)){if(i._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);t.controllers[i._name]=i.save()}}),e&&this.folders.forEach(i=>{if(i._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);t.folders[i._title]=i.save()}),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{this.$children.style.height=this.$children.clientHeight+"px",this.domElement.classList.add("transition");const i=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(e){return this._title=e,this.$title.innerHTML=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(i=>i.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),void 0!==this._onChange&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),void 0!==this._onFinishChange&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),void 0!==this._onOpenClose&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}const _ue=iT;let al=(()=>{var n;class e{constructor(){this.positionOptions={min:-20,max:20},this.intensityOptions={min:0,max:10,precision:1}}addToDebug(i){this.gui||(this.gui=new _ue({closeFolders:!0}),this.gui.open(!1));const r=this.gui.addFolder(`${i.name||i.obj.name}`);for(const[s,o]of Object.entries(i.properties))switch(s){case"Position":this.addPosition(i,r,o);break;case"Color":this.addColor(i,r,o);break;case"Intensity":this.addIntensity(i,r,o);break;case"Rotation":this.addRotation(i,r,o);break;case"Scale":this.addScale(i,r,o);break;case"LookAt":const a=r.addFolder("LookAt");this.addPosition(i,a,o);break;default:r.add(i.obj,s,i.min,i.max,i.precision)}}addScale(i,r,s){const o=r.addFolder("Scale"),a=Object.assign({},{min:0,max:100,precision:1},s);o.add(i.obj.scale,"x",a.min,a.max,a.precision),o.add(i.obj.scale,"y",a.min,a.max,a.precision),o.add(i.obj.scale,"z",a.min,a.max,a.precision)}addRotation(i,r,s){const o=r.addFolder("Rotation"),a=Object.assign({},{min:0,max:360,precision:1},s);o.add(i.obj.rotation,"x",a.min,a.max,a.precision),o.add(i.obj.rotation,"y",a.min,a.max,a.precision),o.add(i.obj.rotation,"z",a.min,a.max,a.precision)}addIntensity(i,r,s){const o=r.addFolder("Intensity"),a=Object.assign({},this.intensityOptions,s);o.add(i.obj,"intensity",a.min,a.max,a.precision)}addColor(i,r,s){const o=r.addFolder("Color");o.addColor(i.obj,"color").onChange(a=>{i.obj.color.set(a)}),o.open()}addPosition(i,r,s){const o=r.addFolder("Position"),a=Object.assign({},this.positionOptions,s);o.add(i.obj.position,"x",a.min,a.max,a.precision).onChange(c=>{i.obj.position.x=c}),o.add(i.obj.position,"y",a.min,a.max,a.precision).onChange(c=>{}),o.add(i.obj.position,"z",a.min,a.max,a.precision).onChange(c=>{}),o.open()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})(),vue=(()=>{var n;class e{constructor(i){this.debug=i,this.raycaster=new QM,this.tempMatrix=new Ge,this.controllers=[],this.workingMatrix=new Ge,this.workingVector=new A,this.origin=new A,this.userData={selectPressed:!1}}createControls(i){if(this.renderer=i.renderer,"orbit"===i.type)return this.createOrbitControls(i)}createOrbitControls(i){return this.controls=new oue(i.camera,i.canvas),this.controls.target.set(0,1.6,0),this.controls.listenToKeyEvents(window),this.controls.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.controls.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.controls.touches={ONE:0,TWO:2},this.controls.enableDamping=!0,this.controls.dampingFactor=.07,this.controls.screenSpacePanning=!1,this.controls.panSpeed=.5,this.controls.rotateSpeed=.5,this.controls.keyPanSpeed=40,this.controls.minDistance=i.minDistance||-30,this.controls.maxDistance=i.maxDistance||50,this.controls.zoomSpeed=.5,this.controls.maxZoom=30,this.controls.minZoom=-30,this.controls.maxPolarAngle=Math.PI/2,this.controls.screenSpacePanning=!1,this.debug.addToDebug({obj:this.controls,name:"Orbit Controls",properties:{panSpeed:{min:0,max:1,precision:.01},rotateSpeed:{min:0,max:1,precision:.01},zoomSpeed:{min:0,max:1,precision:.01},dampingFactor:{min:0,max:1,precision:.01},minDistance:{min:0,max:5,precision:.01},maxDistance:{min:10,max:500,precision:1},keyPanSpeed:{min:0,max:100,precision:1}}}),this.controls}createControllers(){this.controllers[0]=this.renderer.xr.getController(0),this.controllers[0].addEventListener("selectstart",this.onSelectStart.bind(this)),this.controllers[0].addEventListener("selectend",this.onSelectEnd.bind(this)),this.controllers[0].addEventListener("select",this.onSelect.bind(this)),this.controls.dispose()}handleControllers(i,r){}updateControls(i){return this.renderer.xr&&this.renderer.xr?.isPresenting?(this.controls.enabled=!1,this.handleControllers()):this.controls.update(i)}get selectPressed(){return void 0!==this.controllers&&this.controllers[0].userData.selectPressed||this.controllers[1].userData.selectPressed}getControllerIntersections(i,r){i.updateMatrixWorld(),this.tempMatrix.identity().extractRotation(i.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(i.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(this.tempMatrix);const s=this.raycaster.intersectObjects(r,!1);return console.log("intersectedObjects ",s),s}onPinchEndLeft(i){console.log("Pinch end Left ",i)}onPinchEndRight(i){console.log("Pinch end Right ",i)}onPinchStartLeft(i){console.log("Pinch start Left ",i)}onPinchStartRight(i){console.log("Pinch start Right ",i)}onSelect(i){console.log("Select controller service  ",i)}onSelectStart(i){console.log("SelectStart controller service  ",i),this.userData.selectPressed=!0}onSelectEnd(i){console.log("SelectEnd controller service  ",i),this.userData.selectPressed=!1}}return(n=e).\u0275fac=function(i){return new(i||n)(we(al))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})();function Fp(n){return Fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fp(n)}function ut(n,e,t){return(e=function wue(n){var e=function yue(n,e){if("object"!==Fp(n)||null===n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var i=t.call(n,e||"default");if("object"!==Fp(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(n)}(n,"string");return"symbol"===Fp(e)?e:String(e)}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var bV=class{constructor(e,t){ut(this,"target",void 0),ut(this,"name",void 0),ut(this,"intersected",void 0),ut(this,"wasIntersected",!1),ut(this,"distance",void 0),this.target=e,this.name=t,this.intersected=!1,this.distance=0}},mr=class{constructor(e,t=null){ut(this,"type",void 0),ut(this,"cancelBubble",void 0),ut(this,"originalEvent",void 0),ut(this,"coords",new Y(0,0)),ut(this,"distance",0),ut(this,"intersected",!1),this.cancelBubble=!1,this.type=e,this.originalEvent=t}stopPropagation(){this.cancelBubble=!0}},xue=class{constructor(e,t,i,r){ut(this,"renderer",void 0),ut(this,"camera",void 0),ut(this,"domElement",void 0),ut(this,"bindEventsOnBodyElement",void 0),ut(this,"autoAdd",void 0),ut(this,"scene",void 0),ut(this,"mouse",void 0),ut(this,"supportsPointerEvents",void 0),ut(this,"interactiveObjects",void 0),ut(this,"closestObject",void 0),ut(this,"raycaster",void 0),ut(this,"treatTouchEventsAsMouseEvents",void 0),ut(this,"dispose",()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentPointerMove):this.domElement.removeEventListener("pointermove",this.onDocumentPointerMove),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove):this.domElement.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd)}),ut(this,"add",(s,o=[])=>{if(s&&!this.interactiveObjects.find(a=>a.target===s))if(o.length>0)o.forEach(a=>{let c=s.getObjectByName(a);if(c){let l=new bV(c,a);this.interactiveObjects.push(l)}});else{let a=new bV(s,s.name);this.interactiveObjects.push(a)}}),ut(this,"remove",(s,o=[])=>{!s||(o.length>0?o.forEach(a=>{let c=s.getObjectByName(a);c&&(this.interactiveObjects=this.interactiveObjects.filter(l=>l.target!==c))}):this.interactiveObjects=this.interactiveObjects.filter(a=>a.target!==s))}),ut(this,"update",()=>{this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(c=>{c.target&&this.checkIntersection(c)}),this.interactiveObjects.sort(function(c,l){return c.distance-l.distance});let o,a,s=this.interactiveObjects.find(c=>c.intersected)??null;if(s!=this.closestObject){if(this.closestObject){let c=new mr("mouseout");this.dispatch(this.closestObject,c)}if(s){let c=new mr("mouseover");this.dispatch(s,c)}this.closestObject=s}this.interactiveObjects.forEach(c=>{!c.intersected&&c.wasIntersected&&(o||(o=new mr("mouseleave")),this.dispatch(c,o))}),this.interactiveObjects.forEach(c=>{c.intersected&&!c.wasIntersected&&(a||(a=new mr("mouseenter")),this.dispatch(c,a))})}),ut(this,"checkIntersection",s=>{let o=this.raycaster.intersectObjects([s.target],!0);if(s.wasIntersected=s.intersected,o.length>0){let a=o[0].distance;o.forEach(c=>{c.distance<a&&(a=c.distance)}),s.intersected=!0,s.distance=a}else s.intersected=!1}),ut(this,"onDocumentMouseMove",s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY);let o=new mr("mousemove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),ut(this,"onDocumentPointerMove",s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY);let o=new mr("pointermove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),ut(this,"onTouchMove",s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY);let o=new mr(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),ut(this,"onMouseClick",s=>{this.update();let o=new mr("click",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})}),ut(this,"onMouseDown",s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY),this.update();let o=new mr("mousedown",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})}),ut(this,"onPointerDown",s=>{this.mapPositionToPoint(this.mouse,s.clientX,s.clientY),this.update();let o=new mr("pointerdown",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})}),ut(this,"onTouchStart",s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY),this.update();let o=new mr(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",s);this.interactiveObjects.forEach(a=>{a.intersected&&this.dispatch(a,o)})}),ut(this,"onMouseUp",s=>{let o=new mr("mouseup",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),ut(this,"onPointerUp",s=>{let o=new mr("pointerup",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),ut(this,"onTouchEnd",s=>{s.touches.length>0&&this.mapPositionToPoint(this.mouse,s.touches[0].clientX,s.touches[0].clientY),this.update();let o=new mr(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",s);this.interactiveObjects.forEach(a=>{this.dispatch(a,o)})}),ut(this,"dispatch",(s,o)=>{s.target&&!o.cancelBubble&&(o.coords=this.mouse,o.distance=s.distance,o.intersected=s.intersected,s.target.dispatchEvent(o))}),ut(this,"mapPositionToPoint",(s,o,a)=>{let c=this.renderer.domElement.getBoundingClientRect();s.x=(o-c.left)/c.width*2-1,s.y=-(a-c.top)/c.height*2+1}),this.renderer=e,this.camera=t,this.domElement=i,this.bindEventsOnBodyElement=!(r&&typeof r.bindEventsOnBodyElement<"u")||r.bindEventsOnBodyElement,this.scene=r&&typeof r.scene<"u"?r.scene:null,this.scene&&(this.scene.onBeforeRender=()=>{this.autoAdd&&null!==this.scene&&this.scene.traverse(s=>{this.add(s),s.addEventListener("removed",o=>{this.remove(o.target)})}),this.update()}),this.autoAdd=!!(r&&typeof r.autoAdd<"u")&&r.autoAdd,this.autoAdd&&null===this.scene&&console.error("Attention: Options.scene needs to be set when using options.autoAdd"),this.mouse=new Y(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new QM,i.addEventListener("click",this.onMouseClick),this.supportsPointerEvents&&(this.bindEventsOnBodyElement?i.ownerDocument.addEventListener("pointermove",this.onDocumentPointerMove):i.addEventListener("pointermove",this.onDocumentPointerMove),i.addEventListener("pointerdown",this.onPointerDown),i.addEventListener("pointerup",this.onPointerUp)),this.bindEventsOnBodyElement?i.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):i.addEventListener("mousemove",this.onDocumentMouseMove),i.addEventListener("mousedown",this.onMouseDown),i.addEventListener("mouseup",this.onMouseUp),i.addEventListener("touchstart",this.onTouchStart,{passive:!0}),i.addEventListener("touchmove",this.onTouchMove,{passive:!0}),i.addEventListener("touchend",this.onTouchEnd,{passive:!0}),this.treatTouchEventsAsMouseEvents=!0}};let kp=(()=>{var n;class e{constructor(){this.colliders={},this.ui={},this.pointer=new Y,this.colliderOptions={name:"object",mesh:null},this.intersectedObjects=[],this.raycasterOptions={origin:new A(0,0,0),direction:null,near:0,far:10},this.raycaster=new QM,this.tempMatrix=new Ge}initInteractionManager(i,r,s){return this.interactionManager=new xue(i,r,s),this.interactionManager.update.bind(this)}addToInteractions(i){this.interactionManager.add(i)}raycast(){return this.intersectedObjects.reduce((r,s)=>{const o=this.raycaster.intersectObject(s,!0);return o[0]&&(!r||o[0].distance<r.distance)?(o[0].object=s,o[0]):r},null)}intersectObjects(i){let r;return i.pointer&&null!==i.pointer.x&&null!==i.pointer.y?this.raycaster.setFromCamera(i.pointer,i.camera):(this.tempMatrix.identity().extractRotation(i.controller.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(i.controller.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(this.tempMatrix),console.log("setting ray from controller ",this.raycaster.ray.origin,this.raycaster.ray.direction)),r=this.raycast(),r&&this.colliders[r.object.uuid]()}removeFromColliders(i){this.colliders=this.colliders.filter(r=>r.name!==i)}setRay(i){this.raycaster.setFromCamera(i.pointer,i.camera)}addToColliders(i){this.intersectedObjects.push(i.mesh),Object.assign({},this.colliderOptions,i),this.colliders[i.mesh.uuid]=i.cb}update(){this.interactionManager.update()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})(),EV=(()=>{var n;class e{constructor(){this.intensity=Math.PI,this.dirLight=new ry(16777215,this.intensity),this.spotLight=new qM(16777215,30,30,this.intensity/4,.5)}createSpotLight(i){return[this.spotLight.clone()]}createHemLight(i){const r=new WM(16165226,10470393,.8);return r.color.setHSL(.6,1,.6),r.groundColor.setHSL(.095,1,.75),r.position.set(-.6,-2,-6),[r]}createPointLight(){return new YM(16777215,Math.PI,13,1)}createDirLight(i){const s=new ry(16777215,i?.intensity||this.intensity);return s.castShadow=!0,s.color.setHSL(.1,1,.95),s.color.convertLinearToSRGB(),s.position.set(-0,12,-15),s.castShadow=!0,s.shadow.mapSize.width=512,s.shadow.mapSize.height=512,s.shadow.camera.left=-50,s.shadow.camera.right=50,s.shadow.camera.top=50,s.shadow.camera.bottom=-50,s.shadow.camera.far=100,s.shadow.bias=-1e-4,s.target.position.set(0,0,-2),[s,s.target]}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})(),rT=(()=>{var n;class e{constructor(i){this.debugService=i,this.meshBasicMaterial=new di,this.normalMaterial=new pB,this.meshLambert=new ty,this.standardMaterial=new Da({roughness:.05,metalness:1}),this.materials={matte:new Fo({specular:4802889,shininess:1}),flat:new ty({}),colors:new Fo({color:16777215,specular:16777215,shininess:2,vertexColors:!0}),multiColors:new Fo({shininess:2,vertexColors:!0}),plastic:new Fo({specular:12698049,shininess:250})},this.params={color:16777215,transmission:1,opacity:1,metalness:0,roughness:0,ior:1.5,thickness:.01,attenuationDistance:1,specularIntensity:1,envMapIntensity:1}}createFloorMaterial(i){return new Da({roughness:.8,color:16777215,metalness:.2,bumpScale:5e-4})}getMaterial(i){return new ts(this.params)}getStandardMaterial(){return this.standardMaterial.clone()}getMeshPhysicalMaterial(i){return new ts({clearcoatRoughness:.1,roughness:.9,color:5505051})}getMaterialByName(i){return this.materials[i]}getBasicMaterial(){return this.standardMaterial}getRandomColoredMaterial(){return new Da({color:16777215*Math.random()})}}return(n=e).\u0275fac=function(i){return new(i||n)(we(al))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})(),SV=(()=>{var n;class e{constructor(i,r,s){this.interactions=i,this.materials=r,this.debug=s,this.boxGeometry=new Po(1,1,1),this.sphereGeometry=new Vc(15,32,16),this.material=this.materials.getRandomColoredMaterial(),this.boxDefaultOptions={scale:1,position:{x:0,y:1.6,z:2},name:"box",material:this.material,cb:o=>{console.log("Collided with a box ",o)}},this.sphereDefaultOptions={name:"sphere",interactive:!0}}createReticle(){const i=new Ot(new Dh(.15,.2,32).rotateX(-Math.PI/2),new di);return i.matrixAutoUpdate=!1,i.visible=!1,this.reticle=i,this.reticle}createIcosahedron(i){const r=Object.assign({radius:1.5,detail:0},i);this.materials.getRandomColoredMaterial(),r.material&&this.materials.getMaterial(r.material);const o=new Ot(new Qv(r.radius,r.detail),this.materials.getRandomColoredMaterial());return o.scale.x=1.3,o}createGround(){const i=new gh(1e4,1e4),r=new ty({color:16777215});r.color.setHSL(.095,1,.75);const s=new Ot(i,r);return s.position.y=-33,s.rotation.x=-Math.PI/2,s.receiveShadow=!0,s}createSkyDom(i){const r=document.getElementById("vertexShader").textContent,s=document.getElementById("fragmentShader").textContent,o={topColor:{value:new Z(30719)},bottomColor:{value:new Z(16777215)},offset:{value:33},exponent:{value:.6}};o.topColor.value.copy(i.color);const a=new Vc(4e3,32,15),c=new Ys({uniforms:o,vertexShader:r,fragmentShader:s,side:1});return new Ot(a,c)}createBackground(i){}createSphere(i){const r=Object.assign({},this.sphereDefaultOptions,i),s=new Ot(this.sphereGeometry,r.material||this.materials.getRandomColoredMaterial());return s.name=r.name,s}createFrame(){new kc(3,3,20,32)}createHeart(){const o=(new Aa).moveTo(25,25).bezierCurveTo(25,25,20,0,0,0).bezierCurveTo(-30,0,-30,35,-30,35).bezierCurveTo(-30,55,-10,77,25,95).bezierCurveTo(60,77,80,55,80,35).bezierCurveTo(80,35,80,0,50,0).bezierCurveTo(35,0,25,25,25,25);return this.addShape(o,{depth:8,bevelEnabled:!0,bevelSegments:2,steps:2,bevelSize:1,bevelThickness:1},15728640,60,100,0,0,0,Math.PI,.003)}createRoundedRect(i){const s=new Aa;return s.moveTo(i.x,i.y+i.radius),s.lineTo(i.x,i.y+i.height-i.radius),s.quadraticCurveTo(i.x,i.y+i.height,i.x+i.radius,i.y+i.height),s.lineTo(i.x+i.width-i.radius,i.y+i.height),s.quadraticCurveTo(i.x+i.width,i.y+i.height,i.x+i.width,i.y+i.height-i.radius),s.lineTo(i.x+i.width,i.y+i.radius),s.quadraticCurveTo(i.x+i.width,i.y,i.x+i.width-i.radius,i.y),s.lineTo(i.x+i.radius,i.y),s.quadraticCurveTo(i.x,i.y,i.x,i.y+i.radius),this.addShape(s,{depth:1,bevelEnabled:!0,bevelSegments:3,steps:3,bevelSize:2,bevelThickness:.5},16777215,i.width/2,0,0,0,0,0,1)}addShape(i,r,s,o,a,c,l,u,h,d){let f=new Jv(i,r),p=new Ot(f,new Fo({color:s}));return p.position.set(o,a,c),p.rotation.set(l,u,h),p.scale.set(d,d,d),p}createBox(i){const r=Object.assign({},this.boxDefaultOptions,i),s=new Ot(this.boxGeometry,r.material||this.materials.getRandomColoredMaterial());return s.position.set(r.position.x,r.position.y,r.position.z),s.name=r.name,s}createNav(i){const r=new Ss,s=new Po(5,5,5),o=new Fo({color:11184674}),a=new sB(s),c=new Bv(a,new Mi({color:0,linewidth:2}));for(let l=-100;l<100;l+=10)for(let u=-100;u<100;u+=10){if(0==l&&0==u)continue;const h=new Ot(s,o);h.position.set(l,2.5,u);const d=c.clone();d.position.copy(h.position),r.add(h),r.add(d)}return r.name="nav",r}createBoxes(i){const r=i.number||1e3,s=i.position||40,o=[];for(let a=0;a<r;a++){const c=new Ot(this.boxGeometry,this.materials.getRandomColoredMaterial());c.position.x=40*Math.random()-20,c.position.y=1.6*Math.random(),c.position.z=Math.random()*s-20,c.rotation.x=2*Math.random()*Math.PI,c.rotation.y=2*Math.random()*Math.PI,c.rotation.z=2*Math.random()*Math.PI,c.scale.x=Math.random()+.5,c.scale.y=Math.random()+.5,c.scale.z=Math.random()+.5,c.name="box"+a,o.push(c)}return o}}return(n=e).\u0275fac=function(i){return new(i||n)(we(kp),we(rT),we(al))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})();var Ty=1e-6,Up=typeof Float32Array<"u"?Float32Array:Array,MV=Math.random;function CV(){var n=new Up(3);return Up!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Eue(n){var e=new Up(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function TV(n){return Math.hypot(n[0],n[1],n[2])}function Sue(n,e,t){var i=new Up(3);return i[0]=n,i[1]=e,i[2]=t,i}function Mue(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function Cue(n,e,t,i){return n[0]=e,n[1]=t,n[2]=i,n}function Tue(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function AV(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function DV(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}function IV(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n}function Aue(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n}function Due(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n}function Iue(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function Rue(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function Pue(n,e){return n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n}function Nue(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function Lue(n,e,t,i){return n[0]=e[0]+t[0]*i,n[1]=e[1]+t[1]*i,n[2]=e[2]+t[2]*i,n}function RV(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])}function PV(n,e){var t=e[0]-n[0],i=e[1]-n[1],r=e[2]-n[2];return t*t+i*i+r*r}function NV(n){var e=n[0],t=n[1],i=n[2];return e*e+t*t+i*i}function Oue(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function Fue(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}function kue(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s,n}function LV(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Uue(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],c=t[2];return n[0]=r*c-s*a,n[1]=s*o-i*c,n[2]=i*a-r*o,n}function Bue(n,e,t,i){var r=e[0],s=e[1],o=e[2];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n}function Vue(n,e,t,i,r,s){var o=s*s,a=o*(2*s-3)+1,c=o*(s-2)+s,l=o*(s-1),u=o*(3-2*s);return n[0]=e[0]*a+t[0]*c+i[0]*l+r[0]*u,n[1]=e[1]*a+t[1]*c+i[1]*l+r[1]*u,n[2]=e[2]*a+t[2]*c+i[2]*l+r[2]*u,n}function zue(n,e,t,i,r,s){var o=1-s,a=o*o,c=s*s,l=a*o,u=3*s*a,h=3*c*o,d=c*s;return n[0]=e[0]*l+t[0]*u+i[0]*h+r[0]*d,n[1]=e[1]*l+t[1]*u+i[1]*h+r[1]*d,n[2]=e[2]*l+t[2]*u+i[2]*h+r[2]*d,n}function Hue(n,e){e=e||1;var t=2*MV()*Math.PI,i=2*MV()-1,r=Math.sqrt(1-i*i)*e;return n[0]=Math.cos(t)*r,n[1]=Math.sin(t)*r,n[2]=i*e,n}function Gue(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function Wue(n,e,t){var i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function jue(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],c=e[1],l=e[2],u=r*l-s*c,h=s*a-i*l,d=i*c-r*a,f=r*d-s*h,p=s*u-i*d,m=i*h-r*u,_=2*t[3];return h*=_,d*=_,p*=2,m*=2,n[0]=a+(u*=_)+(f*=2),n[1]=c+h+p,n[2]=l+d+m,n}function $ue(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function que(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function Xue(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function Yue(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),h=u&&LV(n,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}function Zue(n){return n[0]=0,n[1]=0,n[2]=0,n}function Kue(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function Jue(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]}function Que(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2];return Math.abs(t-s)<=Ty*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(i-o)<=Ty*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-a)<=Ty*Math.max(1,Math.abs(r),Math.abs(a))}Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var ehe=AV,the=DV,nhe=IV,ihe=RV,rhe=PV,she=TV,ohe=NV,ahe=function(){var n=CV();return function(e,t,i,r,s,o){var a,c;for(t||(t=3),i||(i=0),c=r?Math.min(r*t+i,e.length):e.length,a=i;a<c;a+=t)n[0]=e[a],n[1]=e[a+1],n[2]=e[a+2],s(n,n,o),e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2];return e}}();let OV=(()=>{var n;class e{constructor(i){this.interactions=i,this.xrMode=rc("inline"),this.appConfig=window.appConfig,this.vrSupported=!1,this.arSupported=!1,this.userData={isSelecting:!1}}checkXRSupport(i){return!(!this.vrSupported&&!this.arSupported)||!!navigator.xr&&(navigator.xr.isSessionSupported("immersive-vr").then(r=>{this.vrSupported=!0,this.xrMode.set("immersive-vr"),console.log("VR supported ",r)}),navigator.xr.isSessionSupported("immersive-ar").then(r=>{this.arSupported=!0,console.log("AR supported ",r)}),this.initXR(i),!0)}onDeviceChange(i){}onSessionEnd(i){}onInputSourcesChange(i){for(let r of i.added);}onSessionStart(i){i.addEventListener("end",this.onSessionEnd),i.addEventListener("inputsourceschange",this.onInputSourcesChange),i.requestReferenceSpace(i.isImmersive?"local-floor":"viewer").then(s=>{i.isImmersive&&(this.xrImmersiveRefSpace=s)})}initXR(i){this.renderer=i.renderer,this.webXRManager=i.renderer.xr,this.webXRManager.enabled=!0,this.scene=i.scene,this.session=this.webXRManager.getSession(),this.initVR(),"immersive-vr"===this.xrMode()?this.initVR():"immersive-ar"===this.xrMode()&&this.initAR()}initVR(){this.controllerLeft=this.initController(this.renderer.xr.getController(0),0),this.controllerRight=this.initController(this.renderer.xr.getController(1),1)}initController(i,r){i.addEventListener("selectstart",this.onSelectStart.bind(this)),i.addEventListener("select",this.onSelect.bind(this)),i.addEventListener("selectend",this.onSelectEnd.bind(this)),i.addEventListener("connected",l=>{let u,h;return"tracked-pointer"===(console.log("Controller connected",l.data.targetRayMode),l.data.targetRayMode)?(u=new ot,u.setAttribute("position",new Pe([0,0,0,0,0,-1],3)),u.setAttribute("color",new Pe([.5,.5,.5,0,0,0],3)),h=new Mi({vertexColors:!0,blending:2}),new Lo(u,h)):(u=new Dh(.02,.04,32).translate(0,0,-1),h=new di({opacity:.5,transparent:!0}),new Ot(u,h))}),i.addEventListener("disconnected",function(){console.log("Controller disconnected")});const s=new e3,o=this.renderer.xr.getControllerGrip(r);o.add(s.createControllerModel(o)),this.scene.add(o);const a=(new ot).setFromPoints([new A(0,0,0),new A(0,0,-1)]),c=new Lo(a);return c.name="line",c.scale.z=5,i.add(c.clone()),this.scene.add(i),i}onSqueze(i){console.log("Squuze event VR",i)}onSelectStart(i){console.log("Select Start VR event ",i),this.userData.isSelecting=!0}onSelect(i){console.log("Select VR event ",i),this.interactions.intersectObjects({controller:this.controllerLeft,scene:this.scene,select:!0}),this.interactions.intersectObjects({controller:this.controllerRight,scene:this.scene,select:!0})}onSelectEnd(i){console.log("Select End VR event ",i),this.userData.isSelecting=!1}initAR(){console.log("Initializing AR")}updateInputSources(i=this.session,r,s,o=this.scene){console.log("updateInputSources ",i,r,s,o);let a=ad;for(let c of i.inputSources){let l=r.getPose(c.targetRaySpace,s);if(!l)continue;"tracked-pointer"==c.targetRayMode&&o.inputRenderer.addLaserPointer(l.transform);let u=new Ic(l.transform),h=2,d=a.fromValues(u.origin.x,u.origin.y,u.origin.z);if(a.add(d,d,[u.direction.x*h,u.direction.y*h,u.direction.z*h]),o.inputRenderer.addCursor(d),c.gripSpace){let f=r.getPose(c.gripSpace,s);f&&o.inputRenderer.addController(f.transform.matrix,c.handedness)}}}}return(n=e).\u0275fac=function(i){return new(i||n)(we(kp))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:null}),e})();const Ay=new t3;let FV=(()=>{var n;class e{constructor(i,r,s,o,a,c,l,u){this.cameraService=i,this.controllerService=r,this.ngZone=s,this.interactionsService=o,this.lightsService=a,this.objectsService=c,this.debug=l,this.webXRService=u,this.scene=new TU,this.renderFunctions=[],this.clock=new TB,this.width=window.innerWidth,this.height=window.innerHeight,this.pointer=new Y,this.toneMappingOptions={None:So,Linear:F2,Reinhard:k2,Cineon:U2,ACESFilmic:ES,Custom:B2},this.params={exposure:1,toneMapping:"ACESFilmic",blurriness:.3,intensity:1}}initScene(i,r){const s=r?Object.assign({},GB,r):GB;this.canvas=i,s.camera.width=this.width,s.camera.height=this.height,this.camera=this.cameraService.createCamera(s.camera),this.dolly=this.cameraService.addDolly(),this.scene.add(this.dolly),this.scene.background=s.background||new Z("skyblue"),s.fog&&(this.scene.fog=new Tv(s.fog.color,s.fog.near,s.fog.far)),this.renderer=new CU({canvas:i,antialias:!0,powerPreference:"high-performance"}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=R2,this.renderer.toneMapping=ES,this.renderer.toneMappingExposure=1.5,this.renderer.xr.enabled=!0,this.scene.backgroundBlurriness=.3,this.rect=this.renderer.domElement.getBoundingClientRect();const o=this.lightsService.createHemLight({intensity:.5});this.spotLights=this.lightsService.createSpotLight(),this.spotlight=this.spotLights[0],this.spotlight.position.set(0,7,1.16),this.spotlight.target.position.set(0,0,-4),this.spotlight=this.spotLights[0];const a=this.lightsService.createSpotLight();a[0].position.set(0,-2,.64),this.camera.add(a[0]),this.debug.addToDebug({obj:a[0],name:"Camera Light",properties:{Position:{},intensity:{min:0,max:20,precision:1},distance:{min:0,max:10,precision:1},angle:{min:0,max:Math.PI,precision:Math.PI/36},penumbra:{min:0,max:1,precision:.01},decay:{min:0,max:10,precision:1}}}),this.scene.add(...o),this.controllerService.createControls({type:"orbit",camera:this.camera,renderer:this.renderer,canvas:i,scene:this.scene});const l=this.interactionsService.initInteractionManager(this.renderer,this.camera,i);return this.renderFunctions.push(l),this.afterSceneInit.bind(this)}afterSceneInit(i){this.interactionsManager=this.interactionsService.initInteractionManager(this.renderer,this.camera,this.canvas);const r=Kae.createButton(this.renderer);r.addEventListener("click",o=>{console.log("clicked xrButton ",o)}),document.body.appendChild(r),document.body.appendChild(Ay.dom);const s=new Gce(this.renderer.getContext());Ay.addPanel(s),Ay.showPanel(0),this.webXRService.checkXRSupport({renderer:this.renderer,camera:this.camera,scene:this.scene}),this.createCornerLights(),this.ngZone.runOutsideAngular(()=>this.renderer.setAnimationLoop(()=>this.render())),this.cameraService.moveCamera(0,1.6,.001,10)}setupXR(){this.renderer.xr.enabled=!0,this.webXRManager=this.renderer.xr,console.log("this.webXRManager ",this.webXRManager),this.controller=this.renderer.xr.getController(0),this.controller&&this.scene.add(this.controller);const r=new e3;this.controllerGrip=this.renderer.xr.getControllerGrip(0),this.controllerGrip.add(r.createControllerModel(this.controllerGrip)),this.scene.add(this.controllerGrip)}onSelectStart(i,r){throw new Error("Method not implemented.")}onSelectEnd(i,r){throw new Error("Method not implemented.")}render(){performance.now();Ay.update();const r=this.clock.getDelta();this.controllerService.updateControls(r),this.cameraService.updateCamera({camera:this.camera,scene:this.scene}),this.renderFunctions.forEach(a=>a(r)),this.renderer.render(this.scene,this.camera),performance.now()}addToScene(i){i instanceof Array?this.scene.add(...i):this.scene.add(i)}createCornerLights(){const i=this.lightsService.createPointLight();i.position.y=3.2,i.position.z=-10;const r=this.lightsService.createPointLight();r.position.set(10,3.2,7.6);const s=this.lightsService.createPointLight();s.position.set(-10,3.2,7.6),this.scene.add(i,r,s)}onTouchStart(i){this.pointer.x=(i.touches[0].clientX-this.rect.left)/(this.rect.right-this.rect.left)*2-1,this.pointer.y=-(i.touches[0].clientY-this.rect.top)/(this.rect.bottom-this.rect.top)*2+1,this.interactionsService.intersectObjects({pointer:this.pointer,camera:this.camera,scene:this.scene,select:!0})}onPointerDown(i){this.pointer.x=(i.clientX-this.rect.left)/(this.rect.right-this.rect.left)*2-1,this.pointer.y=-(i.clientY-this.rect.top)/(this.rect.bottom-this.rect.top)*2+1,this.interactionsService.intersectObjects({pointer:this.pointer,camera:this.camera,scene:this.scene})}onResize(i,r,s){r=r||window.innerWidth,s=s||window.innerHeight,this.camera.aspect=r/s,this.camera.updateProjectionMatrix(),this.renderer.setSize(r,s),this.renderer.setPixelRatio(window.devicePixelRatio),console.log("onResize ",i)}onDeviceChange(i){console.log("Device changed: ",i),this.onResize()}}return(n=e).\u0275fac=function(i){return new(i||n)(we(_V),we(vue),we(It),we(kp),we(EV),we(SV),we(al),we(OV))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:null}),e})();const sT=new WeakMap;class che extends Oh{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new Pr(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,r)},i,r)}parse(e,t,i){this.decodeDracoFile(e,t,null,null,Wt).catch(i)}decodeDracoFile(e,t,i,r,s=Qn){return this.decodeGeometry(e,{attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s}).then(t)}decodeGeometry(e,t){const i=JSON.stringify(t);if(sT.has(e)){const c=sT.get(e);if(c.key===i)return c.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=this._getWorker(s,e.byteLength).then(c=>(r=c,new Promise((l,u)=>{r._callbacks[s]={resolve:l,reject:u},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),sT.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new ot;e.index&&t.setIndex(new jt(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,c=new jt(o,r.itemSize);"color"===s&&(this._assignVertexColorSpace(c,r.vertexColorSpace),c.normalized=!(o instanceof Float32Array)),t.setAttribute(s,c)}return t}_assignVertexColorSpace(e,t){if(t!==Wt)return;const i=new Z;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new Pr(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=lhe.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}}function lhe(){let n,e;function r(o,a,c,l,u,h){const d=h.num_components(),p=c.num_points()*d,m=p*u.BYTES_PER_ELEMENT,_=function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}(o,u),g=o._malloc(m);a.GetAttributeDataArrayForAllPoints(c,h,_,m,g);const v=new u(o.HEAPF32.buffer,g,p).slice();return o._free(g),{name:l,array:v,itemSize:d}}onmessage=function(o){const a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(u){n.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(n)});break;case"decode":const c=a.buffer,l=a.taskConfig;e.then(u=>{const h=u.draco,d=new h.Decoder;try{const f=function t(o,a,c,l){const u=l.attributeIDs,h=l.attributeTypes;let d,f;const p=a.GetEncodedGeometryType(c);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeArrayToMesh(c,c.byteLength,d);else{if(p!==o.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");d=new o.PointCloud,f=a.DecodeArrayToPointCloud(c,c.byteLength,d)}if(!f.ok()||0===d.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const m={index:null,attributes:[]};for(const _ in u){const g=self[h[_]];let v,y;if(l.useUniqueIDs)y=u[_],v=a.GetAttributeByUniqueId(d,y);else{if(y=a.GetAttributeId(d,o[u[_]]),-1===y)continue;v=a.GetAttribute(d,y)}const w=r(o,a,d,_,g,v);"color"===_&&(w.vertexColorSpace=l.vertexColorSpace),m.attributes.push(w)}return p===o.TRIANGULAR_MESH&&(m.index=function i(o,a,c){const u=3*c.num_faces(),h=4*u,d=o._malloc(h);a.GetTrianglesUInt32Array(c,h,d);const f=new Uint32Array(o.HEAPF32.buffer,d,u).slice();return o._free(d),{array:f,itemSize:1}}(o,a,d)),o.destroy(d),m}(h,d,new Int8Array(c),l),p=f.attributes.map(m=>m.array.buffer);f.index&&p.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},p)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{h.destroy(d)}})}}}let oT=(()=>{var n;class e{constructor(i,r){this.debugService=i,this.materialsService=r,this.loadingProgress=rc(0),this.loadingManager=new HM,this.gltfLoader=new jB(this.loadingManager),this.textureLoader=new GM(this.loadingManager),this.dracoLoader=new che(this.loadingManager),this.loadingManager.onStart=(s,o,a)=>{this.onStart(s,o,a)},this.loadingManager.onProgress=(s,o,a)=>{this.loadingProgress.set(100*o/a)},this.loadingManager.onLoad=()=>{console.log("Loading complete!"),this.loadingProgress.set(100)},this.loadingManager.onError=s=>{console.error("There was an error loading "+s)},this.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),this.dracoLoader.setDecoderConfig({type:"js"}),this.dracoLoader.preload(),this.gltfLoader.setDRACOLoader(this.dracoLoader)}loadModel(i){new Y(20,15),this.gltfLoader.load(i.path,s=>{let o=0;const a=s.scene;a.position.z=-0,a.scale.set(3,3,3);let c=this.materialsService.getMeshPhysicalMaterial();a.traverse(l=>{l.isMesh&&(o+=1,"Floor"==l.name&&(c=this.createFloor()),l.material=c,l.castShadow=!0,l.receiveShadow=!0,l.castShadow=!0,l.receiveShadow=!0,l.material.map&&(l.material.map.anisotropy=16))}),i.scene.add(a),i.onLoadCB()},s=>{i.onLoadProgress(s)},s=>{console.error("Error loading model")})}createFloor(){const i=new Da({roughness:.8,color:16777215,metalness:.2,bumpScale:5e-4});return this.textureLoader.load("assets/textures/hardwood_diffuse.jpg",r=>{r.wrapS=Cr,r.wrapT=Cr,r.anisotropy=16,r.repeat.set(10,24),r.colorSpace=Wt,i.map=r,i.needsUpdate=!0}),this.textureLoader.load("assets/textures/hardwood_bump.jpg",function(r){r.wrapS=Cr,r.wrapT=Cr,r.anisotropy=4,r.repeat.set(10,24),i.bumpMap=r,i.needsUpdate=!0}),this.textureLoader.load("assets/textures/hardwood_roughness.jpg",function(r){r.wrapS=Cr,r.wrapT=Cr,r.anisotropy=4,r.repeat.set(10,24),i.roughnessMap=r,i.needsUpdate=!0}),i}loadTexture(i){return this.textureLoader.load(i)}onStart(i,r,s){}}return(n=e).\u0275fac=function(i){return new(i||n)(we(al),we(rT))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"root"}),e})();var fi={d:(n,e)=>{for(var t in e)fi.o(e,t)&&!fi.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o:(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r:n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},Ur={};fi.d(Ur,{g1:()=>Iy,gO:()=>Gp,km:()=>Dy,zV:()=>zp,ol:()=>CT,uM:()=>Ry,N1:()=>lz,xv:()=>MT,PH:()=>Ny,UH:()=>Py,ZP:()=>khe,Vx:()=>uz});var Dy={};fi.r(Dy),fi.d(Dy,{COLUMN:()=>Ly,COLUMN_REVERSE:()=>UV,ROW:()=>Bp,ROW_REVERSE:()=>kV,contentDirection:()=>BV});var Iy={};fi.r(Iy),fi.d(Iy,{CENTER:()=>cT,END:()=>lT,START:()=>aT,STRETCH:()=>VV,alignItems:()=>zV,warnAboutDeprecatedAlignItems:()=>HV});var Ry={};fi.r(Ry),fi.d(Ry,{CENTER:()=>hT,END:()=>dT,SPACE_AROUND:()=>fT,SPACE_BETWEEN:()=>pT,SPACE_EVENLY:()=>mT,START:()=>uT,justifyContent:()=>GV});var Py={};fi.r(Py),fi.d(Py,{NORMAL:()=>Vp,NOWRAP:()=>Xh,PRE:()=>Oy,PRE_LINE:()=>Yh,PRE_WRAP:()=>Fy,WHITE_CHARS:()=>_T,collapseWhitespaceOnInlines:()=>qV,collapseWhitespaceOnString:()=>WV,newlineBreakability:()=>jV,shouldBreak:()=>$V});var Ny={};fi.r(Ny),fi.d(Ny,{CENTER:()=>vT,JUSTIFY:()=>yT,JUSTIFY_CENTER:()=>ez,JUSTIFY_LEFT:()=>QV,JUSTIFY_RIGHT:()=>ky,LEFT:()=>KV,RIGHT:()=>JV,textAlign:()=>tz});const bt=(n=>{var e={};return fi.d(e,n),e})({BufferAttribute:()=>jt,BufferGeometry:()=>ot,CanvasTexture:()=>Toe,Color:()=>Z,FileLoader:()=>Pr,LinearFilter:()=>an,Mesh:()=>Ot,Object3D:()=>gn,Plane:()=>No,PlaneGeometry:()=>gh,ShaderMaterial:()=>Ys,TextureLoader:()=>GM,Vector2:()=>Y,Vector3:()=>A}),Bp="row",kV="row-reverse",Ly="column",UV="column-reverse";function BV(n,e,t,i){let r=t,s="getWidth",o="x",a="y";0===e.indexOf(Ly)&&(s="getHeight",o="y",a="x");for(let c=0;c<n.childrenBoxes.length;c++){const l=n.childrenBoxes[c],u=l.id,h=l[s](),d=l.margin||0;r+=d*i,n.childrenPos[u]={[o]:r+h/2*i,[a]:0},r+=i*(h+d)}}const aT="start",cT="center",lT="end",VV="stretch";function zV(n,e){const t=n.getAlignItems();-1===hhe.indexOf(t)&&console.warn(`alignItems === '${t}' is not supported`);let i="getWidth",r="x";0===e.indexOf(Bp)&&(i="getHeight",r="y");const s=n[i]()/2-(n.padding||0);n.childrenBoxes.forEach(o=>{let a;switch(t){case lT:case"right":case"bottom":a=0===e.indexOf(Bp)?-s+o[i]()/2+(o.margin||0):s-o[i]()/2-(o.margin||0);break;case aT:case"left":case"top":a=0===e.indexOf(Bp)?s-o[i]()/2-(o.margin||0):-s+o[i]()/2+(o.margin||0)}n.childrenPos[o.id][r]=a||0})}function HV(n){-1!==dhe.indexOf(n)&&console.warn(`alignItems === '${n}' is deprecated and will be remove in 7.x.x. Fallback are 'start'|'end'`)}const hhe=[aT,cT,lT,VV,"top","right","bottom","left"],dhe=["top","right","bottom","left"],uT="start",hT="center",dT="end",fT="space-around",pT="space-between",mT="space-evenly";function GV(n,e,t,i){const r=n.getJustifyContent();-1===fhe.indexOf(r)&&console.warn(`justifyContent === '${r}' is not supported`);const s=0===e.indexOf("row")?"width":"height",o=n.getChildrenSideSum(s),c=("width"===s?n.getInnerWidth():n.getInnerHeight())-o,u=function phe(n,e){switch(n){case dT:return e;case hT:return e/2}return 0}(r,2*t-o*Math.sign(t)),h=function mhe(n,e,t,i){const r=Array(n.length).fill(0);if(e>0)switch(t){case pT:if(n.length>1){const s=e/(n.length-1)*i;r[0]=0;for(let o=1;o<n.length;o++)r[o]=s*o}break;case mT:if(n.length>1){const s=e/(n.length+1)*i;for(let o=0;o<n.length;o++)r[o]=s*(o+1)}break;case fT:if(n.length>1){const s=e/n.length*i,o=s/2;r[0]=o;for(let a=1;a<n.length;a++)r[a]=o+s*a}}return r}(n.childrenBoxes,c,r,i),d=0===e.indexOf("row")?"x":"y";n.childrenBoxes.forEach((f,p)=>{n.childrenPos[f.id][d]-=u-h[p]})}const fhe=[uT,hT,dT,fT,pT,mT];function gT(n){return class extends n{constructor(t){super(t),this.isBoxComponent=!0,this.childrenPos={}}getInnerWidth(){const t=this.getContentDirection();switch(t){case"row":case"row-reverse":return this.width-(2*this.padding||0)||this.getChildrenSideSum("width");case"column":case"column-reverse":return this.getHighestChildSizeOn("width");default:console.error(`Invalid contentDirection : ${t}`)}}getInnerHeight(){const t=this.getContentDirection();switch(t){case"row":case"row-reverse":return this.getHighestChildSizeOn("height");case"column":case"column-reverse":return this.height-(2*this.padding||0)||this.getChildrenSideSum("height");default:console.error(`Invalid contentDirection : ${t}`)}}getChildrenSideSum(t){return this.childrenBoxes.reduce((i,r)=>{const s=2*r.margin||0;return i+("width"===t?r.getWidth()+s:r.getHeight()+s)},0)}setPosFromParentRecords(){this.parentUI&&this.parentUI.childrenPos[this.id]&&(this.position.x=this.parentUI.childrenPos[this.id].x,this.position.y=this.parentUI.childrenPos[this.id].y)}computeChildrenPosition(){if(this.children.length>0){const t=this.getContentDirection();let i;switch(t){case Bp:i=-this.getInnerWidth()/2;break;case kV:i=this.getInnerWidth()/2;break;case Ly:i=this.getInnerHeight()/2;break;case UV:i=-this.getInnerHeight()/2}const r=-Math.sign(i);BV(this,t,i,r),GV(this,t,i,r),zV(this,t)}}getHighestChildSizeOn(t){return this.childrenBoxes.reduce((i,r)=>{const s=r.margin||0,o="width"===t?r.getWidth()+2*s:r.getHeight()+2*s;return Math.max(i,o)},0)}getWidth(){return this.parentUI&&"stretch"===this.parentUI.getAlignItems()&&-1!==this.parentUI.getContentDirection().indexOf("column")?this.parentUI.getWidth()-(2*this.parentUI.padding||0):this.width||this.getInnerWidth()+(2*this.padding||0)}getHeight(){return this.parentUI&&"stretch"===this.parentUI.getAlignItems()&&-1!==this.parentUI.getContentDirection().indexOf("row")?this.parentUI.getHeight()-(2*this.parentUI.padding||0):this.height||this.getInnerHeight()+(2*this.padding||0)}}}const _T={"\t":"\t","\n":"\n","\r":"\r"," ":" "},Vp="normal",Xh="nowrap",Oy="pre",Yh="pre-line",Fy="pre-wrap",WV=function(n,e){switch(e){case Xh:case Vp:n=n.replace(/\n/g," ");case Yh:n=n.replace(/[ ]{2,}/g," ")}return n},jV=function(n){switch(n){case Oy:case Fy:case Yh:return"mandatory"}},$V=function(n,e,t,i){const r=n[e];switch(i.WHITESPACE){case Vp:case Yh:case Fy:if("mandatory"===r.lineBreak)return!0;if(t+(r.xadvance?r.xadvance:r.width)+(r.xoffset?r.xoffset:0)+(r.kerning?r.kerning:0)>i.INNER_WIDTH)return!0;const c=ZV(n,e,i);return function ghe(n,e,t,i){return!(!n||!n.glyph||e+t<i.INNER_WIDTH)&&i.BREAKON.indexOf(n.glyph)>-1}(n[e-1],t,c,i);case Oy:return"mandatory"===r.lineBreak;default:return!1}},qV=function(n,e){const t=n[0],i=n[n.length-1];switch(e){case Fy:t.glyph&&"\n"===t.glyph&&n.length>1&&YV([t],n[1]),i.glyph&&"\n"===i.glyph&&n.length>1&&XV([i],n[n.length-2]);break;case Yh:case Xh:case Vp:let s,r=[];for(let o=0;o<n.length;o++){const a=n[o];if(!(a.glyph&&_T[a.glyph]&&n.length>o))break;r.push(a),s=n[o+1]}YV(r,s),r=[],s=null;for(let o=n.length-1;o>0;o--){const a=n[o];if(!(a.glyph&&_T[a.glyph]&&o>0))break;r.push(a),s=n[o-1]}XV(r,s);break;case Oy:break;default:return console.warn(`whiteSpace: '${e}' is not valid`),0}return t.offsetX};function XV(n,e){if(e)for(let t=0;t<n.length;t++){const i=n[t];i.width=0,i.height=0,i.offsetX=e.offsetX+e.width}}function YV(n,e){if(e)for(let t=0;t<n.length;t++){const i=n[t];i.width=0,i.height=0,i.offsetX=e.offsetX}}function ZV(n,e,t,i){if(i=i||0,!n[e])return i;const r=n[e],a=r.xadvance?r.xadvance:r.width;return r.lineBreak?i+a:ZV(n,e+1,t,i+a+t.LETTERSPACING+(r.xoffset?r.xoffset:0)+(r.kerning?r.kerning:0))}const KV="left",JV="right",vT="center",yT="justify",QV="justify-left",ky="justify-right",ez="justify-center";function tz(n,e,t){for(let i=0;i<n.length;i++){const r=n[i],s=_he(r,e,t,i===n.length-1);for(let o=0;o<r.length;o++)r[o].offsetX+=s;r.x=s}if(0===e.indexOf(yT))for(let i=0;i<n.length;i++){const r=n[i];if(-1!==e.indexOf("-")&&i===n.length-1)return;const s=t-r.width;if(s<=0)return;let o=0;for(let u=1;u<r.length-1;u++)o+=" "===r[u].glyph?1:0;const a=s/o;let c=1;e===ky&&(r.reverse(),c=-1);let l=0;for(let u=1;u<=r.length-1;u++){const h=r[u];h.offsetX+=l*c,l+=" "===h.glyph?a:0}e===ky&&r.reverse()}}const _he=(n,e,t,i)=>{switch(e){case QV:case yT:case KV:return-t/2;case ky:case JV:return t/2-n.width;case vT:return-n.width/2;case ez:return i?-n.width/2:-t/2;default:console.warn(`textAlign: '${e}' is not valid`)}};function nz(n){return class extends n{computeInlinesPosition(){const t=this.getWidth()-(2*this.padding||0),i=this.getHeight()-(2*this.padding||0),r=this.getJustifyContent(),s=this.getTextAlign(),o=this.getInterLine(),a=this.computeLines();a.interLine=o;const c=Math.abs(a.height),l=(()=>{switch(r){case"start":return i/2;case"end":return c-i/2;case"center":return c/2;default:console.warn(`justifyContent: '${r}' is not valid`)}})();a.forEach(u=>{u.y+=l,u.forEach(h=>{h.offsetY+=l})}),tz(a,s,t),this.lines=a}calculateBestFit(t){if(0!==this.childrenInlines.length)switch(t){case"grow":this.calculateGrowFit();break;case"shrink":this.calculateShrinkFit();break;case"auto":this.calculateAutoFit()}}calculateGrowFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(u=>u.isText);let l,o=1,a=2,c=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(l=this.calculateHeight(c),l>t){if(c<=o){this.childrenInlines.forEach(u=>{u.isInlineBlock||(u._fitFontSize=u.getFontSize())});break}a=c,c-=(a-o)/2}else{if(Math.abs(t-l)<.075)break;Math.abs(c-a)<5e-10&&(a*=2),o=c,c+=(a-o)/2}}while(++i<=10)}calculateShrinkFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(u=>u.isText);let l,o=0,a=1,c=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(l=this.calculateHeight(c),l>t)a=c,c-=(a-o)/2;else{if(c>=a){this.childrenInlines.forEach(u=>{u.isInlineBlock||(u._fitFontSize=u.getFontSize())});break}if(Math.abs(t-l)<.075)break;o=c,c+=(a-o)/2}}while(++i<=10)}calculateAutoFit(){const t=this.getHeight()-(2*this.padding||0);let i=1;const s=this.childrenInlines.find(u=>u.isText);let l,o=0,a=2,c=s._fitFontSize?s._fitFontSize/s.getFontSize():1;do{if(l=this.calculateHeight(c),l>t)a=c,c-=(a-o)/2;else{if(Math.abs(t-l)<.075)break;Math.abs(c-a)<5e-10&&(a*=2),o=c,c+=(a-o)/2}}while(++i<=10)}computeLines(){const t=this.getWidth()-(2*this.padding||0),i=[[]];i.height=0;const r=this.getInterLine();this.childrenInlines.reduce((c,l)=>{if(!l.inlines)return;const u=l._fitFontSize||l.getFontSize(),h=l.isText?l.getLetterSpacing()*u:0,d=l.getWhiteSpace(),f=l.getBreakOn(),p={WHITESPACE:d,LETTERSPACING:h,BREAKON:f,INNER_WIDTH:t};return l.inlines.reduce((_,g,v,y)=>{const w=g.kerning?g.kerning:0,x=g.xoffset?g.xoffset:0,E=g.xadvance?g.xadvance:g.width;return $V(y,v,_,p)?(i.push([g]),g.offsetX=x,0===g.width?0:E+h):(i[i.length-1].push(g),g.offsetX=_+x+w,_+E+w+h)},c)},0);let s=0,o=0,a=-r/2;return i.forEach(c=>{if(c.lineHeight=c.reduce((u,h)=>Math.max(u,void 0!==h.lineHeight?h.lineHeight:h.height),0),c.lineBase=c.reduce((u,h)=>Math.max(u,void 0!==h.lineBase?h.lineBase:h.height),0),c.width=0,c.height=c.lineHeight,c[0]){const u=this.getWhiteSpace(),h=qV(c,u);c.forEach(d=>{d.offsetX-=h}),c.width=this.computeLineWidth(c),c.width>s&&(s=c.width),c.forEach(d=>{d.offsetY=a-d.height-d.anchor,d.lineHeight<c.lineHeight&&(d.offsetY-=c.lineBase-d.lineBase)}),c.y=a,o+=c.lineHeight+r,a-=c.lineHeight+r}}),i.height=o,i.width=s,i}calculateHeight(t){this.childrenInlines.forEach(r=>{r.isInlineBlock||(r._fitFontSize=r.getFontSize()*t,r.calculateInlines(r._fitFontSize))});const i=this.computeLines();return Math.abs(i.height)}computeLineWidth(t){const r=t[t.length-1];return r.offsetX+r.width+t[0].offsetX}}}const vhe=new bt.FileLoader,wT=[],Uy={},yhe=new bt.TextureLoader,xT=[],By={},Di={};function bT(n){if(n._kernings)return;const e={};for(let t=0;t<n.kernings.length;t++){const i=n.kernings[t];0!==i.amount&&(e[String.fromCharCode(i.first,i.second)]=i.amount)}n._kernings=e}const zp={setFontFamily:function whe(n,e){"string"==typeof e?function bhe(n,e){-1===wT.indexOf(e)&&(wT.push(e),vhe.load(e,t=>{const i=JSON.parse(t);bT(i),Uy[e]=i;for(const r of Object.keys(Di))e===Di[r].jsonURL&&Di[r].component._updateFontFamily(i)})),Di[n.id]||(Di[n.id]={component:n}),Di[n.id].jsonURL=e,Uy[e]&&n._updateFontFamily(Uy[e])}(n,e):(Di[n.id]||(Di[n.id]={component:n}),bT(e),Di[n.id].json=e,n._updateFontFamily(e))},setFontTexture:function xhe(n,e){-1===xT.indexOf(e)&&(xT.push(e),yhe.load(e,t=>{t.generateMipmaps=!1,t.minFilter=bt.LinearFilter,t.magFilter=bt.LinearFilter,By[e]=t;for(const i of Object.keys(Di))e===Di[i].textureURL&&Di[i].component._updateFontTexture(t)})),Di[n.id]||(Di[n.id]={component:n}),Di[n.id].textureURL=e,By[e]&&n._updateFontTexture(By[e])},getFontOf:function iz(n){const e=Di[n.id];return!e&&n.parentUI?iz(n.parentUI):e},addFont:function Ehe(n,e,t){t.generateMipmaps=!1,t.minFilter=bt.LinearFilter,t.magFilter=bt.LinearFilter,wT.push(n),Uy[n]=e,bT(e),t&&(xT.push(n),By[n]=t)}};let Hp=(()=>{class n{static requestUpdate(t,i,r,s){t.traverse(o=>{o.isUI&&(this.requestedUpdates[o.id]?(i&&(this.requestedUpdates[o.id].updateParsing=!0),r&&(this.requestedUpdates[o.id].updateLayout=!0),s&&(this.requestedUpdates[o.id].updateInner=!0)):this.requestedUpdates[o.id]={updateParsing:i,updateLayout:r,updateInner:s,needCallback:i||r||s})})}static register(t){this.components.includes(t)||this.components.push(t)}static disposeOf(t){const i=this.components.indexOf(t);i>-1&&this.components.splice(i,1)}static update(){if(Object.keys(this.requestedUpdates).length>0){const t=this.components.filter(i=>!i.parentUI);t.forEach(i=>this.traverseParsing(i)),t.forEach(i=>this.traverseUpdates(i))}}static traverseParsing(t){const i=this.requestedUpdates[t.id];i&&i.updateParsing&&(t.parseParams(),i.updateParsing=!1),t.childrenUIs.forEach(r=>this.traverseParsing(r))}static traverseUpdates(t){const i=this.requestedUpdates[t.id];delete this.requestedUpdates[t.id],i&&i.updateLayout&&(i.updateLayout=!1,t.updateLayout()),i&&i.updateInner&&(i.updateInner=!1,t.updateInner()),t.childrenUIs.forEach(r=>{this.traverseUpdates(r)}),i&&i.needCallback&&t.onAfterUpdate()}}return n.components=[],n.requestedUpdates={},n})();const pi={container:null,fontFamily:null,fontSize:.05,fontKerning:"normal",bestFit:"none",offset:.01,interLine:.01,breakOn:"- ,.:?!\n",whiteSpace:Yh,contentDirection:Ly,alignItems:cT,justifyContent:uT,textAlign:vT,textType:"MSDF",fontColor:new bt.Color(16777215),fontOpacity:1,fontPXRange:4,fontSupersampling:!0,borderRadius:.01,borderWidth:0,borderColor:new bt.Color("black"),borderOpacity:1,backgroundSize:"cover",backgroundColor:new bt.Color(2236962),backgroundWhiteColor:new bt.Color(16777215),backgroundOpacity:.8,backgroundOpaqueOpacity:1,getDefaultTexture:function She(){if(!Vy){const n=document.createElement("canvas").getContext("2d");n.canvas.width=1,n.canvas.height=1,n.fillStyle="#ffffff",n.fillRect(0,0,1,1),Vy=new bt.CanvasTexture(n.canvas),Vy.isDefault=!0}return Vy},hiddenOverflow:!1,letterSpacing:0};let Vy;function zy(n){return class extends n{constructor(t){super(t),ut(this,"_rebuildParentUI",()=>{this.parentUI=this.parent&&this.parent.isUI?this.parent:null}),this.states={},this.currentState=void 0,this.isUI=!0,this.autoLayout=!0,this.childrenUIs=[],this.childrenBoxes=[],this.childrenTexts=[],this.childrenInlines=[],this.parentUI=null,this.addEventListener("added",this._rebuildParentUI),this.addEventListener("removed",this._rebuildParentUI)}getClippingPlanes(){const t=[];if(this.parentUI){if(this.isBlock&&this.parentUI.getHiddenOverflow()){const i=this.parentUI.getHeight()/2-(this.parentUI.padding||0),r=this.parentUI.getWidth()/2-(this.parentUI.padding||0),s=[new bt.Plane(new bt.Vector3(0,1,0),i),new bt.Plane(new bt.Vector3(0,-1,0),i),new bt.Plane(new bt.Vector3(1,0,0),r),new bt.Plane(new bt.Vector3(-1,0,0),r)];s.forEach(o=>{o.applyMatrix4(this.parent.matrixWorld)}),t.push(...s)}this.parentUI.parentUI&&t.push(...this.parentUI.getClippingPlanes())}return t}getHighestParent(){return this.parentUI?this.parent.getHighestParent():this}_getProperty(t){return void 0===this[t]&&this.parentUI?this.parent._getProperty(t):void 0!==this[t]?this[t]:pi[t]}getFontSize(){return this._getProperty("fontSize")}getFontKerning(){return this._getProperty("fontKerning")}getLetterSpacing(){return this._getProperty("letterSpacing")}getFontTexture(){return void 0===this.fontTexture&&this.parentUI?this.parent._getProperty("fontTexture"):void 0!==this.fontTexture?this.fontTexture:pi.getDefaultTexture()}getFontFamily(){return this._getProperty("fontFamily")}getBreakOn(){return this._getProperty("breakOn")}getWhiteSpace(){return this._getProperty("whiteSpace")}getTextAlign(){return this._getProperty("textAlign")}getTextType(){return this._getProperty("textType")}getFontColor(){return this._getProperty("fontColor")}getFontSupersampling(){return this._getProperty("fontSupersampling")}getFontOpacity(){return this._getProperty("fontOpacity")}getFontPXRange(){return this._getProperty("fontPXRange")}getBorderRadius(){return this._getProperty("borderRadius")}getBorderWidth(){return this._getProperty("borderWidth")}getBorderColor(){return this._getProperty("borderColor")}getBorderOpacity(){return this._getProperty("borderOpacity")}getContainer(){return!this.threeOBJ&&this.parent?this.parent.getContainer():this.threeOBJ?this:pi.container}getParentsNumber(t){return t=t||0,this.parentUI?this.parentUI.getParentsNumber(t+1):t}getBackgroundOpacity(){return this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:pi.backgroundOpacity}getBackgroundColor(){return this.backgroundColor||pi.backgroundColor}getBackgroundTexture(){return this.backgroundTexture||pi.getDefaultTexture()}getAlignContent(){return this.alignContent||pi.alignContent}getAlignItems(){return this.alignItems||pi.alignItems}getContentDirection(){return this.contentDirection||pi.contentDirection}getJustifyContent(){return this.justifyContent||pi.justifyContent}getInterLine(){return void 0===this.interLine?pi.interLine:this.interLine}getOffset(){return void 0===this.offset?pi.offset:this.offset}getBackgroundSize(){return void 0===this.backgroundSize?pi.backgroundSize:this.backgroundSize}getHiddenOverflow(){return void 0===this.hiddenOverflow?pi.hiddenOverflow:this.hiddenOverflow}getBestFit(){return void 0===this.bestFit?pi.bestFit:this.bestFit}_rebuildChildrenLists(){this.childrenUIs=this.children.filter(t=>t.isUI),this.childrenBoxes=this.children.filter(t=>t.isBoxComponent),this.childrenInlines=this.children.filter(t=>t.isInline),this.childrenTexts=this.children.filter(t=>t.isText)}add(){for(const i of Object.keys(arguments))arguments[i].isInline&&this.update(null,!0);const t=super.add(...arguments);return this._rebuildChildrenLists(),t}remove(){for(const i of Object.keys(arguments))arguments[i].isInline&&this.update(null,!0);const t=super.remove(...arguments);return this._rebuildChildrenLists(),t}update(t,i,r){Hp.requestUpdate(this,t,i,r)}onAfterUpdate(){}_updateFontFamily(t){this.fontFamily=t,this.traverse(i=>{i.isUI&&i.update(!0,!0,!1)}),this.getHighestParent().update(!1,!0,!1)}_updateFontTexture(t){this.fontTexture=t,this.getHighestParent().update(!1,!0,!1)}set(t){let i,r,s;if(Hp.register(this),t&&JSON.stringify(t)!==JSON.stringify({})){t.alignContent&&(t.alignItems=t.alignContent,t.textAlign||(t.textAlign=t.alignContent),console.warn("`alignContent` property has been deprecated, please rely on `alignItems` and `textAlign` instead."),delete t.alignContent),t.alignItems&&HV(t.alignItems);for(const o of Object.keys(t))if(this[o]!=t[o])switch(o){case"content":case"fontSize":case"fontKerning":case"breakOn":case"whiteSpace":this.isText&&(i=!0),r=!0,this[o]=t[o];break;case"bestFit":this.isBlock&&(i=!0,r=!0),this[o]=t[o];break;case"width":case"height":case"padding":(this.isInlineBlock||this.isBlock&&"none"!=this.getBestFit())&&(i=!0),r=!0,this[o]=t[o];break;case"letterSpacing":case"interLine":this.isBlock&&"none"!=this.getBestFit()&&(i=!0),r=!0,this[o]=t[o];break;case"margin":case"contentDirection":case"justifyContent":case"alignContent":case"alignItems":case"textAlign":case"textType":r=!0,this[o]=t[o];break;case"fontColor":case"fontOpacity":case"fontSupersampling":case"offset":case"backgroundColor":case"backgroundOpacity":case"backgroundTexture":case"backgroundSize":case"borderRadius":case"borderWidth":case"borderColor":case"borderOpacity":s=!0,this[o]=t[o];break;case"hiddenOverflow":this[o]=t[o]}t.fontFamily&&zp.setFontFamily(this,t.fontFamily),t.fontTexture&&zp.setFontTexture(this,t.fontTexture),this.parentUI&&"none"!=this.parentUI.getBestFit()&&this.parentUI.update(!0,!0,!1),this.update(i,r,s),r&&this.getHighestParent().update(!1,!0,!1)}}setupState(t){this.states[t.state]={attributes:t.attributes,onSet:t.onSet}}setState(t){const i=this.states[t];i?t!==this.currentState&&(this.currentState=t,i.onSet&&i.onSet(),i.attributes&&this.set(i.attributes)):console.warn(`state "${t}" does not exist within this component:`,this.name)}clear(){this.traverse(t=>{Hp.disposeOf(t),t.material&&t.material.dispose(),t.geometry&&t.geometry.dispose()})}}}function ET(n){return class extends n{constructor(t){super(t),this.textUniforms={u_texture:{value:this.getFontTexture()},u_color:{value:this.getFontColor()},u_opacity:{value:this.getFontOpacity()},u_pxRange:{value:this.getFontPXRange()},u_useRGSS:{value:this.getFontSupersampling()}},this.backgroundUniforms={u_texture:{value:this.getBackgroundTexture()},u_color:{value:this.getBackgroundColor()},u_opacity:{value:this.getBackgroundOpacity()},u_backgroundMapping:{value:this.getBackgroundSize()},u_borderWidth:{value:this.getBorderWidth()},u_borderColor:{value:this.getBorderColor()},u_borderRadiusTopLeft:{value:this.getBorderRadius()},u_borderRadiusTopRight:{value:this.getBorderRadius()},u_borderRadiusBottomRight:{value:this.getBorderRadius()},u_borderRadiusBottomLeft:{value:this.getBorderRadius()},u_borderOpacity:{value:this.getBorderOpacity()},u_size:{value:new bt.Vector2(1,1)},u_tSize:{value:new bt.Vector2(1,1)}}}updateBackgroundMaterial(){this.backgroundUniforms.u_texture.value=this.getBackgroundTexture(),this.backgroundUniforms.u_tSize.value.set(this.backgroundUniforms.u_texture.value.image.width,this.backgroundUniforms.u_texture.value.image.height),this.size&&this.backgroundUniforms.u_size.value.copy(this.size),this.backgroundUniforms.u_texture.value.isDefault?(this.backgroundUniforms.u_color.value=this.getBackgroundColor(),this.backgroundUniforms.u_opacity.value=this.getBackgroundOpacity()):(this.backgroundUniforms.u_color.value=this.backgroundColor||pi.backgroundWhiteColor,this.backgroundUniforms.u_opacity.value=this.backgroundOpacity||0===this.backgroundOpacity?this.backgroundOpacity:pi.backgroundOpaqueOpacity),this.backgroundUniforms.u_backgroundMapping.value=(()=>{switch(this.getBackgroundSize()){case"stretch":return 0;case"contain":return 1;case"cover":return 2}})();const t=this.getBorderRadius();this.backgroundUniforms.u_borderWidth.value=this.getBorderWidth(),this.backgroundUniforms.u_borderColor.value=this.getBorderColor(),this.backgroundUniforms.u_borderOpacity.value=this.getBorderOpacity(),Array.isArray(t)?(this.backgroundUniforms.u_borderRadiusTopLeft.value=t[0],this.backgroundUniforms.u_borderRadiusTopRight.value=t[1],this.backgroundUniforms.u_borderRadiusBottomRight.value=t[2],this.backgroundUniforms.u_borderRadiusBottomLeft.value=t[3]):(this.backgroundUniforms.u_borderRadiusTopLeft.value=t,this.backgroundUniforms.u_borderRadiusTopRight.value=t,this.backgroundUniforms.u_borderRadiusBottomRight.value=t,this.backgroundUniforms.u_borderRadiusBottomLeft.value=t)}updateTextMaterial(){this.textUniforms.u_texture.value=this.getFontTexture(),this.textUniforms.u_color.value=this.getFontColor(),this.textUniforms.u_opacity.value=this.getFontOpacity(),this.textUniforms.u_pxRange.value=this.getFontPXRange(),this.textUniforms.u_useRGSS.value=this.getFontSupersampling()}getBackgroundMaterial(){return(!this.backgroundMaterial||!this.backgroundUniforms)&&(this.backgroundMaterial=this._makeBackgroundMaterial()),this.backgroundMaterial}getFontMaterial(){return(!this.fontMaterial||!this.textUniforms)&&(this.fontMaterial=this._makeTextMaterial()),this.fontMaterial}_makeTextMaterial(){return new bt.ShaderMaterial({uniforms:this.textUniforms,transparent:!0,clipping:!0,vertexShader:Mhe,fragmentShader:Che,extensions:{derivatives:!0}})}_makeBackgroundMaterial(){return new bt.ShaderMaterial({uniforms:this.backgroundUniforms,transparent:!0,clipping:!0,vertexShader:The,fragmentShader:Ahe,extensions:{derivatives:!0}})}updateClippingPlanes(t){const i=void 0!==t?t:this.getClippingPlanes();JSON.stringify(i)!==JSON.stringify(this.clippingPlanes)&&(this.clippingPlanes=i,this.fontMaterial&&(this.fontMaterial.clippingPlanes=this.clippingPlanes),this.backgroundMaterial&&(this.backgroundMaterial.clippingPlanes=this.clippingPlanes))}}}const Mhe="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\tgl_Position.z -= 0.00001;\n\n\t#include <clipping_planes_vertex>\n\n}\n",Che="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\nuniform float u_pxRange;\nuniform bool u_useRGSS;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\n// functions from the original msdf repo:\n// https://github.com/Chlumsky/msdfgen#using-a-multi-channel-distance-field\n\nfloat median(float r, float g, float b) {\n\treturn max(min(r, g), min(max(r, g), b));\n}\n\nfloat screenPxRange() {\n\tvec2 unitRange = vec2(u_pxRange)/vec2(textureSize(u_texture, 0));\n\tvec2 screenTexSize = vec2(1.0)/fwidth(vUv);\n\treturn max(0.5*dot(unitRange, screenTexSize), 1.0);\n}\n\nfloat tap(vec2 offsetUV) {\n\tvec3 msd = texture( u_texture, offsetUV ).rgb;\n\tfloat sd = median(msd.r, msd.g, msd.b);\n\tfloat screenPxDistance = screenPxRange() * (sd - 0.5);\n\tfloat alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\treturn alpha;\n}\n\nvoid main() {\n\n\tfloat alpha;\n\n\tif ( u_useRGSS ) {\n\n\t\t// shader-based supersampling based on https://bgolus.medium.com/sharper-mipmapping-using-shader-based-supersampling-ed7aadb47bec\n\t\t// per pixel partial derivatives\n\t\tvec2 dx = dFdx(vUv);\n\t\tvec2 dy = dFdy(vUv);\n\n\t\t// rotated grid uv offsets\n\t\tvec2 uvOffsets = vec2(0.125, 0.375);\n\t\tvec2 offsetUV = vec2(0.0, 0.0);\n\n\t\t// supersampled using 2x2 rotated grid\n\t\talpha = 0.0;\n\t\toffsetUV.xy = vUv + uvOffsets.x * dx + uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.x * dx - uvOffsets.y * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv + uvOffsets.y * dx - uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\toffsetUV.xy = vUv - uvOffsets.y * dx + uvOffsets.x * dy;\n\t\talpha += tap(offsetUV);\n\t\talpha *= 0.25;\n\n\t} else {\n\n\t\talpha = tap( vUv );\n\n\t}\n\n\n\t// apply the opacity\n\talpha *= u_opacity;\n\n\t// this is useful to avoid z-fighting when quads overlap because of kerning\n\tif ( alpha < 0.02) discard;\n\n\n\tgl_FragColor = vec4( u_color, alpha );\n\n\t#include <clipping_planes_fragment>\n\n}\n",The="\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <clipping_planes_vertex>\n\n}\n",Ahe="\n\nuniform sampler2D u_texture;\nuniform vec3 u_color;\nuniform float u_opacity;\n\nuniform float u_borderRadiusTopLeft;\nuniform float u_borderRadiusTopRight;\nuniform float u_borderRadiusBottomLeft;\nuniform float u_borderRadiusBottomRight;\nuniform float u_borderWidth;\nuniform vec3 u_borderColor;\nuniform float u_borderOpacity;\nuniform vec2 u_size;\nuniform vec2 u_tSize;\nuniform int u_backgroundMapping;\n\nvarying vec2 vUv;\n\n#include <clipping_planes_pars_fragment>\n\nfloat getEdgeDist() {\n\tvec2 ndc = vec2( vUv.x * 2.0 - 1.0, vUv.y * 2.0 - 1.0 );\n\tvec2 planeSpaceCoord = vec2( u_size.x * 0.5 * ndc.x, u_size.y * 0.5 * ndc.y );\n\tvec2 corner = u_size * 0.5;\n\tvec2 offsetCorner = corner - abs( planeSpaceCoord );\n\tfloat innerRadDist = min( offsetCorner.x, offsetCorner.y ) * -1.0;\n\tif (vUv.x < 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopLeft, 0.0 ) ) - u_borderRadiusTopLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y >= 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusTopRight, 0.0 ) ) - u_borderRadiusTopRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusTopRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x >= 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomRight, 0.0 ) ) - u_borderRadiusBottomRight;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomRight );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n\tif (vUv.x < 0.5 && vUv.y < 0.5) {\n\t\tfloat roundedDist = length( max( abs( planeSpaceCoord ) - u_size * 0.5 + u_borderRadiusBottomLeft, 0.0 ) ) - u_borderRadiusBottomLeft;\n\t\tfloat s = step( innerRadDist * -1.0, u_borderRadiusBottomLeft );\n\t\treturn mix( innerRadDist, roundedDist, s );\n\t}\n}\n\nvec4 sampleTexture() {\n\tfloat textureRatio = u_tSize.x / u_tSize.y;\n\tfloat panelRatio = u_size.x / u_size.y;\n\tvec2 uv = vUv;\n\tif ( u_backgroundMapping == 1 ) { // contain\n\t\tif ( textureRatio < panelRatio ) { // repeat on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t} else { // repeat on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t}\n\t} else if ( u_backgroundMapping == 2 ) { // cover\n\t\tif ( textureRatio < panelRatio ) { // stretch on Y\n\t\t\tfloat newY = uv.y * ( textureRatio / panelRatio );\n\t\t\tnewY += 0.5 - 0.5 * ( textureRatio / panelRatio );\n\t\t\tuv.y = newY;\n\t\t} else { // stretch on X\n\t\t\tfloat newX = uv.x * ( panelRatio / textureRatio );\n\t\t\tnewX += 0.5 - 0.5 * ( panelRatio / textureRatio );\n\t\t\tuv.x = newX;\n\t\t}\n\t}\n\treturn texture2D( u_texture, uv ).rgba;\n}\n\nvoid main() {\n\n\tfloat edgeDist = getEdgeDist();\n\tfloat change = fwidth( edgeDist );\n\n\tvec4 textureSample = sampleTexture();\n\tvec3 blendedColor = textureSample.rgb * u_color;\n\n\tfloat alpha = smoothstep( change, 0.0, edgeDist );\n\tfloat blendedOpacity = u_opacity * textureSample.a * alpha;\n\n\tvec4 frameColor = vec4( blendedColor, blendedOpacity );\n\n\tif ( u_borderWidth <= 0.0 ) {\n\t\tgl_FragColor = frameColor;\n\t} else {\n\t\tvec4 borderColor = vec4( u_borderColor, u_borderOpacity * alpha );\n\t\tfloat stp = smoothstep( edgeDist + change, edgeDist, u_borderWidth * -1.0 );\n\t\tgl_FragColor = mix( frameColor, borderColor, stp );\n\t}\n\n\t#include <clipping_planes_fragment>\n}\n";class rz extends bt.Mesh{constructor(e){super(new bt.PlaneGeometry,e),this.castShadow=!0,this.receiveShadow=!0,this.name="MeshUI-Frame"}}let Hy=null;function Zh(...n){if(!Hy)throw new Error("Cannot use mixins with Base null");let e=Hy;Hy=null;let i,t=n.length;for(;--t>=0;)i=n[t],e=i(e);return e}Zh.withBase=n=>(Hy=n,Zh);class Gp extends(Zh.withBase(bt.Object3D)(gT,nz,ET,zy)){constructor(e){super(e),this.isBlock=!0,this.size=new bt.Vector2(1,1),this.frame=new rz(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){const e=this.getBestFit();"none"!=e&&this.childrenTexts.length?this.calculateBestFit(e):this.childrenTexts.forEach(t=>{t._fitFontSize=void 0})}updateLayout(){const e=this.getWidth(),t=this.getHeight();e&&t?(this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.autoLayout&&this.setPosFromParentRecords(),this.childrenInlines.length&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.parentUI&&(this.position.z=this.getOffset())):console.warn("Block got no dimension from its parameters or from children parameters")}updateInner(){this.parentUI&&(this.position.z=this.getOffset()),this.frame&&this.updateBackgroundMaterial()}}function sz(n){return class extends n{constructor(t){super(t),this.isInline=!0}}}function oz(n){let e,t,i,r=0;for(let a=0;a<n.length;++a){const c=n[a];if(c.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===e&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===t&&(t=c.itemSize),t!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=c.normalized),i!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=c.array.length}const s=new e(r);let o=0;for(let a=0;a<n.length;++a)s.set(n[a].array,o),o+=n[a].array.length;return new bt.BufferAttribute(s,t,i)}class Ihe extends bt.PlaneGeometry{constructor(e,t){const i=e.glyph,r=e.fontSize;super(e.width,e.height),null===i.match(/\s/g)?(-1===t.info.charset.indexOf(i)&&console.error(`The character '${i}' is not included in the font characters set.`),this.mapUVs(t,i),this.transformGeometry(e)):(this.nullifyUVs(),this.scale(0,0,1),this.translate(0,r/2,0))}mapUVs(e,t){const i=e.chars.find(u=>u.char===t),r=e.common,s=i.x/r.scaleW,o=(i.x+i.width)/r.scaleW,a=1-(i.y+i.height)/r.scaleH,c=1-i.y/r.scaleH,l=this.attributes.uv;for(let u=0;u<l.count;u++){let h=l.getX(u),d=l.getY(u);[h,d]=(()=>{switch(u){case 0:return[s,c];case 1:return[o,c];case 2:return[s,a];case 3:return[o,a]}})(),l.setXY(u,h,d)}}nullifyUVs(){const e=this.attributes.uv;for(let t=0;t<e.count;t++)e.setXY(t,0,0)}transformGeometry(e){this.translate(e.width/2,e.height/2,0)}}const ST={getGlyphDimensions:function Rhe(n){const e=n.font,t=n.fontSize,i=n.glyph,r=t/e.info.size,s=e.chars.find(h=>h.char===i);let o=s?s.width*r:t/3,a=s?s.height*r:0;return 0===o&&(o=s?s.xadvance*r:t),0===a&&(a=.7*t),"\n"===i&&(o=0),{width:o,height:a,anchor:s?s.yoffset*r:0,xadvance:s?s.xadvance*r:o,xoffset:s?s.xoffset*r:0}},getGlyphPairKerning:function Phe(n,e){const t=n._kernings;return t[e]?t[e]:0},buildText:function Nhe(){const n=[];this.inlines.forEach((i,r)=>{n[r]=new Ihe(i,this.getFontFamily()),n[r].translate(i.offsetX,i.offsetY,0)});const e=function Dhe(n,e=!1){const t=null!==n[0].index,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},a=n[0].morphTargetsRelative,c=new bt.BufferGeometry;let l=0;for(let u=0;u<n.length;++u){const h=n[u];let d=0;if(t!==(null!==h.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const f in h.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[f]&&(s[f]=[]),s[f].push(h.attributes[f]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const f in h.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[f]&&(o[f]=[]),o[f].push(h.morphAttributes[f])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(h.userData),e){let f;if(t)f=h.index.count;else{if(void 0===h.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;f=h.attributes.position.count}c.addGroup(l,f,u),l+=f}}if(t){let u=0;const h=[];for(let d=0;d<n.length;++d){const f=n[d].index;for(let p=0;p<f.count;++p)h.push(f.getX(p)+u);u+=n[d].attributes.position.count}c.setIndex(h)}for(const u in s){const h=oz(s[u]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;c.setAttribute(u,h)}for(const u in o){const h=o[u][0].length;if(0===h)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[u]=[];for(let d=0;d<h;++d){const f=[];for(let m=0;m<o[u].length;++m)f.push(o[u][m][d]);const p=oz(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;c.morphAttributes[u].push(p)}}return c}(n);return new bt.Mesh(e,this.getFontMaterial())}};function Lhe(n){return class extends n{createText(){const t=this,i=(()=>{if("MSDF"===this.getTextType())return ST.buildText.call(this);console.warn(`'${this.getTextType()}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)})();return i.renderOrder=1/0,i.onBeforeRender=function(){t.updateClippingPlanes&&t.updateClippingPlanes()},i}getGlyphDimensions(t){if("MSDF"===t.textType)return ST.getGlyphDimensions(t);console.warn(`'${t.textType}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}getGlyphPairKerning(t,i,r){if("MSDF"===t)return ST.getGlyphPairKerning(i,r);console.warn(`'${t}' is not a supported text type.\nSee https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type`)}}}const Ohe=function cz(n){n.children.forEach(e=>{e.children.length>0&&cz(e),n.remove(e),Hp.disposeOf(e),e.material&&e.material.dispose(),e.geometry&&e.geometry.dispose()}),n.children=[]};class MT extends(Zh.withBase(bt.Object3D)(sz,Lhe,ET,zy)){constructor(e){super(e),this.isText=!0,this.set(e)}parseParams(){this.calculateInlines(this._fitFontSize||this.getFontSize())}updateLayout(){Ohe(this),this.inlines&&(this.textContent=this.createText(),this.updateTextMaterial(),this.add(this.textContent)),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.textContent&&this.updateTextMaterial()}calculateInlines(e){const t=this.content,i=this.getFontFamily(),r=this.getBreakOn(),s=this.getTextType(),o=this.getWhiteSpace();if(!i||"string"==typeof i)return void(zp.getFontOf(this)||console.warn("no font was found"));if(!this.content)return void(this.inlines=null);if(!s)return void console.error("You must provide a 'textType' attribute so three-mesh-ui knows how to render your text.\n See https://github.com/felixmariotto/three-mesh-ui/wiki/Using-a-custom-text-type");const a=WV(t,o),c=Array.from?Array.from(a):String(a).split(""),l=e/i.info.size,u=i.common.lineHeight*l,h=i.common.base*l,d=c.map(f=>{const p=this.getGlyphDimensions({textType:s,glyph:f,font:i,fontSize:e});let m=null;return o!==Xh&&(r.includes(f)||f.match(/\s/g))&&(m="possible"),f.match(/\n/g)&&(m=jV(o)),{height:p.height,width:p.width,anchor:p.anchor,xadvance:p.xadvance,xoffset:p.xoffset,lineBreak:m,glyph:f,fontSize:e,lineHeight:u,lineBase:h}});if("none"!==this.getFontKerning())for(let f=1;f<d.length;f++){const p=d[f],_=this.getGlyphPairKerning(s,i,d[f-1].glyph+d[f].glyph);p.kerning=_*(e/i.info.size)}this.inlines=d}}class CT extends(Zh.withBase(bt.Object3D)(sz,gT,nz,ET,zy)){constructor(e){super(e),this.isInlineBlock=!0,this.size=new bt.Vector2(1,1),this.frame=new rz(this.getBackgroundMaterial()),this.frame.onBeforeRender=()=>{this.updateClippingPlanes&&this.updateClippingPlanes()},this.add(this.frame),this.set(e)}parseParams(){this.width||console.warn("inlineBlock has no width. Set to 0.3 by default"),this.height||console.warn("inlineBlock has no height. Set to 0.3 by default"),this.inlines=[{height:this.height||.3,width:this.width||.3,anchor:0,lineBreak:"possible"}]}updateLayout(){const e=this.getWidth(),t=this.getHeight();if(this.inlines){const i=this.inlines[0];this.position.set(i.width/2,i.height/2,0),this.position.x+=i.offsetX,this.position.y+=i.offsetY}this.size.set(e,t),this.frame.scale.set(e,t,1),this.frame&&this.updateBackgroundMaterial(),this.frame.renderOrder=this.getParentsNumber(),this.childrenInlines.length&&this.computeInlinesPosition(),this.computeChildrenPosition(),this.position.z=this.getOffset()}updateInner(){this.position.z=this.getOffset(),this.frame&&this.updateBackgroundMaterial()}}const Ha_fr=[[[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]}],[{width:.2,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ha_eng=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ha_ru=[[[{width:1/12,chars:[{lowerCase:"\u0439",upperCase:"\u0419"},{lowerCase:"q",upperCase:"Q"}]},{width:1/12,chars:[{lowerCase:"\u0446",upperCase:"\u0426"},{lowerCase:"w",upperCase:"W"}]},{width:1/12,chars:[{lowerCase:"\u0443",upperCase:"\u0423"},{lowerCase:"e",upperCase:"E"}]},{width:1/12,chars:[{lowerCase:"\u043a",upperCase:"\u041a"},{lowerCase:"r",upperCase:"R"}]},{width:1/12,chars:[{lowerCase:"\u0435",upperCase:"\u0415"},{lowerCase:"t",upperCase:"T"}]},{width:1/12,chars:[{lowerCase:"\u043d",upperCase:"\u041d"},{lowerCase:"y",upperCase:"Y"}]},{width:1/12,chars:[{lowerCase:"\u0433",upperCase:"\u0413"},{lowerCase:"u",upperCase:"U"}]},{width:1/12,chars:[{lowerCase:"\u0448",upperCase:"\u0428"},{lowerCase:"i",upperCase:"I"}]},{width:1/12,chars:[{lowerCase:"\u0449",upperCase:"\u0429"},{lowerCase:"o",upperCase:"O"}]},{width:1/12,chars:[{lowerCase:"\u0437",upperCase:"\u0417"},{lowerCase:"p",upperCase:"P"}]},{width:1/12,chars:[{lowerCase:"\u0445",upperCase:"\u0425"},{lowerCase:"{",upperCase:"["}]},{width:1/12,chars:[{lowerCase:"\u044a",upperCase:"\u042a"},{lowerCase:"}",upperCase:"]"}]}],[{width:1/12,chars:[{lowerCase:"\u0444",upperCase:"\u0424"},{lowerCase:"a",upperCase:"A"}]},{width:1/12,chars:[{lowerCase:"\u044b",upperCase:"\u042b"},{lowerCase:"s",upperCase:"S"}]},{width:1/12,chars:[{lowerCase:"\u0432",upperCase:"\u0412"},{lowerCase:"d",upperCase:"D"}]},{width:1/12,chars:[{lowerCase:"\u0430",upperCase:"\u0410"},{lowerCase:"f",upperCase:"F"}]},{width:1/12,chars:[{lowerCase:"\u043f",upperCase:"\u041f"},{lowerCase:"g",upperCase:"G"}]},{width:1/12,chars:[{lowerCase:"\u0440",upperCase:"\u0420"},{lowerCase:"h",upperCase:"H"}]},{width:1/12,chars:[{lowerCase:"\u043e",upperCase:"\u041e"},{lowerCase:"j",upperCase:"J"}]},{width:1/12,chars:[{lowerCase:"\u043b",upperCase:"\u041b"},{lowerCase:"k",upperCase:"K"}]},{width:1/12,chars:[{lowerCase:"\u0434",upperCase:"\u0414"},{lowerCase:"l",upperCase:"L"}]},{width:1/12,chars:[{lowerCase:"\u0436",upperCase:"\u0416"},{lowerCase:":",upperCase:";"}]},{width:1/12,chars:[{lowerCase:"\u044d",upperCase:"\u042d"},{lowerCase:'"',upperCase:"'"}]},{width:1/12,chars:[{lowerCase:"\u0451",upperCase:"\u0401"},{lowerCase:"|",upperCase:"\\"}]}],[{width:.125,command:"shift",chars:[{icon:"shift"}]},{width:1/12,chars:[{lowerCase:"\u044f",upperCase:"\u042f"},{lowerCase:"z",upperCase:"Z"}]},{width:1/12,chars:[{lowerCase:"\u0447",upperCase:"\u0427"},{lowerCase:"x",upperCase:"X"}]},{width:1/12,chars:[{lowerCase:"\u0441",upperCase:"\u0421"},{lowerCase:"c",upperCase:"C"}]},{width:1/12,chars:[{lowerCase:"\u043c",upperCase:"\u041c"},{lowerCase:"v",upperCase:"V"}]},{width:1/12,chars:[{lowerCase:"\u0438",upperCase:"\u0418"},{lowerCase:"b",upperCase:"B"}]},{width:1/12,chars:[{lowerCase:"\u0442",upperCase:"\u0422"},{lowerCase:"n",upperCase:"N"}]},{width:1/12,chars:[{lowerCase:"\u044c",upperCase:"\u042c"},{lowerCase:"m",upperCase:"M"}]},{width:1/12,chars:[{lowerCase:"\u0431",upperCase:"\u0411"},{lowerCase:",",upperCase:""}]},{width:1/12,chars:[{lowerCase:"\u044e",upperCase:"\u042e"},{lowerCase:".",upperCase:""}]},{width:.125,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.3,command:"switch",chars:[{lowerCase:"\u0410\u0411\u0412"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ha_de=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"\xfc",upperCase:"\xdc"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"\xf6",upperCase:"\xd6"}]},{width:1/11,chars:[{lowerCase:"\xe4",upperCase:"\xc4"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ha_es=[[[{width:.1,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"l",upperCase:"L"}]},{width:.1,chars:[{lowerCase:"\xf1",upperCase:"\xd1"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ha_el=[[[{width:.1,chars:[{lowerCase:";",upperCase:":"},{lowerCase:"q",upperCase:"Q"}]},{width:.1,chars:[{lowerCase:"\u03c2",upperCase:"\u03c2"},{lowerCase:"w",upperCase:"W"}]},{width:.1,chars:[{lowerCase:"\u03b5",upperCase:"\u0395"},{lowerCase:"e",upperCase:"E"}]},{width:.1,chars:[{lowerCase:"\u03c1",upperCase:"\u03a1"},{lowerCase:"r",upperCase:"R"}]},{width:.1,chars:[{lowerCase:"\u03c4",upperCase:"\u03a4"},{lowerCase:"t",upperCase:"T"}]},{width:.1,chars:[{lowerCase:"\u03c5",upperCase:"\u03a5"},{lowerCase:"y",upperCase:"Y"}]},{width:.1,chars:[{lowerCase:"\u03b8",upperCase:"\u0398"},{lowerCase:"u",upperCase:"U"}]},{width:.1,chars:[{lowerCase:"\u03b9",upperCase:"\u0399"},{lowerCase:"i",upperCase:"I"}]},{width:.1,chars:[{lowerCase:"\u03bf",upperCase:"\u039f"},{lowerCase:"o",upperCase:"O"}]},{width:.1,chars:[{lowerCase:"\u03c0",upperCase:"\u03a0"},{lowerCase:"p",upperCase:"P"}]}],[{width:.1,chars:[{lowerCase:"\u03b1",upperCase:"\u0391"},{lowerCase:"a",upperCase:"A"}]},{width:.1,chars:[{lowerCase:"\u03c3",upperCase:"\u03a3"},{lowerCase:"s",upperCase:"S"}]},{width:.1,chars:[{lowerCase:"\u03b4",upperCase:"\u0394"},{lowerCase:"d",upperCase:"D"}]},{width:.1,chars:[{lowerCase:"\u03c6",upperCase:"\u03a6"},{lowerCase:"f",upperCase:"F"}]},{width:.1,chars:[{lowerCase:"\u03b3",upperCase:"\u0393"},{lowerCase:"g",upperCase:"G"}]},{width:.1,chars:[{lowerCase:"\u03b7",upperCase:"\u0397"},{lowerCase:"h",upperCase:"H"}]},{width:.1,chars:[{lowerCase:"\u03be",upperCase:"\u039e"},{lowerCase:"j",upperCase:"J"}]},{width:.1,chars:[{lowerCase:"\u03ba",upperCase:"\u039a"},{lowerCase:"k",upperCase:"K"}]},{width:.1,chars:[{lowerCase:"\u03bb",upperCase:"\u039b"},{lowerCase:"l",upperCase:"L"}]}],[{width:.15,command:"shift",chars:[{icon:"shift"}]},{width:.1,chars:[{lowerCase:"\u03b6",upperCase:"\u0396"},{lowerCase:"z",upperCase:"Z"}]},{width:.1,chars:[{lowerCase:"\u03c7",upperCase:"\u03a7"},{lowerCase:"x",upperCase:"X"}]},{width:.1,chars:[{lowerCase:"\u03c8",upperCase:"\u03a8"},{lowerCase:"c",upperCase:"C"}]},{width:.1,chars:[{lowerCase:"\u03c9",upperCase:"\u03a9"},{lowerCase:"v",upperCase:"V"}]},{width:.1,chars:[{lowerCase:"\u03b2",upperCase:"\u0392"},{lowerCase:"b",upperCase:"B"}]},{width:.1,chars:[{lowerCase:"\u03bd",upperCase:"\u039d"},{lowerCase:"n",upperCase:"N"}]},{width:.1,chars:[{lowerCase:"\u03bc",upperCase:"\u039c"},{lowerCase:"m",upperCase:"M"}]},{width:.15,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.15,command:"switch-set",chars:[{lowerCase:"eng"}]},{width:.15,command:"switch",chars:[{lowerCase:".?12"}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Ha_nord=[[[{width:1/11,chars:[{lowerCase:"q",upperCase:"Q"}]},{width:1/11,chars:[{lowerCase:"w",upperCase:"W"}]},{width:1/11,chars:[{lowerCase:"e",upperCase:"E"}]},{width:1/11,chars:[{lowerCase:"r",upperCase:"R"}]},{width:1/11,chars:[{lowerCase:"t",upperCase:"T"}]},{width:1/11,chars:[{lowerCase:"y",upperCase:"Y"}]},{width:1/11,chars:[{lowerCase:"u",upperCase:"U"}]},{width:1/11,chars:[{lowerCase:"i",upperCase:"I"}]},{width:1/11,chars:[{lowerCase:"o",upperCase:"O"}]},{width:1/11,chars:[{lowerCase:"p",upperCase:"P"}]},{width:1/11,chars:[{lowerCase:"\xe5",upperCase:"\xc5"}]}],[{width:1/11,chars:[{lowerCase:"a",upperCase:"A"}]},{width:1/11,chars:[{lowerCase:"s",upperCase:"S"}]},{width:1/11,chars:[{lowerCase:"d",upperCase:"D"}]},{width:1/11,chars:[{lowerCase:"f",upperCase:"F"}]},{width:1/11,chars:[{lowerCase:"g",upperCase:"G"}]},{width:1/11,chars:[{lowerCase:"h",upperCase:"H"}]},{width:1/11,chars:[{lowerCase:"j",upperCase:"J"}]},{width:1/11,chars:[{lowerCase:"k",upperCase:"K"}]},{width:1/11,chars:[{lowerCase:"l",upperCase:"L"}]},{width:1/11,chars:[{lowerCase:"\xe6",upperCase:"\xc6"}]},{width:1/11,chars:[{lowerCase:"\xf8",upperCase:"\xd8"}]}],[{width:2/11,command:"shift",chars:[{icon:"shift"}]},{width:1/11,chars:[{lowerCase:"z",upperCase:"Z"}]},{width:1/11,chars:[{lowerCase:"x",upperCase:"X"}]},{width:1/11,chars:[{lowerCase:"c",upperCase:"C"}]},{width:1/11,chars:[{lowerCase:"v",upperCase:"V"}]},{width:1/11,chars:[{lowerCase:"b",upperCase:"B"}]},{width:1/11,chars:[{lowerCase:"n",upperCase:"N"}]},{width:1/11,chars:[{lowerCase:"m",upperCase:"M"}]},{width:2/11,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]],[[{width:.1,chars:[{lowerCase:"1"}]},{width:.1,chars:[{lowerCase:"2"}]},{width:.1,chars:[{lowerCase:"3"}]},{width:.1,chars:[{lowerCase:"4"}]},{width:.1,chars:[{lowerCase:"5"}]},{width:.1,chars:[{lowerCase:"6"}]},{width:.1,chars:[{lowerCase:"7"}]},{width:.1,chars:[{lowerCase:"8"}]},{width:.1,chars:[{lowerCase:"9"}]},{width:.1,chars:[{lowerCase:"0"}]}],[{width:.1,chars:[{lowerCase:"@"}]},{width:.1,chars:[{lowerCase:"#"}]},{width:.1,chars:[{lowerCase:"|"}]},{width:.1,chars:[{lowerCase:"_"}]},{width:.1,chars:[{lowerCase:"&"}]},{width:.1,chars:[{lowerCase:"-"}]},{width:.1,chars:[{lowerCase:"+"}]},{width:.1,chars:[{lowerCase:"("}]},{width:.1,chars:[{lowerCase:")"}]},{width:.1,chars:[{lowerCase:"/"}]}],[{width:.1,chars:[{lowerCase:"="}]},{width:.1,chars:[{lowerCase:"*"}]},{width:.1,chars:[{lowerCase:'"'}]},{width:.1,chars:[{lowerCase:"'"}]},{width:.1,chars:[{lowerCase:":"}]},{width:.1,chars:[{lowerCase:";"}]},{width:.1,chars:[{lowerCase:"!"}]},{width:.1,chars:[{lowerCase:"?"}]},{width:.2,command:"backspace",chars:[{icon:"backspace"}]}],[{width:.2,command:"switch",chars:[{lowerCase:".?12"}]},{width:.1,chars:[{lowerCase:","}]},{width:.4,command:"space",chars:[{icon:"space"}]},{width:.1,chars:[{lowerCase:"."}]},{width:.2,command:"enter",chars:[{icon:"enter"}]}]]],Fhe=new bt.TextureLoader;class lz extends(Zh.withBase(bt.Object3D)(gT,zy)){constructor(e){let t;if(e||(e={}),e.width||(e.width=1),e.height||(e.height=.4),e.margin||(e.margin=.003),e.padding||(e.padding=.01),super(e),this.currentPanel=0,this.isLowerCase=!0,this.charsetCount=1,e.language||navigator.language)switch(e.language||navigator.language){case"fr":case"fr-CH":case"fr-CA":t=Ha_fr;break;case"ru":this.charsetCount=2,t=Ha_ru;break;case"de":case"de-DE":case"de-AT":case"de-LI":case"de-CH":t=Ha_de;break;case"es":case"es-419":case"es-AR":case"es-CL":case"es-CO":case"es-ES":case"es-CR":case"es-US":case"es-HN":case"es-MX":case"es-PE":case"es-UY":case"es-VE":t=Ha_es;break;case"el":this.charsetCount=2,t=Ha_el;break;case"nord":t=Ha_nord;break;default:t=Ha_eng}else t=Ha_eng;this.keys=[],this.panels=t.map(i=>{const r=e.height/i.length-2*e.margin,s=new Gp({width:e.width+2*e.padding,height:e.height+2*e.padding,offset:0,padding:e.padding,fontFamily:e.fontFamily,fontTexture:e.fontTexture,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity});return s.charset=0,s.add(...i.map(o=>{const a=new Gp({width:e.width,height:r,margin:e.margin,contentDirection:"row",justifyContent:"center"});a.frame.visible=!1;const c=[];return o.forEach(l=>{const u=new Gp({width:e.width*l.width-2*e.margin,height:r,margin:e.margin,justifyContent:"center",offset:0}),h=l.chars[s.charset].lowerCase||l.chars[s.charset].icon||"undif";if("enter"===h&&e.enterTexture||"shift"===h&&e.shiftTexture||"backspace"===h&&e.backspaceTexture){const d=(()=>{switch(h){case"backspace":return e.backspaceTexture;case"enter":return e.enterTexture;case"shift":return e.shiftTexture;default:console.warn("There is no icon image for this key")}})();Fhe.load(d,f=>{u.add(new CT({width:.65*u.width,height:.65*u.height,backgroundSize:"contain",backgroundTexture:f}))})}else u.add(new MT({content:h,offset:0}));u.type="Key",u.info=l,u.info.input=h,u.panel=s,c.push(u),this.keys.push(u)}),a.add(...c),a})),s}),this.add(this.panels[0]),this.set(e)}setNextPanel(){this.panels.forEach(e=>{this.remove(e)}),this.currentPanel=(this.currentPanel+1)%this.panels.length,this.add(this.panels[this.currentPanel]),this.update(!0,!0,!0)}setNextCharset(){this.panels[this.currentPanel].charset=(this.panels[this.currentPanel].charset+1)%this.charsetCount,this.keys.forEach(e=>{if(!this.panels[this.currentPanel].getObjectById(e.id))return;const i=e.info.chars[e.panel.charset]||e.info.chars[0],r=this.isLowerCase||!i.upperCase?i.lowerCase:i.upperCase;if(!e.childrenTexts.length)return;const s=e.childrenTexts[0];e.info.input=r,s.set({content:r}),s.update(!0,!0,!0)})}toggleCase(){this.isLowerCase=!this.isLowerCase,this.keys.forEach(e=>{const t=e.info.chars[e.panel.charset]||e.info.chars[0],i=this.isLowerCase||!t.upperCase?t.lowerCase:t.upperCase;if(!e.childrenTexts.length)return;const r=e.childrenTexts[0];e.info.input=i,r.set({content:i}),r.update(!0,!0,!0)})}parseParams(){}updateLayout(){}updateInner(){}}const uz=()=>Hp.update(),hz={Block:Gp,Text:MT,InlineBlock:CT,Keyboard:lz,FontLibrary:zp,update:uz,TextAlign:Ny,Whitespace:Py,JustifyContent:Ry,AlignItems:Iy,ContentDirection:Dy};typeof global<"u"&&(global.ThreeMeshUI=hz);const khe=hz;var Kh=Ur.gO,TT=Ur.xv,Uhe=Ur.Vx;let AT=(()=>{var n;class e{constructor(i,r){this.interactions=i,this.debug=r,this.selectState=!1,this.FontJSON="assets/fonts/Roboto-msdf.json",this.FontImage="assets/fonts/Roboto-msdf.png",this.buttonOptions={width:.4,height:.15,justifyContent:"center",offset:.05,margin:.02,borderRadius:.075},this.defaultOptions={name:"Button Panel Container",buttons:[{name:"Next Button",text:"Next",onHover:s=>{console.log("Next Button is hovered")},buttonOptions:{width:.4,height:.15,justifyContent:"center",offset:.05,margin:.02,borderRadius:.075}},{name:"Prev Button",text:"Previous",onHover:s=>{console.log("Previous Button is hovered")},buttonOptions:{width:.4,height:.15,justifyContent:"center",offset:.05,margin:.02,borderRadius:.075}}]},this.idleStateAttributes={state:"idle",attributes:{width:.4,height:.15,offset:.035,backgroundColor:new Z(6710886),backgroundOpacity:.3,fontColor:new Z(16777215)},onSet:s=>{}},this.hoveredStateAttributes={state:"hovered",attributes:{width:.4,height:.15,offset:.035,backgroundColor:new Z(10066329),backgroundOpacity:1,fontColor:new Z(16777215)},onSet:s=>{}},this.selectedAttributes={offset:.02,backgroundColor:new Z(7829367),fontColor:new Z(2236962)},this.hemLight=new WM(8421504,6316128),this.selected=0,this.selection=[1,2,3]}createMoreInfoPanels(i){const r=new Kh({ref:"container",padding:.02,fontFamily:this.FontJSON,fontTexture:this.FontImage,fontColor:new Z(16777215),fontSize:.3,backgroundOpacity:.5,width:1,height:2});r.rotation.y=-.5,r.name=`More Info Panel ${i.id}`;const s=new Kh({height:.2,width:.9,margin:.05,justifyContent:"center",fontSize:.1}),o=new TT({content:`${i.title} `});o.name=`${i.id} Text`,s.add(o),s.name=`Painting ${i.id} title`,this.title=s,r.add(this.title);const a=new Kh({height:1.6,width:.9,margin:.01,padding:.02,fontSize:.15,alignItems:"start",textAlign:"justify",backgroundOpacity:0,bestFit:"auto"}).add(new TT({content:i.description}));a.name="Artwork Description";const c=new Kh({padding:.02,margin:.025,backgroundOpacity:.2,height:1.6,width:.9,justifyContent:"center",bestFit:"grow",fontSize:5});return c.name="Content Container",this.description=a,c.add(this.description),r.add(c),r}updateInfoPanel(i){this.description.children[1].set({content:String(i.description)}),this.title.children[1].set({content:`${i.title}: ${i.votes} likes`})}updateVote(i){const r=`${i.text.content.split(":")[0]} : ${i.votes} likes`;i.text.set({content:r})}createInteractiveButtons(i){const r=Object.assign({},this.defaultOptions,i),s=new Kh({justifyContent:"center",contentDirection:"row-reverse",fontFamily:this.FontJSON,fontTexture:this.FontImage,fontSize:.1,padding:.02,borderRadius:.11,height:.2,width:i.buttons.length/2});return s.name=r.name,this.container=s,r.buttons.forEach((o,a)=>{const c=this.createButton(r.id,o);this.container.add(c)}),s}createButton(i,r){const s=new Kh(this.buttonOptions);return s.name=`Frame ${i} ${r.name}`,s.add(new TT({content:r.text,name:`${r.name} Text`})),s.setupState({state:"selected",attributes:this.selectedAttributes}),s.setupState(this.idleStateAttributes),s.setupState(this.hoveredStateAttributes),s.position.set(-.5,0,0),this.interactions.addToInteractions(s),this.interactions.addToColliders({mesh:s,name:r.name,cb:()=>{r.onClick(i)}}),s.addEventListener("click",()=>{r.onClick(i)}),s}update(){Uhe()}}return(n=e).\u0275fac=function(i){return new(i||n)(we(kp),we(al))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:null}),e})(),dz=(()=>{var n;class e{constructor(i,r,s,o,a,c,l){this.objectsService=i,this.interactionsService=r,this.lightsService=s,this.loadersService=o,this.materialsService=a,this.uiService=c,this.debug=l,this.frameDistance=7,this.angle=0,this.frames=[],this.locations=[],this.focusFactor=4,this.frameGeometry=new kc(.8,.7,.1,36,5),this.matrix=new Ge,this.frameMaterial=new Fo({color:16777215}),this.framesGroup=new Ss}createFrames(i=[],r=[],s){return this.framesGroup.name="Frames Group",this.angle=2*Math.PI/i.length,this.frames=i.map((o,a)=>this.placeFrame(this.createFrame(o,r,a),a)),this.framesGroup.add(...this.frames),this.framesGroup.position.set(0,1.6,0),this.focusFrame(0),this.framesGroup}placeFrame(i,r=0){const s=r*this.angle,o=Math.sin(s)*this.frameDistance,a=-Math.cos(s)*this.frameDistance;return i.position.set(o,0,a),i.scale.set(1.3,1.3,1.3),i.rotation.y=s,i.userData.originalPosition=i.position.clone(),i}createFrame(i,r=[],s){const o=new Ss;o.name=` ${i.title} frame group`,this.frameGeometry.rotateX(Math.PI/2);const a=new Po(i?.width/100*1.12,i?.height/100*1.12,.15),c=this.loadersService.loadTexture(i.textureUrl);c.colorSpace=Wt,c.mapping=300;const l=new Fo({map:c,color:16777215}),u=new Ov(this.frameGeometry,this.frameMaterial,5),h=new Ov(a,l,5);u.name=` ${i.title} frame mesh`||"frame",h.name=` ${i.title} canvas mesh`||"frame canvas";const d=this.lightsService.createSpotLight();d[0].target=h,o.add(u,h,...d),o.rotateY(Math.PI);const f=this.uiService.createInteractiveButtons({buttons:r,id:i.id}),p=this.uiService.createMoreInfoPanels({id:i.id,title:i.title,description:i.description,votes:i.votes});return p.quaternion.copy(u.quaternion),f.position.x=0,f.position.y=-.7,f.position.z=-.2,f.rotateY(Math.PI),f.rotateX(-.55),p.position.x=1.3,p.rotateY(-72),o.add(p,f),o}focusFrame(i){const r=this.frames[i],a=new A(r.position.x/this.frameDistance*this.focusFactor,r.position.y,r.position.z/this.frameDistance*this.focusFactor);this.moveFrame(r,a)}resetPosition(i){const r=this.frames[i];this.moveFrame(r,r.userData.originalPosition)}animateFrameColors(i,r){}moveFrame(i,r){Lp.to(i.position,{x:r.x,y:r.y,z:r.z,duration:2.5})}rotateFrames(i=72){console.log("MathUtils.degToRad( angle ) + this.framesGroup.rotation.y",Cc_degToRad(i),this.framesGroup.rotation.y);const r=Cc_degToRad(i)+this.framesGroup.rotation.y;Lp.to(this.framesGroup.rotation,{y:r,duration:1})}}return(n=e).\u0275fac=function(i){return new(i||n)(we(SV),we(kp),we(EV),we(oT),we(rT),we(AT),we(al))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})();const fz=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=63&r|128):55296==(64512&r)&&i+1<n.length&&56320==(64512&n.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&n.charCodeAt(++i)),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=63&r|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=63&r|128)}return e},pz={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,c=r+2<n.length,l=c?n[r+2]:0;let d=(15&a)<<2|l>>6,f=63&l;c||(f=64,o||(d=64)),i.push(t[s>>2],t[(3&s)<<4|a>>4],t[d],t[f])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(fz(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const c=((7&r)<<18|(63&n[t++])<<12|(63&n[t++])<<6|63&n[t++])-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(1023&c))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const l=r<n.length?t[n.charAt(r)]:64;++r;const h=r<n.length?t[n.charAt(r)]:64;if(++r,null==s||null==a||null==l||null==h)throw new Hhe;i.push(s<<2|a>>4),64!==l&&(i.push(a<<4&240|l>>2),64!==h&&i.push(l<<6&192|h))}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Hhe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Gy=function(n){return function(n){const e=fz(n);return pz.encodeByteArray(e,!0)}(n).replace(/\./g,"")},Wy=()=>{try{return function jhe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&function(n){try{return pz.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}(n[1]);return e&&JSON.parse(e)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},gz=()=>{var n;return null===(n=Wy())||void 0===n?void 0:n.config};class _z{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,i))}}}class Jh extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name="FirebaseError",Object.setPrototypeOf(this,Jh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vz.prototype.create)}}class vz{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?function nde(n,e){return n.replace(ide,(t,i)=>{const r=e[i];return null!=r?String(r):`<${i}?>`})}(s,i):"Error";return new Jh(r,`${this.serviceName}: ${o} (${r}).`,i)}}const ide=/\{\$([^}]+)}/g;function RT(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(wz(s)&&wz(o)){if(!RT(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function wz(n){return null!==n&&"object"==typeof n}function Ga(n){return n&&n._delegate?n._delegate:n}class Wp{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const cl="[DEFAULT]";class hde{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new _z;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),r=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function fde(n){return"EAGER"===n.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:cl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=cl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return Fn(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...t.filter(i=>"_delete"in i).map(i=>i._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=cl){return this.instances.has(e)}getOptions(e=cl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries())i===this.normalizeInstanceIdentifier(s)&&o.resolve(r);return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=null!==(i=this.onInitCallbacks.get(r))&&void 0!==i?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:dde(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=cl){return this.component?this.component.multipleInstances?e:cl:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function dde(n){return n===cl?void 0:n}class pde{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new hde(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const LT=[];var zt=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(zt||{});const xz={debug:zt.DEBUG,verbose:zt.VERBOSE,info:zt.INFO,warn:zt.WARN,error:zt.ERROR,silent:zt.SILENT},mde=zt.INFO,gde={[zt.DEBUG]:"log",[zt.VERBOSE]:"log",[zt.INFO]:"info",[zt.WARN]:"warn",[zt.ERROR]:"error"},_de=(n,e,...t)=>{if(e<n.logLevel)return;const i=(new Date).toISOString(),r=gde[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${n.name}:`,...t)};class bz{constructor(e){this.name=e,this._logLevel=mde,this._logHandler=_de,this._userLogHandler=null,LT.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in zt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?xz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,zt.DEBUG,...e),this._logHandler(this,zt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,zt.VERBOSE,...e),this._logHandler(this,zt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,zt.INFO,...e),this._logHandler(this,zt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,zt.WARN,...e),this._logHandler(this,zt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,zt.ERROR,...e),this._logHandler(this,zt.ERROR,...e)}}const vde=(n,e)=>e.some(t=>n instanceof t);let Ez,Sz;const Mz=new WeakMap,OT=new WeakMap,Cz=new WeakMap,FT=new WeakMap,kT=new WeakMap;let UT={get(n,e,t){if(n instanceof IDBTransaction){if("done"===e)return OT.get(n);if("objectStoreNames"===e)return n.objectStoreNames||Cz.get(n);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wa(n[e])},set:(n,e,t)=>(n[e]=t,!0),has:(n,e)=>n instanceof IDBTransaction&&("done"===e||"store"===e)||e in n};function Mde(n){return"function"==typeof n?function Sde(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function wde(){return Sz||(Sz=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...e){return n.apply(BT(this),e),Wa(Mz.get(this))}:function(...e){return Wa(n.apply(BT(this),e))}:function(e,...t){const i=n.call(BT(this),e,...t);return Cz.set(i,e.sort?e.sort():[e]),Wa(i)}}(n):(n instanceof IDBTransaction&&function bde(n){if(OT.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});OT.set(n,e)}(n),vde(n,function yde(){return Ez||(Ez=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,UT):n)}function Wa(n){if(n instanceof IDBRequest)return function xde(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Wa(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Mz.set(t,n)}).catch(()=>{}),kT.set(e,n),e}(n);if(FT.has(n))return FT.get(n);const e=Mde(n);return e!==n&&(FT.set(n,e),kT.set(e,n)),e}const BT=n=>kT.get(n),Tde=["get","getKey","getAll","getAllKeys","count"],Ade=["put","add","delete","clear"],VT=new Map;function Tz(n,e){if(!(n instanceof IDBDatabase)||e in n||"string"!=typeof e)return;if(VT.get(e))return VT.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Ade.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Tde.includes(t))return;const s=function(){var o=Fn(function*(a,...c){const l=this.transaction(a,r?"readwrite":"readonly");let u=l.store;return i&&(u=u.index(c.shift())),(yield Promise.all([u[t](...c),r&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return VT.set(e,s),s}!function Ede(n){UT=n(UT)}(n=>({...n,get:(e,t,i)=>Tz(e,t)||n.get(e,t,i),has:(e,t)=>!!Tz(e,t)||n.has(e,t)}));class Dde{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function Ide(n){const e=n.getComponent();return"VERSION"===e?.type}(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}return null}).filter(t=>t).join(" ")}}const zT="@firebase/app",ll=new bz("@firebase/app"),qy="[DEFAULT]",nfe={[zT]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ul=new Map,Xy=new Map;function ife(n,e){try{n.container.addComponent(e)}catch(t){ll.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Yy(n){const e=n.name;if(Xy.has(e))return ll.debug(`There were multiple attempts to register component ${e}.`),!1;Xy.set(e,n);for(const t of ul.values())ife(t,n);return!0}const Ho=new vz("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class sfe{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Wp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ho.create("app-deleted",{appName:this._name})}}function Iz(n,e={}){let t=n;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:qy,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw Ho.create("bad-app-name",{appName:String(r)});if(t||(t=gz()),!t)throw Ho.create("no-options");const s=ul.get(r);if(s){if(RT(t,s.options)&&RT(i,s.config))return s;throw Ho.create("duplicate-app",{appName:r})}const o=new pde(r);for(const c of Xy.values())o.addComponent(c);const a=new sfe(t,i,o);return ul.set(r,a),a}function Qh(n,e,t){var i;let r=null!==(i=nfe[n])&&void 0!==i?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];return s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void ll.warn(a.join(" "))}Yy(new Wp(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const cfe="firebase-heartbeat-database",lfe=1,jp="firebase-heartbeat-store";let GT=null;function Rz(){return GT||(GT=function Cde(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Wa(o);return i&&o.addEventListener("upgradeneeded",c=>{i(Wa(o.result),c.oldVersion,c.newVersion,Wa(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",l=>r(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}(cfe,lfe,{upgrade:(n,e)=>{0===e&&n.createObjectStore(jp)}}).catch(n=>{throw Ho.create("idb-open",{originalErrorMessage:n.message})})),GT}function WT(){return WT=Fn(function*(n){try{return yield(yield Rz()).transaction(jp).objectStore(jp).get(Nz(n))}catch(e){if(e instanceof Jh)ll.warn(e.message);else{const t=Ho.create("idb-get",{originalErrorMessage:e?.message});ll.warn(t.message)}}}),WT.apply(this,arguments)}function Pz(n,e){return jT.apply(this,arguments)}function jT(){return jT=Fn(function*(n,e){try{const i=(yield Rz()).transaction(jp,"readwrite");yield i.objectStore(jp).put(e,Nz(n)),yield i.done}catch(t){if(t instanceof Jh)ll.warn(t.message);else{const i=Ho.create("idb-set",{originalErrorMessage:t?.message});ll.warn(i.message)}}}),jT.apply(this,arguments)}function Nz(n){return`${n.name}!${n.options.appId}`}class ffe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new mfe(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){var e=this;return Fn(function*(){var t,i;const s=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Lz();if((null!=(null===(t=e._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(e._heartbeatsCache=yield e._heartbeatsCachePromise,null!=(null===(i=e._heartbeatsCache)||void 0===i?void 0:i.heartbeats)))&&e._heartbeatsCache.lastSentHeartbeatDate!==o&&!e._heartbeatsCache.heartbeats.some(a=>a.date===o))return e._heartbeatsCache.heartbeats.push({date:o,agent:s}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(a=>{const c=new Date(a.date).valueOf();return Date.now()-c<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return Fn(function*(){var t;if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null==(null===(t=e._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===e._heartbeatsCache.heartbeats.length)return"";const i=Lz(),{heartbeatsToSend:r,unsentEntries:s}=function pfe(n,e=1024){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),Oz(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Oz(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}(e._heartbeatsCache.heartbeats),o=Gy(JSON.stringify({version:2,heartbeats:r}));return e._heartbeatsCache.lastSentHeartbeatDate=i,s.length>0?(e._heartbeatsCache.heartbeats=s,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),o})()}}function Lz(){return(new Date).toISOString().substring(0,10)}class mfe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Fn(function*(){return!!function Qhe(){try{return"object"==typeof indexedDB}catch{return!1}}()&&function ede(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e((null===(s=r.error)||void 0===s?void 0:s.message)||"")}}catch(t){e(t)}})}().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return Fn(function*(){if(yield e._canUseIndexedDBPromise){const i=yield function ufe(n){return WT.apply(this,arguments)}(e.app);return i?.heartbeats?i:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(e){var t=this;return Fn(function*(){var i;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return Pz(t.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return Fn(function*(){var i;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return Pz(t.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function Oz(n){return Gy(JSON.stringify({version:2,heartbeats:n})).length}!function gfe(n){Yy(new Wp("platform-logger",e=>new Dde(e),"PRIVATE")),Yy(new Wp("heartbeat",e=>new ffe(e),"PRIVATE")),Qh(zT,"0.9.24",n),Qh(zT,"0.9.24","esm2017"),Qh("fire-js","")}(""),Qh("firebase","10.7.0","app");class gr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gr.UNAUTHENTICATED=new gr(null),gr.GOOGLE_CREDENTIALS=new gr("google-credentials-uid"),gr.FIRST_PARTY=new gr("first-party-uid"),gr.MOCK_USER=new gr("mock-user");let ed="10.7.0";const hl=new bz("@firebase/firestore");function dl(n,...e){if(hl.logLevel<=zt.DEBUG){const t=e.map($T);hl.debug(`Firestore (${ed}): ${n}`,...t)}}function Zy(n,...e){if(hl.logLevel<=zt.ERROR){const t=e.map($T);hl.error(`Firestore (${ed}): ${n}`,...t)}}function Fz(n,...e){if(hl.logLevel<=zt.WARN){const t=e.map($T);hl.warn(`Firestore (${ed}): ${n}`,...t)}}function $T(n){if("string"==typeof n)return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function kt(n="Unexpected state"){const e=`FIRESTORE (${ed}) INTERNAL ASSERTION FAILED: `+n;throw Zy(e),new Error(e)}function _r(n,e){n||kt()}function fl(n,e){return n}const td="unknown",Oe="invalid-argument",Ky="unauthenticated",Go="failed-precondition",ZT="unimplemented";class Me extends Jh{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Wz{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xfe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(gr.UNAUTHENTICATED))}shutdown(){}}class bfe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Efe{constructor(e){this.auth=null,e.onInit(t=>{this.auth=t})}getToken(){return this.auth?this.auth.getToken().then(e=>e?(_r("string"==typeof e.accessToken),new Wz(e.accessToken,new gr(this.auth.getUid()))):null):Promise.resolve(null)}invalidateToken(){}start(e,t){}shutdown(){}}class Sfe{constructor(e,t,i){this.t=e,this.i=t,this.o=i,this.type="FirstParty",this.user=gr.FIRST_PARTY,this.u=new Map}l(){return this.o?this.o():null}get headers(){this.u.set("X-Goog-AuthUser",this.t);const e=this.l();return e&&this.u.set("Authorization",e),this.i&&this.u.set("X-Goog-Iam-Authorization-Token",this.i),this.u}}class Mfe{constructor(e,t,i){this.t=e,this.i=t,this.o=i}getToken(){return Promise.resolve(new Sfe(this.t,this.i,this.o))}start(e,t){e.enqueueRetryable(()=>t(gr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Cfe{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Tfe{constructor(e){this.h=e,this.appCheck=null,e.onInit(t=>{this.appCheck=t})}getToken(){return this.appCheck?this.appCheck.getToken().then(e=>e?(_r("string"==typeof e.token),new Cfe(e.token)):null):Promise.resolve(null)}invalidateToken(){}start(e,t){}shutdown(){}}class Afe{constructor(e,t,i,r,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class $p{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new $p("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof $p&&e.projectId===this.projectId&&e.database===this.database}}class qp{constructor(e,t,i){void 0===t?t=0:t>e.length&&kt(),void 0===i?i=e.length-t:i>e.length-t&&kt(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===qp.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qp?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Dn extends qp{construct(e,t,i){return new Dn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Me(Oe,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new Dn(t)}static emptyPath(){return new Dn([])}}const Dfe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vr extends qp{construct(e,t,i){return new vr(e,t,i)}static isValidIdentifier(e){return Dfe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new vr(["__name__"])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(0===i.length)throw new Me(Oe,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if("\\"===a){if(r+1===e.length)throw new Me(Oe,"Path has trailing escape character: "+e);const c=e[r+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Me(Oe,"Path has invalid escape sequence: "+e);i+=c,r+=2}else"`"===a?(o=!o,r++):"."!==a||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new Me(Oe,"Unterminated ` in path: "+e);return new vr(t)}static emptyPath(){return new vr([])}}class Bn{constructor(e){this.path=e}static fromPath(e){return new Bn(Dn.fromString(e))}static fromName(e){return new Bn(Dn.fromString(e).popFirst(5))}static empty(){return new Bn(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Dn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Bn(new Dn(e.slice()))}}function JT(n,e,t){if(!t)throw new Me(Oe,`Function ${n}() cannot be called with an empty ${e}.`)}function jz(n){if(!Bn.isDocumentKey(n))throw new Me(Oe,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function $z(n){if(Bn.isDocumentKey(n))throw new Me(Oe,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Jy(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return"function"==typeof n?"a function":kt()}function cs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Me(Oe,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Jy(n);throw new Me(Oe,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Xz(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}let Qy=null;function e0(n){return 0===n&&1/n==-1/0}const Rfe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Zz,Tt;function Kz(n){if(void 0===n)return Zy("RPC_ERROR","HTTP error has no status"),td;switch(n){case 200:return"ok";case 400:return Go;case 401:return Ky;case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 416:return"out-of-range";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return td;case 501:return ZT;case 503:return"unavailable";case 504:return"deadline-exceeded";default:return n>=200&&n<300?"ok":n>=400&&n<500?Go:n>=500&&n<600?"internal":td}}(Tt=Zz||(Zz={}))[Tt.OK=0]="OK",Tt[Tt.CANCELLED=1]="CANCELLED",Tt[Tt.UNKNOWN=2]="UNKNOWN",Tt[Tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tt[Tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tt[Tt.NOT_FOUND=5]="NOT_FOUND",Tt[Tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tt[Tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tt[Tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tt[Tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tt[Tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tt[Tt.ABORTED=10]="ABORTED",Tt[Tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tt[Tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tt[Tt.INTERNAL=13]="INTERNAL",Tt[Tt.UNAVAILABLE=14]="UNAVAILABLE",Tt[Tt.DATA_LOSS=15]="DATA_LOSS";class Pfe extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.m=i+"://"+t.host,this.A=`projects/${r}/databases/${s}`,this.T="(default)"===this.databaseId.database?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get P(){return!1}R(t,i,r,s,o){const a=function Ife(){return null===Qy?Qy=268435456+Math.round(2147483648*Math.random()):Qy++,"0x"+Qy.toString(16)}(),c=this.I(t,i);dl("RestConnection",`Sending RPC '${t}' ${a}:`,c,r);const l={"google-cloud-resource-prefix":this.A,"x-goog-request-params":this.T};return this.V(l,s,o),this.p(t,c,l,r).then(u=>(dl("RestConnection",`Received RPC '${t}' ${a}: `,u),u),u=>{throw Fz("RestConnection",`RPC '${t}' ${a} failed with error: `,u,"url: ",c,"request:",r),u})}g(t,i,r,s,o,a){return this.R(t,i,r,s,o)}V(t,i,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+ed,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}I(t,i){return`${this.m}/v1/${i}:${Rfe[t]}`}}{constructor(e,t){super(e),this.F=t}v(e,t){throw new Error("Not supported by FetchConnection")}p(e,t,i,r){var s=this;return Fn(function*(){var o;const a=JSON.stringify(r);let c;try{c=yield s.F(t,{method:"POST",headers:i,body:a})}catch(l){const u=l;throw new Me(Kz(u.status),"Request failed with error: "+u.statusText)}if(!c.ok){let l=yield c.json();Array.isArray(l)&&(l=l[0]);const u=null===(o=l?.error)||void 0===o?void 0:o.message;throw new Me(Kz(c.status),`Request failed with error: ${u??c.statusText}`)}return c.json()})()}}function Lfe(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class Ofe{static newId(){const t=62*Math.floor(256/62);let i="";for(;i.length<20;){const r=Lfe(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[s]%62))}return i}}function ri(n,e){return n<e?-1:n>e?1:0}function QT(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function Jz(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Xp(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}class Ffe extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Wo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Ffe("Invalid base64 string: "+s):s}}(e);return new Wo(t)}static fromUint8Array(e){const t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new Wo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ri(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Wo.EMPTY_BYTE_STRING=new Wo("");const kfe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pl(n){if(_r(!!n),"string"==typeof n){let e=0;const t=kfe.exec(n);if(_r(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Yn(n.seconds),nanos:Yn(n.nanos)}}function Yn(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Yp(n){return"string"==typeof n?Wo.fromBase64String(n):Wo.fromUint8Array(n)}class Br{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Me(Oe,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Me(Oe,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Me(Oe,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Me(Oe,"Timestamp seconds out of range: "+e)}static now(){return Br.fromMillis(Date.now())}static fromDate(e){return Br.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Br(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ri(this.nanoseconds,e.nanoseconds):ri(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}function eA(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Qz(n){const e=n.mapValue.fields.__previous_value__;return eA(e)?Qz(e):e}function Zp(n){const e=pl(n.mapValue.fields.__local_write_time__.timestampValue);return new Br(e.seconds,e.nanos)}const t0={fields:{__type__:{stringValue:"__max__"}}};function ml(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?eA(n)?4:function(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}(n)?9007199254740991:10:kt()}function nd(n,e){if(n===e)return!0;const t=ml(n);if(t!==ml(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Zp(n).isEqual(Zp(e));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=pl(r.timestampValue),a=pl(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return Yp(r.bytesValue).isEqual(Yp(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return Yn(r.geoPointValue.latitude)===Yn(s.geoPointValue.latitude)&&Yn(r.geoPointValue.longitude)===Yn(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Yn(r.integerValue)===Yn(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Yn(r.doubleValue),a=Yn(s.doubleValue);return o===a?e0(o)===e0(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return QT(n.arrayValue.values||[],e.arrayValue.values||[],nd);case 10:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(Jz(o)!==Jz(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(void 0===a[c]||!nd(o[c],a[c])))return!1;return!0}(n,e);default:return kt()}}function Kp(n,e){return void 0!==(n.values||[]).find(t=>nd(t,e))}function n0(n,e){if(n===e)return 0;const t=ml(n),i=ml(e);if(t!==i)return ri(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ri(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Yn(s.integerValue||s.doubleValue),c=Yn(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return eH(n.timestampValue,e.timestampValue);case 4:return eH(Zp(n),Zp(e));case 5:return ri(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Yp(s),c=Yp(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){const u=ri(a[l],c[l]);if(0!==u)return u}return ri(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ri(Yn(s.latitude),Yn(o.latitude));return 0!==a?a:ri(Yn(s.longitude),Yn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){const u=n0(a[l],c[l]);if(u)return u}return ri(a.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===t0&&o===t0)return 0;if(s===t0)return 1;if(o===t0)return-1;const a=s.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const d=ri(c[h],u[h]);if(0!==d)return d;const f=n0(a[c[h]],l[u[h]]);if(0!==f)return f}return ri(c.length,u.length)}(n.mapValue,e.mapValue);default:throw kt()}}function eH(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return ri(n,e);const t=pl(n),i=pl(e),r=ri(t.seconds,i.seconds);return 0!==r?r:ri(t.nanos,i.nanos)}function tH(n){return!!n&&"arrayValue"in n}function nH(n){return!!n&&"nullValue"in n}function iH(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function tA(n){return!!n&&"mapValue"in n}function Jp(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Xp(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Jp(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Jp(n.arrayValue.values[t]);return e}return Object.assign({},n)}class s0{constructor(e,t){this.position=e,this.inclusive=t}}class sH{}class Vr extends sH{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,i):new Ufe(e,t,i):"array-contains"===t?new zfe(e,i):"in"===t?new Hfe(e,i):"not-in"===t?new Gfe(e,i):"array-contains-any"===t?new Wfe(e,i):new Vr(e,t,i)}static createKeyFieldInFilter(e,t,i){return"in"===t?new Bfe(e,i):new Vfe(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(n0(t,this.value)):null!==t&&ml(this.value)===ml(t)&&this.matchesComparison(n0(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return kt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gl extends sH{constructor(e,t){super(),this.filters=e,this.op=t,this.D=null}static create(e,t){return new gl(e,t)}matches(e){return function(i){return"and"===i.op}(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.D||(this.D=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.D}getFilters(){return Object.assign([],this.filters)}}class Ufe extends Vr{constructor(e,t,i){super(e,t,i),this.key=Bn.fromName(i.referenceValue)}matches(e){const t=Bn.comparator(e.key,this.key);return this.matchesComparison(t)}}class Bfe extends Vr{constructor(e,t){super(e,"in",t),this.keys=aH(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Vfe extends Vr{constructor(e,t){super(e,"not-in",t),this.keys=aH(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function aH(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>Bn.fromName(i.referenceValue))}class zfe extends Vr{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return tH(t)&&Kp(t.arrayValue,this.value)}}class Hfe extends Vr{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Kp(this.value.arrayValue,t)}}class Gfe extends Vr{constructor(e,t){super(e,"not-in",t)}matches(e){if(Kp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Kp(this.value.arrayValue,t)}}class Wfe extends Vr{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!tH(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Kp(this.value.arrayValue,i))}}class o0{constructor(e,t="asc"){this.field=e,this.dir=t}}class Vn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Vn(e)}static min(){return new Vn(new Br(0,0))}static max(){return new Vn(new Br(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class a0{constructor(e,t){this.comparator=e,this.root=t||mi.EMPTY}insert(e,t){return new a0(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mi.BLACK,null,null))}remove(e){return new a0(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(0===r)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new c0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new c0(this.root,e,this.comparator,!1)}getReverseIterator(){return new c0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new c0(this.root,e,this.comparator,!0)}}class c0{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mi{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??mi.RED,this.left=r??mi.EMPTY,this.right=s??mi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new mi(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return mi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return mi.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw kt();const e=this.left.check();if(e!==this.right.check())throw kt();return e+(this.isRed()?0:1)}}mi.EMPTY=null,mi.RED=!0,mi.BLACK=!1,mi.EMPTY=new class{constructor(){this.size=0}get key(){throw kt()}get value(){throw kt()}get color(){throw kt()}get left(){throw kt()}get right(){throw kt()}copy(e,t,i,r,s){return this}insert(e,t,i){return new mi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qp{constructor(e){this.comparator=e,this.data=new a0(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cH(this.data.getIterator())}getIteratorFrom(e){return new cH(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof Qp)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Qp(this.comparator);return t.data=e,t}}class cH{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class _l{constructor(e){this.fields=e,e.sort(vr.comparator)}static empty(){return new _l([])}unionWith(e){let t=new Qp(vr.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new _l(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return QT(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class zr{constructor(e){this.value=e}static empty(){return new zr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!tA(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jp(t)}setAll(e){let t=vr.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Jp(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());tA(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nd(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];tA(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Xp(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new zr(Jp(this.value))}}class ro{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ro(e,0,Vn.min(),Vn.min(),Vn.min(),zr.empty(),0)}static newFoundDocument(e,t,i,r){return new ro(e,1,t,Vn.min(),i,r,0)}static newNoDocument(e,t){return new ro(e,2,t,Vn.min(),Vn.min(),zr.empty(),0)}static newUnknownDocument(e,t){return new ro(e,3,t,Vn.min(),Vn.min(),zr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Vn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ro&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ro(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $fe{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.C=null}}function lH(n,e=null,t=[],i=[],r=null,s=null,o=null){return new $fe(n,e,t,i,r,s,o)}class vl{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.S=null,this.N=null,this.O=null}}function nA(n){const e=fl(n);return e.N||(e.N=function dH(n,e){if("F"===n.limitType)return lH(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>new o0(r.field,"desc"===r.dir?"asc":"desc"));const t=n.endAt?new s0(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new s0(n.startAt.position,n.startAt.inclusive):null;return lH(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}(e,function hH(n){const e=fl(n);if(null===e.S){e.S=[];const t=new Set;for(const s of e.explicitOrderBy)e.S.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Qp(vr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.S.push(new o0(s,i))}),t.has(vr.keyField().canonicalString())||e.S.push(new o0(vr.keyField(),i))}return e.S}(n))),e.N}function fH(n,e){return function(i){return"number"==typeof i&&Number.isInteger(i)&&!e0(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}(e)?function(i){return{integerValue:""+i}}(e):function(i,r){if(i.useProto3Json){if(isNaN(r))return{doubleValue:"NaN"};if(r===1/0)return{doubleValue:"Infinity"};if(r===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e0(r)?"-0":r}}(n,e)}class l0{constructor(){this._=void 0}}class pH extends l0{}class mH extends l0{constructor(e){super(),this.elements=e}}class gH extends l0{constructor(e){super(),this.elements=e}}class _H extends l0{constructor(e,t){super(),this.serializer=e,this.q=t}}class u0{constructor(e,t){this.field=e,this.transform=t}}class Ii{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ii}static exists(e){return new Ii(void 0,e)}static updateTime(e){return new Ii(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}class h0{}class vH extends h0{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class rA extends h0{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}class d0 extends h0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yH extends h0{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}const Xfe={asc:"ASCENDING",desc:"DESCENDING"},Yfe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Zfe={and:"AND",or:"OR"};class Kfe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function sA(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Jfe(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Qfe(n,e){return sA(n,e.toTimestamp())}function em(n){return _r(!!n),Vn.fromTimestamp(function(t){const i=pl(t);return new Br(i.seconds,i.nanos)}(n))}function oA(n,e){return function(i){return new Dn(["projects",i.projectId,"databases",i.database])}(n).child("documents").child(e).canonicalString()}function f0(n,e){return oA(n.databaseId,e.path)}function wH(n,e){return oA(n.databaseId,e)}function bH(n,e,t){return{name:f0(n,e),fields:t.value.mapValue.fields}}function EH(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=wH(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=wH(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(c){if(0!==c.length)return SH(gl.create(c,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const s=function(c){if(0!==c.length)return c.map(l=>function(h){return{field:ja(h.field),direction:npe(h.dir)}}(l))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=function(c,l){return c.useProto3Json||function Yz(n){return null==n}(l)?l:{value:l}}(n,e.limit);return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),t}function npe(n){return Xfe[n]}function ipe(n){return Yfe[n]}function rpe(n){return Zfe[n]}function ja(n){return{fieldPath:n.canonicalString()}}function SH(n){return n instanceof Vr?function(t){if("=="===t.op){if(iH(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NAN"}};if(nH(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(iH(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NOT_NAN"}};if(nH(t.value))return{unaryFilter:{field:ja(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ja(t.field),op:ipe(t.op),value:t.value}}}(n):n instanceof gl?function(t){const i=t.getFilters().map(r=>SH(r));return 1===i.length?i[0]:{compositeFilter:{op:rpe(t.op),filters:i}}}(n):kt()}function spe(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function MH(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function cA(n){return new Kfe(n,!0)}class ope extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.J=!1}Y(){if(this.J)throw new Me(Go,"The client has already been terminated.")}R(e,t,i){return this.Y(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.connection.R(e,t,i,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===Ky&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Me(td,r.toString())})}g(e,t,i,r){return this.Y(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.g(e,t,i,s,o,r)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Ky&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Me(td,s.toString())})}terminate(){this.J=!0}}function lA(){return lA=Fn(function*(n,e){const t=fl(n),i=function xH(n){return new Dn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}(t.serializer)+"/documents",r={writes:e.map(s=>function tpe(n,e){let t;if(e instanceof vH)t={update:bH(n,e.key,e.value)};else if(e instanceof d0)t={delete:f0(n,e.key)};else if(e instanceof rA)t={update:bH(n,e.key,e.data),updateMask:spe(e.fieldMask)};else{if(!(e instanceof yH))return kt();t={verify:f0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof pH)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof mH)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof gH)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof _H)return{fieldPath:o.field.canonicalString(),increment:a.q};throw kt()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return void 0!==s.updateTime?{updateTime:Qfe(r,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:kt()}(n,e.precondition)),t}(t.serializer,s))};yield t.R("Commit",i,r)}),lA.apply(this,arguments)}function hA(){return hA=Fn(function*(n,e){const t=fl(n),i=EH(t.serializer,nA(e));return(yield t.g("RunQuery",i.parent,{structuredQuery:i.structuredQuery})).filter(r=>!!r.document).map(r=>function(o,a,c){const l=function aA(n,e){const t=function(r){const s=Dn.fromString(r);return _r(MH(s)),s}(e);if(t.get(1)!==n.databaseId.projectId)throw new Me(Oe,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Me(Oe,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Bn(function(r){return _r(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}(t))}(o,a.name),u=em(a.updateTime),h=a.createTime?em(a.createTime):Vn.min(),d=new zr({mapValue:{fields:a.fields}});return ro.newFoundDocument(l,u,h,d)}(t.serializer,r.document))}),hA.apply(this,arguments)}const tm=new Map;function jo(n){if(n._terminated)throw new Me(Go,"The client has already been terminated.");if(!tm.has(n)){dl("ComponentProvider","Initializing Datastore");const e=function(s){return new Pfe(s,fetch.bind(null))}(function(s,o,a,c){return new Afe(s,o,a,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Xz(c.experimentalLongPollingOptions),c.useFetchStreams)}(n._databaseId,n.app.options.appId||"",n._persistenceKey,n._freezeSettings())),t=cA(n._databaseId),i=function(s,o,a,c){return new ope(s,o,a,c)}(n._authCredentials,n._appCheckCredentials,e,t);tm.set(n,i)}return tm.get(n)}class AH{constructor(e){var t,i;if(void 0===e.host){if(void 0!==e.ssl)throw new Me(Oe,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Me(Oe,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(s,o,a,c){if(!0===o&&!0===c)throw new Me(Oe,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Xz(null!==(i=e.experimentalLongPollingOptions)&&void 0!==i?i:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new Me(Oe,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Me(Oe,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Me(Oe,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $o{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new AH({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Me(Go,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Me(Go,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new AH(e),void 0!==e.credentials&&(this._authCredentials=function(i){if(!i)return new xfe;switch(i.type){case"firstParty":return new Mfe(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Me(Oe,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=tm.get(t);i&&(dl("ComponentProvider","Removing Datastore"),tm.delete(t),i.terminate())}(this),Promise.resolve()}}function lpe(n,e){const t="object"==typeof n?n:function afe(n=qy){const e=ul.get(n);if(!e&&n===qy&&gz())return Iz();if(!e)throw Ho.create("no-app",{appName:n});return e}(),i="string"==typeof n?n:e||"(default)",r=function Dz(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}(t,"firestore/lite").getImmediate({identifier:i});if(!r._initialized){const s=(n=>{const e=(n=>{var e,t;return null===(t=null===(e=Wy())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[n]})(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),i]:[e.substring(0,t),i]})("firestore");s&&function upe(n,e,t,i={}){var r;const s=(n=cs(n,$o))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Fz("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if("string"==typeof i.mockUserToken)a=i.mockUserToken,c=gr.MOCK_USER;else{a=function Khe(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Gy(JSON.stringify({alg:"none",type:"JWT"})),Gy(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const l=i.mockUserToken.sub||i.mockUserToken.user_id;if(!l)throw new Me(Oe,"mockUserToken must contain 'sub' or 'user_id' field!");c=new gr(l)}n._authCredentials=new bfe(new Wz(a,c))}}(r,...s)}return r}class Hr{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Hr(this.firestore,e,this._query)}}class si{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ms(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new si(this.firestore,e,this._key)}}class Ms extends Hr{constructor(e,t,i){super(e,t,function(s){return new vl(s)}(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new si(this.firestore,null,new Bn(e))}withConverter(e){return new Ms(this.firestore,e,this._path)}}class rd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rd(Wo.fromBase64String(e))}catch(t){throw new Me(Oe,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new rd(Wo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class yl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Me(Oe,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class p0{constructor(e){this._methodName=e}}class fA{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Me(Oe,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Me(Oe,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ri(this._lat,e._lat)||ri(this._long,e._long)}}const fpe=/^__.*__$/;class RH{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new rA(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function PH(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw kt()}}class m0{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,void 0===s&&this.X(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get tt(){return this.settings.tt}et(e){return new m0(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}rt(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.et({path:i,nt:!1});return r.it(e),r}st(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.et({path:i,nt:!1});return r.X(),r}ot(e){return this.et({path:void 0,nt:!0})}ut(e){return _0(e,this.settings.methodName,this.settings._t||!1,this.path,this.settings.ct)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}X(){if(this.path)for(let e=0;e<this.path.length;e++)this.it(this.path.get(e))}it(e){if(0===e.length)throw this.ut("Document fields must not be empty");if(PH(this.tt)&&fpe.test(e))throw this.ut('Document fields cannot begin and end with "__"')}}class mpe{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||cA(e)}lt(e,t,i,r=!1){return new m0({tt:e,methodName:t,ct:i,path:vr.emptyPath(),nt:!1,_t:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}class im extends p0{_toFieldTransform(e){if(2!==e.tt)throw e.ut(1===e.tt?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof im}}class vpe extends p0{constructor(e,t){super(e),this.dt=t}_toFieldTransform(e){const t=new _H(e.serializer,fH(e.serializer,this.dt));return new u0(e.path,t)}isEqual(e){return this===e}}function xl(n,e){if(FH(n=Ga(n)))return _A("Unsupported field value:",e,n),function OH(n,e){const t={};return function(r){for(const s in r)if(Object.prototype.hasOwnProperty.call(r,s))return!1;return!0}(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xp(n,(i,r)=>{const s=xl(r,e.rt(i));null!=s&&(t[i]=s)}),{mapValue:{fields:t}}}(n,e);if(n instanceof p0)return function(i,r){if(!PH(r.tt))throw r.ut(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ut(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.nt&&4!==e.tt)throw e.ut("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let c=xl(a,r.ot(o));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if(null===(i=Ga(i)))return{nullValue:"NULL_VALUE"};if("number"==typeof i)return fH(r.serializer,i);if("boolean"==typeof i)return{booleanValue:i};if("string"==typeof i)return{stringValue:i};if(i instanceof Date){const s=Br.fromDate(i);return{timestampValue:sA(r.serializer,s)}}if(i instanceof Br){const s=new Br(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:sA(r.serializer,s)}}if(i instanceof fA)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof rd)return{bytesValue:Jfe(r.serializer,i._byteString)};if(i instanceof si){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.ut(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:oA(i.firestore._databaseId||r.databaseId,i._key.path)}}throw r.ut(`Unsupported field value: ${Jy(i)}`)}(n,e)}function FH(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Br||n instanceof fA||n instanceof rd||n instanceof si||n instanceof p0)}function _A(n,e,t){if(!FH(t)||!function(r){return"object"==typeof r&&null!==r&&(Object.getPrototypeOf(r)===Object.prototype||null===Object.getPrototypeOf(r))}(t)){const i=Jy(t);throw e.ut("an object"===i?n+" a custom object":n+" "+i)}}function rm(n,e,t){if((e=Ga(e))instanceof yl)return e._internalPath;if("string"==typeof e)return vA(n,e);throw _0("Field path arguments must be of type string or ",n,!1,void 0,t)}const ype=new RegExp("[~\\*/\\[\\]]");function vA(n,e,t){if(e.search(ype)>=0)throw _0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new yl(...e.split("."))._internalPath}catch{throw _0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function _0(n,e,t,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new Me(Oe,a+n+c)}function kH(n,e){return n.some(t=>t.isEqual(e))}class bl{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new si(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new UH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(function wA(n,e){return"string"==typeof e?vA(n,e):e instanceof yl?e._internalPath:e._delegate._internalPath}("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class UH extends bl{data(){return super.data()}}class yA{constructor(e,t){this._docs=t,this.query=e}get docs(){return[...this._docs]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(e,t){this._docs.forEach(e,t)}}class b0 extends class{convertValue(t,i="none"){switch(ml(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Yn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,i);case 5:return t.stringValue;case 6:return this.convertBytes(Yp(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,i);case 10:return this.convertObject(t.mapValue,i);default:throw kt()}}convertObject(t,i){return this.convertObjectMap(t.fields,i)}convertObjectMap(t,i="none"){const r={};return Xp(t,(s,o)=>{r[s]=this.convertValue(o,i)}),r}convertGeoPoint(t){return new fA(Yn(t.latitude),Yn(t.longitude))}convertArray(t,i){return(t.values||[]).map(r=>this.convertValue(r,i))}convertServerTimestamp(t,i){switch(i){case"previous":const r=Qz(t);return null==r?null:this.convertValue(r,i);case"estimate":return this.convertTimestamp(Zp(t));default:return null}}convertTimestamp(t){const i=pl(t);return new Br(i.seconds,i.nanos)}convertDocumentKey(t,i){const r=Dn.fromString(t);_r(MH(r));const s=new $p(r.get(1),r.get(3)),o=new Bn(r.popFirst(5));return s.isEqual(i)||Zy(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),o}}{constructor(e){super(),this.firestore=e}convertBytes(e){return new rd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new si(this.firestore,null,t)}}function Cpe(n){return new vpe("increment",n)}ed="10.7.0_lite",Yy(new Wp("firestore/lite",(e,{instanceIdentifier:t,options:i})=>{const r=e.getProvider("app").getImmediate(),s=new $o(new Efe(e.getProvider("auth-internal")),new Tfe(e.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Me(Oe,'"projectId" not provided in firebase.initializeApp.');return new $p(a.options.projectId,c)}(r,t),r);return i&&s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),Qh("firestore-lite","4.4.0",""),Qh("firestore-lite","4.4.0","esm2017");const Npe={apiKey:"AIzaSyAZtsaXYC5VSw1qssHszoLzOjgtDEM_kIc",authDomain:"art-3d-exhibit.firebaseapp.com",projectId:"art-3d-exhibit",storageBucket:"art-3d-exhibit.appspot.com",messagingSenderId:"652122924025",appId:"1:652122924025:web:8753742d36068d00149328"};let Lpe=(()=>{var n;class e{constructor(){this.artworksArray=[{id:0,title:"Self Portrait",audio:"assets/audio/1.mp3",date:"1887",description:"This self-portrait was one of about 32 produced over a 10-year period, and these were an important part of his work as a painter; he painted himself because he often lacked the money to pay for models. Art historians are divided as to whether this painting is Van Gogh's final self-portrait or not. It is considered that it was painted in Arles following Van Gogh's admission to hospital after mutilating his ear. Van Gogh sent the picture to his younger brother, the art dealer Theo; an accompanying letter read: 'I hope you will notice that my facial expressions have become much calmer, although my eyes have the same insecure look as before, or so it appears to me.'",height:65,textureUrl:"assets/artworks/selfportrait.webp",votes:0,width:54,wiki:"https://wikipedia.org/wiki/Van_Gogh_self-portrait_(1889)"},{id:1,title:"Almond Blossom",audio:"assets/audio/2.mp3",date:"1890",description:"In mid-March 1888 van Gogh writes that the almond trees are coming into full flower, weather there is changeable, often windy with turbulent skies. Later on Theo wrote to his brother Vincent on January 31, 1890, to announce the birth of his son, Vincent Willem van Gogh. He was very close to his brother and he sought to symbolize new life in the flowers of the almond tree for the birth of baby Vincent.",height:73.5,textureUrl:"assets/artworks/almond_blossom.webp",votes:34,width:92,wiki:"https://en.wikipedia.org/wiki/Almond_Blossoms"},{id:2,title:"The Bedroom",audio:"assets/audio/3.mp3",date:"1887",description:"The painting depicts van Gogh's bedroom at 2, Place Lamartine in Arles, Bouches-du-Rhone, France, known as the Yellow House. The door to the right opened on to the upper floor and the staircase; the door to the left was that of the guest room he held prepared for Gauguin; the window in the front wall looked on to Place Lamartine and its public gardens. This room was not rectangular but trapezoid with an obtuse angle in the left hand corner of the front wall and an acute angle at the right.",height:72.4,textureUrl:"assets/artworks/bedroom.webp",votes:65,width:91.3,wiki:"https://wikipedia.org/wiki/Bedroom_in_Arles"},{id:3,title:"Sunflowers",audio:"assets/audio/1.mp3",date:"1887",description:"This is one of five versions of Sunflowers on display in museums and galleries across the world. Van Gogh made the paintings to decorate his house in Arles in readiness for a visit from his friend and fellow artist, Paul Gauguin.'The sunflower is mine', Van Gogh once declared, and it is clear that the flower had various meanings for him. The different stages in the sunflower's life cycle shown here, from young bud through to maturity and eventual decay, follow in the vanitas tradition of Dutch seventeenth-century flower paintings, which emphasise the transient nature of human actions. The sunflowers were perhaps also intended to be a symbol of friendship and a celebration of the beauty and vitality of nature.",height:95,textureUrl:"assets/artworks/sunflowers.webp",votes:72,width:73,download:"https://en.wikipedia.org/wiki/File:Vincent_van_Gogh_-_Sunflowers_-_VGM_F458.jpg",wiki:"https://wikipedia.org/wiki/Sunflowers_(Van_Gogh_series)"},{id:4,title:"Irises",audio:"assets/audio/1.mp3",date:"1889",description:"Van Gogh painted this still life in the psychiatric hospital in Saint-Remy. For him, the painting was mainly a study in color. He set out to achieve a powerful color contrast. By placing the purple flowers against a yellow background, he made the decorative forms stand out even more strongly. The irises were originally purple. But as the red pigment has faded, they have turned blue. Van Gogh made two paintings of this bouquet. In the other still life, he contrasted purple and pink with green.",height:93,textureUrl:"assets/artworks/irises.webp",votes:56,width:74,wiki:"https://en.wikipedia.org/wiki/Vase_with_Irises_Against_a_Yellow_Background"}],this.artworks=rc(this.artworksArray),this.config=Npe,this.app=Iz(this.config),this.db=lpe(this.app),this.upvoted=[],this.dbArtworks=function dpe(n,e,...t){if(n=Ga(n),JT("collection","path",e),n instanceof $o){const i=Dn.fromString(e,...t);return $z(i),new Ms(n,null,i)}{if(!(n instanceof si||n instanceof Ms))throw new Me(Oe,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Dn.fromString(e,...t));return $z(i),new Ms(n.firestore,null,i)}}(this.db,"artworks"),this.getFirebaseData()}getArtworks(){return this.artworks()}getFirebaseData(){var i=this;return Fn(function*(){const r=yield function bpe(n){!function(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Me(ZT,"limitToLast() queries require specifying at least one orderBy() clause")}((n=cs(n,Hr))._query);const e=jo(n.firestore),t=new b0(n.firestore);return function ape(n,e){return hA.apply(this,arguments)}(e,n._query).then(i=>{const r=i.map(s=>new UH(n.firestore,t,s.key,s,n.converter));return"L"===n._query.limitType&&r.reverse(),new yA(n,r)})}(i.dbArtworks);i.artworksArray.map((s,o)=>{s.votes=r.docs[o].data().votes}),i.artworks.set(i.artworksArray)})()}upvoteArtwork(i){-1===this.upvoted.indexOf(i)?(this.upvoted.push(i),this.artworks.update(r=>(r[i].votes=r[i].votes+1,r)),this.updateFirebase(i)):console.log("Upvoted already!")}updateFirebase(i){var r=this;return Fn(function*(){const s=function DH(n,e,...t){if(n=Ga(n),1===arguments.length&&(e=Ofe.newId()),JT("doc","path",e),n instanceof $o){const i=Dn.fromString(e,...t);return jz(i),new si(n,null,new Bn(i))}{if(!(n instanceof si||n instanceof Ms))throw new Me(Oe,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Dn.fromString(e,...t));return jz(i),new si(n.firestore,n instanceof Ms?n.converter:null,new Bn(i))}}(r.db,`artworks/${i}`);yield function Epe(n,e,t,...i){const r=function wl(n){const e=n._freezeSettings(),t=cA(n._databaseId);return new mpe(n._databaseId,!!e.ignoreUndefinedProperties,t)}((n=cs(n,si)).firestore);let s;return s="string"==typeof(e=Ga(e))||e instanceof yl?function gA(n,e,t,i,r,s){const o=n.lt(1,e,t),a=[rm(e,i,t)],c=[r];if(s.length%2!=0)throw new Me(Oe,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(rm(e,s[d])),c.push(s[d+1]);const l=[],u=zr.empty();for(let d=a.length-1;d>=0;--d)if(!kH(l,a[d])){const f=a[d];let p=c[d];p=Ga(p);const m=o.st(f);if(p instanceof im)l.push(f);else{const _=xl(p,m);null!=_&&(l.push(f),u.set(f,_))}}const h=new _l(l);return new RH(u,h,o.fieldTransforms)}(r,"updateDoc",n._key,e,t,i):function mA(n,e,t,i){const r=n.lt(1,e,t);_A("Data must be an object, but it was:",r,i);const s=[],o=zr.empty();Xp(i,(c,l)=>{const u=vA(e,c,t);l=Ga(l);const h=r.st(u);if(l instanceof im)s.push(u);else{const d=xl(l,h);null!=d&&(s.push(u),o.set(u,d))}});const a=new _l(s);return new RH(o,a,r.fieldTransforms)}(r,"updateDoc",n._key,e),function id(n,e){return lA.apply(this,arguments)}(jo(n.firestore),[s.toMutation(n._key,Ii.exists(!0))])}(s,{votes:Cpe(1)})})()}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275prov=Ae({token:n,factory:n.\u0275fac,providedIn:"platform"}),e})(),Ope=(()=>{var n;class e{constructor(){this.baseUrl="https://twitter.com/intent/tweet",this.hashtags="Angular,WebXR,AngularSignals",this.text="Checkout Angular WebXR Art Gallery!",this.imageUrl="assets/images/thumbnail.jpg",this.tweetHref=rc(`${this.baseUrl}?text=${encodeURIComponent(this.text)}&hashtags=${this.hashtags}&url=https://webxr.art&image=${this.imageUrl}`)}onTweet(i){this.tweetHref.set(`${this.baseUrl}?text=${encodeURIComponent(this.text)}&hashtags=${this.hashtags}`)}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=Xa({type:n,selectors:[["art-tweet"]],decls:3,vars:1,consts:[["aria-label","Tweet Angular WebXR Gallery","target","_blank","rel","noopener","data-size","large","title","Twitter","appTweet","",1,"twitter-share-button",3,"href"],["id","twitter-logo","xmlns","http://www.w3.org/2000/svg","height","24","width","24","data-name","Logo","viewBox","0 0 512 512","fill","#fff"],["d","M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"]],template:function(i,r){1&i&&(mo(0,"a",0),function oD(){Je.lFrame.currentNamespace="svg"}(),mo(1,"svg",1),fa(2,"path",2),da()()),2&i&&Tb("href",r.tweetHref(),Ex)},styles:['[_nghost-%COMP%]{display:block;position:fixed;top:0;right:50px;z-index:1005}#twitter-logo[_ngcontent-%COMP%]{height:40px;margin:0 8px}image[_ngcontent-%COMP%]{src:"assets/images/gallery.png"}#twitter-logo[_ngcontent-%COMP%]:hover{opacity:.8}']}),e})();const Fpe=["#loading-bar"],kpe=["#bar"];let Upe=(()=>{var n;class e{constructor(){this.progress=0,this.delta=0}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=Xa({type:n,selectors:[["art-loading"]],viewQuery:function(i,r){if(1&i&&(Qg(Fpe,7),Qg(kpe,7)),2&i){let s;mf(s=gf())&&(r.div=s.first),mf(s=gf())&&(r.bar=s.first)}},inputs:{delta:"delta"},decls:2,vars:1,consts:[["id","loading-bar"],["id","progress-bar","aria-label","Content loading\u2026","max","100",3,"value"]],template:function(i,r){1&i&&(mo(0,"div",0),fa(1,"progress",1),da()),2&i&&(xg(1),Ng("value",r.delta))},styles:['[_nghost-%COMP%]{width:100%;height:100%}#loading-bar[_ngcontent-%COMP%]{position:fixed;top:50%;left:10%;width:80%;height:10%;opacity:"0.7";display:"flex";align-items:"center";justify-content:center;z-index:"1111";display:flex}#bar-base[_ngcontent-%COMP%]{background:"#aaa";width:"50%";min-width:"250px";border-radius:"10px";height:"15px"}#bar[_ngcontent-%COMP%]{background:"#22a";width:"50%";border-radius:"10px";height:"100%";width:"0"}']}),e})();const Bpe=["canvas"];function Vpe(n,e){1&n&&fa(0,"art-loading",0),2&n&&Ng("delta",ON().loadersService.loadingProgress())}const zpe=[{path:"",component:(()=>{var n;class e{get canvasEl(){return this.canvas?.nativeElement}constructor(i,r,s,o,a,c){this.sceneService=i,this.artworksService=r,this.framesService=s,this.loadersService=o,this.ui=a,this.ngZone=c,this.loadingBar=!0,this.loadingClass="loading",this.artworks=[],this.artworksLength=0,this.selectedIndex=rc(0),this.loadingProgress=rc(0),this.focused=0,this.info=function Zj(n,e){const t=function cG(n){const e=Object.create(lG);e.computation=n;const t=()=>{if(RA(e),R0(e),e.value===hm)throw e.error;return e.value};return t[Xo]=e,t}(n);return e?.equal&&(t[Xo].equal=e.equal),t}(()=>{this.selectedIndex()})}ngOnInit(){const i=Date.now();this.artworks=this.artworksService.getArtworks();const r=this.sceneService.initScene(this.canvasEl);this.loadersService.loadModel({path:"assets/models/VRGallery0110NoFloorTexture.glb",scene:this.sceneService.scene,onLoadProgress:this.onLoadProgress.bind(this),onLoadCB:()=>{this.sceneService.addToScene(this.frames),this.loadingBar=!1}}),this.loadersService.loadModel({path:"assets/models/VRGalleryInnerWalls0110Merge.glb",scene:this.sceneService.scene,onLoadProgress:this.onLoadProgress.bind(this),onLoadCB:()=>{r(i)}}),this.buttons=[{name:"Next Button",text:"Next",onClick:a=>{this.changeSelection(a,1)},position:{x:-.75,y:0,z:-0},rotation:{}},{name:"Upvote Button",text:"Upvote",onClick:a=>{this.upvoteSelection(a)},position:{x:-.8,y:.8,z:-.1},rotation:{}},{name:"Previous Button",text:"Previous",onClick:a=>{this.changeSelection(a,-1)},position:{x:.75,y:0,z:-0},rotation:{}}],this.frames=this.framesService.createFrames(this.artworks,this.buttons,r),this.sceneService.renderFunctions.push(this.ui.update),this.artworksLength=this.artworks.length,this.selectedArtwork=rc(this.artworks[0],{equal:this.compareSelected})}onLoadProgress(i){}compareSelected(i,r){return!i||i.id===r.id}onSelectArtwork(){this.framesService.focusFrame(this.selectedArtwork().id)}changeSelection(i,r){let s;console.log("Selection is changing",i,r),this.framesService.resetPosition(this.focused),1===r?(s=i<this.artworksLength-1?i+1:0,this.framesService.rotateFrames(72)):-1===r&&(s=0===i?this.artworksLength-1:i-1,this.framesService.rotateFrames(-72)),this.focused=s,this.framesService.focusFrame(s)}upvoteSelection(i){this.artworksService.upvoteArtwork(i);const s=this.frames.children[i].getObjectByName(`${i} Text`);this.ui.updateVote({votes:this.artworks[i].votes,text:s})}}return(n=e).\u0275fac=function(i){return new(i||n)(Ue(FV),Ue(Lpe),Ue(dz),Ue(oT),Ue(AT),Ue(It))},n.\u0275cmp=Xa({type:n,selectors:[["art-gallery"]],viewQuery:function(i,r){if(1&i&&Qg(Bpe,7),2&i){let s;mf(s=gf())&&(r.canvas=s.first)}},decls:4,vars:2,consts:[[3,"delta"],[3,"resize"],["canvas",""]],template:function(i,r){if(1&i&&(fa(0,"art-tweet"),vu(1,Vpe,1,1,"art-loading",0),mo(2,"canvas",1,2),Yg("resize",function(o){return r.sceneService.onResize(o)},0,HD),da()),2&i){const s=function WN(n){return function Fl(n,e){return n[e]}(function _5(){return Je.lFrame.contextLView}(),it+n)}(3);xg(1),DP(1,r.loadersService.loadingProgress()<100?1:-1),xg(1),Rg("aria-label",s)}},dependencies:[Ope,Upe],styles:["#canvas[_ngcontent-%COMP%]{width:100%;height:100%;display:block}.loaded[_ngcontent-%COMP%]{display:none}.loading[_ngcontent-%COMP%]{display:block}mat-progress-bar[_ngcontent-%COMP%]{height:40px}"],changeDetection:0}),e})(),title:"WebXR Gallery"},{path:"**",component:(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275cmp=Xa({type:n,selectors:[["art-error"]],decls:2,vars:0,template:function(i,r){1&i&&(mo(0,"p"),function eL(n,e=""){const t=X(),i=Et(),r=n+it,s=i.firstCreatePass?su(i,r,1,e,null):i.data[r],o=tL(i,t,s,e,n);t[r]=o,Im()&&sg(i,t,o,s),Ls(s,!1)}(1,"error works!"),da())}}),e})(),title:"Error Page"}];let Hpe=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=As({type:n}),n.\u0275inj=us({imports:[C2.forRoot(zpe),C2]}),e})(),Gpe=(()=>{var n;class e{constructor(i,r,s){this.router=i,this.titleService=r,this.document=s,this.handleRouteEvents()}handleRouteEvents(){this.router.events.subscribe(i=>{if(i instanceof Gs){const r=this.getTitle(this.router.routerState,this.router.routerState.root).join("-");this.titleService.setTitle(r),gtag("event","page_view",{page_title:r,page_path:i.urlAfterRedirects,page_location:this.document.location.href})}})}getTitle(i,r){const s=[];return r&&r.snapshot.data&&r.snapshot.data.title&&s.push(r.snapshot.data.title),i&&r&&r.firstChild&&s.push(...this.getTitle(i,r.firstChild)),s}}return(n=e).\u0275fac=function(i){return new(i||n)(Ue(Kr),Ue(UE),Ue(sr))},n.\u0275cmp=Xa({type:n,selectors:[["art-root"]],decls:2,vars:0,consts:[["role","main",1,"content"]],template:function(i,r){1&i&&(mo(0,"div",0),fa(1,"router-outlet"),da())},dependencies:[oS],styles:['[_nghost-%COMP%] {\n    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n    font-size: 14px;\n    color: #333;\n    box-sizing: border-box;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    margin: 0;\n  }\n\n  body[_ngcontent-%COMP%] {\n    margin-top: 0;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #twitter-logo[_ngcontent-%COMP%] {\n    height: 40px;\n    margin: 0 8px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #youtube-logo[_ngcontent-%COMP%] {\n    height: 40px;\n    margin: 0 16px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #twitter-logo[_ngcontent-%COMP%]:hover, .toolbar[_ngcontent-%COMP%]   #youtube-logo[_ngcontent-%COMP%]:hover {\n    opacity: 0.8;\n  }']}),e})(),Wpe=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=As({type:n}),n.\u0275inj=us({imports:[tF]}),e})(),jpe=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=As({type:n}),n.\u0275inj=us({providers:[dz,_V,oT,FV,AT,OV]}),e})();const $pe=["addListener","removeListener"],qpe=["addEventListener","removeEventListener"],Xpe=["on","off"];function E0(n,e,t,i){if(Ct(t)&&(i=t,t=void 0),i)return E0(n,e,t).pipe(SF(i));const[r,s]=function Kpe(n){return Ct(n.addEventListener)&&Ct(n.removeEventListener)}(n)?qpe.map(o=>a=>n[o](e,a,t)):function Ype(n){return Ct(n.addListener)&&Ct(n.removeListener)}(n)?$pe.map(WH(n,e)):function Zpe(n){return Ct(n.on)&&Ct(n.off)}(n)?Xpe.map(WH(n,e)):[];if(!r&&K0(n))return Zn(o=>E0(o,e,t))(Pi(n));if(!r)throw new TypeError("Invalid event target");return new sn(o=>{const a=(...c)=>o.next(1<c.length?c:c[0]);return r(a),()=>s(a)})}function WH(n,e){return t=>i=>n[t](e,i)}const od=new sn(ud),Qpe={connector:()=>new Ki};function jH(n,e=Qpe){const{connector:t}=e;return bn((i,r)=>{const s=t();Pi(n(function Jpe(n){return new sn(e=>n.subscribe(e))}(s))).subscribe(r),r.add(i.subscribe(s))})}class nme extends Zi{constructor(e,t){super()}schedule(e,t=0){return this}}const S0={setInterval(n,e,...t){const{delegate:i}=S0;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=S0;return(e?.clearInterval||clearInterval)(n)},delegate:void 0},$H={now:()=>($H.delegate||Date).now(),delegate:void 0};class om{constructor(e,t=om.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}om.now=$H.now;const qH=new class rme extends om{constructor(e,t=om.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class ime extends nme{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return S0.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&S0.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,dm(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),sme=qH;function XH(n,e){return e?t=>Tf(e.pipe(or(1),function ome(){return bn((n,e)=>{n.subscribe(Rn(e,ud))})}()),t.pipe(XH(n))):Zn((t,i)=>Pi(n(t,i)).pipe(or(1),TF(t)))}const am="Service workers are disabled or not supported by this browser";class M0{constructor(e){if(this.serviceWorker=e,e){const i=E0(e,"controllerchange").pipe(At(()=>e.controller)),s=Tf(M_(()=>Xe(e.controller)),i);this.worker=s.pipe(Mr(u=>!!u)),this.registration=this.worker.pipe(Ni(()=>e.getRegistration()));const l=E0(e,"message").pipe(At(u=>u.data)).pipe(Mr(u=>u&&u.type)).pipe(function tme(n){return n?e=>jH(n)(e):e=>function eme(n,e){const t=Ct(n)?n:()=>n;return Ct(e)?jH(e,{connector:t}):i=>new HE(i,t)}(new Ki)(e)}());l.connect(),this.events=l}else this.worker=this.events=this.registration=function ume(n){return M_(()=>Af(new Error(n)))}(am)}postMessage(e,t){return this.worker.pipe(or(1),ui(i=>{i.postMessage({action:e,...t})})).toPromise().then(()=>{})}postMessageWithOperation(e,t,i){const r=this.waitForOperationCompleted(i),s=this.postMessage(e,t);return Promise.all([s,r]).then(([,o])=>o)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(e){let t;return t="string"==typeof e?i=>i.type===e:i=>e.includes(i.type),this.events.pipe(Mr(t))}nextEventOfType(e){return this.eventsOfType(e).pipe(or(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(Mr(t=>t.nonce===e),or(1),At(t=>{if(void 0!==t.result)return t.result;throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let YH=(()=>{var n;class e{get isEnabled(){return this.sw.isEnabled}constructor(i){if(this.sw=i,this.pushManager=null,this.subscriptionChanges=new Ki,!i.isEnabled)return this.messages=od,this.notificationClicks=od,void(this.subscription=od);this.messages=this.sw.eventsOfType("PUSH").pipe(At(s=>s.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(At(s=>s.data)),this.pushManager=this.sw.registration.pipe(At(s=>s.pushManager));const r=this.pushManager.pipe(Ni(s=>s.getSubscription()));this.subscription=Q0(r,this.subscriptionChanges)}requestSubscription(i){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(am));const r={userVisibleOnly:!0};let s=this.decodeBase64(i.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(s.length));for(let a=0;a<s.length;a++)o[a]=s.charCodeAt(a);return r.applicationServerKey=o,this.pushManager.pipe(Ni(a=>a.subscribe(r)),or(1)).toPromise().then(a=>(this.subscriptionChanges.next(a),a))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(or(1),Ni(r=>{if(null===r)throw new Error("Not subscribed to push notifications.");return r.unsubscribe().then(s=>{if(!s)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(am))}decodeBase64(i){return atob(i)}}return(n=e).\u0275fac=function(i){return new(i||n)(we(M0))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})(),ZH=(()=>{var n;class e{get isEnabled(){return this.sw.isEnabled}constructor(i){if(this.sw=i,!i.isEnabled)return this.versionUpdates=od,void(this.unrecoverable=od);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(am));const i=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:i},i)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(am));const i=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:i},i)}}return(n=e).\u0275fac=function(i){return new(i||n)(we(M0))},n.\u0275prov=Ae({token:n,factory:n.\u0275fac}),e})();const KH=new Ne("NGSW_REGISTER_SCRIPT");function hme(n,e,t,i){return()=>{if(!iF(i)||!("serviceWorker"in navigator)||!1===t.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof t.registrationStrategy)r=t.registrationStrategy();else{const[o,...a]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(o){case"registerImmediately":r=Xe(null);break;case"registerWithDelay":r=JH(+a[0]||0);break;case"registerWhenStable":r=a[0]?Q0(QH(n),JH(+a[0])):QH(n);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`)}}n.get(It).runOutsideAngular(()=>r.pipe(or(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:t.scope}).catch(o=>console.error("Service worker registration failed with:",o))))}}function JH(n){return Xe(null).pipe(function lme(n,e=qH){const t=function cme(n=0,e,t=sme){let i=-1;return null!=e&&(c1(e)?t=e:i=e),new sn(r=>{let s=function ame(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,e);return XH(()=>t)}(n))}function QH(n){return n.get(dc).isStable.pipe(Mr(t=>t))}function dme(n,e){return new M0(iF(e)&&!1!==n.enabled?navigator.serviceWorker:void 0)}class SA{}function fme(n,e={}){return function $w(n){return{\u0275providers:n}}([YH,ZH,{provide:KH,useValue:n},{provide:SA,useValue:e},{provide:M0,useFactory:dme,deps:[SA,ra]},{provide:t_,useFactory:hme,deps:[nr,KH,SA,ra],multi:!0}])}let pme=(()=>{var n;class e{static register(i,r={}){return{ngModule:e,providers:[fme(i,r)]}}}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=As({type:n}),n.\u0275inj=us({providers:[YH,ZH]}),e})(),mme=(()=>{var n;class e{}return(n=e).\u0275fac=function(i){return new(i||n)},n.\u0275mod=As({type:n,bootstrap:[Gpe]}),n.\u0275inj=us({imports:[GK,Hpe,Wpe,jpe,pme.register("ngsw-worker.js",{enabled:!0,registrationStrategy:"registerWhenStable:30000"})]}),e})();zK().bootstrapModule(mme).catch(n=>console.error(n))}},A0=>{A0(A0.s=580)}]);